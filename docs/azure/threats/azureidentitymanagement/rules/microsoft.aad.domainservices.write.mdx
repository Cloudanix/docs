--- 
slug: Microsoft.AAD.domainServices.write
eventname: Microsoft.AAD.domainServices.write
title: Microsoft.AAD.domainServices.write
sidebar_label: Microsoft.AAD.domainServices.write
---
                       
### Event Information

- The Microsoft.AAD.domainServices.write event in Azure for Azure Identity Management refers to a write operation performed on Azure Active Directory (AAD) Domain Services.
- This event indicates that a change or modification has been made to the AAD Domain Services configuration, such as adding or removing a domain, updating domain settings, or managing domain join operations.
- It is important to monitor this event to track any changes made to the AAD Domain Services configuration and ensure that they align with the desired configuration and security policies.


### Examples

1. Unauthorized modification of Azure Active Directory (AAD) domain services: If security is impacted with Microsoft.AAD.domainServices.write in Azure for Azure Identity Management, it could potentially allow an attacker to modify the configuration or settings of Azure Active Directory domain services. This could lead to unauthorized access, privilege escalation, or disruption of critical services.

2. Compromise of user identities and access controls: A security impact with Microsoft.AAD.domainServices.write could result in the compromise of user identities and access controls within Azure Active Directory. This could allow an attacker to gain unauthorized access to sensitive resources, manipulate user permissions, or perform malicious activities on behalf of legitimate users.

3. Breach of compliance and regulatory requirements: If security is impacted with Microsoft.AAD.domainServices.write, it could result in a breach of compliance and regulatory requirements. This could lead to penalties, legal consequences, and reputational damage for organizations that are required to adhere to specific security standards such as GDPR, HIPAA, or PCI DSS. It is crucial to ensure the integrity and security of Azure Identity Management to maintain compliance with these standards.

### Remediation

#### Using Console

1. Unauthorized modification of Azure Active Directory (AAD) domain services:

- Step 1: Sign in to the Azure portal (https://portal.azure.com) using your Azure account credentials.
- Step 2: Navigate to the Azure Active Directory service by clicking on "Azure Active Directory" in the left-hand menu.
- Step 3: In the Azure Active Directory overview page, click on "Azure AD Domain Services" in the left-hand menu.
- Step 4: In the Azure AD Domain Services page, select the specific domain service that you want to remediate.
- Step 5: Click on the "Properties" tab to access the configuration settings for the domain service.
- Step 6: Review the current configuration settings and ensure that the "Microsoft.AAD.domainServices.write" permission is only granted to authorized individuals or roles.
- Step 7: If unauthorized access or modification is detected, remove the permission from any unauthorized users or roles by clicking on "Access control (IAM)" in the left-hand menu and managing the permissions accordingly.
- Step 8: Regularly monitor the Azure AD Domain Services for any suspicious activities or unauthorized modifications.

2. Privilege escalation:

- Step 1: Sign in to the Azure portal (https://portal.azure.com) using your Azure account credentials.
- Step 2: Navigate to the Azure Active Directory service by clicking on "Azure Active Directory" in the left-hand menu.
- Step 3: In the Azure Active Directory overview page, click on "Azure AD Domain Services" in the left-hand menu.
- Step 4: In the Azure AD Domain Services page, select the specific domain service that you want to remediate.
- Step 5: Click on the "Properties" tab to access the configuration settings for the domain service.
- Step 6: Review the current configuration settings and ensure that the "Microsoft.AAD.domainServices.write" permission is only granted to authorized individuals or roles.
- Step 7: Regularly review and audit the permissions assigned to users and roles within Azure Identity Management to identify any unauthorized assignments or potential privilege escalations.
- Step 8: If unauthorized access or privilege escalation is detected, remove the permission from any unauthorized users or roles by clicking on "Access control (IAM)" in the left-hand menu and managing the permissions accordingly.

3. Unauthorized domain takeover:

- Step 1: Sign in to the Azure portal (https://portal.azure.com) using your Azure account credentials.
- Step 2: Navigate to the Azure Active Directory service by clicking on "Azure Active Directory" in the left-hand menu.
- Step 3: In the Azure Active Directory overview page, click on "Azure AD Domain Services" in the left-hand menu.
- Step 4: In the Azure AD Domain Services page, select the specific domain service that you want to remediate.
- Step 5: Click on the "Properties" tab to access the configuration settings for the domain service.
- Step 6: Review the current configuration settings and ensure that the "Microsoft.AAD.domainServices.write" permission is only granted to authorized individuals or roles.
- Step 7: Regularly monitor the Azure AD Domain Services for any suspicious activities or unauthorized modifications.
- Step 8: Implement additional security measures such as multi-factor authentication, strong password policies, and regular security assessments to reduce the risk of unauthorized domain takeovers.

#### Using CLI

1. To remediate unauthorized modification of Azure Active Directory (AAD) domain services in Azure Identity Management, you can follow these steps using Azure CLI:

- Identify the affected user or role with the Microsoft.AAD.domainServices.write permission:
  `az role assignment list --assignee <user or role ID> --query "[?contains(roleDefinitionName, 'Microsoft.AAD.domainServices.write')]"`

- Remove the unauthorized permission from the user or role:
  `az role assignment delete --assignee <user or role ID> --role "Microsoft.AAD.domainServices.write"`

- Monitor and audit the Azure Active Directory domain services for any further unauthorized modifications.

2. To remediate privilege escalation in Azure Identity Management, specifically related to the Microsoft.AAD.domainServices.write permission, you can take the following steps using Azure CLI:

- Identify the unauthorized user or role with the Microsoft.AAD.domainServices.write permission:
  `az role assignment list --assignee <user or role ID> --query "[?contains(roleDefinitionName, 'Microsoft.AAD.domainServices.write')]"`

- Remove the unauthorized permission from the user or role:
  `az role assignment delete --assignee <user or role ID> --role "Microsoft.AAD.domainServices.write"`

- Regularly review and update Azure role assignments to ensure only authorized users have the necessary permissions.

3. To remediate unauthorized domain takeover in Azure Active Directory domain services, specifically related to the Microsoft.AAD.domainServices.write permission, you can take the following steps using Azure CLI:

- Identify the unauthorized user or role with the Microsoft.AAD.domainServices.write permission:
  `az role assignment list --assignee <user or role ID> --query "[?contains(roleDefinitionName, 'Microsoft.AAD.domainServices.write')]"`

- Remove the unauthorized permission from the user or role:
  `az role assignment delete --assignee <user or role ID> --role "Microsoft.AAD.domainServices.write"`

- Implement strong access controls, including multi-factor authentication and regular monitoring of Azure Active Directory for any suspicious activities or changes.

#### Using Python

To remediate unauthorized modification of Azure Active Directory (AAD) domain services in Azure Identity Management, you can take the following steps:

1. Regularly review and audit permissions: Conduct regular reviews of permissions assigned to users and roles in Azure Active Directory. Ensure that the Microsoft.AAD.domainServices.write permission is only granted to authorized individuals or roles.

2. Implement least privilege principle: Follow the principle of least privilege by granting only the necessary permissions to users and roles. Avoid granting the Microsoft.AAD.domainServices.write permission unless it is absolutely required for specific tasks.

3. Enable Azure AD Privileged Identity Management (PIM): Azure AD PIM allows you to manage, control, and monitor access to Azure resources. By enabling PIM, you can enforce just-in-time access for privileged roles, reducing the risk of unauthorized modifications to Azure Active Directory domain services.

Here's an example of a Python script using the Azure SDK for Python to review and audit permissions:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.authorization import AuthorizationManagementClient

# Authenticate using default credentials
credential = DefaultAzureCredential()
authorization_client = AuthorizationManagementClient(credential, "<subscription_id>")

# Get all role assignments in Azure Active Directory
role_assignments = authorization_client.role_assignments.list()

# Iterate through role assignments and check for Microsoft.AAD.domainServices.write permission
for assignment in role_assignments:
    if assignment.role_definition_id.endswith("Microsoft.AAD.domainServices.write"):
        print(f"Assignment: {assignment.id}, Principal: {assignment.principal_id}")
```

Please note that you need to replace `<subscription_id>` with your actual Azure subscription ID. This script will list all role assignments that have the Microsoft.AAD.domainServices.write permission.

Remember to always test and validate any scripts in a non-production environment before applying them to your production environment.


 