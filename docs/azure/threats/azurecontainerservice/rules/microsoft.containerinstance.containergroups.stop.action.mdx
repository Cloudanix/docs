--- 
slug: Microsoft.ContainerInstance.containerGroups.stop.action
eventname: Microsoft.ContainerInstance.containerGroups.stop.action
title: Microsoft.ContainerInstance.containerGroups.stop.action
sidebar_label: Microsoft.ContainerInstance.containerGroups.stop.action
---
                       
### Event Information

#### Meaning

- The Microsoft.ContainerInstance.containerGroups.stop.action event in Azure Container Service (azu) indicates that a container group has been stopped.
- This event is triggered when a user or an automated process initiates the stop action on a container group in Azure Container Instances.
- Stopping a container group will terminate all the containers within that group, freeing up resources and stopping any ongoing processes or services running in those containers.

### Remediation

#### Using Console

1. Impact on Security: The Microsoft.ContainerInstance.containerGroups.stop.action in Azure Container Service (AKS) can potentially impact security by allowing unauthorized users to stop or terminate container groups, leading to service disruption or unauthorized access to sensitive data within the containers.

2. Example: An example of how security can be impacted is if an attacker gains access to the Azure Container Service management console or API and executes the stop action on a container group that hosts critical applications or services. This can result in a denial of service or unauthorized access to the containers and their data.

3. Remediation Steps using Azure Portal:
   - Step 1: Sign in to the Azure portal (https://portal.azure.com) using your Azure account credentials.
   - Step 2: Navigate to the Azure Container Service (AKS) resource that you want to secure.
   - Step 3: Click on the "Access control (IAM)" tab in the left-hand menu.
   - Step 4: Review the existing role assignments and identify any users or groups that have the "Contributor" or "Owner" role assigned. These roles have the necessary permissions to stop container groups.
   - Step 5: Select the user or group that you want to modify and click on the "Remove" button to revoke their access.
   - Step 6: If necessary, create a new role assignment with more restricted permissions, such as "Reader" or a custom role with only the required permissions.
   - Step 7: Save the changes and ensure that only authorized users or groups have the necessary permissions to stop container groups in Azure Container Service.

Note: It is recommended to regularly review and update the access control settings to ensure that only authorized users have the necessary permissions to perform actions on Azure Container Service resources.

#### Using CLI

1. Example of security impact: The `Microsoft.ContainerInstance.containerGroups.stop.action` in Azure Container Service (AKS) allows unauthorized users to stop container groups, potentially leading to service disruption or unauthorized access to sensitive data within the containers.

2. Remediation steps using Azure CLI:
   - Step 1: Install Azure CLI if not already installed.
   - Step 2: Authenticate with your Azure account using the following command:
     ```
     az login
     ```
   - Step 3: Identify the affected container group by listing all the container groups in the AKS cluster:
     ```
     az container list --resource-group <resource-group-name> --query "[].{Name:name, ResourceGroup:resourceGroup, State:containers[0].instanceView.currentState.state}" --output table
     ```
   - Step 4: Update the access control settings for the container group to restrict the `stop` action to authorized users only. For example, you can use the following command to grant access to a specific Azure Active Directory (AAD) user or group:
     ```
     az role assignment create --assignee <aad-user-or-group-id> --role "Contributor" --scope <container-group-resource-id>
     ```
   - Step 5: Verify that the access control changes have been applied successfully by listing the role assignments for the container group:
     ```
     az role assignment list --scope <container-group-resource-id> --output table
     ```
   - Step 6: Test the access control by attempting to stop the container group using a non-authorized user account.

Note: Replace `<resource-group-name>`, `<aad-user-or-group-id>`, and `<container-group-resource-id>` with the appropriate values specific to your environment.

#### Using Python

1. Example of security impact: The `Microsoft.ContainerInstance.containerGroups.stop.action` event in Azure Container Service (AKS) allows an unauthorized user to stop or terminate container groups, potentially leading to service disruption or unauthorized access to sensitive data within the containers.

2. Remediation for Azure Container Service (AKS) using Python:
   - Implement RBAC (Role-Based Access Control) to ensure that only authorized users have permissions to stop or terminate container groups.
   - Use Azure AD (Active Directory) to manage user authentication and authorization for AKS. This ensures that only authenticated users with the appropriate roles can perform actions on container groups.
   - Utilize Azure Policy to enforce security controls and prevent unauthorized access to the `Microsoft.ContainerInstance.containerGroups.stop.action` event. For example, you can create a policy that denies the stop action for container groups to non-administrative users.

Python script example to implement RBAC for AKS using the Azure SDK for Python (azure-mgmt-containerinstance):
```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.authorization import AuthorizationManagementClient
from azure.mgmt.containerinstance import ContainerInstanceManagementClient

# Authenticate using DefaultAzureCredential
credential = DefaultAzureCredential()

# Create AuthorizationManagementClient and ContainerInstanceManagementClient
authorization_client = AuthorizationManagementClient(credential, subscription_id)
container_instance_client = ContainerInstanceManagementClient(credential, subscription_id)

# Define the role assignment
role_assignment = {
    "properties": {
        "roleDefinitionId": "/subscriptions/{subscriptionId}/providers/Microsoft.Authorization/roleDefinitions/{roleDefinitionId}",
        "principalId": "/subscriptions/{subscriptionId}/providers/Microsoft.AzureActiveDirectory/users/{userId}"
    }
}

# Create the role assignment
authorization_client.role_assignments.create(scope, role_assignment)

# Grant the necessary permissions to the user or service principal
container_instance_client.container_groups.stop(scope, resource_group_name, container_group_name)
```

Note: Replace `{subscriptionId}`, `{roleDefinitionId}`, `{userId}`, `{scope}`, `{resource_group_name}`, and `{container_group_name}` with the appropriate values for your environment.

Please ensure that you have installed the required Python packages (`azure-identity`, `azure-mgmt-authorization`, `azure-mgmt-containerinstance`) before running the script.


 