--- 
slug: Microsoft.ContainerService.managedClusters.stop.action
eventname: Microsoft.ContainerService.managedClusters.stop.action
title: Microsoft.ContainerService.managedClusters.stop.action
sidebar_label: Microsoft.ContainerService.managedClusters.stop.action
---
                       
### Event Information

#### Meaning

1. The Microsoft.ContainerService.managedClusters.stop.action event in Azure Container Service (AKS) indicates that a stop action has been initiated on a managed cluster.
2. This event is triggered when a user or an automated process initiates the stop action on the AKS cluster, which suspends all the running containers and stops the cluster nodes.
3. The stop action is typically used to temporarily pause the cluster, conserve resources, or perform maintenance tasks without permanently deleting the cluster or its resources.

### Remediation

#### Using Console

- Example: If security is impacted with the `Microsoft.ContainerService.managedClusters.stop.action` in Azure Container Service (AKS), it means that an unauthorized user or process has the ability to stop or shut down the managed clusters within the AKS service. This can lead to service disruption, data loss, or unauthorized access to the underlying infrastructure.

- Remediation Steps using Azure Portal:
  1. Sign in to the Azure portal (https://portal.azure.com) using your Azure credentials.
  2. Navigate to the Azure Container Service (AKS) resource that is impacted.
  3. In the left-hand menu, click on "Access control (IAM)".
  4. Review the existing role assignments and identify any unauthorized or unnecessary roles assigned to users or groups.
  5. Remove any unauthorized or unnecessary role assignments by selecting the role assignment and clicking on "Remove".
  6. Review the existing RBAC (Role-Based Access Control) roles and ensure that only authorized users or groups have the necessary permissions to manage the AKS service.
  7. Consider enabling Azure AD authentication and RBAC for AKS to further secure access to the managed clusters.
  8. Regularly monitor the access control settings and review the audit logs to detect any unauthorized access attempts or changes to the AKS service.

Note: It is important to regularly review and update the access control settings and RBAC roles to ensure that only authorized users have the necessary permissions to manage the Azure Container Service (AKS) and mitigate any security risks.

#### Using CLI

- Security can be impacted with the `Microsoft.ContainerService.managedClusters.stop.action` in Azure Container Service if unauthorized users are able to stop or modify the state of managed clusters.
- This can lead to potential disruption of services, unauthorized access to sensitive data, or unauthorized changes to the infrastructure.
- To remediate this issue in Azure Container Service using Azure CLI, you can follow these steps:
  1. Identify the affected managed cluster using the Azure CLI command: `az aks list`
  2. Update the RBAC (Role-Based Access Control) settings for the managed cluster to restrict the permissions for stopping or modifying the cluster state. For example, you can remove the `Contributor` role from unauthorized users.
  3. Verify the changes by running the command: `az aks show --name <cluster-name> --resource-group <resource-group-name>`

Note: Replace `<cluster-name>` and `<resource-group-name>` with the actual names of the affected managed cluster and its resource group.

#### Using Python

1. Example of security impact: The `Microsoft.ContainerService.managedClusters.stop.action` in Azure Container Service (AKS) allows unauthorized users to stop or delete managed clusters, leading to potential service disruption or data loss.

2. Remediation steps for Azure Container Service (AKS) using Python:
   - Use Azure SDK for Python (azure-mgmt-containerinstance) to manage AKS resources programmatically.
   - Implement RBAC (Role-Based Access Control) to restrict access to the `Microsoft.ContainerService.managedClusters.stop.action` action.
   - Grant only authorized users or service principals the necessary permissions to stop or delete managed clusters.
   - Regularly review and audit access control policies to ensure they align with the principle of least privilege.

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.containerinstance import ContainerInstanceManagementClient

# Authenticate using DefaultAzureCredential
credential = DefaultAzureCredential()

# Specify your Azure subscription ID and resource group name
subscription_id = "<your-subscription-id>"
resource_group_name = "<your-resource-group-name>"

# Specify the AKS cluster name
cluster_name = "<your-aks-cluster-name>"

# Create the ContainerInstanceManagementClient
client = ContainerInstanceManagementClient(credential, subscription_id)

# Define a function to stop the AKS cluster
def stop_aks_cluster():
    client.managed_clusters.begin_stop(resource_group_name, cluster_name)

# Call the function to stop the AKS cluster
stop_aks_cluster()
```

Note: Make sure to install the required Python packages (`azure-identity`, `azure-mgmt-containerinstance`) using pip before running the script.


 