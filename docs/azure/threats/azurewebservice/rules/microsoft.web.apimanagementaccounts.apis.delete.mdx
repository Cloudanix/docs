--- 
slug: microsoft.web.apimanagementaccounts.apis.delete
eventname: microsoft.web.apimanagementaccounts.apis.delete
title: microsoft.web.apimanagementaccounts.apis.delete
sidebar_label: microsoft.web.apimanagementaccounts.apis.delete
---
                       
### Event Information

#### Meaning

- The `microsoft.web.apimanagementaccounts.apis.delete` event in Azure is triggered when an API is deleted from an API Management account.
- This event indicates that an API has been removed from the API Management service, and any associated configurations, policies, and subscriptions related to that API will also be removed.
- It is important to monitor this event to track API changes and ensure that any necessary cleanup or reconfiguration is performed after an API is deleted.

### Remediation

#### Using Console

- The security impact of the `microsoft.web.apimanagementaccounts.apis.delete` action in Azure API Management is that it allows the deletion of APIs within an API Management account. This can potentially lead to the loss of critical API configurations and data.

- To remediate this security impact for Azure API Management in the Azure portal, follow these step-by-step instructions:
  1. Sign in to the Azure portal (https://portal.azure.com) using your Azure credentials.
  2. Navigate to the API Management service that you want to secure.
  3. Click on the "APIs" tab in the left-hand menu to view the list of APIs.
  4. Select the API that you want to protect from deletion.
  5. In the API details page, click on the "Access control (IAM)" tab.
  6. Click on the "+ Add" button to add a new role assignment.
  7. In the "Add role assignment" panel, select the appropriate role (e.g., "Contributor" or "Owner") for the user or group that should have the permission to delete APIs.
  8. Search for and select the user or group from the list.
  9. Click on the "Save" button to apply the role assignment.
  10. Repeat steps 4-9 for each API that you want to protect from deletion.

- By following these steps, you can restrict the `microsoft.web.apimanagementaccounts.apis.delete` action to only authorized users or groups, thereby mitigating the security impact and reducing the risk of accidental or malicious API deletions.

#### Using CLI

1. Impact on Security: The `microsoft.web.apimanagementaccounts.apis.delete` action in Azure API Management can potentially impact security by allowing unauthorized deletion of APIs within the API Management service. This action can be misused by an attacker to remove critical APIs, leading to service disruptions or unauthorized access to sensitive data.

2. Remediation Steps using Azure CLI: To remediate this security issue for Azure API Management service (AzureWebService) using Azure CLI, you can follow these steps:

   a. Identify the affected API: Use the Azure CLI command `az apim api list --service-name <apim-service-name>` to list all the APIs within the API Management service. Identify the API that needs to be protected from unauthorized deletion.

   b. Restrict permissions: Use the Azure CLI command `az role assignment create --assignee <principal-id> --role "API Management Service Contributor" --scope <apim-resource-id>` to assign the "API Management Service Contributor" role to the appropriate principal (user or service principal) for the API Management service. This role provides the necessary permissions to manage APIs without allowing deletion.

   c. Enable Azure RBAC: Enable Azure Role-Based Access Control (RBAC) for the API Management service by using the Azure CLI command `az apim update --name <apim-service-name> --resource-group <resource-group-name> --enable-rbac true`. This ensures that only authorized users or service principals can perform actions on the API Management service.

Please note that `<apim-service-name>`, `<principal-id>`, `<apim-resource-id>`, `<resource-group-name>` should be replaced with the actual values specific to your Azure environment.

#### Using Python

1. Example of security impact: If an unauthorized user gains access to the `microsoft.web.apimanagementaccounts.apis.delete` permission for the `AzureWebService` resource in Azure API Management, they can delete APIs associated with the service. This can lead to disruption of services, loss of data, and potential security vulnerabilities.

2. Remediation steps using Python:
   - Install the `azure-mgmt-apimanagement` package using pip: `pip install azure-mgmt-apimanagement`
   - Use the Azure SDK for Python to authenticate and interact with the Azure API Management service.
   - To remediate the security impact, you can revoke the `microsoft.web.apimanagementaccounts.apis.delete` permission for the unauthorized user or service principal.
   - Here's an example Python script to revoke the permission for a specific user or service principal:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.apimanagement import ApiManagementClient

# Authenticate using default credentials
credential = DefaultAzureCredential()

# Provide your Azure subscription ID and resource group name
subscription_id = "<your-subscription-id>"
resource_group_name = "<your-resource-group-name>"
service_name = "<your-api-management-service-name>"
user_or_service_principal_id = "<user-or-service-principal-id>"

# Create the API Management client
client = ApiManagementClient(credential, subscription_id)

# Revoke the permission for the user or service principal
client.api_management_service.api_management_service_users.delete(
    resource_group_name,
    service_name,
    user_or_service_principal_id,
    "microsoft.web.apimanagementaccounts.apis.delete"
)
```

Please note that you need to replace the placeholders (`<your-subscription-id>`, `<your-resource-group-name>`, `<your-api-management-service-name>`, `<user-or-service-principal-id>`) with the actual values specific to your Azure environment.


 