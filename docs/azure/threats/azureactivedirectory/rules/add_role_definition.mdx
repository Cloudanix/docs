--- 
slug: Add role definition
eventname: Add role definition
title: Add role definition
sidebar_label: Add role definition
---
                       
### Event Information

- The "Add role definition" event in Azure Active Directory refers to the action of creating a new custom role definition within Azure AD.
- Role definitions in Azure AD define the permissions and access levels that can be assigned to users or groups within an Azure subscription.
- This event indicates that a new role definition has been added, allowing administrators to grant specific permissions to users or groups for managing Azure resources.


### Examples

1. Unauthorized access: Adding a role definition in Azure Active Directory (AAD) without proper security controls can potentially grant unauthorized access to sensitive resources. For example, if a role definition is created with overly permissive permissions, it could allow users to access and modify data or resources they should not have access to.

2. Privilege escalation: If a role definition is not properly scoped or reviewed, it can lead to privilege escalation. For instance, if a user is assigned a role with higher privileges than necessary, they may be able to perform actions or access resources beyond their intended scope, potentially compromising the security of the system.

3. Misconfiguration: Incorrectly configuring a role definition in Azure Active Directory can introduce security vulnerabilities. For example, if a role is assigned to a user or group without proper justification or periodic review, it can result in unauthorized access or exposure of sensitive data. Additionally, misconfigurations in role assignments can lead to inconsistent or conflicting permissions, making it difficult to enforce proper security controls.

### Remediation

#### Using Console

To remediate unauthorized access, privilege escalation, and misconfiguration in Azure Active Directory using the Azure console, you can follow these steps:

1. Review and update role definitions:
   - Navigate to the Azure portal and open the Azure Active Directory service.
   - Go to "Roles and administrators" and select "Roles".
   - Review the existing role definitions and identify any overly permissive or misconfigured roles.
   - Modify the role definitions to ensure they have the appropriate permissions and scope.
   - Remove any unnecessary or unused role definitions.

2. Implement role-based access control (RBAC):
   - Identify the users or groups that require access to specific resources.
   - Create custom roles or use built-in roles that align with the principle of least privilege.
   - Assign the roles to the appropriate users or groups.
   - Regularly review and update role assignments to ensure they are still necessary and appropriate.

3. Enable auditing and monitoring:
   - Enable Azure Active Directory auditing to track changes and activities related to role definitions and assignments.
   - Set up alerts or notifications to be notified of any suspicious or unauthorized changes.
   - Regularly review audit logs and investigate any potential security incidents or anomalies.

By following these steps, you can remediate unauthorized access, privilege escalation, and misconfiguration issues in Azure Active Directory, ensuring proper security controls and reducing the risk of unauthorized access to sensitive resources.

#### Using CLI

1. Unauthorized access: To remediate unauthorized access due to a misconfigured role definition in Azure Active Directory, you can use the Azure CLI to add a role definition with proper security controls. 

   - First, identify the role definition that needs to be added or modified using the `az role definition list` command.
   - Create a JSON file with the necessary role definition details, ensuring that the permissions are appropriately scoped.
   - Use the `az role definition create` command to add the role definition, specifying the JSON file as the input.

   Example CLI commands:
   ```
   az role definition list --name "MyRoleDefinition"
   az role definition create --role-definition "path/to/role-definition.json"
   ```

2. Privilege escalation: To remediate privilege escalation caused by an improperly scoped or reviewed role definition in Azure Active Directory, you can modify the role assignment to ensure that users have the appropriate level of privileges.

   - Identify the user or group that has been assigned the role with higher privileges than necessary using the `az role assignment list` command.
   - Use the `az role assignment delete` command to remove the existing role assignment.
   - Create a new role assignment with the correct role and scope using the `az role assignment create` command.

   Example CLI commands:
   ```
   az role assignment list --assignee "user@example.com"
   az role assignment delete --assignee "user@example.com" --role "MyRole"
   az role assignment create --assignee "user@example.com" --role "MyRole" --scope "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroup}"
   ```

3. Misconfiguration: To remediate misconfigurations in role definitions in Azure Active Directory, you can review and modify the existing role assignments to ensure proper security controls.

   - Use the `az role assignment list` command to identify the role assignments that need to be reviewed.
   - Review the role assignments and identify any misconfigurations or inconsistencies.
   - Use the `az role assignment delete` command to remove any incorrect or unnecessary role assignments.
   - Create new role assignments with the correct permissions and scope using the `az role assignment create` command.

   Example CLI commands:
   ```
   az role assignment list --scope "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroup}"
   az role assignment delete --assignee "user@example.com" --role "MyRole"
   az role assignment create --assignee "user@example.com" --role "MyRole" --scope "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroup}"
   ```

#### Using Python

To remediate unauthorized access, privilege escalation, and misconfiguration issues in Azure Active Directory (AAD) using Python scripts, you can utilize the Azure SDK for Python. Here are some steps you can follow:

1. Unauthorized Access:
   - Use the `azure.identity` library to authenticate with Azure AD using a service principal or user credentials.
   - Use the `azure.graphrbac` library to retrieve the existing role definitions from Azure AD.
   - Analyze the permissions and scope of each role definition to identify any overly permissive ones.
   - Use the `azure.graphrbac` library to update the role definition with the appropriate permissions and scope.
   - Implement proper security controls, such as multi-factor authentication, to ensure only authorized users can modify role definitions.

2. Privilege Escalation:
   - Use the `azure.graphrbac` library to retrieve the existing role assignments for users or groups.
   - Analyze the assigned roles and their associated permissions to identify any instances of privilege escalation.
   - Use the `azure.graphrbac` library to update the role assignments with the appropriate roles and permissions.
   - Implement a review process to regularly validate and adjust role assignments based on the principle of least privilege.

3. Misconfiguration:
   - Use the `azure.graphrbac` library to retrieve the existing role assignments for users or groups.
   - Analyze the role assignments to identify any misconfigurations, such as assignments without proper justification or periodic review.
   - Use the `azure.graphrbac` library to remove or update the role assignments as necessary.
   - Implement a governance framework to enforce consistent and secure role assignments, including regular reviews and audits.

Please note that the above steps provide a high-level overview, and you may need to customize the scripts based on your specific requirements and environment.


 