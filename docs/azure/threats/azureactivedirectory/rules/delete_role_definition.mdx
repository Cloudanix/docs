--- 
slug: Delete role definition
eventname: Delete role definition
title: Delete role definition
sidebar_label: Delete role definition
---
                       
### Event Information

1. The "Delete role definition" event in Azure Active Directory (Azure AD) refers to the action of removing a role definition from the Azure AD tenant.
2. Role definitions in Azure AD define the permissions and access levels that can be assigned to users, groups, or applications within the tenant.
3. When the "Delete role definition" event occurs, it indicates that a specific role definition, along with its associated permissions, has been deleted from the Azure AD tenant. This event can be useful for auditing and tracking changes to the access control configuration in Azure AD.


### Examples

1. Unauthorized access: Deleting a role definition in Azure Active Directory (AAD) can potentially lead to unauthorized access to sensitive resources. For example, if a role definition that grants administrative privileges is deleted, it could allow unauthorized users to gain elevated access and compromise the security of the Azure environment.

2. Data breaches: Deleting a role definition without proper authorization can result in data breaches. For instance, if a role definition that restricts access to specific data or resources is deleted, it could expose sensitive information to unauthorized individuals, leading to potential data breaches and compliance violations.

3. Loss of control: Deleting a role definition can result in a loss of control over access management and permissions. If a critical role definition is deleted, it may become difficult to manage and track access rights within the Azure environment. This can lead to confusion, increased security risks, and potential compliance issues.

### Remediation

#### Using Console

To remediate unauthorized access, data breaches, and loss of control caused by deleting a role definition in Azure Active Directory (AAD), you can follow these step-by-step instructions using the Azure console:

1. Identify the deleted role definition:
   - Go to the Azure portal and navigate to the Azure Active Directory service.
   - Select "Roles and administrators" from the left-hand menu.
   - Look for the deleted role definition in the list of available roles.

2. Restore the deleted role definition:
   - Click on the deleted role definition to open its details.
   - Select the "Restore" option to restore the role definition.
   - Confirm the restoration by following the on-screen prompts.

3. Review and update permissions:
   - Once the role definition is restored, review its permissions and ensure they align with your security requirements.
   - Modify the role definition if necessary to restrict or grant access as needed.
   - Regularly review and update role definitions to maintain proper access management and permissions.

By following these steps, you can remediate the potential risks associated with deleting a role definition in Azure Active Directory, ensuring authorized access, preventing data breaches, and maintaining control over access management and permissions.

#### Using CLI

1. To remediate unauthorized access due to the deletion of a role definition in Azure Active Directory (AAD), you can follow these steps using Azure CLI:

- Identify the deleted role definition by retrieving the audit logs or using the Azure AD PowerShell module.
- Restore the deleted role definition by creating a new one with the same permissions and settings as the original.
- Assign the restored role definition to the appropriate users or groups to ensure proper access control.

Azure CLI commands:
```
# Retrieve the deleted role definition audit logs
az monitor activity-log list --resource-type Microsoft.Authorization/roleDefinitions --query "[?operationName.value=='Microsoft.Authorization/roleDefinitions/delete']"

# Create a new role definition with the same permissions and settings
az role definition create --role-definition <path_to_role_definition_json>

# Assign the restored role definition to users or groups
az role assignment create --role <role_name> --assignee <user_or_group_id> --scope <scope_of_assignment>
```

2. To remediate data breaches caused by the unauthorized deletion of a role definition in Azure Active Directory (AAD), you can take the following steps using Azure CLI:

- Identify the impacted data or resources that were exposed due to the deleted role definition.
- Assess the extent of the data breach and determine the necessary actions, such as notifying affected parties or activating incident response procedures.
- Implement additional security measures, such as enabling Azure AD Privileged Identity Management (PIM) to enforce just-in-time access and periodic access reviews.

Please note that data breach remediation may involve various additional steps depending on the specific circumstances and compliance requirements.

3. To remediate the loss of control resulting from the deletion of a role definition in Azure Active Directory (AAD), you can perform the following actions using Azure CLI:

- Restore the deleted role definition by creating a new one with the same permissions and settings.
- Review and update the access management processes and policies to prevent similar incidents in the future.
- Regularly monitor and audit role definitions and assignments to ensure proper access control and detect any unauthorized changes.

Azure CLI commands:
```
# Create a new role definition with the same permissions and settings
az role definition create --role-definition <path_to_role_definition_json>

# Review and update access management processes and policies
# Regularly monitor and audit role definitions and assignments
# Implement automated checks or alerts for any unauthorized changes
```

Please note that the specific commands and steps may vary depending on your Azure environment setup and requirements.

#### Using Python

1. To remediate unauthorized access due to the deletion of a role definition in Azure Active Directory, you can use the Azure AD Graph API or Microsoft Graph API in Python to programmatically restore the deleted role definition. Here's an example script:

```python
import requests
import json

# Define the necessary variables
tenant_id = '<your-tenant-id>'
client_id = '<your-client-id>'
client_secret = '<your-client-secret>'
role_definition_id = '<deleted-role-definition-id>'

# Get an access token using client credentials flow
token_url = f'https://login.microsoftonline.com/{tenant_id}/oauth2/token'
data = {
    'grant_type': 'client_credentials',
    'client_id': client_id,
    'client_secret': client_secret,
    'resource': 'https://graph.windows.net'
}
response = requests.post(token_url, data=data)
access_token = response.json()['access_token']

# Restore the deleted role definition
restore_url = f'https://graph.windows.net/{tenant_id}/deletedApplications/{role_definition_id}/restore'
headers = {
    'Authorization': f'Bearer {access_token}',
    'Content-Type': 'application/json'
}
response = requests.post(restore_url, headers=headers)

# Check the response status
if response.status_code == 204:
    print('Role definition restored successfully.')
else:
    print('Failed to restore the role definition.')
```

2. To remediate data breaches caused by the deletion of a role definition without proper authorization, you can implement a role-based access control (RBAC) policy and enforce strict access controls. Additionally, you can regularly monitor and audit role definition changes to detect any unauthorized deletions. This can be done using Azure Monitor and Azure Policy. 

3. To remediate the loss of control over access management and permissions due to the deletion of a critical role definition, you should establish a robust access management process. This includes regularly backing up role definitions, implementing role-based access control (RBAC) with granular permissions, and regularly reviewing and updating role assignments. Additionally, you can leverage Azure Policy to enforce governance and compliance standards for role definition management.


 