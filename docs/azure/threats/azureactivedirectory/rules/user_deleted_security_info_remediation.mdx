
### Event Information

#### Meaning

- The "User deleted security info" event in Azure Active Directory refers to an action taken by a user to remove or delete their security information associated with their account.
- This event indicates that the user has intentionally removed or deleted their security information, such as phone numbers or alternate email addresses, which are used for authentication and account recovery purposes.
- It is important to monitor and investigate this event as it may indicate a potential security risk or unauthorized access to the user's account, especially if the deletion was not initiated by the user themselves.

### Remediation

#### Using Console

- Example: If a user accidentally deletes their security information in Azure Active Directory, it can impact the security of their account. For example, if a user deletes their multi-factor authentication settings, it can leave their account vulnerable to unauthorized access.

- Remediation Steps:
  1. Sign in to the Azure portal using your Azure Active Directory administrator account.
  2. In the left-hand menu, click on "Azure Active Directory" to open the Azure Active Directory blade.
  3. In the Azure Active Directory blade, click on "Users" to view the list of users in your directory.
  4. Search for the user who deleted their security info and click on their name to open their user profile.
  5. In the user profile, click on the "Authentication methods" tab to view the user's authentication settings.
  6. Click on the "Add method" button to add a new authentication method for the user.
  7. Follow the prompts to select and configure the desired authentication method, such as phone number or email address.
  8. Once the new authentication method is added, make sure to test it to ensure it is working correctly.
  9. Communicate with the user to inform them about the remediation steps taken and provide guidance on how to prevent similar incidents in the future, such as enabling multi-factor authentication and being cautious when modifying security settings.

Note: It is important to have proper access control and monitoring in place to prevent unauthorized deletion of security information. Regularly reviewing audit logs and implementing least privilege access can help mitigate the risk of such incidents.

#### Using CLI

1. Example of security impact: If a user accidentally or maliciously deletes security information in Azure Active Directory (Azure AD), it can lead to unauthorized access to resources, compromised user accounts, and potential data breaches. For instance, if a user deletes their multi-factor authentication (MFA) settings, it removes an additional layer of security, making it easier for attackers to gain unauthorized access to the user's account.

2. Remediation using Azure CLI: To remediate this issue in Azure Active Directory using Azure CLI, you can follow these steps:

   a. Identify the affected user: Use the following Azure CLI command to retrieve the user's object ID or user principal name (UPN):
   
      ```
      az ad user show --upn <user-upn> --query objectId --output tsv
      ```

   b. Restore the deleted security info: Once you have the user's object ID or UPN, you can restore the deleted security information using the following Azure CLI command:
   
      ```
      az ad user update --id <user-object-id> --restore-mfa
      ```

   c. Verify the restoration: After executing the command, verify that the user's security information, such as MFA settings, has been restored successfully.

Please note that you need to have appropriate permissions and access to Azure AD to execute these commands.

#### Using Python

1. Example of security impact: If a user accidentally or maliciously deletes their security information in Azure Active Directory (Azure AD), it can lead to unauthorized access to resources and potential data breaches. This can occur if the user's multi-factor authentication (MFA) settings, such as phone number or email address, are deleted.

2. Remediation steps for Azure AD using Python:
   - Identify the affected user: Use the Azure AD Graph API or Microsoft Graph API to retrieve the list of users in the Azure AD tenant and identify the user whose security info has been deleted.
   - Restore the security information: Use the Azure AD Graph API or Microsoft Graph API to update the user's security information, such as adding a new phone number or email address for MFA. You can use the `python-azure-graphapi` library to interact with the API in Python. Here's an example script:

```python
from azure.graphrbac import GraphRbacManagementClient
from azure.common.credentials import ServicePrincipalCredentials

# Set up credentials
tenant_id = '<your-tenant-id>'
client_id = '<your-client-id>'
client_secret = '<your-client-secret>'
credentials = ServicePrincipalCredentials(
    client_id=client_id,
    secret=client_secret,
    tenant=tenant_id
)

# Create Graph API client
graph_client = GraphRbacManagementClient(credentials, tenant_id)

# Identify the affected user
user_principal_name = '<user-principal-name>'
user = graph_client.users.get(user_principal_name)

# Restore security information
user.mobile_phone = '<new-phone-number>'
user.other_mails = ['<new-email-address>']
graph_client.users.update(user)
```

Please note that you need to replace `<your-tenant-id>`, `<your-client-id>`, `<your-client-secret>`, `<user-principal-name>`, `<new-phone-number>`, and `<new-email-address>` with the actual values specific to your Azure AD environment.

3. Monitor and enforce security policies: Implement monitoring and alerting mechanisms to detect any unauthorized changes to security information in Azure AD. Additionally, enforce security policies such as requiring MFA for all users to mitigate the risk of security info deletion.

