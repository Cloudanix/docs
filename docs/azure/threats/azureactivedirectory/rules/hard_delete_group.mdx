--- 
slug: Hard Delete group
eventname: Hard Delete group
title: Hard Delete group
sidebar_label: Hard Delete group
---
                       
### Event Information

- The Hard Delete group event in Azure Active Directory refers to the permanent removal of a group from the directory.
- When this event occurs, all associated resources and permissions linked to the group are also permanently deleted.
- This event is irreversible and should be used with caution, as it can result in data loss and impact user access and permissions within the Azure AD environment.


### Examples

1. Loss of data recovery: When the Hard Delete option is enabled for Azure Active Directory (AAD) groups, it permanently deletes the group and all associated data without any possibility of recovery. This can be a security concern if important data or configurations are accidentally deleted, as there is no way to retrieve them.

2. Increased risk of unauthorized access: Hard deleting AAD groups can potentially lead to an increased risk of unauthorized access. For example, if a group containing privileged users or sensitive resources is accidentally hard deleted, it may result in unauthorized individuals gaining access to those resources, compromising security.

3. Impact on audit trails and compliance: Hard deleting AAD groups can impact audit trails and compliance requirements. When a group is hard deleted, all associated logs, access history, and permissions are permanently removed. This can make it difficult to track and investigate security incidents, as well as meet compliance standards that require maintaining detailed audit trails.

### Remediation

#### Using Console

To remediate the loss of data recovery, increased risk of unauthorized access, and impact on audit trails and compliance when hard deleting Azure Active Directory (AAD) groups in Azure using the Azure console, you can follow these step-by-step instructions:

1. Disable the Hard Delete option for AAD groups:
   - Sign in to the Azure portal (portal.azure.com) with your Azure account.
   - Navigate to the Azure Active Directory service.
   - Select "Groups" from the left-hand menu.
   - Choose the specific AAD group that you want to modify.
   - In the group settings, click on "Delete" and select "Delete group".
   - In the confirmation dialog, uncheck the "Permanently delete this group and all its associated resources" option.
   - Click on "Delete" to remove the group without enabling hard delete.

2. Implement backup and recovery mechanisms:
   - Enable Azure Active Directory backup and recovery services, such as Azure Backup or Azure Site Recovery.
   - Configure regular backups of your AAD groups and associated data.
   - Ensure that backups are stored in a separate location or storage account to prevent accidental deletion or loss.

3. Implement access controls and permissions:
   - Regularly review and update the access controls and permissions for AAD groups.
   - Ensure that only authorized users have the necessary privileges to delete groups or perform critical operations.
   - Implement multi-factor authentication (MFA) for privileged users to add an extra layer of security.

By following these steps, you can mitigate the risks associated with hard deleting AAD groups in Azure, ensuring data recovery options, reducing the risk of unauthorized access, and maintaining compliance with audit trail requirements.

#### Using CLI

1. To remediate the loss of data recovery in Azure Active Directory (AAD) groups when the Hard Delete option is enabled, it is recommended to disable the Hard Delete option and enable the Soft Delete option instead. This allows for the recovery of deleted groups and associated data within a specified retention period.

- Use the Azure CLI command to disable Hard Delete and enable Soft Delete for AAD groups:
  `az ad group update --id <group_id> --set deletionPolicy=SoftDelete`

2. To mitigate the increased risk of unauthorized access due to hard deleting AAD groups, it is important to regularly backup and restore AAD groups and their associated resources. This ensures that in case of accidental deletion, the groups can be easily restored, minimizing the risk of unauthorized access.

- Use the Azure CLI command to backup an AAD group:
  `az ad group backup --id <group_id> --name <backup_name>`

- Use the Azure CLI command to restore a backed-up AAD group:
  `az ad group restore --id <group_id> --name <backup_name>`

3. To address the impact on audit trails and compliance requirements caused by hard deleting AAD groups, it is recommended to enable Azure AD Audit Logs and retain them for the required compliance period. This allows for the tracking and investigation of security incidents even if a group is hard deleted.

- Use the Azure CLI command to enable Azure AD Audit Logs:
  `az ad diagnostic-settings create --name <diagnostic_settings_name> --resource <aad_resource_id> --logs '[{"category": "AuditLogs", "enabled": true}]'`

- Use the Azure CLI command to set the retention period for Azure AD Audit Logs:
  `az monitor diagnostic-settings update --name <diagnostic_settings_name> --resource <aad_resource_id> --logs '[{"category": "AuditLogs", "enabled": true, "retentionPolicy": {"days": <retention_days>}}]'`

#### Using Python

1. To remediate the loss of data recovery in Azure Active Directory (AAD) groups when the Hard Delete option is enabled, it is recommended to implement a backup and recovery strategy. This can be achieved by regularly exporting and storing the group data and configurations using Azure PowerShell or Azure CLI. Here is an example of a Python script using Azure SDK for Python (azure-mgmt-resource) to export and backup AAD group data:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.resource import ResourceManagementClient

# Set your Azure subscription ID and resource group name
subscription_id = '<your-subscription-id>'
resource_group_name = '<your-resource-group-name>'

# Set your Azure credentials
credential = DefaultAzureCredential()

# Create a Resource Management client
resource_client = ResourceManagementClient(credential, subscription_id)

# Set the AAD group ID to backup
aad_group_id = '<your-aad-group-id>'

# Export and backup the AAD group data
backup_path = '<your-backup-path>'
resource_client.resources.export_template(resource_group_name, aad_group_id, backup_path)
```

2. To mitigate the increased risk of unauthorized access due to hard deleting AAD groups, it is recommended to implement proper access controls and permissions management. Regularly review and audit the group memberships and access rights to ensure that only authorized individuals have access to sensitive resources. Additionally, consider implementing multi-factor authentication (MFA) for privileged users to add an extra layer of security.

3. To address the impact on audit trails and compliance requirements caused by hard deleting AAD groups, it is recommended to enable Azure Active Directory Audit Logs. These logs capture detailed information about group modifications, including hard deletions. By enabling and regularly reviewing these logs, you can maintain a record of group activities and meet compliance standards. Here is an example of a Python script using Azure SDK for Python (azure-identity) to enable Azure Active Directory Audit Logs:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.monitor import MonitorManagementClient

# Set your Azure subscription ID and resource group name
subscription_id = '<your-subscription-id>'
resource_group_name = '<your-resource-group-name>'

# Set your Azure credentials
credential = DefaultAzureCredential()

# Create a Monitor Management client
monitor_client = MonitorManagementClient(credential, subscription_id)

# Enable Azure Active Directory Audit Logs
monitor_client.diagnostic_settings.create_or_update(
    resource_group_name,
    'Microsoft.auditLogs',
    'default',
    {
        'workspace_id': '<your-log-analytics-workspace-id>',
        'logs': {
            'category': 'AuditLogs',
            'enabled': True
        }
    }
)
```

Note: Replace the placeholders (`<your-subscription-id>`, `<your-resource-group-name>`, `<your-aad-group-id>`, `<your-backup-path>`, `<your-log-analytics-workspace-id>`) with the appropriate values for your environment.


 