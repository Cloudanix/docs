
### Event Information

#### Meaning

- The "Add role definition" event in Azure Active Directory refers to the action of creating a new custom role definition within the Azure AD tenant.
- Role definitions in Azure AD define the permissions and access levels that can be assigned to users or groups for managing Azure resources.
- This event indicates that a new role definition has been added, allowing administrators to grant specific permissions to users or groups for performing certain tasks within the Azure environment.

#### Example

1. Example of security impact: If an unauthorized user gains access to the Azure Active Directory and adds a new role definition, they can potentially grant themselves elevated privileges or access to sensitive resources. This can lead to unauthorized access, data breaches, or malicious activities within the Azure environment.

Remediation:
- Regularly review and monitor role definitions in Azure Active Directory to identify any unauthorized changes.
- Implement strong access controls and multi-factor authentication to prevent unauthorized access to Azure Active Directory.
- Use Azure RBAC (Role-Based Access Control) to assign roles and permissions to users, groups, and applications, ensuring that only necessary privileges are granted.
- Regularly audit and review the Azure AD audit logs to detect any suspicious activities related to role definitions.
- If an unauthorized role definition is identified, remove it immediately using the Azure CLI command:
  ```
  az ad role definition delete --name <role_definition_name>
  ```

2. Example of security impact: If a malicious user gains access to the Azure portal or Azure CLI and adds a new role assignment to an existing role definition in Azure Active Directory, they can grant themselves or others unauthorized access to resources or perform actions beyond their intended privileges.

Remediation:
- Regularly review and monitor role assignments in Azure Active Directory to identify any unauthorized changes.
- Implement just-in-time access controls to limit the duration and scope of role assignments.
- Enable Azure AD Privileged Identity Management (PIM) to enforce approval workflows and time-bound access for privileged roles.
- Regularly audit and review the Azure AD audit logs to detect any suspicious activities related to role assignments.
- If an unauthorized role assignment is identified, remove it immediately using the Azure CLI command:
  ```
  az role assignment delete --assignee <user_or_group_object_id> --role <role_name> --scope <resource_scope>
  ```

3. Example of security impact: If a misconfigured or compromised application with excessive permissions is granted a new role assignment in Azure Active Directory, it can lead to unauthorized access, data leakage, or misuse of resources.

Remediation:
- Regularly review and audit the permissions granted to applications in Azure Active Directory.
- Implement the principle of least privilege when assigning roles and permissions to applications.
- Use Azure AD App Registration to manage and control the permissions granted to applications.
- Regularly review and monitor the Azure AD audit logs to detect any suspicious activities related to application role assignments.
- If an application is found to have excessive permissions, modify its role assignment using the Azure CLI command:
  ```
  az role assignment update --assignee-object-id <application_object_id> --role <role_name> --scope <resource_scope>
  ```

