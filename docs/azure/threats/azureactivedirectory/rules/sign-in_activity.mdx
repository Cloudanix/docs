--- 
slug: Sign-in activity
eventname: Sign-in activity
title: Sign-in activity
sidebar_label: Sign-in activity
---
                       
### Event Information

#### Meaning

- The Sign-in activity event in Azure Active Directory refers to the event generated when a user signs in to an Azure AD tenant.
- This event provides information about the user who signed in, the time and date of the sign-in, the location from where the sign-in occurred, and the client application used for the sign-in.
- By analyzing the Sign-in activity event, administrators can monitor and track user sign-ins, detect suspicious activities, and enforce security policies to protect the Azure AD tenant.

### Remediation

#### Using Console

- Example of security impact: If there is a sign-in activity in Azure Active Directory (Azure AD) that is suspicious or unauthorized, it could indicate a potential security breach or unauthorized access to Azure resources. For example, if there are multiple failed sign-in attempts from different IP addresses within a short period of time, it could indicate a brute-force attack or a compromised user account.

- Remediation steps using Azure console:
1. Identify the suspicious sign-in activity: In the Azure portal, navigate to Azure Active Directory > Sign-ins. Review the sign-in logs and filter them based on criteria such as failed sign-ins, unusual IP addresses, or abnormal sign-in patterns.

2. Investigate the suspicious activity: Analyze the sign-in logs to gather more information about the suspicious activity. Look for patterns, such as multiple failed sign-in attempts from the same IP address or unusual sign-in locations.

3. Take appropriate actions: Depending on the severity of the suspicious activity, you can take the following actions:
   - Disable or reset compromised user accounts: If a user account is compromised, disable or reset the account to prevent further unauthorized access.
   - Enable multi-factor authentication (MFA): Enforce MFA for all users or specific users to add an extra layer of security during sign-in.
   - Review and update security policies: Evaluate your existing security policies and make necessary updates to strengthen the security posture of your Azure AD environment.
   - Implement conditional access policies: Use Azure AD's conditional access policies to enforce additional security measures, such as blocking sign-ins from specific IP ranges or requiring additional verification for risky sign-ins.

Note: It is recommended to involve your organization's security team or follow your organization's incident response procedures while remediating security issues in Azure Active Directory.

#### Using CLI

Example of security impact: Unauthorized sign-in activity in Azure Active Directory (Azure AD) can indicate potential security breaches, such as compromised user accounts or unauthorized access attempts.

Remediation steps using Azure CLI:
1. Identify the compromised user account:
   - Use the Azure CLI command `az monitor activity-log list` to retrieve the activity logs.
   - Filter the logs based on the sign-in activity using the `--filter` parameter.
   - Analyze the logs to identify any suspicious or unauthorized sign-in attempts.

2. Disable the compromised user account:
   - Use the Azure CLI command `az ad user update` to disable the compromised user account.
   - Specify the user's object ID or user principal name (UPN) using the `--id` parameter.
   - Set the `accountEnabled` property to `false` to disable the account.

3. Investigate and mitigate the root cause:
   - Review the logs and investigate the source of the unauthorized sign-in activity.
   - Implement additional security measures, such as multi-factor authentication (MFA) or conditional access policies, to prevent similar incidents in the future.

Note: The specific commands and parameters may vary based on the Azure CLI version and the Azure AD configuration.

#### Using Python

Example of security impact with Sign-in activity in Azure Active Directory:
- Unauthorized access: If there is a sign-in activity in Azure Active Directory from an unknown or suspicious IP address, it could indicate a potential security breach or unauthorized access to the Azure environment.

Remediation steps for Azure Active Directory using Python:
1. Monitor sign-in activity: Use the Azure Monitor service to collect and analyze sign-in logs from Azure Active Directory. You can leverage the Azure Monitor REST API in Python to retrieve sign-in logs programmatically. Here's an example script:

```python
import requests
import json

# Set the Azure Monitor API endpoint
api_endpoint = "https://management.azure.com/subscriptions/{subscription_id}/resourceGroups/{resource_group}/providers/Microsoft.Insights/components/{workspace_name}/query?api-version=2019-01-01"

# Set the query to retrieve sign-in logs
query = {
    "query": "AzureActivity | where OperationName == 'SignIn' | project TimeGenerated, UserPrincipalName, IPAddress"
}

# Set the Azure Monitor API credentials
headers = {
    "Authorization": "Bearer {access_token}"
}

# Send the query request to Azure Monitor
response = requests.post(api_endpoint, headers=headers, json=query)

# Process the response
if response.status_code == 200:
    sign_in_logs = response.json()
    # Analyze the sign-in logs and take appropriate actions
else:
    print("Failed to retrieve sign-in logs. Status code:", response.status_code)
```

2. Implement conditional access policies: Use the Azure Active Directory PowerShell module or the Microsoft Graph API in Python to create and manage conditional access policies. These policies allow you to define rules and restrictions for user sign-ins based on various conditions such as location, device, or risk level.

Here's an example script using the Azure Active Directory PowerShell module:

```python
import subprocess

# Install the Azure Active Directory PowerShell module
subprocess.run(["pip", "install", "AzureAD"])

# Import the module
from azuread import *

# Connect to Azure Active Directory
Connect-AzureAD -TenantId "{tenant_id}" -ApplicationId "{application_id}" -CertificateThumbprint "{certificate_thumbprint}"

# Create a new conditional access policy
New-AzureADMSConditionalAccessPolicy -DisplayName "Restrict Sign-ins" -UsersIncluded "{user_group_id}" -LocationsIncluded "{location_id}" -ClientAppTypes "{client_app_type}" -GrantControls "{grant_controls}"
```

Note: The above scripts are just examples and may require modifications based on your specific requirements and environment setup.


 