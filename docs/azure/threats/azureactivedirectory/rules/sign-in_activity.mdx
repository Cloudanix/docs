--- 
slug: Sign-in activity
eventname: Sign-in activity
title: Sign-in activity
sidebar_label: Sign-in activity
---
                       
### Event Information

1. The Sign-in activity event in Azure Active Directory refers to the logging of user sign-in activities within the Azure AD tenant.
2. This event provides information about the user who signed in, the time and date of the sign-in, the location from where the sign-in occurred, and the result of the sign-in attempt (success or failure).
3. Monitoring and analyzing Sign-in activity events can help detect suspicious or unauthorized access attempts, track user behavior, and identify potential security threats in the Azure AD environment.


### Examples

1. Unusual sign-in activity: If there is a sudden increase in sign-in activity from a specific IP address or location that is not typical for your organization, it could indicate a security breach. This could be a sign of unauthorized access attempts or compromised user credentials.

2. Multiple failed sign-in attempts: If there are multiple failed sign-in attempts for a specific user account within a short period of time, it could indicate a brute-force attack or an attempt to guess the user's password. This could potentially lead to unauthorized access to the account and compromise the security of your Azure Active Directory.

3. Sign-in from suspicious devices: If there are sign-in activities from devices that are not recognized or trusted by your organization, it could indicate a potential security risk. This could be a sign of a compromised device or an attempt to gain unauthorized access to your Azure Active Directory.

In all these cases, it is important to investigate and take appropriate actions to mitigate the security risks. This may include reviewing access controls, resetting passwords, enabling multi-factor authentication, and implementing additional security measures to protect your Azure Active Directory.

### Remediation

#### Using Console

To remediate unusual sign-in activity, multiple failed sign-in attempts, and sign-in from suspicious devices in Azure Active Directory, you can follow these step-by-step instructions:

1. Review Sign-In Logs:
   - Sign in to the Azure portal (portal.azure.com) using your administrator account.
   - Navigate to Azure Active Directory.
   - Under the Monitoring section, select Sign-ins.
   - Review the sign-in logs to identify any unusual or suspicious activities, such as unfamiliar IP addresses or multiple failed sign-in attempts.

2. Reset Passwords and Enable Multi-Factor Authentication (MFA):
   - Identify the user accounts that are affected by the unusual sign-in activity or multiple failed sign-in attempts.
   - For each affected user account, go to Azure Active Directory > Users > All users.
   - Select the user account and click on Reset password.
   - Follow the prompts to set a new password for the user.
   - Enable MFA for the user account to add an extra layer of security. Go to Azure Active Directory > Users > All users, select the user account, and click on Multi-factor authentication. Follow the instructions to enable MFA.

3. Implement Conditional Access Policies:
   - Conditional Access policies allow you to define specific access controls based on various conditions, such as location, device, or risk level.
   - Go to Azure Active Directory > Security > Conditional Access.
   - Create a new policy or modify an existing one to enforce stricter access controls for the affected user accounts or suspicious devices.
   - For example, you can require MFA for all sign-ins, block sign-ins from specific IP addresses or locations, or enforce device compliance requirements.

By following these steps, you can remediate unusual sign-in activity, multiple failed sign-in attempts, and sign-in from suspicious devices in Azure Active Directory, enhancing the security of your organization's cloud environment.

#### Using CLI

1. Unusual sign-in activity: To remediate this issue in Azure Active Directory using Azure CLI, you can follow these steps:

- Identify the specific IP address or location that is showing unusual sign-in activity by analyzing the logs or security reports.
- Use the Azure CLI command `az ad sign-in list` to retrieve the sign-in logs for the specified time period.
- Filter the sign-in logs based on the IP address or location using the `--filter` parameter in the command.
- Analyze the sign-in logs to determine if the activity is indeed suspicious or unauthorized.
- If the activity is confirmed to be unauthorized, take appropriate actions such as blocking the IP address or location, resetting user credentials, or enabling multi-factor authentication for the affected accounts.

2. Multiple failed sign-in attempts: To remediate this issue in Azure Active Directory using Azure CLI, you can follow these steps:

- Identify the specific user account that is experiencing multiple failed sign-in attempts.
- Use the Azure CLI command `az ad sign-in list` to retrieve the sign-in logs for the specified user account.
- Filter the sign-in logs based on the user account using the `--filter` parameter in the command.
- Analyze the sign-in logs to determine the source of the failed sign-in attempts.
- If the failed sign-in attempts are suspicious or indicate a brute-force attack, take appropriate actions such as blocking the source IP address, resetting the user's password, or enabling multi-factor authentication for the affected account.

3. Sign-in from suspicious devices: To remediate this issue in Azure Active Directory using Azure CLI, you can follow these steps:

- Identify the devices that are showing sign-in activities but are not recognized or trusted by your organization.
- Use the Azure CLI command `az ad sign-in list` to retrieve the sign-in logs for the specified time period.
- Filter the sign-in logs based on the device information using the `--filter` parameter in the command.
- Analyze the sign-in logs to determine if the sign-in activities from the suspicious devices are unauthorized or pose a security risk.
- If the sign-in activities are confirmed to be unauthorized or suspicious, take appropriate actions such as blocking the devices, resetting user credentials, or enabling multi-factor authentication for the affected accounts.

#### Using Python

To remediate the mentioned security events in Azure Active Directory using Python, you can utilize the Microsoft Graph API and the Azure AD Python SDK. Here are some steps and example code snippets to help you get started:

1. Unusual sign-in activity:
   - Use the Microsoft Graph API to retrieve sign-in logs for the specific IP address or location.
   - Analyze the logs to identify any suspicious activities or patterns.
   - Take appropriate actions such as blocking the IP address or location, resetting compromised user credentials, and enabling multi-factor authentication for affected accounts.

   Example code snippet:
   ```python
   from azure.identity import ClientSecretCredential
   from azure.graphrbac import GraphRbacManagementClient

   # Authenticate using client secret credentials
   credentials = ClientSecretCredential(
       tenant_id='<your-tenant-id>',
       client_id='<your-client-id>',
       client_secret='<your-client-secret>'
   )

   # Create Graph API client
   graph_client = GraphRbacManagementClient(credentials, '<your-azure-ad-graph-api-version>')

   # Retrieve sign-in logs for a specific IP address
   sign_in_logs = graph_client.sign_in_activity.list(
       filter=f"ipAddress eq '<ip-address>'"
   )

   # Analyze and take appropriate actions based on the sign-in logs
   # ...
   ```

2. Multiple failed sign-in attempts:
   - Use the Microsoft Graph API to retrieve sign-in logs for the specific user account.
   - Analyze the logs to identify any patterns of failed sign-in attempts.
   - Implement account lockout policies and password complexity requirements to prevent brute-force attacks.
   - Consider enabling Azure AD Identity Protection to detect and respond to risky sign-in attempts automatically.

   Example code snippet:
   ```python
   # Retrieve sign-in logs for a specific user account
   sign_in_logs = graph_client.sign_in_activity.list(
       filter=f"userPrincipalName eq '<user-principal-name>'"
   )

   # Analyze and take appropriate actions based on the sign-in logs
   # ...
   ```

3. Sign-in from suspicious devices:
   - Use the Microsoft Graph API to retrieve sign-in logs for the specific user account.
   - Analyze the logs to identify any unrecognized or suspicious devices.
   - Implement device management policies to enforce device compliance and restrict access from untrusted devices.
   - Consider implementing conditional access policies to control access based on device trust and other factors.

   Example code snippet:
   ```python
   # Retrieve sign-in logs for a specific user account
   sign_in_logs = graph_client.sign_in_activity.list(
       filter=f"userPrincipalName eq '<user-principal-name>'"
   )

   # Analyze and take appropriate actions based on the sign-in logs
   # ...
   ```

Please note that the provided code snippets are just examples to demonstrate the usage of the Azure AD Python SDK. You will need to adapt and extend the code based on your specific requirements and the actions you want to take to remediate the security events.


 