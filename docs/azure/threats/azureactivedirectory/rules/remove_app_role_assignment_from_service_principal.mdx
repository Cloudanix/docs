--- 
slug: Remove app role assignment from service principal
eventname: Remove app role assignment from service principal
title: Remove app role assignment from service principal
sidebar_label: Remove app role assignment from service principal
---
                       
### Event Information

#### Meaning

- The "Remove app role assignment from service principal" event in Azure Active Directory refers to the removal of a specific app role assignment from a service principal.
- This event indicates that a previously assigned app role has been revoked or removed from the service principal's permissions.
- It is important to monitor and track these events to ensure that the appropriate access controls and permissions are maintained within the Azure Active Directory environment.

### Remediation

#### Using Console

- Security impact: Removing app role assignment from a service principal in Azure Active Directory can potentially lead to unauthorized access to resources and data. This can result in data breaches, unauthorized modifications, or misuse of resources.

- Example: Let's say there is a service principal assigned with an app role that grants read-only access to a specific resource group in Azure. If this app role assignment is removed, the service principal will lose its access to the resource group, potentially impacting the security of the resources within it.

- Remediation steps using Azure portal:
  1. Sign in to the Azure portal (https://portal.azure.com) with appropriate credentials.
  2. Navigate to the Azure Active Directory service.
  3. Select "Enterprise applications" from the left-hand menu.
  4. Search for the specific service principal that had the app role assignment removed.
  5. Click on the service principal to open its details.
  6. In the left-hand menu, select "App roles".
  7. Click on "Add assignment" to assign the appropriate app role to the service principal.
  8. Select the desired app role from the list and click "Add".
  9. Save the changes and ensure that the service principal now has the necessary app role assignment to maintain the required security level.

Note: The exact steps may vary slightly depending on the Azure portal version and layout.

#### Using CLI

- Security impact: Removing app role assignment from a service principal in Azure Active Directory can potentially lead to unauthorized access to resources and data. This can result in data breaches, privilege escalation, and other security vulnerabilities.

- Remediation steps using Azure CLI:
  1. Identify the service principal and the app role assignment that needs to be restored.
  2. Use the `az ad app role assignment create` command to reassign the app role to the service principal. For example:
     ```
     az ad app role assignment create --assignee-object-id <service_principal_object_id> --role <app_role_id> --resource <resource_id>
     ```
     Replace `<service_principal_object_id>` with the object ID of the service principal, `<app_role_id>` with the ID of the app role, and `<resource_id>` with the ID of the resource to which the app role is being assigned.

- It is important to note that the specific commands and parameters may vary depending on the Azure CLI version and the specific Azure Active Directory configuration. It is recommended to refer to the Azure CLI documentation for the most up-to-date and accurate commands.

#### Using Python

1. Impact on Security: Removing app role assignment from a service principal in Azure Active Directory can impact security by potentially granting unauthorized access to resources. This can lead to unauthorized data access, privilege escalation, or other security breaches.

2. Remediation Steps: To remediate this issue in Azure Active Directory using Python, you can use the Azure SDK for Python (azure-identity and azure-mgmt-authorization libraries). Here is an example script to remove app role assignments from a service principal:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.authorization import AuthorizationManagementClient

# Authenticate using default credentials
credential = DefaultAzureCredential()

# Specify your Azure subscription ID and tenant ID
subscription_id = '<your-subscription-id>'
tenant_id = '<your-tenant-id>'

# Specify the service principal object ID and the app role ID to remove
service_principal_object_id = '<service-principal-object-id>'
app_role_id = '<app-role-id>'

# Create the authorization management client
authorization_client = AuthorizationManagementClient(credential, subscription_id)

# Remove the app role assignment from the service principal
authorization_client.role_assignments.delete(
    scope=f'/providers/Microsoft.Authorization/roleAssignments/{app_role_id}',
    role_assignment_name=service_principal_object_id
)
```

Please note that you need to install the required Python packages (`azure-identity` and `azure-mgmt-authorization`) before running this script. Also, make sure you have the necessary permissions to manage role assignments in Azure Active Directory.

3. Additional Considerations: It is important to carefully review and validate the app role assignments before removing them from a service principal. Ensure that the removal of the app role assignment does not impact any legitimate access requirements or break any application functionality. It is recommended to follow a change management process and thoroughly test the impact of the removal before applying it in a production environment.


 