--- 
slug: Remove app role assignment from service principal
eventname: Remove app role assignment from service principal
title: Remove app role assignment from service principal
sidebar_label: Remove app role assignment from service principal
---
                       
### Event Information

#### Meaning

1. The "Remove app role assignment from service principal" event in Azure Active Directory refers to the removal of a specific app role assignment from a service principal.
2. This event indicates that a previously assigned app role has been revoked or removed from the service principal's permissions.
3. It is important to monitor this event as it can help track changes in access permissions and ensure that only the necessary roles are assigned to service principals for proper security and access control.

#### Example

1. Example: If a malicious user gains access to the Azure portal or has compromised the credentials of a user with sufficient privileges, they could potentially remove an app role assignment from a service principal in Azure Active Directory (AAD). This could impact security by granting unauthorized access to resources or sensitive data associated with that service principal.

Remediation:
- Regularly review and monitor app role assignments in Azure Active Directory to detect any unauthorized changes.
- Enable Azure AD Privileged Identity Management (PIM) to enforce just-in-time access and require approval for role assignments.
- Implement multi-factor authentication (MFA) for all user accounts with administrative privileges to prevent unauthorized access.
- Enable Azure AD Conditional Access policies to enforce additional security controls, such as location-based restrictions or device compliance requirements.

CLI Command for reviewing app role assignments:
```
az ad sp show --id <service_principal_id> --query appRoles
```

2. Example: A misconfiguration in an automated deployment pipeline or a human error during manual configuration could inadvertently remove an app role assignment from a service principal in Azure Active Directory. This could lead to unintended access restrictions or permissions being revoked, potentially impacting the security of the system.

Remediation:
- Implement infrastructure as code (IaC) practices using tools like Azure Resource Manager (ARM) templates or Terraform to ensure consistent and auditable deployments.
- Use version control for your infrastructure code to track changes and easily revert any unintended modifications.
- Implement automated testing and validation of deployment configurations to catch misconfigurations before they are applied.
- Regularly review and audit changes made to app role assignments to identify any unauthorized modifications.

CLI Command for adding an app role assignment:
```
az ad app role assignment create --app-id <service_principal_app_id> --role <role_id> --assignee-object-id <service_principal_object_id>
```

3. Example: A compromised service principal or a malicious insider with access to the Azure AD Graph API or Microsoft Graph API could programmatically remove app role assignments from service principals in Azure Active Directory. This could be done to gain unauthorized access to resources or to disrupt the security posture of the system.

Remediation:
- Regularly review and monitor logs and audit trails for suspicious activities related to app role assignments in Azure AD.
- Implement strong access controls and permissions for service principals, limiting their privileges to only what is necessary.
- Enable Azure AD Identity Protection to detect and respond to suspicious activities or potential account compromises.
- Implement network security controls, such as network segmentation and firewall rules, to limit access to the Azure AD Graph API or Microsoft Graph API.

CLI Command for monitoring Azure AD audit logs:
```
az monitor activity-log list --resource-group <resource_group_name> --resource-type Microsoft.DirectoryServices/directoryAudits --query "[?category=='AuditLogs']"
```


 