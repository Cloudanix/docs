--- 
slug: Microsoft.KeyVault.vaults.delete
eventname: Microsoft.KeyVault.vaults.delete
title: Microsoft.KeyVault.vaults.delete
sidebar_label: Microsoft.KeyVault.vaults.delete
---
                       
### Event Information

- The Microsoft.KeyVault.vaults.delete event in Azure for AzureSecurityService indicates that a Key Vault has been deleted in the Azure environment.
- This event signifies that the Key Vault and all its associated secrets, keys, and certificates have been permanently removed.
- It is important to monitor this event as it can help track any unauthorized or accidental deletion of Key Vaults, ensuring the security and integrity of sensitive data stored within the Key Vault.


### Examples

1. Unauthorized deletion of a Key Vault: If security is impacted with Microsoft.KeyVault.vaults.delete in Azure for AzureSecurityService, it could potentially lead to unauthorized deletion of a Key Vault. This can result in the loss of sensitive cryptographic keys, secrets, and certificates stored within the Key Vault, compromising the security of applications and services that rely on these resources.

2. Data breach: If an attacker gains access to the AzureSecurityService and performs the Microsoft.KeyVault.vaults.delete operation, they can delete a Key Vault containing sensitive data. This can lead to a data breach, exposing confidential information such as customer data, credentials, or other sensitive assets stored within the Key Vault.

3. Service disruption: Deleting a Key Vault can cause service disruption for applications and services that rely on it. If the Key Vault is deleted unintentionally or maliciously, it can result in the loss of access to critical resources, leading to downtime and potential financial losses for the organization. It may also impact compliance requirements if the Key Vault is used to store encryption keys or other compliance-related data.

### Remediation

#### Using Console

1. Identify the unauthorized deletion: Monitor the Azure activity logs and audit logs to identify any unauthorized deletion of a Key Vault. Look for events related to the Microsoft.KeyVault.vaults.delete operation performed by the AzureSecurityService.

2. Disable the AzureSecurityService: If an unauthorized deletion is detected, immediately disable the AzureSecurityService to prevent further unauthorized actions. This can be done by navigating to the Azure portal, selecting the AzureSecurityService resource, and disabling it.

3. Restore the Key Vault: If a backup of the Key Vault is available, restore it to a new Key Vault. Ensure that the restored Key Vault has proper access controls and permissions configured. If a backup is not available, recreate the Key Vault and reconfigure the necessary cryptographic keys, secrets, and certificates. Update any applications or services that rely on the Key Vault to use the new Key Vault.

#### Using CLI

1. To remediate unauthorized deletion of a Key Vault in Azure using Azure CLI commands, you can:

- Implement Role-Based Access Control (RBAC) to ensure that only authorized users have the necessary permissions to delete Key Vaults. Use the `az role assignment create` command to assign appropriate roles to users or groups, limiting the ability to delete Key Vaults.

- Enable Azure Key Vault soft delete feature to provide an additional layer of protection. This feature allows you to recover a deleted Key Vault within a specified retention period. Use the `az keyvault update` command to enable soft delete for a Key Vault.

2. To mitigate the risk of data breach and exposure when deleting a Key Vault in Azure, you can:

- Implement Azure Key Vault access policies to control who can delete Key Vaults. Use the `az keyvault set-policy` command to define access policies that restrict deletion permissions to authorized users or groups.

- Enable Azure Key Vault logging and monitoring to detect and respond to any unauthorized deletion attempts. Use Azure Monitor or Azure Security Center to set up alerts and notifications for Key Vault deletion events.

3. To prevent disruption of services caused by the deletion of a Key Vault in Azure, you can:

- Implement backup and disaster recovery strategies for Key Vaults. Regularly back up the contents of the Key Vault and store the backups in a separate location. This ensures that even if a Key Vault is accidentally deleted, you can restore its contents and minimize service disruption. Use Azure Backup or Azure Site Recovery for this purpose.

- Implement Azure Resource Locks to prevent accidental deletion of Key Vaults. Use the `az lock create` command to apply a lock at the resource group or Key Vault level, preventing any modifications or deletions until the lock is removed.

Please note that the specific CLI commands may vary based on your Azure CLI version and configuration.

#### Using Python

To remediate unauthorized deletion of a Key Vault in Azure for AzureSecurityService, you can take the following steps:

1. Implement Role-Based Access Control (RBAC): Ensure that proper RBAC permissions are assigned to users and service principals accessing the Key Vault. Limit the delete permission to only authorized individuals or groups. Regularly review and update these permissions to prevent unauthorized access.

2. Enable Soft Delete: Enable the soft delete feature for the Key Vault. Soft delete allows you to recover a deleted Key Vault within a specified retention period. This provides an additional layer of protection against accidental or unauthorized deletions.

3. Enable Azure Monitor and Alerts: Set up Azure Monitor and configure alerts for any deletion activities related to the Key Vault. This will allow you to receive notifications whenever a deletion event occurs, enabling you to take immediate action and investigate any unauthorized activities.

Here is an example Python script to enable soft delete for a Key Vault in Azure:

```python
from azure.identity import DefaultAzureCredential
from azure.keyvault.secrets import SecretClient
from azure.mgmt.keyvault import KeyVaultManagementClient
from azure.mgmt.keyvault.models import VaultProperties

# Authenticate using DefaultAzureCredential
credential = DefaultAzureCredential()

# Specify your Azure subscription ID and resource group name
subscription_id = "<your-subscription-id>"
resource_group_name = "<your-resource-group-name>"
vault_name = "<your-key-vault-name>"

# Create a Key Vault management client
keyvault_client = KeyVaultManagementClient(credential, subscription_id)

# Get the Key Vault properties
vault_properties = keyvault_client.vaults.get(resource_group_name, vault_name).properties

# Enable soft delete for the Key Vault
vault_properties.enable_soft_delete = True

# Update the Key Vault properties
keyvault_client.vaults.update(resource_group_name, vault_name, VaultProperties(properties=vault_properties))
```

Please note that you need to install the required Azure SDK packages (`azure-identity`, `azure-keyvault-secrets`, `azure-mgmt-keyvault`) before running the script.


 