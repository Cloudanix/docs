--- 
slug: Microsoft.Network.routeTables.routes.write
eventname: Microsoft.Network.routeTables.routes.write
title: Microsoft.Network.routeTables.routes.write
sidebar_label: Microsoft.Network.routeTables.routes.write
---
                       
### Event Information

#### Meaning

- The Microsoft.Network.routeTables.routes.write event in AzureNetwork refers to a write operation performed on the routes within a route table in Azure.
- This event indicates that a change has been made to the routes associated with a specific route table in Azure.
- It could involve adding, modifying, or deleting routes within the route table, which can impact the network traffic flow within the Azure network.

#### Example

1. Example of security impact: If an unauthorized user gains access to the Microsoft.Network.routeTables.routes.write event in AzureRealtime for AzureNetwork, they could potentially modify the routing tables and routes within the network. This could lead to unauthorized access to sensitive resources or redirecting traffic to malicious destinations.

Remediation:
- Regularly review and monitor the Azure Network Security Group (NSG) rules and routing tables to detect any unauthorized changes.
- Implement RBAC (Role-Based Access Control) to ensure that only authorized users have permissions to modify the routing tables and routes.
- Enable Azure Network Watcher's Traffic Analytics feature to detect any abnormal traffic patterns or suspicious activities within the network.

Example CLI command to review NSG rules:
```
az network nsg show --name <nsg_name> --resource-group <resource_group_name>
```

Example CLI command to review routing tables:
```
az network route-table show --name <route_table_name> --resource-group <resource_group_name>
```

2. Example of security impact: If a malicious actor gains access to the Microsoft.Network.routeTables.routes.write event in AzureRealtime for AzureNetwork, they could add a new route that directs traffic to a compromised or unauthorized destination. This could result in data exfiltration, unauthorized access to resources, or disruption of network connectivity.

Remediation:
- Implement Azure Network Security Groups (NSGs) to restrict inbound and outbound traffic based on trusted sources and destinations.
- Regularly review and monitor the routing tables and routes within the Azure Network to detect any unauthorized or suspicious routes.
- Enable Azure Network Watcher's Flow Logs to capture and analyze network traffic for any anomalies or unauthorized routes.

Example CLI command to add a route to a route table:
```
az network route-table route create --name <route_name> --resource-group <resource_group_name> --route-table-name <route_table_name> --address-prefix <destination_address_prefix> --next-hop-type <next_hop_type> --next-hop-ip-address <next_hop_ip_address>
```

Example CLI command to enable Flow Logs:
```
az network watcher flow-log configure --name <flow_log_name> --resource-group <resource_group_name> --location <location> --enabled true --storage-account <storage_account_id>
```

3. Example of security impact: If an unauthorized user gains access to the Microsoft.Network.routeTables.routes.write event in AzureRealtime for AzureNetwork, they could modify the routes within the routing table to redirect traffic to a malicious destination. This could result in data interception, unauthorized access to resources, or disruption of network connectivity.

Remediation:
- Implement network segmentation using Azure Virtual Network (VNet) peering or Azure Firewall to restrict communication between different network segments.
- Regularly review and monitor the routing tables and routes within the Azure Network to detect any unauthorized or suspicious routes.
- Enable Azure Network Watcher's Connection Monitor to continuously monitor network connectivity and detect any abnormal routing behavior.

Example CLI command to create a VNet peering:
```
az network vnet peering create --name <peering_name> --resource-group <resource_group_name> --vnet-name <vnet_name> --remote-vnet <remote_vnet_id> --allow-vnet-access
```

Example CLI command to enable Connection Monitor:
```
az network watcher connection-monitor create --name <connection_monitor_name> --resource-group <resource_group_name> --location <location> --source-resource <source_resource_id> --destination-resource <destination_resource_id> --auto-start true
```


 