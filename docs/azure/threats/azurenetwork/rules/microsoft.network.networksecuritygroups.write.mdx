--- 
slug: Microsoft.Network.networkSecurityGroups.write
eventname: Microsoft.Network.networkSecurityGroups.write
title: Microsoft.Network.networkSecurityGroups.write
sidebar_label: Microsoft.Network.networkSecurityGroups.write
---
                       
### Event Information

#### Meaning

1. The Microsoft.Network.networkSecurityGroups.write event in Azure signifies that a write operation has been performed on a network security group (NSG) within the Azure Network.
2. This event indicates that changes have been made to the configuration of an NSG, such as adding or removing rules, modifying security rules, or updating the NSG properties.
3. It is important to monitor this event as it helps track any modifications made to NSGs, ensuring that the network security policies are properly managed and maintained in the Azure environment.

### Remediation

#### Using Console

- Example: If the security is impacted with Microsoft.Network.networkSecurityGroups.write in Azure for AzureNetwork, it means that an unauthorized user or process has the ability to modify or create network security groups within the Azure Network. This can potentially lead to unauthorized access or network misconfigurations.

- Remediation Steps using Azure Portal:
  1. Sign in to the Azure portal (https://portal.azure.com) using appropriate credentials.
  2. Navigate to the Azure Network resource that is impacted.
  3. Select the "Network security groups" option from the left-hand menu.
  4. Identify the network security group(s) that are affected by the write permission.
  5. Click on the network security group to open its settings.
  6. In the network security group settings, click on the "Access control (IAM)" option from the left-hand menu.
  7. Review the list of users and roles that have the "Microsoft.Network.networkSecurityGroups.write" permission.
  8. Remove the unauthorized users or roles by selecting them and clicking on the "Remove" button.
  9. Save the changes and ensure that only authorized users or roles have the necessary permissions.

Note: It is recommended to regularly review and audit the access control settings for Azure Network resources to ensure that only authorized users have the necessary permissions. Additionally, implementing Azure RBAC (Role-Based Access Control) and following the principle of least privilege can help mitigate security risks.

#### Using CLI

1. Impact of Microsoft.Network.networkSecurityGroups.write on AzureNetwork security:
   - The Microsoft.Network.networkSecurityGroups.write permission allows a user to modify network security groups (NSGs) associated with an AzureNetwork resource in Azure.
   - If this permission is misused or granted to unauthorized users, it can potentially lead to unauthorized changes to NSGs, which can compromise the security of the AzureNetwork.

2. Remediation of Microsoft.Network.networkSecurityGroups.write for AzureNetwork using Azure CLI:
   - To remediate the security impact of Microsoft.Network.networkSecurityGroups.write on AzureNetwork, you can follow these steps using Azure CLI:

   1. Identify the affected AzureNetwork resource:
      ```
      az network vnet show --name <azure_network_name> --resource-group <resource_group_name>
      ```

   2. Revoke the Microsoft.Network.networkSecurityGroups.write permission for unauthorized users or roles:
      ```
      az role assignment delete --assignee <user_or_role_id> --scope <azure_network_resource_id> --role "Microsoft.Network/networkSecurityGroups/write"
      ```

   3. Verify the permission revocation:
      ```
      az role assignment list --scope <azure_network_resource_id> --query "[?roleDefinitionName=='Microsoft.Network/networkSecurityGroups/write']"
      ```

   Note: Replace `<azure_network_name>`, `<resource_group_name>`, `<user_or_role_id>`, and `<azure_network_resource_id>` with the appropriate values specific to your Azure environment.

#### Using Python

1. Example of security impact with Microsoft.Network.networkSecurityGroups.write in Azure for AzureNetwork:
   - If an unauthorized user gains write access to the Microsoft.Network.networkSecurityGroups resource type in Azure for AzureNetwork, they can modify the network security groups associated with the network. This can lead to unauthorized changes in network traffic rules, potentially exposing the network to security vulnerabilities or allowing unauthorized access to resources within the network.

2. Remediation for AzureNetwork using Python:
   - To remediate the security impact of Microsoft.Network.networkSecurityGroups.write in Azure for AzureNetwork using Python, you can utilize the Azure SDK for Python (azure-mgmt-network) to manage network security groups programmatically. Here's an example Python script that demonstrates how to revoke the write access for network security groups in AzureNetwork:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.network import NetworkManagementClient

# Authenticate using default credentials
credential = DefaultAzureCredential()

# Specify your Azure subscription ID
subscription_id = '<your-subscription-id>'

# Specify the resource group and AzureNetwork name
resource_group_name = '<your-resource-group-name>'
azure_network_name = '<your-azure-network-name>'

# Create the NetworkManagementClient
network_client = NetworkManagementClient(credential, subscription_id)

# Get the existing network security group associated with AzureNetwork
network_security_group = network_client.network_security_groups.get(resource_group_name, azure_network_name)

# Revoke the write access for network security groups
network_security_group.network_security_group_properties.default_security_rules[0].access = 'Deny'

# Update the network security group
network_client.network_security_groups.create_or_update(resource_group_name, azure_network_name, network_security_group)

print('Write access for network security groups in AzureNetwork has been revoked.')
```

Please note that you need to install the required Python packages (`azure-identity` and `azure-mgmt-network`) before running the script. Also, make sure to replace the placeholders (`<your-subscription-id>`, `<your-resource-group-name>`, and `<your-azure-network-name>`) with the actual values specific to your Azure environment.


 