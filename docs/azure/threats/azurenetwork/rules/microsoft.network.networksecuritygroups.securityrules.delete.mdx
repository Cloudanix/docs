--- 
slug: Microsoft.Network.networkSecurityGroups.securityRules.delete
eventname: Microsoft.Network.networkSecurityGroups.securityRules.delete
title: Microsoft.Network.networkSecurityGroups.securityRules.delete
sidebar_label: Microsoft.Network.networkSecurityGroups.securityRules.delete
---
                       
### Event Information

#### Meaning

1. The Microsoft.Network.networkSecurityGroups.securityRules.delete event in Azure signifies the deletion of a security rule within a network security group (NSG) in Azure.

2. This event indicates that a specific security rule within an NSG has been removed, which can impact the network traffic flow and security policies associated with the NSG.

3. It is important to monitor and track these events to ensure that the deletion of security rules aligns with the desired network security configuration and to identify any unauthorized changes or potential security risks.

### Remediation

#### Using Console

- Example: If security is impacted with the deletion of a network security group (NSG) rule in Azure Network, it can potentially expose the associated resources to unauthorized access or compromise the network security posture.

- Remediation Steps using Azure Console:
  1. Log in to the Azure portal (https://portal.azure.com) using your credentials.
  2. Navigate to the Azure Network resource that is impacted by the deletion of the NSG rule.
  3. Select the "Network security groups" option from the left-hand menu.
  4. Identify the affected NSG and click on its name to open the NSG configuration.
  5. In the NSG configuration, click on the "Inbound security rules" or "Outbound security rules" tab, depending on the direction of the deleted rule.
  6. Click on the "+ Add" button to create a new security rule.
  7. Provide the necessary details for the new security rule, such as name, priority, source/destination IP addresses, ports, and protocol.
  8. Review the rule configuration and click on the "Add" button to save the new security rule.
  9. Repeat the above steps if multiple rules were deleted or if both inbound and outbound rules were affected.
  10. Verify that the new security rules are applied correctly and ensure that the impacted resources are now adequately protected.

Note: It is recommended to regularly review and audit the network security group configurations to identify any unauthorized changes and take appropriate actions to remediate them. Additionally, implementing RBAC (Role-Based Access Control) and monitoring solutions can help detect and prevent unauthorized modifications to network security groups.

#### Using CLI

- The security impact of deleting a network security group (NSG) rule in AzureNetwork can result in the loss of specific security configurations and access controls for the associated resources.
- For example, if a security rule allowing inbound traffic from a specific IP address range is deleted, it can potentially expose the associated resources to unauthorized access from that IP range.
- To remediate this issue using Azure CLI, you can follow these steps:
  1. Identify the specific NSG and rule that was deleted using the Azure portal or CLI commands like `az network nsg list` and `az network nsg show`.
  2. Recreate the deleted security rule using the `az network nsg rule create` command, providing the necessary parameters such as NSG name, rule name, priority, source/destination IP ranges, and protocol.
  3. Apply the newly created rule to the appropriate NSG using the `az network nsg rule create` command, specifying the NSG name and the rule name.

Example CLI commands:
```
az network nsg rule create --nsg-name <nsg-name> --name <rule-name> --priority <priority> --source-address-prefix <source-ip-range> --destination-address-prefix <destination-ip-range> --protocol <protocol> --access <access> --direction <direction>
az network nsg rule create --nsg-name MyNSG --name MyRule --priority 100 --source-address-prefix 10.0.0.0/24 --destination-address-prefix '*' --protocol Tcp --access Allow --direction Inbound
az network nsg rule create --nsg-name MyNSG --name MyRule --priority 100 --source-address-prefix '*' --destination-address-prefix 10.0.0.0/24 --protocol Tcp --access Allow --direction Outbound
```

#### Using Python

1. Impact on Security: The `Microsoft.Network.networkSecurityGroups.securityRules.delete` action in Azure can potentially impact security by allowing unauthorized deletion of security rules within a network security group (NSG) associated with an Azure Network. This action can lead to the removal of essential security rules, leaving the network vulnerable to unauthorized access or malicious activities.

2. Remediation Steps using Python: To remediate this security issue for an Azure Network (VNet) in Azure using Python, you can utilize the Azure SDK for Python (azure-mgmt-network) to programmatically manage network security groups and their associated security rules. Here's an example Python script that demonstrates how to delete a specific security rule from a network security group:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.network import NetworkManagementClient

# Define your Azure subscription ID and resource group name
subscription_id = 'your_subscription_id'
resource_group_name = 'your_resource_group_name'

# Create a credential object using default Azure credentials
credential = DefaultAzureCredential()

# Create a NetworkManagementClient instance
network_client = NetworkManagementClient(credential, subscription_id)

# Define the name of the network security group and the security rule to be deleted
network_security_group_name = 'your_network_security_group_name'
security_rule_name = 'your_security_rule_name'

# Delete the specified security rule from the network security group
network_client.security_rules.delete(resource_group_name, network_security_group_name, security_rule_name)
```

Please note that you need to install the required Python packages (`azure-identity` and `azure-mgmt-network`) before running the script. You can install them using pip:

```
pip install azure-identity azure-mgmt-network
```

3. Additional Considerations:
- It is recommended to follow the principle of least privilege when granting permissions to delete security rules. Only authorized individuals or processes should have the necessary permissions to perform this action.
- Regularly review and audit the security rules within network security groups to identify any unauthorized or unnecessary rules that could potentially impact security.


 