--- 
slug: Microsoft.Network.virtualNetworks.delete
eventname: Microsoft.Network.virtualNetworks.delete
title: Microsoft.Network.virtualNetworks.delete
sidebar_label: Microsoft.Network.virtualNetworks.delete
---
                       
### Event Information

1. The Microsoft.Network.virtualNetworks.delete event in Azure for AzureNetwork indicates that a virtual network (VNet) has been deleted in the Azure Network resource group.
2. This event signifies that all associated resources within the VNet, such as subnets, network security groups, and route tables, have also been removed.
3. It is important to note that this event can have significant implications on the overall network connectivity and communication within the Azure environment, and should be carefully managed and monitored to avoid any disruptions.


### Examples

1. Unauthorized deletion of a virtual network (VNet): If security is impacted with Microsoft.Network.virtualNetworks.delete in Azure for AzureNetwork, it could potentially lead to the unauthorized deletion of a VNet. This can result in the loss of network connectivity for resources within the VNet, affecting the availability and accessibility of applications and services.

2. Data exposure: Deleting a virtual network without proper safeguards can lead to the exposure of sensitive data. If the VNet contains resources such as virtual machines, databases, or storage accounts, their associated data may be lost or accessible to unauthorized individuals, potentially leading to data breaches and compliance violations.

3. Disruption of network security controls: Deleting a virtual network can disrupt network security controls that are in place to protect resources within the VNet. This can include network security groups (NSGs), virtual network service endpoints, and network virtual appliances. Disrupting these controls can leave resources vulnerable to unauthorized access, compromising the overall security posture of the environment.

### Remediation

#### Using Console

To remediate the unauthorized deletion of a virtual network (VNet) in Azure, follow these steps:

1. Implement RBAC (Role-Based Access Control): Ensure that only authorized users have the necessary permissions to delete virtual networks. Assign appropriate roles and permissions to users based on their responsibilities and restrict access to critical resources like virtual networks.

2. Enable Azure Resource Manager Locks: Apply locks to the virtual network resource to prevent accidental or unauthorized deletion. Azure provides two types of locks - CanNotDelete and ReadOnly. Apply the CanNotDelete lock to the virtual network resource to prevent deletion.

3. Enable Azure Backup and Recovery: Regularly back up your virtual network configuration and data to ensure that you can restore it in case of accidental deletion. Azure provides backup and recovery services like Azure Site Recovery and Azure Backup, which can be used to protect and recover virtual networks.

By implementing RBAC, applying resource locks, and enabling backup and recovery mechanisms, you can mitigate the risk of unauthorized deletion of virtual networks in Azure.

#### Using CLI

1. To remediate unauthorized deletion of a virtual network (VNet) in Azure, you can use the Azure CLI commands to restore the deleted VNet and ensure network connectivity is restored:

```
# List all deleted virtual networks
az network vnet list-deleted

# Restore the deleted virtual network
az network vnet restore --name <vnet_name> --resource-group <resource_group_name>
```

2. To mitigate data exposure when deleting a virtual network, it is recommended to perform proper backup and data migration procedures before deleting the VNet. You can use the following Azure CLI commands to create a backup of the VNet resources:

```
# Create a backup of virtual machines within the VNet
az vm backup create --resource-group <resource_group_name> --vault-name <vault_name> --vm <vm_name>

# Create a backup of databases within the VNet
az sql db export --resource-group <resource_group_name> --server <server_name> --name <database_name> --storage-uri <storage_uri>

# Create a backup of storage accounts within the VNet
az storage blob copy start-batch --destination-container <container_name> --destination-path <destination_path> --source-container <container_name> --source-path <source_path>
```

3. To prevent network disruption caused by deleting a virtual network, it is important to follow proper change management processes and implement network segmentation. You can use the following Azure CLI commands to create network segmentation and monitor network activity:

```
# Implement network segmentation using network security groups (NSGs)
az network nsg create --resource-group <resource_group_name> --name <nsg_name>
az network nsg rule create --resource-group <resource_group_name> --nsg-name <nsg_name> --name <rule_name> --priority <priority> --source-address-prefixes <source_address_prefixes> --destination-address-prefixes <destination_address_prefixes> --destination-port-ranges <destination_port_ranges> --access <access> --protocol <protocol>

# Monitor network activity using Azure Network Watcher
az network watcher flow-log configure --resource-group <resource_group_name> --nsg <nsg_name> --enabled true
az network watcher flow-log show --resource-group <resource_group_name> --nsg <nsg_name>
```

Remember to replace `<vnet_name>`, `<resource_group_name>`, `<vault_name>`, `<vm_name>`, `<server_name>`, `<database_name>`, `<container_name>`, `<source_path>`, `<destination_path>`, `<nsg_name>`, `<rule_name>`, `<priority>`, `<source_address_prefixes>`, `<destination_address_prefixes>`, `<destination_port_ranges>`, `<access>`, and `<protocol>` with the appropriate values for your environment.

#### Using Python

To remediate the unauthorized deletion of a virtual network (VNet) in Azure, you can follow these steps using Python scripts:

1. Implement access controls: Ensure that only authorized users or roles have permissions to delete virtual networks. You can use the Azure SDK for Python to manage access control lists (ACLs) for resources. Here's an example script:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.network import NetworkManagementClient

# Authenticate using default credentials
credential = DefaultAzureCredential()
network_client = NetworkManagementClient(credential, subscription_id)

# Set the resource group and VNet name
resource_group_name = "your_resource_group"
vnet_name = "your_vnet"

# Get the VNet resource
vnet = network_client.virtual_networks.get(resource_group_name, vnet_name)

# Remove the delete permission for unauthorized users or roles
vnet.delete_permission = None

# Update the VNet with the modified permissions
network_client.virtual_networks.create_or_update(resource_group_name, vnet_name, vnet)
```

2. Enable backup and recovery: Regularly back up your virtual networks and associated resources to prevent data loss. You can use Azure Backup service to create backups and restore them when needed. Here's an example script:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.recoveryservices import RecoveryServicesClient

# Authenticate using default credentials
credential = DefaultAzureCredential()
recovery_client = RecoveryServicesClient(credential, subscription_id)

# Set the resource group and VNet name
resource_group_name = "your_resource_group"
vnet_name = "your_vnet"

# Enable backup for the VNet
recovery_client.backup_protected_items.enable_protection(resource_group_name, vnet_name)
```

3. Implement change management processes: Establish a change management process to review and approve any VNet deletion requests. This can help prevent accidental or unauthorized deletions. You can use Azure DevOps or other similar tools to automate the change management workflow.

Note: The provided scripts are just examples and may require modifications based on your specific requirements and environment setup.


 