--- 
slug: Microsoft.Network.virtualNetworks.delete
eventname: Microsoft.Network.virtualNetworks.delete
title: Microsoft.Network.virtualNetworks.delete
sidebar_label: Microsoft.Network.virtualNetworks.delete
---
                       
### Event Information

#### Meaning

1. The Microsoft.Network.virtualNetworks.delete event in Azure signifies the deletion of a virtual network within the Azure Network service.
2. This event indicates that a virtual network resource has been permanently removed from the Azure environment.
3. It is important to note that deleting a virtual network will also remove all associated subnets, network security groups, and any other resources within the virtual network.

### Remediation

#### Using Console

- Example: If security is impacted with Microsoft.Network.virtualNetworks.delete in Azure for AzureNetwork, it means that an unauthorized user or process has the ability to delete virtual networks within the Azure Network resource group. This can lead to disruption of network connectivity and potential data loss.

- Remediation steps using the Azure portal:
  1. Sign in to the Azure portal (https://portal.azure.com) using your Azure account credentials.
  2. Navigate to the Azure Network resource group that contains the affected virtual network.
  3. Select the virtual network that needs to be protected.
  4. In the left-hand menu, under Settings, click on "Access control (IAM)".
  5. Click on the "+ Add" button to add a new role assignment.
  6. In the "Add role assignment" blade, select the appropriate role (e.g., "Contributor" or "Network Contributor") that should have the permission to delete virtual networks.
  7. In the "Assign access to" field, search and select the user, group, or service principal that should have the permission.
  8. Click on the "Save" button to apply the role assignment.
  9. Repeat steps 5-8 for any additional users or groups that require the permission.
  10. Ensure that only authorized users or processes have the necessary permissions to delete virtual networks within the Azure Network resource group.

- Note: It is important to regularly review and audit the access control settings to ensure that only authorized users have the necessary permissions. Additionally, enabling Azure AD Privileged Identity Management (PIM) can provide just-in-time access to critical Azure resources, further enhancing security.

#### Using CLI

1. Example of security impact: If an unauthorized user gains access to the Azure CLI or Azure portal and executes the `az network vnet delete` command with the appropriate permissions, they can delete a virtual network (VNet) in Azure. This can result in the loss of network connectivity for resources within the VNet, potential data loss, and disruption of services relying on the VNet.

2. Remediation for AZU AzureNetwork using AZU CLI:
   - Implement Role-Based Access Control (RBAC): Assign appropriate RBAC roles to users and service principals to restrict access to the `Microsoft.Network/virtualNetworks/delete` action. This ensures that only authorized individuals can delete virtual networks.
   - Enable Azure Resource Locks: Apply a "CanNotDelete" lock on the Azure Network resource group or the specific virtual network to prevent accidental or unauthorized deletion. This lock can be applied using the `az lock create` command.
   - Enable Azure Network Watcher: Utilize Azure Network Watcher to monitor and detect any suspicious activities related to virtual network deletion. Network Watcher provides diagnostic and visualization tools to help identify potential security threats.

Example CLI commands:
```
# Assign RBAC role to restrict delete permissions
az role assignment create --assignee <user or service principal ID> --role "Contributor" --scope /subscriptions/<subscription ID>/resourceGroups/<resource group name>/providers/Microsoft.Network/virtualNetworks/<virtual network name>

# Apply "CanNotDelete" lock on the resource group
az lock create --name "network-rg-lock" --lock-type CanNotDelete --resource-group <resource group name>

# Apply "CanNotDelete" lock on the virtual network
az lock create --name "vnet-lock" --lock-type CanNotDelete --resource-group <resource group name> --resource-name <virtual network name> --resource-type Microsoft.Network/virtualNetworks

# Enable Network Watcher flow logs for monitoring
az network watcher flow-log configure --enabled true --nsg <network security group name> --resource-group <resource group name> --storage-account <storage account name> --enabled true
```

Please note that the specific commands may vary based on your Azure CLI version and configuration.

#### Using Python

1. Example of security impact with Microsoft.Network.virtualNetworks.delete in Azure for Azure Network:
   - If an unauthorized user gains access to the Azure subscription and executes the Microsoft.Network.virtualNetworks.delete operation on an Azure Network, it can result in the deletion of the entire virtual network, including all associated resources such as subnets, network security groups, and virtual machines. This can lead to a significant disruption of services and potential data loss.

2. Remediation for Azure Network security impact using Python:
   - To remediate the security impact of unauthorized deletion of Azure Networks, you can implement RBAC (Role-Based Access Control) and apply the principle of least privilege. This ensures that only authorized users have the necessary permissions to perform critical operations like virtual network deletion.
   - Using the Azure SDK for Python, you can write a script to assign the appropriate RBAC roles to users or groups. For example, you can assign the "Contributor" role to users who need to manage virtual networks, while restricting the "Network Contributor" role to users who only need to manage network-related resources within the virtual network.
   - Here's an example Python script that uses the `azure-mgmt-network` library to assign RBAC roles to a user or group:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.network import NetworkManagementClient

# Authenticate using default credentials
credential = DefaultAzureCredential()

# Specify your Azure subscription ID
subscription_id = 'your_subscription_id'

# Specify the resource group and virtual network name
resource_group_name = 'your_resource_group'
virtual_network_name = 'your_virtual_network'

# Specify the user or group object ID to assign the RBAC role
user_or_group_object_id = 'your_user_or_group_object_id'

# Create the NetworkManagementClient
network_client = NetworkManagementClient(credential, subscription_id)

# Assign the Contributor role to the user or group for the virtual network
network_client.virtual_networks.begin_grant_access(
    resource_group_name,
    virtual_network_name,
    user_or_group_object_id,
    'Contributor'
).result()
```

Please note that you need to install the `azure-mgmt-network` library and authenticate with appropriate credentials before running this script.


 