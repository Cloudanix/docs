--- 
slug: Microsoft.Network.networkSecurityGroups.securityRules.write
eventname: Microsoft.Network.networkSecurityGroups.securityRules.write
title: Microsoft.Network.networkSecurityGroups.securityRules.write
sidebar_label: Microsoft.Network.networkSecurityGroups.securityRules.write
---
                       
### Event Information

#### Meaning

1. The Microsoft.Network.networkSecurityGroups.securityRules.write event in Azure signifies that a security rule has been created, updated, or deleted within a network security group (NSG) in Azure.

2. This event indicates changes made to the security rules that control inbound and outbound traffic for resources within the Azure network.

3. By monitoring this event, administrators can track and audit any modifications to the NSG security rules, ensuring compliance with security policies and identifying any unauthorized changes.

### Remediation

#### Using Console

- Example: If security is impacted with Microsoft.Network.networkSecurityGroups.securityRules.write in Azure for AzureNetwork, it means that an unauthorized entity has the ability to modify the security rules of the network security group associated with the AzureNetwork resource. This can potentially lead to unauthorized access or exposure of sensitive resources within the network.

- Remediation Steps using Azure Portal:
  1. Log in to the Azure Portal (portal.azure.com) using your credentials.
  2. Navigate to the AzureNetwork resource that is impacted by the security issue.
  3. Select the "Network security group" associated with the AzureNetwork resource.
  4. In the network security group settings, click on the "Inbound security rules" or "Outbound security rules" tab, depending on the direction of the impacted security rule.
  5. Locate the unauthorized security rule that allows Microsoft.Network.networkSecurityGroups.securityRules.write and select it.
  6. Click on the "Delete" or "Remove" button to remove the unauthorized security rule.
  7. Confirm the deletion when prompted.
  8. Review the remaining security rules and ensure that they are properly configured to meet your security requirements.
  9. Save the changes and exit the network security group settings.

Note: It is recommended to regularly review and audit the security rules of network security groups to prevent unauthorized modifications and ensure compliance with security best practices.

#### Using CLI

1. Impact on Security: The Microsoft.Network.networkSecurityGroups.securityRules.write permission in Azure Network Security Groups (NSGs) allows a user to create, update, or delete security rules within the NSG. If this permission is misused or granted to unauthorized users, it can potentially lead to unauthorized changes to the network security rules, compromising the security of the Azure Network.

2. Example: An example scenario where security can be impacted is if an unauthorized user gains access to the Microsoft.Network.networkSecurityGroups.securityRules.write permission for an Azure Network. They can then create a new security rule that allows unrestricted inbound access to a critical resource, such as a database server, bypassing the existing security controls and potentially exposing the resource to unauthorized access.

3. Remediation using Azure CLI: To remediate this issue for an Azure Network using Azure CLI, you can follow these steps:

- Identify the affected Azure Network and the NSG associated with it.
- Revoke the Microsoft.Network.networkSecurityGroups.securityRules.write permission from unauthorized users or roles.
- Regularly review and audit the NSG rules to ensure they align with the security requirements and remove any unnecessary or overly permissive rules.
- Implement a robust RBAC (Role-Based Access Control) strategy to ensure that only authorized users have the necessary permissions to manage NSG rules.
- Monitor and log NSG rule changes to detect any unauthorized modifications and take appropriate actions.

CLI Commands:
1. Revoke permission from a user or role:
   ```
   az role assignment delete --assignee <user or role ID> --scope <Azure Network ID> --role "Microsoft.Network/networkSecurityGroups/securityRules/write"
   ```

2. Review NSG rules:
   ```
   az network nsg rule list --nsg-name <NSG name> --resource-group <resource group name>
   ```

3. Implement RBAC:
   ```
   az role assignment create --assignee <user or role ID> --scope <Azure Network ID> --role "Contributor"
   ```

Note: Replace `<user or role ID>`, `<Azure Network ID>`, `<NSG name>`, and `<resource group name>` with the appropriate values specific to your environment.

#### Using Python

1. Example of security impact: If the "Microsoft.Network.networkSecurityGroups.securityRules.write" permission is granted to a user or service principal for an Azure Network Security Group (NSG) in Azure, it means they have the ability to create, update, or delete security rules within that NSG. This can potentially lead to unauthorized changes to the network security configuration, allowing traffic that should be blocked or blocking traffic that should be allowed.

2. Remediation for Azure Network using Python: To remediate this security issue for an Azure Network, you can use the Azure SDK for Python (azure-mgmt-network) to remove the "Microsoft.Network.networkSecurityGroups.securityRules.write" permission from the user or service principal.

Here's an example Python script that demonstrates how to revoke the permission:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.network import NetworkManagementClient

# Set your Azure subscription ID and resource group name
subscription_id = '<your-subscription-id>'
resource_group_name = '<your-resource-group-name>'

# Create a credential object using default Azure credentials
credential = DefaultAzureCredential()

# Create a NetworkManagementClient instance
network_client = NetworkManagementClient(credential, subscription_id)

# Set the Azure Network Security Group and the user or service principal object ID
network_security_group_name = '<your-network-security-group-name>'
object_id = '<user-or-service-principal-object-id>'

# Get the existing Network Security Group
network_security_group = network_client.network_security_groups.get(resource_group_name, network_security_group_name)

# Remove the "Microsoft.Network.networkSecurityGroups.securityRules.write" permission from the user or service principal
network_security_group.permissions = [p for p in network_security_group.permissions if p not in ['Microsoft.Network/networkSecurityGroups/securityRules/write']]

# Update the Network Security Group
network_client.network_security_groups.create_or_update(resource_group_name, network_security_group_name, network_security_group)
```

Please note that you need to install the required Python packages (`azure-identity` and `azure-mgmt-network`) before running this script. You can install them using pip:

```
pip install azure-identity azure-mgmt-network
```

3. Additional considerations:
- Ensure that you have the necessary permissions to modify the Network Security Group and the appropriate Azure SDK version installed.
- It is recommended to follow the principle of least privilege and only grant necessary permissions to users or service principals.
- Regularly review and audit the permissions assigned to users or service principals to maintain a secure network environment.


 