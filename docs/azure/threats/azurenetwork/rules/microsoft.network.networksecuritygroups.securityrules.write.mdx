--- 
slug: Microsoft.Network.networkSecurityGroups.securityRules.write
eventname: Microsoft.Network.networkSecurityGroups.securityRules.write
title: Microsoft.Network.networkSecurityGroups.securityRules.write
sidebar_label: Microsoft.Network.networkSecurityGroups.securityRules.write
---
                       
### Event Information

#### Meaning

1. The Microsoft.Network.networkSecurityGroups.securityRules.write event in AzureRealTime for AzureNetwork refers to the action of creating or modifying security rules within a network security group (NSG) in Azure.

2. This event indicates that a change has been made to the inbound or outbound rules of an NSG, which are used to control network traffic to and from Azure resources.

3. By monitoring this event, administrators can track any modifications made to the security rules of NSGs, ensuring that the network traffic is properly controlled and compliant with the organization's security policies.

#### Example

1. Example of security impact: If an unauthorized user gains write access to the network security group (NSG) security rules in Azure, they can potentially modify or delete existing rules, allowing them to bypass network security measures or open up unauthorized access to resources. This can lead to potential security breaches or unauthorized access to sensitive data or services.

Remediation:
- Regularly review and audit the access control policies and permissions for NSGs to ensure that only authorized users have write access.
- Implement role-based access control (RBAC) to restrict write access to NSG security rules to only trusted administrators or security teams.
- Enable Azure Monitor and Azure Security Center to receive alerts and notifications for any unauthorized changes to NSG security rules. 

Example CLI command to restrict write access to NSG security rules:
```
az role assignment create --role "Network Contributor" --assignee <user or group principal ID> --scope /subscriptions/<subscription ID>/resourceGroups/<resource group name>/providers/Microsoft.Network/networkSecurityGroups/<NSG name>
```

2. Example of security impact: If a malicious actor gains write access to the Azure Network Security Group (NSG) security rules, they can add new rules to allow inbound or outbound traffic to unauthorized IP addresses or ports. This can result in unauthorized access to resources, data exfiltration, or the introduction of malware or malicious activities within the network.

Remediation:
- Implement just-in-time (JIT) access control to restrict inbound and outbound traffic to specific IP addresses or ports for a limited time window.
- Regularly review and monitor NSG security rules for any unauthorized changes or suspicious activities.
- Enable network security group flow logs to capture and analyze network traffic for any anomalies or unauthorized access attempts.

Example CLI command to enable NSG flow logs:
```
az network watcher flow-log configure --enabled true --nsg <NSG resource ID> --storage-account <storage account ID> --enabled true
```

3. Example of security impact: If an attacker gains write access to the Azure Network Security Group (NSG) security rules, they can modify existing rules to allow unrestricted access to sensitive resources or services. This can lead to data breaches, service disruptions, or unauthorized access to critical infrastructure.

Remediation:
- Implement network security best practices such as the principle of least privilege, where only necessary ports and protocols are allowed in NSG rules.
- Regularly review and update NSG security rules to align with the organization's security policies and requirements.
- Enable Azure Security Center's Just-in-Time VM Access feature to restrict access to virtual machines (VMs) based on specific time windows and approved requests.

Example CLI command to enable Just-in-Time VM Access:
```
az security jit-policy update --name <policy name> --resource-group <resource group name> --enabled true
```


 