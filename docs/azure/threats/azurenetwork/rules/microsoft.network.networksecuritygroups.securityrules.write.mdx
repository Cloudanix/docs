--- 
slug: Microsoft.Network.networkSecurityGroups.securityRules.write
eventname: Microsoft.Network.networkSecurityGroups.securityRules.write
title: Microsoft.Network.networkSecurityGroups.securityRules.write
sidebar_label: Microsoft.Network.networkSecurityGroups.securityRules.write
---
                       
### Event Information

1. The Microsoft.Network.networkSecurityGroups.securityRules.write event in Azure for AzureNetwork refers to the action of creating or modifying security rules within a network security group (NSG) in Azure.

2. This event indicates that changes have been made to the inbound or outbound rules of an NSG, which control the traffic flow to and from resources within a virtual network.

3. By monitoring this event, administrators can track any modifications made to the security rules of an NSG, ensuring that the network traffic is properly controlled and compliant with the organization's security policies.


### Examples

1. Unauthorized modification of network security rules: If security is impacted with Microsoft.Network.networkSecurityGroups.securityRules.write in Azure for AzureNetwork, it could potentially allow unauthorized users to modify the network security rules associated with the Azure Network. This could lead to the introduction of insecure rules or the removal of critical security controls, compromising the overall security posture of the network.

2. Exposure of sensitive resources: A security impact with Microsoft.Network.networkSecurityGroups.securityRules.write in Azure for AzureNetwork could result in the exposure of sensitive resources. Attackers may exploit this vulnerability to modify security rules and gain unauthorized access to sensitive data or services hosted within the network. This could lead to data breaches, unauthorized access, or service disruptions.

3. Elevation of privileges: If security is impacted with Microsoft.Network.networkSecurityGroups.securityRules.write in Azure for AzureNetwork, it could potentially allow unauthorized users to elevate their privileges within the network. By modifying security rules, attackers may gain higher levels of access, enabling them to perform malicious activities such as lateral movement, privilege escalation, or launching further attacks within the network. This can significantly increase the risk of unauthorized access and compromise the overall security of the Azure Network.

### Remediation

#### Using Console

To remediate the issues mentioned in the previous response for Azure Network using the Azure console, you can follow these step-by-step instructions:

1. Enable Network Security Groups (NSGs):
   - Go to the Azure portal and navigate to the desired virtual network.
   - Select "Network security groups" from the left-hand menu.
   - Click on "Add" to create a new NSG or select an existing NSG.
   - Configure inbound and outbound security rules based on your requirements.
   - Apply the NSG to the desired subnets or network interfaces.

2. Implement Azure DDoS Protection Standard:
   - Go to the Azure portal and navigate to the desired virtual network.
   - Select "Distributed denial of service (DDoS) protection" from the left-hand menu.
   - Click on "Enable DDoS protection" and choose the "Standard" tier.
   - Configure the DDoS protection settings based on your requirements.
   - Apply the DDoS protection to the desired resources within the virtual network.

3. Implement Azure Firewall:
   - Go to the Azure portal and navigate to the desired virtual network.
   - Select "Firewalls and virtual networks" from the left-hand menu.
   - Click on "Add" to create a new Azure Firewall or select an existing one.
   - Configure the firewall rules and network rules based on your requirements.
   - Associate the Azure Firewall with the desired subnets or network interfaces.

Note: The above instructions are general guidelines and may vary based on your specific Azure environment and requirements. It is recommended to refer to the official Azure documentation for detailed instructions and best practices.

#### Using CLI

To remediate issues related to Azure Network using Azure CLI, you can follow these steps:

1. Enable Network Security Groups (NSGs) for Subnets:
   - Use the `az network vnet subnet update` command to update the subnet configuration.
   - Specify the `--network-security-group` parameter with the name or resource ID of the NSG you want to associate with the subnet.

2. Implement Network Virtual Appliances (NVAs):
   - Use the `az network vnet-gateway create` command to create a virtual network gateway.
   - Specify the `--gateway-type` parameter as "Vpn" or "ExpressRoute" depending on your requirements.
   - Provide the necessary parameters like `--name`, `--resource-group`, `--vnet`, etc.

3. Enable Azure Firewall:
   - Use the `az network firewall create` command to create an Azure Firewall.
   - Specify the `--name` and `--resource-group` parameters for the firewall.
   - Configure the necessary parameters like `--public-ip-address`, `--vnet-name`, `--subnet-name`, etc.

Please note that the actual CLI commands may vary based on your specific requirements and Azure environment setup. Make sure to replace the placeholders with the appropriate values.

#### Using Python

To remediate issues related to AzureNetwork using Python, you can use the Azure SDK for Python. Here are three examples of how you can remediate common issues:

1. Example 1: Enable Network Security Group (NSG) Flow Logs
   - Use the `azure.mgmt.network` package to retrieve the NSG resource.
   - Enable flow logs for the NSG by setting the `enable_flow_logs` property to `True`.
   - Update the NSG resource using the `network_client.network_security_groups.create_or_update` method.

   ```python
   from azure.identity import DefaultAzureCredential
   from azure.mgmt.network import NetworkManagementClient

   # Authenticate using default credentials
   credential = DefaultAzureCredential()
   network_client = NetworkManagementClient(credential, subscription_id)

   # Retrieve the NSG resource
   nsg = network_client.network_security_groups.get(resource_group_name, nsg_name)

   # Enable flow logs for the NSG
   nsg.enable_flow_logs = True

   # Update the NSG resource
   network_client.network_security_groups.create_or_update(resource_group_name, nsg_name, nsg)
   ```

2. Example 2: Add a Network Security Rule to an NSG
   - Use the `azure.mgmt.network` package to retrieve the NSG resource.
   - Add a new security rule to the NSG by appending it to the `security_rules` list.
   - Update the NSG resource using the `network_client.network_security_groups.create_or_update` method.

   ```python
   from azure.identity import DefaultAzureCredential
   from azure.mgmt.network import NetworkManagementClient
   from azure.mgmt.network.models import SecurityRule

   # Authenticate using default credentials
   credential = DefaultAzureCredential()
   network_client = NetworkManagementClient(credential, subscription_id)

   # Retrieve the NSG resource
   nsg = network_client.network_security_groups.get(resource_group_name, nsg_name)

   # Add a new security rule to the NSG
   new_rule = SecurityRule(name="Allow-SSH", protocol="Tcp", source_port_range="*", destination_port_range="22", access="Allow", direction="Inbound")
   nsg.security_rules.append(new_rule)

   # Update the NSG resource
   network_client.network_security_groups.create_or_update(resource_group_name, nsg_name, nsg)
   ```

3. Example 3: Update Network Security Group (NSG) Rules
   - Use the `azure.mgmt.network` package to retrieve the NSG resource.
   - Modify the existing security rules in the NSG by updating the desired properties.
   - Update the NSG resource using the `network_client.network_security_groups.create_or_update` method.

   ```python
   from azure.identity import DefaultAzureCredential
   from azure.mgmt.network import NetworkManagementClient

   # Authenticate using default credentials
   credential = DefaultAzureCredential()
   network_client = NetworkManagementClient(credential, subscription_id)

   # Retrieve the NSG resource
   nsg = network_client.network_security_groups.get(resource_group_name, nsg_name)

   # Modify the existing security rules in the NSG
   for rule in nsg.security_rules:
       if rule.name == "Allow-SSH":
           rule.access = "Deny"

   # Update the NSG resource
   network_client.network_security_groups.create_or_update(resource_group_name, nsg_name, nsg)
   ```


 