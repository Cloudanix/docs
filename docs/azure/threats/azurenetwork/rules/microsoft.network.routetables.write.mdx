--- 
slug: Microsoft.Network.routeTables.write
eventname: Microsoft.Network.routeTables.write
title: Microsoft.Network.routeTables.write
sidebar_label: Microsoft.Network.routeTables.write
---
                       
### Event Information

#### Meaning

- The Microsoft.Network.routeTables.write event in AzureNetwork refers to a write operation performed on a route table in the Azure network.
- This event indicates that a change has been made to the route table configuration, such as adding or modifying routes.
- It is important to monitor this event to track any changes made to the route tables, as they can impact the network traffic flow within the Azure environment.

#### Example

1. Example of security impact: If an unauthorized user gains write access to the route tables in AzureNetwork, they can potentially modify the routing configuration, leading to unauthorized access to resources or network traffic redirection. This can result in data breaches, service disruptions, or unauthorized access to sensitive information.

Remediation:
- Regularly review and update access control policies for route tables to ensure that only authorized users have write access.
- Implement Azure RBAC (Role-Based Access Control) to restrict write access to route tables to only trusted individuals or groups.
- Enable Azure Network Watcher's flow logs to monitor and detect any unauthorized changes to route tables. 

Azure CLI command to restrict write access to route tables:
```
az role assignment create --assignee <user or group principal ID> --role "Network Contributor" --scope /subscriptions/<subscription ID>/resourceGroups/<resource group name>/providers/Microsoft.Network/routeTables/<route table name>
```

2. Example of security impact: If a malicious actor gains write access to the route tables in AzureNetwork, they can modify the routing configuration to redirect network traffic to unauthorized destinations or intercept sensitive information. This can lead to data exfiltration, unauthorized access to resources, or service disruptions.

Remediation:
- Implement network security groups (NSGs) to restrict inbound and outbound traffic to and from the route tables.
- Regularly monitor and review the route table configurations for any unauthorized changes.
- Enable Azure Security Center to detect and alert on any suspicious activities related to route tables.

Azure CLI command to apply NSG to a route table:
```
az network route-table update --name <route table name> --resource-group <resource group name> --disable-bgp-route-propagation --set "properties.subnets[0].networkSecurityGroup.id=/subscriptions/<subscription ID>/resourceGroups/<resource group name>/providers/Microsoft.Network/networkSecurityGroups/<NSG name>"
```

3. Example of security impact: If a misconfigured route table is created in AzureNetwork, it can inadvertently allow unauthorized access to resources or expose sensitive information. For example, if a route table is mistakenly associated with a subnet that should be isolated, it can result in unintended network connectivity.

Remediation:
- Regularly review and validate the route table configurations to ensure they align with the intended network architecture.
- Implement network segmentation and isolation by associating the appropriate subnets with the correct route tables.
- Enable Azure Network Watcher's network security group (NSG) flow logs to monitor and detect any unauthorized traffic or misconfigurations.

Azure CLI command to validate route table associations:
```
az network vnet subnet show --name <subnet name> --vnet-name <VNet name> --resource-group <resource group name> --query "routeTable.id"
```


 