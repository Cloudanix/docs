--- 
slug: Microsoft.Resources.subscriptions.resourceGroups.write
eventname: Microsoft.Resources.subscriptions.resourceGroups.write
title: Microsoft.Resources.subscriptions.resourceGroups.write
sidebar_label: Microsoft.Resources.subscriptions.resourceGroups.write
---
                       
### Event Information

#### Meaning

- The Microsoft.Resources.subscriptions.resourceGroups.write event in Azure Resource Management refers to the action of creating or updating a resource group within an Azure subscription.
- This event indicates that a user or application has performed a write operation on a resource group, which includes actions such as creating, updating, or deleting resources within that group.
- Monitoring this event can help track changes and activities related to resource group management, providing visibility into the creation and modification of resource groups within an Azure subscription.

### Remediation

#### Using Console

- Example: If the security is impacted with Microsoft.Resources.subscriptions.resourceGroups.write in Azure Resource Management, it means that users or applications have the ability to create, update, or delete resource groups within the Azure subscription. This can potentially lead to unauthorized changes or resource group sprawl.

- Remediation Steps:
1. Sign in to the Azure portal using your Azure account credentials.
2. Navigate to the Azure Resource Manager (ARM) section by clicking on the "Resource groups" option in the left-hand menu.
3. In the Resource groups blade, select the resource group for which you want to remediate the security issue.
4. Click on the "Access control (IAM)" option in the left-hand menu of the selected resource group.
5. In the IAM blade, click on the "Add" button to add a new role assignment.
6. In the "Add role assignment" blade, select the appropriate role that restricts the Microsoft.Resources.subscriptions.resourceGroups.write permission. For example, you can select the "Contributor" role, which allows users to manage resources within the resource group but does not grant them the ability to create or delete resource groups.
7. In the "Add members" field, specify the user or group to whom you want to assign the role.
8. Click on the "Save" button to apply the role assignment.
9. Repeat steps 5-8 for any other resource groups that need to be remediated.

Note: It is important to carefully evaluate the impact of restricting the Microsoft.Resources.subscriptions.resourceGroups.write permission, as it may affect legitimate operations and workflows within your Azure environment.

#### Using CLI

1. Impact of Microsoft.Resources.subscriptions.resourceGroups.write on security in Azure Resource Management:
   - The Microsoft.Resources.subscriptions.resourceGroups.write permission allows a user to create, update, or delete resource groups within an Azure subscription. If this permission is misused or granted to unauthorized users, it can lead to potential security risks such as unauthorized access, resource tampering, or accidental deletion of critical resources.

2. Remediation for Azure Resource Management using Azure CLI:
   - To remediate the security impact of Microsoft.Resources.subscriptions.resourceGroups.write in Azure Resource Management, you can follow these steps using Azure CLI:

     1. Identify the affected user or role assignment:
        ```
        az role assignment list --scope /subscriptions/{subscriptionId}
        ```

     2. Revoke the Microsoft.Resources.subscriptions.resourceGroups.write permission for the user or role assignment:
        ```
        az role assignment delete --assignee {principalId} --role "Contributor" --scope /subscriptions/{subscriptionId}
        ```

     3. Verify the permission revocation:
        ```
        az role assignment list --scope /subscriptions/{subscriptionId}
        ```

3. Additional considerations:
   - It is important to regularly review and audit role assignments and permissions within Azure Resource Management to ensure that only authorized users have the necessary access. Implementing the principle of least privilege and regularly monitoring access controls can help mitigate security risks associated with this permission.

#### Using Python

1. Example of security impact: If the "Microsoft.Resources.subscriptions.resourceGroups.write" permission is granted to a user or service principal in Azure Resource Management, it means they have the ability to create, update, or delete resource groups within the Azure subscription. This can potentially lead to unauthorized changes to the resource group structure, resource deletion, or resource group creation without proper governance.

2. Remediation for AZU AzureResourceManagement using Python:
To remediate this security issue, you can use the Azure SDK for Python (azure-mgmt-resource) to manage access control for resource groups. Here's an example Python script that revokes the "Microsoft.Resources.subscriptions.resourceGroups.write" permission for a specific user or service principal:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.authorization import AuthorizationManagementClient
from azure.mgmt.resource import ResourceManagementClient

# Authenticate using default credentials
credential = DefaultAzureCredential()

# Specify your Azure subscription ID
subscription_id = 'your_subscription_id'

# Specify the user or service principal object ID
object_id = 'user_or_service_principal_object_id'

# Create the authorization management client
authorization_client = AuthorizationManagementClient(credential, subscription_id)

# Revoke the "Microsoft.Resources.subscriptions.resourceGroups.write" permission
permission_id = '/subscriptions/{0}/providers/Microsoft.Authorization/permissions/{1}'.format(subscription_id, object_id)
authorization_client.permissions.delete_by_id(permission_id)
```

Please note that you need to install the required Python packages (`azure-identity`, `azure-mgmt-authorization`, `azure-mgmt-resource`) before running this script. You can install them using pip:

```
pip install azure-identity azure-mgmt-authorization azure-mgmt-resource
```

3. Additional considerations:
- It is recommended to review and validate the permissions before revoking them to ensure that the impacted user or service principal does not require the write access for legitimate operations.
- Make sure you have appropriate permissions to perform the revocation action.


 