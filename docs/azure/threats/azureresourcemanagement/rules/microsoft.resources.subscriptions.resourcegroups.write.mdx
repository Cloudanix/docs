--- 
slug: Microsoft.Resources.subscriptions.resourceGroups.write
eventname: Microsoft.Resources.subscriptions.resourceGroups.write
title: Microsoft.Resources.subscriptions.resourceGroups.write
sidebar_label: Microsoft.Resources.subscriptions.resourceGroups.write
---
                       
### Event Information

- The Microsoft.Resources.subscriptions.resourceGroups.write event in Azure for Azure Resource Management refers to the action of creating or updating a resource group within an Azure subscription.
- This event indicates that a user or application has performed a write operation on a resource group, which includes actions such as creating, updating, or deleting resources within that resource group.
- Monitoring this event can help track changes and modifications made to resource groups, providing visibility into resource group management activities within an Azure subscription.


### Examples

1. Unauthorized creation or modification of resource groups: If security is impacted with Microsoft.Resources.subscriptions.resourceGroups.write in Azure for Azure Resource Management, it could lead to unauthorized creation or modification of resource groups. This means that an attacker could potentially create new resource groups or modify existing ones without proper authorization. This can result in unauthorized access to sensitive resources or disruption of the infrastructure.

2. Escalation of privileges: Another example of security impact with Microsoft.Resources.subscriptions.resourceGroups.write is the potential for escalation of privileges. If an attacker gains write access to resource groups, they can potentially escalate their privileges by modifying access control settings or granting themselves additional permissions. This can lead to unauthorized access to other resources within the subscription and compromise the overall security of the environment.

3. Resource group deletion or tampering: With write access to resource groups, an attacker can also delete or tamper with existing resource groups. This can result in the loss of critical resources or disruption of services. Additionally, tampering with resource groups can lead to the manipulation of resource configurations, potentially introducing vulnerabilities or misconfigurations that can be exploited by attackers.

### Remediation

#### Using Console

To remediate the issues related to Azure Resource Management using the Azure console, you can follow these step-by-step instructions:

1. Enable Azure Resource Manager diagnostic settings:
   - Go to the Azure portal and navigate to the resource group containing the resources you want to monitor.
   - Select the resource group and click on "Diagnostic settings" in the left-hand menu.
   - Click on "Add diagnostic setting" and provide a name for the diagnostic setting.
   - Select the desired resources and enable the required diagnostic logs.
   - Choose the destination for the logs, such as Azure Storage or Log Analytics.
   - Save the diagnostic setting.

2. Implement Azure Policy for resource management:
   - In the Azure portal, go to the Azure Policy service.
   - Click on "Definitions" in the left-hand menu and search for the desired policy definition.
   - Select the policy definition and click on "Assign policy" to apply it.
   - Choose the scope for the policy assignment, such as a subscription or resource group.
   - Configure the parameters and conditions for the policy, if applicable.
   - Save the policy assignment.

3. Monitor and remediate non-compliant resources:
   - In the Azure portal, go to the Azure Policy service.
   - Click on "Compliance" in the left-hand menu to view the compliance status of resources.
   - Identify the non-compliant resources and click on them to view the details.
   - Take necessary actions to remediate the non-compliance, such as modifying resource configurations or deleting resources.
   - Verify the compliance status after remediation.

Note: The specific steps may vary depending on the Azure portal version and interface changes. It is recommended to refer to the official Azure documentation for the latest instructions.

#### Using CLI

To remediate AzureResourceManagement issues using Azure CLI, you can follow these steps:

1. Identify the specific issue or misconfiguration in AzureResourceManagement.
2. Use the Azure CLI to execute the appropriate commands to remediate the issue.

Example 1: Enable diagnostic settings for an Azure resource:
```
az monitor diagnostic-settings create --name <diagnostic-settings-name> --resource <resource-id> --logs '[{"category": "AuditEvent", "enabled": true}]'
```

Example 2: Enable Azure Policy for resource compliance:
```
az policy assignment create --name <policy-assignment-name> --scope <resource-id> --policy <policy-definition-id>
```

Example 3: Enable Azure Security Center recommendations:
```
az security secure-score control update --name <control-name> --resource-id <resource-id> --status "enabled"
```

Please note that the specific CLI commands may vary depending on the exact issue and the resources involved. It is important to refer to the Azure CLI documentation and adjust the commands accordingly.

#### Using Python

To remediate AzureResourceManagement issues in Azure using Python, you can follow these steps:

1. Identify the specific issue or misconfiguration in AzureResourceManagement.
2. Use the Azure SDK for Python (azure-mgmt-resource package) to interact with Azure Resource Manager and perform the necessary remediation tasks.
3. Write Python scripts to automate the remediation process based on the specific issue. Here are three examples:

Example 1: Enable diagnostic settings for Azure resources:
```python
from azure.mgmt.monitor import MonitorManagementClient
from azure.identity import DefaultAzureCredential

# Authenticate using DefaultAzureCredential
credential = DefaultAzureCredential()

# Create a MonitorManagementClient
monitor_client = MonitorManagementClient(credential, subscription_id)

# Enable diagnostic settings for a specific resource
monitor_client.diagnostic_settings.create_or_update(
    resource_uri,
    diagnostic_settings_name,
    {
        "logs": [
            {
                "category": "AuditEvent",
                "enabled": True
            }
        ]
    }
)
```

Example 2: Enable Azure Policy for resource compliance:
```python
from azure.mgmt.resource import PolicyClient
from azure.identity import DefaultAzureCredential

# Authenticate using DefaultAzureCredential
credential = DefaultAzureCredential()

# Create a PolicyClient
policy_client = PolicyClient(credential, subscription_id)

# Enable Azure Policy for a specific resource
policy_client.assign_resource_policy(
    policy_assignment_name,
    {
        "policy_definition_id": policy_definition_id,
        "scope": resource_uri
    }
)
```

Example 3: Enable Azure Security Center recommendations:
```python
from azure.mgmt.security import SecurityCenter
from azure.identity import DefaultAzureCredential

# Authenticate using DefaultAzureCredential
credential = DefaultAzureCredential()

# Create a SecurityCenter client
security_center_client = SecurityCenter(credential, subscription_id)

# Enable Azure Security Center recommendations for a specific resource
security_center_client.security_solutions.update(
    resource_group_name,
    security_solution_name,
    {
        "properties": {
            "isEnabled": True
        }
    }
)
```

Please note that you need to replace the placeholders (e.g., subscription_id, resource_uri) with the actual values specific to your Azure environment.


 