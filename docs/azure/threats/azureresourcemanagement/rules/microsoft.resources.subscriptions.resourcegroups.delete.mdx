--- 
slug: Microsoft.Resources.subscriptions.resourceGroups.delete
eventname: Microsoft.Resources.subscriptions.resourceGroups.delete
title: Microsoft.Resources.subscriptions.resourceGroups.delete
sidebar_label: Microsoft.Resources.subscriptions.resourceGroups.delete
---
                       
### Event Information

- The Microsoft.Resources.subscriptions.resourceGroups.delete event in Azure for Azure Resource Management indicates that a resource group has been deleted within an Azure subscription.
- This event signifies that all resources within the resource group, including virtual machines, storage accounts, and network resources, have been permanently removed.
- It is important to note that this event is irreversible, and all data and configurations associated with the deleted resource group will be lost. Therefore, it is crucial to ensure that the deletion is intended and that any necessary backups or data transfers have been performed beforehand.


### Examples

1. Unauthorized deletion of resource groups: If security is impacted with Microsoft.Resources.subscriptions.resourceGroups.delete in Azure, it could potentially lead to unauthorized deletion of resource groups. This can result in the loss of critical resources and data, impacting the availability and functionality of the Azure environment.

2. Data exposure and leakage: In some cases, the deletion of resource groups may not completely remove all associated resources, such as storage accounts or virtual machines. If security is compromised, an attacker could potentially gain access to these resources before they are fully deleted, leading to data exposure and leakage.

3. Impact on compliance and auditability: Deletion of resource groups without proper authorization and documentation can have a significant impact on compliance and auditability. It becomes difficult to track and monitor the changes made to the Azure environment, potentially leading to non-compliance with regulatory requirements and making it challenging to investigate security incidents.

### Remediation

#### Using Console

To remediate unauthorized deletion of resource groups in Azure using the Azure console, you can follow these steps:

1. Enable RBAC (Role-Based Access Control): Implement RBAC to ensure that only authorized users have the necessary permissions to delete resource groups. This can be done by following these steps:
   - Go to the Azure portal and navigate to the resource group you want to secure.
   - Click on "Access control (IAM)" in the left-hand menu.
   - Click on "Add" and select the appropriate role (e.g., Owner, Contributor, or User Access Administrator).
   - Specify the user or group that should have the role assigned and click on "Save".

2. Enable resource group locks: Resource group locks can prevent accidental or unauthorized deletion of resource groups. To enable resource group locks, follow these steps:
   - Go to the Azure portal and navigate to the resource group you want to protect.
   - Click on "Locks" in the left-hand menu.
   - Click on "Add" and provide a name and description for the lock.
   - Select the appropriate lock type (e.g., CanNotDelete) and click on "OK".

3. Enable Azure Policy: Azure Policy allows you to define and enforce specific rules and conditions for resource group deletion. To enable Azure Policy, follow these steps:
   - Go to the Azure portal and navigate to the Azure Policy service.
   - Click on "Definitions" in the left-hand menu.
   - Click on "Assign policy" and select the appropriate policy definition (e.g., "Deny resource group deletion").
   - Specify the scope (e.g., subscription or resource group) and click on "Assign".

By implementing these steps, you can mitigate the risk of unauthorized deletion of resource groups in Azure and ensure better security, compliance, and auditability.

#### Using CLI

To remediate unauthorized deletion of resource groups in Azure using Azure CLI, you can follow these steps:

1. Implement Role-Based Access Control (RBAC): Ensure that proper RBAC roles and permissions are assigned to users and groups. Limit the delete access to resource groups only to authorized personnel.

2. Enable Azure Resource Manager Locks: Use Azure Resource Manager locks to prevent accidental or unauthorized deletion of resource groups. You can apply a delete lock to the resource group, which will prevent any resources within it from being deleted.

3. Enable Azure Resource Manager Policies: Implement Azure Resource Manager policies to enforce governance and compliance rules. You can create a policy that restricts the deletion of resource groups without proper authorization.

CLI commands:

1. Assign RBAC roles:
   ```
   az role assignment create --assignee <user or group principal ID> --role "Contributor" --scope /subscriptions/<subscription ID>/resourceGroups/<resource group name>
   ```

2. Apply delete lock:
   ```
   az lock create --name "DeleteLock" --lock-type CanNotDelete --resource-group <resource group name>
   ```

3. Create policy definition:
   ```
   az policy definition create --name "RestrictResourceGroupDeletion" --rules "{'if': {'field': 'type', 'equals': 'Microsoft.Resources/subscriptions/resourceGroups/delete'}, 'then': {'effect': 'deny'}}" --mode All
   ```

4. Assign policy to subscription:
   ```
   az policy assignment create --name "RestrictResourceGroupDeletionAssignment" --policy "RestrictResourceGroupDeletion" --scope /subscriptions/<subscription ID>
   ```

#### Using Python

To remediate unauthorized deletion of resource groups in Azure, you can take the following steps:

1. Implement Role-Based Access Control (RBAC): Ensure that proper RBAC permissions are assigned to users and groups. Limit the delete permission for resource groups to only authorized individuals or roles. Regularly review and update these permissions to maintain the principle of least privilege.

2. Enable Azure Resource Manager Locks: Use Azure Resource Manager locks to prevent accidental or unauthorized deletion of resource groups. Apply the "CanNotDelete" lock to critical resource groups to prevent any deletion attempts. This lock can only be removed by users with the appropriate permissions.

3. Enable Azure Resource Manager Policies: Implement Azure Resource Manager policies to enforce specific rules and restrictions on resource group deletion. For example, you can create a policy that requires a specific tag to be present on a resource group before it can be deleted. This helps prevent accidental or unauthorized deletions.

Here is an example Python script using the Azure SDK for Python (azure-mgmt-resource) to implement an RBAC role assignment for a resource group:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.authorization import AuthorizationManagementClient
from azure.mgmt.authorization.models import RoleAssignmentProperties

# Authenticate using default credentials
credential = DefaultAzureCredential()

# Create the Authorization Management client
authorization_client = AuthorizationManagementClient(credential, "<subscription_id>")

# Define the role assignment properties
role_assignment = RoleAssignmentProperties(
    principal_id="<principal_id>",
    role_definition_id="/subscriptions/<subscription_id>/providers/Microsoft.Authorization/roleDefinitions/<role_definition_id>",
    scope="/subscriptions/<subscription_id>/resourceGroups/<resource_group_name>"
)

# Create the role assignment
authorization_client.role_assignments.create("<scope>", "<role_assignment_name>", role_assignment)
```

Note: Replace `<subscription_id>`, `<principal_id>`, `<role_definition_id>`, `<resource_group_name>`, `<scope>`, and `<role_assignment_name>` with the appropriate values for your environment.

Please refer to the official Azure SDK for Python documentation for more information on how to use the SDK and customize the script according to your specific requirements.


 