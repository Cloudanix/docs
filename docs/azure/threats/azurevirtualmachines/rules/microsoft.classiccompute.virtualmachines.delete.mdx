--- 
slug: Microsoft.ClassicCompute.virtualMachines.delete
eventname: Microsoft.ClassicCompute.virtualMachines.delete
title: Microsoft.ClassicCompute.virtualMachines.delete
sidebar_label: Microsoft.ClassicCompute.virtualMachines.delete
---
                       
### Event Information

#### Meaning

1. The Microsoft.ClassicCompute.virtualMachines.delete event in Azure signifies the deletion of a virtual machine (VM) in the Classic deployment model.

2. This event indicates that a VM in the Classic deployment model has been permanently removed from the Azure environment.

3. It is important to note that this event is specific to the Classic deployment model and does not apply to VMs created using the Azure Resource Manager (ARM) deployment model.

### Remediation

#### Using Console

- Example: If security is impacted with Microsoft.ClassicCompute.virtualMachines.delete in Azure for Azure Virtual Machines, it means that an unauthorized user or process has the ability to delete virtual machines in the Azure Classic deployment model. This can lead to data loss, service disruption, and potential security breaches.

- Remediation Steps using Azure Console:
  1. Access the Azure portal and navigate to the Azure Virtual Machines section.
  2. Identify the affected virtual machine(s) that need to be protected from unauthorized deletion.
  3. Select the virtual machine(s) and click on the "Access control (IAM)" tab.
  4. Click on the "+ Add" button to add a new role assignment.
  5. In the "Add role assignment" window, select the appropriate role (e.g., "Contributor" or "Virtual Machine Contributor") that grants the necessary permissions for managing virtual machines without the ability to delete them.
  6. Specify the user, group, or service principal that should be assigned the role.
  7. Click on the "Save" button to apply the role assignment.
  8. Repeat these steps for all the virtual machines that need to be protected.

Note: It is important to regularly review and update the role assignments to ensure that only authorized users have the necessary permissions and to mitigate any potential security risks.

#### Using CLI

- Example: If security is impacted with `Microsoft.ClassicCompute.virtualMachines.delete` in Azure for `AzureVirtualMachines`, it means that the ability to delete classic virtual machines is not properly restricted, potentially allowing unauthorized users to delete virtual machines and causing data loss or service disruption.

- Remediation steps using AZU CLI:
  1. Identify the affected virtual machine: `az vm list --resource-group <resource-group-name> --query "[?type=='Microsoft.ClassicCompute/virtualMachines']"`
  2. Restrict the delete permission for the affected virtual machine: `az role assignment create --role "Contributor" --assignee <principal-id> --scope <virtual-machine-id> --resource-group <resource-group-name>`
  3. Verify the changes: `az role assignment list --assignee <principal-id> --scope <virtual-machine-id> --resource-group <resource-group-name>`

Note: Replace `<resource-group-name>` with the actual name of the resource group, `<principal-id>` with the ID of the user or group to restrict delete permission, and `<virtual-machine-id>` with the ID of the affected virtual machine.

#### Using Python

1. Example of security impact: If the Microsoft.ClassicCompute.virtualMachines.delete permission is misconfigured or granted to unauthorized users in Azure, it can lead to potential security risks. An attacker with this permission could delete virtual machines (VMs) in the Azure environment, resulting in data loss, service disruption, or unauthorized access to sensitive information.

2. Remediation for AzureVirtualMachines using Python: To remediate this security issue, you can use the Azure SDK for Python to manage access control for Azure resources. Here's an example of how you can revoke the Microsoft.ClassicCompute.virtualMachines.delete permission for a specific user or group:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.authorization import AuthorizationManagementClient

# Authenticate using default credentials
credential = DefaultAzureCredential()

# Specify your Azure subscription ID
subscription_id = 'your_subscription_id'

# Specify the resource group and VM name
resource_group_name = 'your_resource_group_name'
vm_name = 'your_vm_name'

# Create the authorization management client
authorization_client = AuthorizationManagementClient(credential, subscription_id)

# Revoke the Microsoft.ClassicCompute.virtualMachines.delete permission for a user or group
result = authorization_client.role_assignments.list_for_resource(
    resource_group_name,
    'Microsoft.ClassicCompute/virtualMachines',
    filter="principalId eq 'your_principal_id'"
)

for assignment in result:
    if assignment.role_definition_id.endswith('/providers/Microsoft.Authorization/roleDefinitions/your_role_definition_id'):
        authorization_client.role_assignments.delete(
            resource_group_name,
            assignment.name
        )
```

Note: Replace the placeholders (`your_subscription_id`, `your_resource_group_name`, `your_vm_name`, `your_principal_id`, `your_role_definition_id`) with the actual values specific to your Azure environment.

3. Additional considerations:
- Regularly review and audit the access control configurations for Azure resources to ensure that only authorized users have the necessary permissions.
- Implement the principle of least privilege by granting only the required permissions to users or groups.
- Monitor and log any changes to access control configurations to detect and respond to any unauthorized modifications.


 