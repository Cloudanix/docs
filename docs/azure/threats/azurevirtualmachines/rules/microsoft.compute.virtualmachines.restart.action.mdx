--- 
slug: Microsoft.Compute.virtualMachines.restart.action
eventname: Microsoft.Compute.virtualMachines.restart.action
title: Microsoft.Compute.virtualMachines.restart.action
sidebar_label: Microsoft.Compute.virtualMachines.restart.action
---
                       
### Event Information

#### Meaning

- The Microsoft.Compute.virtualMachines.restart.action event in AzureRealTime for AzureVirtualMachines indicates that a restart action has been triggered on a virtual machine in Azure.
- This event is typically generated when an administrator or an automated process initiates a restart of the virtual machine.
- The event provides real-time information about the restart action, allowing administrators to monitor and track the status of virtual machine restarts in Azure.

#### Example

1. Example of security impact: If an unauthorized user gains access to the Azure portal or API and triggers the Microsoft.Compute.virtualMachines.restart.action event for Azure Virtual Machines, it can lead to potential security risks. This event allows the user to restart the virtual machine, which can disrupt the availability of the application or service running on the VM. Additionally, if the user has escalated privileges, they may be able to perform malicious activities during the restart process, such as injecting malware or stealing sensitive data.

Remediation:
- Implement strong access controls: Ensure that only authorized users have access to the Azure portal or API. Use Azure Active Directory (AAD) to manage user access and enforce multi-factor authentication (MFA) for added security.
- Enable auditing and monitoring: Enable Azure Monitor to track and log activities related to virtual machine restart events. Regularly review the logs and set up alerts for any suspicious or unauthorized activities.
- Implement network security measures: Utilize Azure Network Security Groups (NSGs) to restrict inbound and outbound traffic to the virtual machines. Apply appropriate firewall rules and network segmentation to minimize the attack surface.

Azure CLI command to enable auditing for virtual machines:
```
az monitor diagnostic-settings create --name <diagnostic-settings-name> --resource <resource-id-of-vm> --resource-type Microsoft.Compute/virtualMachines --logs '[{"category": "Administrative", "enabled": true}]'
```

2. Example of security impact: If a malicious insider or an attacker gains access to the Azure Resource Manager (ARM) API and triggers the Microsoft.Compute.virtualMachines.restart.action event for Azure Virtual Machines, they can potentially disrupt the availability of critical infrastructure or services. This can lead to downtime, loss of productivity, and potential financial losses for the organization.

Remediation:
- Implement strong access controls: Use Azure RBAC (Role-Based Access Control) to grant permissions to users and ensure that only authorized individuals have the ability to restart virtual machines. Regularly review and update access permissions to minimize the risk of unauthorized actions.
- Enable Azure Security Center: Azure Security Center provides advanced threat protection and security recommendations for Azure resources. Enable it to receive alerts and recommendations related to virtual machine security, including potential unauthorized restart events.
- Implement continuous monitoring: Utilize Azure Monitor and Azure Log Analytics to monitor virtual machine activities and detect any suspicious or unauthorized restart events. Set up alerts and automated responses to mitigate potential security incidents.

Azure CLI command to enable Azure Security Center:
```
az security pricing create --name <security-center-name> --tier Standard
```

3. Example of security impact: If a misconfigured or compromised automation script or tool triggers the Microsoft.Compute.virtualMachines.restart.action event for Azure Virtual Machines, it can lead to unintended consequences and security vulnerabilities. For example, if a script is designed to restart a specific set of virtual machines but contains a bug or incorrect configuration, it may inadvertently restart critical production machines, causing service disruptions and potential data loss.

Remediation:
- Test and validate automation scripts: Before deploying any automation scripts or tools that involve virtual machine restart actions, thoroughly test them in non-production environments. Validate the scripts against a predefined set of virtual machines to ensure they perform the intended actions without any unintended consequences.
- Implement version control and change management: Maintain a version control system for automation scripts and follow proper change management processes. This helps track and review any modifications made to the scripts, reducing the risk of introducing security vulnerabilities.
- Implement backup and disaster recovery: Regularly backup critical virtual machines and implement disaster recovery measures to minimize the impact of potential restart events. This ensures that even if a restart occurs, the data and services can be quickly restored.

Azure CLI command to create a backup for a virtual machine:
```
az backup protection enable-for-vm --resource-group <resource-group-name> --vault-name <backup-vault-name> --vm <vm-name> --policy-name <backup-policy-name>
```


 