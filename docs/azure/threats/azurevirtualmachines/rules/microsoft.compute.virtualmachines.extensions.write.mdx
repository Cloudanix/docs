--- 
slug: Microsoft.Compute.virtualMachines.extensions.write
eventname: Microsoft.Compute.virtualMachines.extensions.write
title: Microsoft.Compute.virtualMachines.extensions.write
sidebar_label: Microsoft.Compute.virtualMachines.extensions.write
---
                       
### Event Information

#### Meaning

1. The Microsoft.Compute.virtualMachines.extensions.write event in AzureRealTime for AzureVirtualMachines refers to the event of writing or updating extensions for virtual machines in Azure.

2. This event indicates that a change has been made to the extensions associated with a virtual machine, such as installing, updating, or removing an extension.

3. It is important to monitor this event as it can provide insights into the configuration changes made to virtual machines, allowing for better tracking and management of extensions in Azure.

#### Example

1. Example of security impact: If an unauthorized user gains access to the Microsoft.Compute.virtualMachines.extensions.write event in Azure, they can potentially install malicious extensions on Azure Virtual Machines. These extensions can be used to gain unauthorized access, exfiltrate data, or perform other malicious activities within the compromised virtual machines.

Remediation:
- Regularly review and monitor the Azure Activity Log and Azure Monitor for any suspicious activities related to the Microsoft.Compute.virtualMachines.extensions.write event.
- Implement RBAC (Role-Based Access Control) to ensure that only authorized users have permissions to modify virtual machine extensions.
- Enable Azure Security Center and configure it to provide recommendations and alerts for virtual machine extension-related security issues.
- Regularly update and patch virtual machines to mitigate any known vulnerabilities that could be exploited through malicious extensions.

Azure CLI command to list virtual machine extensions:
```
az vm extension list --resource-group <resource-group-name> --vm-name <virtual-machine-name> --query "[].{Name:name, Publisher:publisher, Type:type, ProvisioningState:provisioningState}"
```

2. Example of security impact: If an attacker gains access to the Microsoft.Compute.virtualMachines.extensions.write event, they can modify or tamper with existing extensions on Azure Virtual Machines. This can lead to unauthorized access, data breaches, or disruption of services running on the compromised virtual machines.

Remediation:
- Implement Azure Security Center's just-in-time (JIT) access control to restrict the installation or modification of virtual machine extensions to specific time windows.
- Regularly review and audit the installed extensions on virtual machines to identify any unauthorized or suspicious extensions.
- Enable Azure Monitor alerts to notify administrators of any modifications or changes made to virtual machine extensions.
- Implement network security groups (NSGs) to restrict inbound and outbound traffic to virtual machines, reducing the attack surface for potential extension-related security threats.

Azure CLI command to enable JIT access control:
```
az vmss update -g <resource-group-name> -n <virtual-machine-scale-set-name> --set virtualMachineProfile.extensionProfile.extensions[0].settings.protectedSettings.JitEnabled=true
```

3. Example of security impact: If an attacker gains access to the Microsoft.Compute.virtualMachines.extensions.write event, they can deploy malicious extensions that can escalate privileges, compromise the integrity of the virtual machine, or exfiltrate sensitive data.

Remediation:
- Implement Azure Policy to enforce restrictions on the installation of virtual machine extensions, ensuring that only approved extensions are allowed.
- Regularly review and update the list of approved extensions, removing any deprecated or vulnerable extensions.
- Enable Azure Security Center's threat protection capabilities to detect and block any attempts to install unauthorized or malicious extensions.
- Implement Azure Key Vault to securely store and manage sensitive information, such as access keys or connection strings, reducing the risk of exposure through compromised extensions.

Azure CLI command to enforce Azure Policy for virtual machine extensions:
```
az policy assignment create --name <policy-assignment-name> --scope <resource-group-scope> --policy "Microsoft.Compute.VirtualMachineExtensionsApproved"
```


 