--- 
slug: Microsoft.Compute.sshPublicKeys.read
eventname: Microsoft.Compute.sshPublicKeys.read
title: Microsoft.Compute.sshPublicKeys.read
sidebar_label: Microsoft.Compute.sshPublicKeys.read
---
                       
### Event Information

#### Meaning

- The Microsoft.Compute.sshPublicKeys.read event in Azure for AzureVirtualMachines refers to the event of reading the SSH public keys associated with a virtual machine in Azure.
- This event is triggered when someone or a process retrieves the SSH public keys for a specific virtual machine.
- It is useful for monitoring and auditing purposes, as it allows tracking who accessed the SSH public keys and when.

### Remediation

#### Using Console

- The security impact of Microsoft.Compute.sshPublicKeys.read in Azure for Azure Virtual Machines is that it allows unauthorized users to read the SSH public keys associated with the virtual machines. This can potentially lead to unauthorized access to the virtual machines and compromise the security of the environment.

To remediate this issue for Azure Virtual Machines using the Azure console, you can follow these step-by-step instructions:

1. Sign in to the Azure portal (https://portal.azure.com) using your Azure account credentials.
2. Navigate to the Azure Virtual Machines service by clicking on "Virtual machines" in the left-hand menu.
3. Select the virtual machine for which you want to remediate the security issue.
4. In the virtual machine's overview page, click on "Access control (IAM)" in the left-hand menu.
5. In the "Access control (IAM)" page, click on the "Add" button to add a new role assignment.
6. In the "Add role assignment" page, select the appropriate role that restricts the read access to SSH public keys. For example, you can select the "Virtual Machine Contributor" role, which allows managing virtual machines but does not grant access to SSH public keys.
7. In the "Add role assignment" page, specify the user or group that should be assigned the role. You can search for the user or group by name or email address.
8. Click on the "Save" button to save the role assignment.

By following these steps, you can remediate the security impact of Microsoft.Compute.sshPublicKeys.read in Azure for Azure Virtual Machines by restricting the read access to SSH public keys to authorized users only.

#### Using CLI

- The security impact of Microsoft.Compute.sshPublicKeys.read in Azure for Azure Virtual Machines is that it allows unauthorized users to read the SSH public keys associated with the virtual machines. This can potentially lead to unauthorized access to the virtual machines and compromise the security of the environment.

To remediate this issue for Azure Virtual Machines using Azure CLI, you can follow these steps:

1. Identify the affected virtual machines: 
   - Run the following command to list all the virtual machines in your Azure subscription:
     ```
     az vm list --query "[].{Name:name, ResourceGroup:resourceGroup}"
     ```
   - Identify the virtual machines that have the Microsoft.Compute.sshPublicKeys.read permission enabled.

2. Remove the Microsoft.Compute.sshPublicKeys.read permission:
   - Run the following command to remove the permission for a specific virtual machine:
     ```
     az role assignment delete --assignee <principal-id> --scope <virtual-machine-id> --role "Microsoft.Compute.sshPublicKeys.read"
     ```
     Replace `<principal-id>` with the ID of the user or group that has the permission, and `<virtual-machine-id>` with the ID of the virtual machine.

3. Verify the removal of the permission:
   - Run the following command to verify that the Microsoft.Compute.sshPublicKeys.read permission has been removed:
     ```
     az role assignment list --scope <virtual-machine-id> --query "[?roleDefinitionName=='Microsoft.Compute.sshPublicKeys.read']"
     ```
     Replace `<virtual-machine-id>` with the ID of the virtual machine.

Note: Make sure you have the necessary permissions to perform these actions in your Azure subscription.

#### Using Python

1. Example of security impact: If the Microsoft.Compute.sshPublicKeys.read permission is granted to unauthorized users or roles in Azure for Azure Virtual Machines, it can potentially allow them to read the SSH public keys associated with the virtual machines. This can lead to unauthorized access to the virtual machines and compromise their security.

2. Remediation for Azure Virtual Machines using Python:
To remediate this security issue for Azure Virtual Machines using Python, you can use the Azure SDK for Python (azure-mgmt-compute) to manage the access control (IAM) of the virtual machines. Here's an example Python script that revokes the Microsoft.Compute.sshPublicKeys.read permission from a specific user or role:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.compute import ComputeManagementClient

# Set your Azure subscription ID and resource group name
subscription_id = 'your_subscription_id'
resource_group_name = 'your_resource_group_name'

# Set the Azure credentials
credentials = DefaultAzureCredential()

# Create the ComputeManagementClient
compute_client = ComputeManagementClient(credentials, subscription_id)

# Set the virtual machine name and the user or role object ID
vm_name = 'your_virtual_machine_name'
user_or_role_object_id = 'user_or_role_object_id_to_revoke_permission'

# Revoke the Microsoft.Compute.sshPublicKeys.read permission
compute_client.virtual_machines.operations.begin_revoke_access(
    resource_group_name,
    vm_name,
    user_or_role_object_id,
    'Microsoft.Compute',
    'sshPublicKeys',
    'read'
).wait()
```

Make sure to replace `'your_subscription_id'`, `'your_resource_group_name'`, `'your_virtual_machine_name'`, and `'user_or_role_object_id_to_revoke_permission'` with the appropriate values for your environment.

3. Additional considerations:
- It's important to regularly review and audit the access control (IAM) settings for Azure Virtual Machines to ensure that only authorized users or roles have the necessary permissions.
- Implementing just-in-time (JIT) access control for SSH connections to Azure Virtual Machines can further enhance security by limiting the exposure of SSH ports to a specific time window and authorized IP addresses.


 