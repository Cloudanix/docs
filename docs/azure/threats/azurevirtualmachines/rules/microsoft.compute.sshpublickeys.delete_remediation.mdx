
### Event Information

#### Meaning

- The Microsoft.Compute.sshPublicKeys.delete event in AzureRealTime for AzureVirtualMachines indicates that a SSH public key has been deleted for a virtual machine in Azure.
- This event signifies that the SSH access to the virtual machine has been modified, specifically in terms of removing a public key from the authorized keys list.
- It is important to monitor this event as it can help track any changes made to the SSH access configuration of the virtual machine, ensuring the security and access control of the system.

#### Example

1. Impact on Security: The Microsoft.Compute.sshPublicKeys.delete event in AzureRealTime for AzureVirtualMachines can potentially impact security if an unauthorized user gains access to delete SSH public keys associated with a virtual machine. This could allow the attacker to gain unauthorized access to the virtual machine.

2. Example: An example scenario where security can be impacted is if an attacker gains access to the Azure portal or Azure CLI with sufficient permissions to delete SSH public keys. They could then delete the SSH public keys associated with a virtual machine, effectively removing the authorized access for legitimate users.

3. Remediation: To mitigate the security impact of this event, it is recommended to follow these steps:
   - Regularly monitor and review the Azure activity logs and Azure Security Center alerts for any suspicious activities related to SSH public keys.
   - Implement strong access controls and permissions for Azure portal and Azure CLI, ensuring that only authorized users have the necessary permissions to delete SSH public keys.
   - Enable Azure Multi-Factor Authentication (MFA) for all user accounts with administrative privileges to add an extra layer of security.
   - Regularly backup and restore SSH public keys to ensure that they can be easily restored in case of accidental deletion or unauthorized access.
   - Consider implementing Azure Key Vault to securely store and manage SSH keys, reducing the risk of unauthorized deletion or access.

Example CLI command to list SSH public keys for a virtual machine:
```
az vm list-ssh-keys --resource-group <resource-group-name> --name <virtual-machine-name>
```

Example CLI command to delete an SSH public key for a virtual machine:
```
az vm delete-ssh-key --resource-group <resource-group-name> --name <virtual-machine-name> --key-data "<ssh-public-key>"
```

