--- 
slug: Microsoft.Storage.storageAccounts.managementPolicies.write
eventname: Microsoft.Storage.storageAccounts.managementPolicies.write
title: Microsoft.Storage.storageAccounts.managementPolicies.write
sidebar_label: Microsoft.Storage.storageAccounts.managementPolicies.write
---
                       
### Event Information

1. The Microsoft.Storage.storageAccounts.managementPolicies.write event in Azure for Azure Storage refers to a write operation performed on the management policies of a storage account.
2. This event indicates that a change or update has been made to the management policies of an Azure Storage account.
3. It is important to monitor this event as it can help track any modifications made to the management policies, such as changes in retention periods, tiering settings, or blob lifecycle rules, ensuring compliance and maintaining data governance.


### Examples

1. Unauthorized modification of storage account management policies: If security is impacted with Microsoft.Storage.storageAccounts.managementPolicies.write in Azure for Azure Storage, it could potentially allow unauthorized users to modify the management policies of the storage account. This could lead to unintended changes in data retention, access controls, or other security configurations, potentially exposing sensitive data or compromising the integrity of the storage account.

2. Data leakage or exposure: Unauthorized modification of management policies could result in the exposure or leakage of sensitive data stored in Azure Storage. For example, an attacker could modify the management policies to disable encryption or change access controls, allowing them to access or exfiltrate data without proper authorization.

3. Compliance violations: If security is impacted with Microsoft.Storage.storageAccounts.managementPolicies.write, it could lead to compliance violations with industry regulations or organizational policies. For instance, if a storage account is subject to specific data retention requirements, unauthorized modification of management policies could result in non-compliance and potential legal or regulatory consequences. It is crucial to ensure that only authorized individuals have the necessary permissions to modify management policies to maintain compliance and data security.

### Remediation

#### Using Console

To remediate unauthorized modification of storage account management policies in Azure for Azure Storage, you can follow these steps using the Azure console:

1. Review and update access control: 
   - Identify the users or roles that have the Microsoft.Storage.storageAccounts.managementPolicies.write permission.
   - Remove this permission from any unauthorized users or roles.
   - Ensure that only trusted and authorized individuals have the necessary permissions to modify management policies.

2. Enable auditing and monitoring:
   - Enable auditing for Azure Storage accounts to track any changes made to management policies.
   - Set up alerts or notifications to be notified of any unauthorized modifications.
   - Regularly review audit logs and investigate any suspicious activities.

3. Implement least privilege principle:
   - Follow the principle of least privilege when assigning permissions to users or roles.
   - Only grant the necessary permissions required for their specific tasks.
   - Regularly review and update permissions to ensure they align with the current requirements.

By following these steps, you can mitigate the risk of unauthorized modification of storage account management policies, prevent data leakage or exposure, and maintain compliance with industry regulations and organizational policies.

#### Using CLI

To remediate unauthorized modification of storage account management policies in Azure for Azure Storage, you can follow these steps using Azure CLI:

1. Identify the affected storage account: 
   - Run the command `az storage account list` to list all the storage accounts in your Azure subscription.
   - Identify the storage account that has been impacted by unauthorized modifications.

2. Revert the unauthorized changes:
   - Use the command `az storage account update` to update the management policies of the affected storage account.
   - Specify the desired management policies using the appropriate parameters, ensuring that they align with your security requirements and compliance standards.
   - For example, you can enable encryption, configure access controls, and set data retention policies.

3. Review and strengthen access controls:
   - Evaluate the access controls and permissions assigned to the storage account.
   - Use the command `az role assignment list --scope <storage-account-id>` to list the role assignments for the storage account.
   - Remove any unauthorized or unnecessary role assignments and ensure that only authorized individuals have the necessary permissions to modify management policies.

Remember to regularly monitor and audit your storage accounts to detect any unauthorized modifications and take immediate action to remediate them.

#### Using Python

To remediate unauthorized modification of storage account management policies in Azure for Azure Storage, you can follow these steps using Python:

1. Identify and restrict access: Review the existing access control settings for the storage account and ensure that only authorized individuals or roles have the necessary permissions to modify management policies. You can use the Azure SDK for Python to programmatically manage access control settings. Here's an example script:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.storage import StorageManagementClient

# Authenticate using default credentials
credential = DefaultAzureCredential()

# Specify your Azure subscription ID and resource group name
subscription_id = '<your-subscription-id>'
resource_group_name = '<your-resource-group-name>'

# Specify the name of the storage account
storage_account_name = '<your-storage-account-name>'

# Create the StorageManagementClient
storage_client = StorageManagementClient(credential, subscription_id)

# Get the existing access control settings for the storage account
access_control = storage_client.storage_accounts.get_properties(
    resource_group_name, storage_account_name).identity

# Restrict access to only authorized individuals or roles
# Modify the access_control object as per your requirements

# Update the access control settings for the storage account
storage_client.storage_accounts.update(
    resource_group_name, storage_account_name, {'identity': access_control})
```

2. Enable auditing and monitoring: Enable auditing and monitoring features provided by Azure Storage to track any changes made to the management policies. This will help in detecting unauthorized modifications and taking appropriate actions. You can use the Azure Monitor service to set up alerts or notifications for any suspicious activities. Here's an example script to enable auditing:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.storage import StorageManagementClient

# Authenticate using default credentials
credential = DefaultAzureCredential()

# Specify your Azure subscription ID and resource group name
subscription_id = '<your-subscription-id>'
resource_group_name = '<your-resource-group-name>'

# Specify the name of the storage account
storage_account_name = '<your-storage-account-name>'

# Create the StorageManagementClient
storage_client = StorageManagementClient(credential, subscription_id)

# Enable auditing for the storage account
storage_client.storage_accounts.update(
    resource_group_name, storage_account_name, {'is_azure_monitor_enabled': True})
```

3. Regularly review and monitor: Continuously review and monitor the access control settings and audit logs for any unauthorized modifications. Implement a regular review process to ensure that the access control settings are up to date and aligned with the organization's security policies. Regularly monitor the audit logs to identify any suspicious activities and take appropriate actions.


 