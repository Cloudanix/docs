--- 
slug: Microsoft.Storage.storageAccounts.blobServices.write
eventname: Microsoft.Storage.storageAccounts.blobServices.write
title: Microsoft.Storage.storageAccounts.blobServices.write
sidebar_label: Microsoft.Storage.storageAccounts.blobServices.write
---
                       
### Event Information

#### Meaning

1. The Microsoft.Storage.storageAccounts.blobServices.write event in AzureRealTime for AzureStorage indicates that a write operation has been performed on a blob service within a storage account in Azure.

2. This event signifies that data has been written or uploaded to a blob container within the storage account, either through a direct API call or through a client application.

3. Monitoring and analyzing this event can help track the usage and activity of blob storage, identify potential performance issues, and ensure data integrity and compliance with relevant policies and regulations.

#### Example

1. Example of security impact: If an unauthorized user gains write access to the blob services in Azure Storage, they can potentially upload malicious files or overwrite existing files with malicious content. This can lead to data breaches, unauthorized access to sensitive information, or the introduction of malware into the system.

Remediation:
- Enable Azure Storage firewall and virtual network service endpoints to restrict access to trusted networks only.
- Implement role-based access control (RBAC) to ensure that only authorized users have write access to the blob services.
- Regularly monitor and review access logs and audit logs to detect any unauthorized write operations. Use Azure Monitor or Azure Security Center for this purpose.

Example CLI command to enable firewall and virtual network service endpoints:
```
az storage account network-rule add --resource-group <resource-group-name> --account-name <storage-account-name> --subnet <subnet-id>
```

Example CLI command to assign RBAC role to a user:
```
az role assignment create --assignee <user-principal-name> --role <role-name> --scope /subscriptions/<subscription-id>/resourceGroups/<resource-group-name>/providers/Microsoft.Storage/storageAccounts/<storage-account-name>
```

2. Example of security impact: If the Microsoft.Storage.storageAccounts.blobServices.write event is triggered by a compromised or malicious application, it can result in unauthorized write operations to the Azure Storage blob services. This can lead to data corruption, loss of data integrity, or the introduction of malicious content into the system.

Remediation:
- Regularly review and update the access control policies for the storage account to ensure that only trusted applications have write access.
- Implement Azure AD authentication for applications accessing the storage account, and enforce multi-factor authentication (MFA) for added security.
- Monitor and analyze the logs and metrics of the storage account to detect any abnormal or suspicious write activities. Use Azure Monitor or Azure Security Center for this purpose.

Example CLI command to update access control policy:
```
az storage account update --name <storage-account-name> --resource-group <resource-group-name> --default-action Deny
```

Example CLI command to enable Azure AD authentication:
```
az storage account update --name <storage-account-name> --resource-group <resource-group-name> --enable-hierarchical-namespace true
```

3. Example of security impact: If the Microsoft.Storage.storageAccounts.blobServices.write event is triggered by a misconfigured access control policy, it can result in unintended write access to the Azure Storage blob services. This can lead to accidental data modifications, unauthorized data uploads, or exposure of sensitive information.

Remediation:
- Regularly review and audit the access control policies for the storage account to ensure that they are correctly configured.
- Implement least privilege access control by granting write access only to the necessary users or applications.
- Enable versioning for the storage account to protect against accidental data modifications or deletions.

Example CLI command to enable versioning:
```
az storage account blob-service-properties update --name <storage-account-name> --resource-group <resource-group-name> --enable-versioning true
```


 