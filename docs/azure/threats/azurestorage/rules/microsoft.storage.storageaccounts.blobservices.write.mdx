--- 
slug: Microsoft.Storage.storageAccounts.blobServices.write
eventname: Microsoft.Storage.storageAccounts.blobServices.write
title: Microsoft.Storage.storageAccounts.blobServices.write
sidebar_label: Microsoft.Storage.storageAccounts.blobServices.write
---
                       
### Event Information

#### Meaning

1. The Microsoft.Storage.storageAccounts.blobServices.write event in AzureStorage refers to a write operation performed on a blob service within an Azure storage account.

2. This event indicates that data is being written or uploaded to a blob container or a specific blob within the storage account.

3. It is important to monitor this event as it can help track and audit data modifications, ensuring data integrity and compliance with regulatory requirements.

### Remediation

#### Using Console

- Example: If security is impacted with Microsoft.Storage.storageAccounts.blobServices.write in Azure Storage, it means that a user or application has the ability to write data to the blob storage service in Azure. This could potentially lead to unauthorized access or modification of sensitive data stored in the Azure Storage account.

- Remediation Steps using Azure Console:
  1. Identify the affected Azure Storage account: Go to the Azure portal and navigate to the Azure Storage account that is impacted by the security issue.
  2. Access Control (IAM): Click on "Access Control (IAM)" in the left-hand menu of the Azure Storage account.
  3. Remove or modify the role assignment: Locate the role assignment that grants the Microsoft.Storage.storageAccounts.blobServices.write permission and either remove it or modify it to restrict the access to authorized users or applications.

Note: It is important to carefully review and consider the impact of removing or modifying the role assignment, as it may affect the functionality of applications or services relying on the write access to Azure Storage. It is recommended to involve the appropriate stakeholders and follow the organization's change management process while making any changes to the access control configuration.

#### Using CLI

1. Example of security impact: If the Microsoft.Storage.storageAccounts.blobServices.write permission is misconfigured in Azure Storage, it could allow unauthorized users to write data to the blob storage containers. This can lead to data breaches, unauthorized modifications, or data loss.

2. Remediation steps using Azure CLI:
   - Identify the affected storage account: `az storage account list`
   - Update the storage account's blob service access policy to restrict write access: 
     `az storage account update --name <storage_account_name> --resource-group <resource_group_name> --default-action Deny --bypass AzureServices --allow blobWrite`
   - Verify the changes: `az storage account show --name <storage_account_name> --resource-group <resource_group_name> --query "networkRuleSet.defaultAction"`

3. Additional considerations:
   - Regularly review and audit the access policies for Azure Storage accounts to ensure they align with the principle of least privilege.
   - Implement Azure Monitor or Azure Security Center to detect and alert on any unauthorized write operations to the blob storage containers.

#### Using Python

1. Example of security impact: If the Microsoft.Storage.storageAccounts.blobServices.write permission is misconfigured or granted to unauthorized users, it can lead to potential data breaches or unauthorized modifications to Azure Storage blobs. This can result in the loss or compromise of sensitive data stored in Azure Storage.

2. Remediation steps for Azure Storage using Python:
   - Identify and review the existing access control configuration for the Azure Storage account using the Azure SDK for Python. You can use the `azure-storage-blob` library to interact with Azure Storage.
   - Use the `BlobServiceClient` class from the `azure.storage.blob` module to connect to the Azure Storage account.
   - Retrieve the existing access control policies for the blob service using the `get_blob_service_properties()` method.
   - Validate the permissions assigned to the `blobServices` resource and ensure that only authorized users or roles have the necessary write access.
   - If any misconfigurations or unauthorized permissions are found, use the `set_blob_service_properties()` method to update the access control policies and remove or modify the undesired permissions.

Example Python script:
```python
from azure.storage.blob import BlobServiceClient

# Connect to the Azure Storage account
connection_string = "<your_connection_string>"
blob_service_client = BlobServiceClient.from_connection_string(connection_string)

# Retrieve the existing access control policies
blob_service_properties = blob_service_client.get_service_properties()

# Validate and modify the permissions as required
# Example: Remove write access for unauthorized users
blob_service_properties['cors'] = []
blob_service_properties['delete_retention_policy'] = {'enabled': False}

# Update the access control policies
blob_service_client.set_service_properties(blob_service_properties)
```

Please note that the above script is just an example and you should customize it based on your specific requirements and access control policies.


 