--- 
slug: Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.write
eventname: Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.write
title: Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.write
sidebar_label: Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.write
---
                       
### Event Information

1. The Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.write event in Azure for Azure Storage refers to an event that is triggered when a write operation is performed on an immutability policy for a container in Azure Storage.

2. This event indicates that a change has been made to the immutability policy of a specific container, which is a feature in Azure Storage that prevents the modification or deletion of data for a specified period of time.

3. By monitoring this event, you can track any modifications made to the immutability policies of containers in Azure Storage, helping to ensure data integrity and compliance with regulatory requirements.


### Examples

1. Unauthorized write access: If security is impacted with the "Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.write" permission in Azure for Azure Storage, it could potentially allow unauthorized users or applications to write data to immutable containers. This can lead to data integrity issues and compromise the security of the storage account.

2. Data tampering: With the "Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.write" permission, malicious actors could modify or tamper with the data stored in immutable containers. This can result in the loss of data integrity and trustworthiness, making it difficult to ensure the accuracy and reliability of the stored information.

3. Compliance violations: Azure Storage's immutability policies are often used to enforce data retention and compliance requirements. If security is impacted with the "Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.write" permission, it can potentially allow unauthorized modifications or deletions of immutable data, leading to compliance violations and potential legal consequences. It is crucial to ensure that only authorized entities have the necessary permissions to write to immutable containers to maintain data integrity and compliance.

### Remediation

#### Using Console

To remediate unauthorized write access, data tampering, and compliance violations related to the "Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.write" permission in Azure for Azure Storage, you can follow these step-by-step instructions:

1. Identify the affected storage account: 
   - Log in to the Azure portal (https://portal.azure.com).
   - Navigate to the Azure Storage accounts section.
   - Identify the storage account that has the "Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.write" permission enabled.

2. Remove the unauthorized write access permission:
   - Select the identified storage account.
   - Go to the "Access control (IAM)" section.
   - Locate the role assignment that grants the "Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.write" permission.
   - Remove the role assignment for any unauthorized users or applications.

3. Implement access control and monitoring measures:
   - Review and update the access control policies for the storage account.
   - Ensure that only authorized users and applications have the necessary permissions.
   - Regularly monitor access logs and audit trails to detect any unauthorized write attempts or data tampering.
   - Consider enabling Azure Monitor and Azure Security Center to gain insights into potential security threats and vulnerabilities.

By following these steps, you can remediate unauthorized write access, prevent data tampering, and ensure compliance with data retention and governance requirements in Azure Storage.

#### Using CLI

1. To remediate unauthorized write access in Azure Storage using Azure CLI, you can follow these steps:

- Identify the affected storage account: `az storage account list`
- Disable the write permission for immutability policies: `az storage account update --name <storage_account_name> --resource-group <resource_group_name> --set properties.supportsImmutabilityPolicy=false`

2. To remediate data tampering in Azure Storage using Azure CLI, you can take the following actions:

- Identify the affected storage account: `az storage account list`
- Enable the write permission for immutability policies: `az storage account update --name <storage_account_name> --resource-group <resource_group_name> --set properties.supportsImmutabilityPolicy=true`

3. To remediate compliance violations in Azure Storage using Azure CLI, you can perform the following steps:

- Identify the affected storage account: `az storage account list`
- Review and update the immutability policies to ensure they align with compliance requirements: `az storage container immutability-policy update --account-name <storage_account_name> --container-name <container_name> --resource-group <resource_group_name> --policy <policy_json_file>`

Note: Replace `<storage_account_name>`, `<resource_group_name>`, `<container_name>`, and `<policy_json_file>` with the appropriate values for your environment.

#### Using Python

To remediate unauthorized write access, data tampering, and compliance violations in Azure Storage using Python, you can utilize the Azure SDK for Python. Here are some steps you can follow:

1. Unauthorized write access:
   - Use the Azure Identity library to authenticate and obtain a token for the Azure Storage account.
   - Use the Azure Storage Blob library to list the containers in the storage account.
   - Check the access control list (ACL) of each container to ensure that the "Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.write" permission is only granted to authorized users or applications.
   - If unauthorized access is detected, revoke the permission or update the ACL accordingly.

2. Data tampering:
   - Use the Azure Identity library to authenticate and obtain a token for the Azure Storage account.
   - Use the Azure Storage Blob library to retrieve the blobs from the immutable containers.
   - Implement data integrity checks, such as checksum validation, to detect any modifications or tampering with the data.
   - If data tampering is detected, take appropriate actions, such as restoring the original data from backups or triggering an alert for further investigation.

3. Compliance violations:
   - Use the Azure Identity library to authenticate and obtain a token for the Azure Storage account.
   - Use the Azure Storage Blob library to retrieve the blobs from the immutable containers.
   - Implement compliance checks to ensure that the data stored in the immutable containers complies with the required retention and governance policies.
   - If any violations are detected, take necessary actions, such as notifying the compliance team, generating compliance reports, or initiating corrective measures.

Please note that the provided steps are high-level and may require customization based on your specific requirements and environment. The Azure SDK for Python documentation provides detailed examples and code snippets to help you implement these actions effectively.


 