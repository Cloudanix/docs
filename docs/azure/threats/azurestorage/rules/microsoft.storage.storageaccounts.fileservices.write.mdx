--- 
slug: Microsoft.Storage.storageAccounts.fileServices.write
eventname: Microsoft.Storage.storageAccounts.fileServices.write
title: Microsoft.Storage.storageAccounts.fileServices.write
sidebar_label: Microsoft.Storage.storageAccounts.fileServices.write
---
                       
### Event Information

#### Meaning

1. The Microsoft.Storage.storageAccounts.fileServices.write event in AzureRealTime for AzureStorage refers to a write operation performed on a file service within a storage account in Azure.

2. This event indicates that a file has been created or modified within the file service of the specified storage account.

3. It is important to monitor this event as it can help track changes and activities related to file services, allowing for better visibility and control over data stored in AzureStorage.

#### Example

1. Example of security impact: If an unauthorized user gains write access to the file services in an Azure Storage account, they can potentially modify or delete critical files, leading to data loss or unauthorized access to sensitive information.

Remediation:
- Enable Azure Storage account firewall and virtual network service endpoints to restrict access to trusted networks only.
- Implement role-based access control (RBAC) to ensure that only authorized users have write access to the file services.
- Regularly monitor and review access logs and audit logs to detect any unauthorized write operations and take appropriate actions.

Azure CLI commands for remediation:
```
# Enable firewall and virtual network service endpoints for the storage account
az storage account network-rule add --resource-group <resource-group-name> --account-name <storage-account-name> --subnet <subnet-id>

# Grant write access to a specific user or group using RBAC
az role assignment create --assignee <user-or-group-id> --role "Storage File Data SMB Share Contributor" --scope /subscriptions/<subscription-id>/resourceGroups/<resource-group-name>/providers/Microsoft.Storage/storageAccounts/<storage-account-name>

# Monitor access logs and audit logs for the storage account
az monitor diagnostic-settings create --name <diagnostic-settings-name> --resource <storage-account-id> --logs '[{"category": "StorageRead", "enabled": true}, {"category": "StorageWrite", "enabled": true}]'
```

2. Example of security impact: If the Microsoft.Storage.storageAccounts.fileServices.write event is triggered with excessive frequency or volume, it could indicate a potential denial-of-service (DoS) attack on the Azure Storage account. This can lead to service disruption and impact the availability of the storage resources.

Remediation:
- Implement rate limiting or throttling mechanisms to restrict the number of write operations that can be performed within a certain time frame.
- Utilize Azure Monitor or other monitoring tools to set up alerts for abnormal write activity and take proactive measures to mitigate the attack.
- Consider implementing Azure DDoS Protection Standard to provide additional protection against DoS attacks.

Azure CLI commands for remediation:
```
# Configure rate limits for the storage account
az storage account update --name <storage-account-name> --resource-group <resource-group-name> --default-action Deny --bypass None --min-tls-version TLS1_2 --allow-blob-public-access false --allow-shared-key-access true --allow-secure-transfer true --deny-https-only false --https-only false --https-only-enforced false --https-only-traffic-port 443 --network-acls default --routing-choice InternetRouting --routing-registry-name AzurePublicCloud --routing-storage-service-version 2019-06-01 --routing-storage-service-update-policy Default --routing-storage-service-allow-redirects false --routing-storage-service-allow-recursive-redirects false --routing-storage-service-allow-recursive-redirects-to-https false --routing-storage-service-allow-recursive-redirects-to-https-only false --routing-storage-service-allow-recursive-redirects-to-https-only-enforced false --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol Https --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced false --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol Https --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced false --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol Https --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced false --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol Https --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced false --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol Https --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced false --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol Https --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced false --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol Https --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced false --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol Https --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced false --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol Https --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol Https --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced false --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol Https --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol Https --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol Https --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol Https --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol Https --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-port 443 --routing-storage-service-allow-recursive-redirects-to-https-only-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced-traffic-protocol-enforced


 