--- 
slug: Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.delete
eventname: Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.delete
title: Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.delete
sidebar_label: Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.delete
---
                       
### Event Information

#### Meaning

1. The "Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.delete" event in AzureStorage refers to the deletion of an immutability policy associated with a container in Azure Blob Storage.

2. This event indicates that the immutability policy, which enforces data retention and prevents modification or deletion of data within the container for a specified period, has been removed.

3. The event can be useful for auditing and compliance purposes, as it provides visibility into any changes made to the immutability policies of Azure Blob Storage containers, allowing organizations to track and monitor data retention and protection measures.

### Remediation

#### Using Console

- The immutabilityPolicies.delete event in Azure Storage indicates that a deletion operation has been performed on an immutable container, which can impact security.
- An example scenario could be an unauthorized user gaining access to the Azure Storage account and deleting an immutable container, potentially compromising the integrity and immutability of the data stored within it.
- To remediate this issue for Azure Storage using the Azure console, follow these step-by-step instructions:
  1. Sign in to the Azure portal (https://portal.azure.com) using your Azure account credentials.
  2. Navigate to the Azure Storage account that has been impacted by the immutabilityPolicies.delete event.
  3. In the left-hand menu, under the "Settings" section, click on "Blob service".
  4. In the Blob service settings, select the "Containers" tab.
  5. Locate the container that was affected by the deletion and click on its name to open its settings.
  6. In the container settings, click on the "Access policy" tab.
  7. Review the existing access policies and ensure that only authorized users or applications have the necessary permissions to delete containers.
  8. If any unauthorized access policies are found, click on the "Add policy" button to create a new access policy.
  9. Configure the new access policy with the appropriate permissions, such as read and write access, while ensuring that delete permissions are only granted to trusted entities.
  10. Save the changes to the access policies and close the container settings.
  11. Regularly monitor the Azure Storage account for any further immutabilityPolicies.delete events and investigate any suspicious activities promptly.

Note: It is important to regularly review and update access policies, monitor activity logs, and implement additional security measures like Azure AD authentication, network security groups, and Azure Security Center to enhance the overall security of Azure Storage.

#### Using CLI

1. Impact on Security: The `Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.delete` action in Azure Storage allows the deletion of immutability policies for blob containers. If security is impacted, it means that an unauthorized user or malicious actor could potentially delete immutability policies, compromising the integrity and immutability of the data stored in the Azure Storage container.

2. Remediation Steps using Azure CLI: To remediate this security issue for Azure Storage using Azure CLI, you can follow these steps:

   a. Install Azure CLI: If you haven't already, install Azure CLI on your local machine or the environment where you want to execute the commands.

   b. Authenticate with Azure: Use the `az login` command to authenticate with your Azure account and select the appropriate subscription.

   c. Restrict Access: To mitigate the security impact, you can restrict the permissions for the `Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.delete` action. This can be achieved by modifying the role assignments or access control lists (ACLs) associated with the Azure Storage account or container. For example, you can remove the delete permission for unauthorized users or assign a more restricted role.

   d. Monitor and Audit: Implement monitoring and auditing mechanisms to track any changes or attempts to delete immutability policies. Azure provides various monitoring and logging services like Azure Monitor, Azure Log Analytics, and Azure Sentinel that can help you detect and respond to security incidents.

   e. Regularly Review and Update: Continuously review and update the access controls and permissions for your Azure Storage accounts and containers to ensure that only authorized users have the necessary privileges.

Please note that the exact CLI commands may vary depending on your specific Azure environment and requirements. It is recommended to refer to the official Azure CLI documentation for detailed command syntax and options.

#### Using Python

1. Impact on Security: The `Microsoft.Storage.storageAccounts.blobServices.containers.immutabilityPolicies.delete` action in Azure Storage allows the deletion of immutability policies for blob containers. If security is impacted, it means that an unauthorized user or process can delete the immutability policies, potentially compromising the integrity and immutability of the stored data.

2. Remediation for Azure Storage using Python: To remediate this security impact in Azure Storage using Python, you can implement the following steps:

   a. Authenticate to Azure: Use the Azure SDK for Python (azure-storage-blob) to authenticate to your Azure subscription. You can use either a service principal or a managed identity for authentication.

   b. Retrieve Blob Container Properties: Use the `get_container_properties` method to retrieve the properties of the target blob container. This will include information about the immutability policies associated with the container.

   c. Implement Access Controls: Ensure that appropriate access controls are in place to restrict the deletion of immutability policies. This can be achieved by assigning the necessary RBAC roles or using shared access signatures (SAS) with limited permissions.

   d. Monitor and Alert: Implement monitoring and alerting mechanisms to detect any unauthorized attempts to delete immutability policies. Azure Monitor and Azure Sentinel can be used to set up alerts based on specific events or anomalies.

   Example Python Script:
   ```python
   from azure.identity import DefaultAzureCredential
   from azure.storage.blob import BlobServiceClient

   # Authenticate to Azure using DefaultAzureCredential
   credential = DefaultAzureCredential()
   blob_service_client = BlobServiceClient(account_url="https://<storage-account-name>.blob.core.windows.net", credential=credential)

   # Retrieve container properties
   container_client = blob_service_client.get_container_client("<container-name>")
   container_properties = container_client.get_container_properties()

   # Implement access controls to restrict immutability policy deletion

   # Monitor and alert on unauthorized deletion attempts
   # ...
   ```
   Note: Replace `<storage-account-name>` and `<container-name>` with the actual names of your Azure Storage account and blob container, respectively.


 