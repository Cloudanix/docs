--- 
slug: Microsoft.Storage.storageAccounts.fileServices.fileshares.files.write
eventname: Microsoft.Storage.storageAccounts.fileServices.fileshares.files.write
title: Microsoft.Storage.storageAccounts.fileServices.fileshares.files.write
sidebar_label: Microsoft.Storage.storageAccounts.fileServices.fileshares.files.write
---
                       
### Event Information

#### Meaning

1. The "Microsoft.Storage.storageAccounts.fileServices.fileshares.files.write" event in AzureRealTime for AzureStorage refers to a write operation performed on a file within a file share in an Azure Storage account.

2. This event indicates that a file has been created or modified within a specific file share in Azure Storage.

3. It is important to monitor this event as it can provide insights into file-level activities and help track changes made to files stored in Azure Storage.

#### Example

1. Example of security impact: If an unauthorized user gains write access to a file in an Azure Storage file share, they can potentially modify or delete sensitive data stored in that file. This can lead to data breaches, unauthorized access, or data loss.

Remediation:
- Regularly review and update access control policies for Azure Storage file shares to ensure that only authorized users have write access.
- Implement Azure AD authentication for Azure Storage file shares to enforce user authentication and authorization.
- Enable Azure Storage logging and monitoring to detect any suspicious write activities and take appropriate actions.

Azure CLI command for implementing Azure AD authentication for a file share:
```
az storage share update --name <file_share_name> --account-name <storage_account_name> --auth-mode login
```

2. Example of security impact: If a malicious actor gains access to the Azure Storage account's access keys, they can use the keys to perform unauthorized write operations on files within the file share. This can lead to data tampering, data loss, or unauthorized access to sensitive information.

Remediation:
- Rotate the access keys regularly to minimize the risk of unauthorized access. 
- Implement Azure Key Vault to securely store and manage the access keys.
- Enable Azure Storage firewall and virtual network service endpoints to restrict access to the storage account.

Azure CLI command for rotating access keys:
```
az storage account keys renew --name <storage_account_name> --resource-group <resource_group_name>
```

3. Example of security impact: If the Azure Storage account's firewall rules are misconfigured, it can allow unauthorized write access to the file shares from IP addresses or networks that should be blocked. This can result in unauthorized modifications or deletions of files.

Remediation:
- Regularly review and update the firewall rules for the Azure Storage account to ensure that only trusted IP addresses or networks have write access.
- Implement Azure Network Security Groups (NSGs) to further restrict access to the storage account.
- Enable Azure Storage account auditing to monitor and detect any unauthorized write attempts.

Azure CLI command for configuring firewall rules:
```
az storage account network-rule add --account-name <storage_account_name> --resource-group <resource_group_name> --ip-address <trusted_ip_address>
```


 