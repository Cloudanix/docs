--- 
slug: Microsoft.Storage.storageAccounts.objectReplicationPolicies.delete
eventname: Microsoft.Storage.storageAccounts.objectReplicationPolicies.delete
title: Microsoft.Storage.storageAccounts.objectReplicationPolicies.delete
sidebar_label: Microsoft.Storage.storageAccounts.objectReplicationPolicies.delete
---
                       
### Event Information

1. The Microsoft.Storage.storageAccounts.objectReplicationPolicies.delete event in Azure for Azure Storage indicates that a replication policy has been deleted for a storage account.
2. This event signifies a change in the replication configuration of the storage account, where a previously defined replication policy has been removed.
3. It is important to monitor this event as it can impact the data redundancy and availability of the storage account, and may require further action to ensure data integrity and compliance with replication requirements.


### Examples

1. Unauthorized deletion: If security is impacted with Microsoft.Storage.storageAccounts.objectReplicationPolicies.delete in Azure for Azure Storage, one example could be an unauthorized user gaining access to the Azure Storage account and deleting the object replication policies. This could result in the loss of data redundancy and potentially compromise the availability and integrity of the stored data.

2. Data loss: Another example could be accidental or malicious deletion of object replication policies by an authorized user. This could lead to the deletion of replicated copies of data, resulting in data loss and potential non-compliance with data retention policies or regulatory requirements.

3. Unauthorized modification: A third example could be an attacker gaining access to the Azure Storage account and modifying the object replication policies instead of deleting them. This could result in unauthorized replication of data to unintended locations, potentially exposing sensitive data to unauthorized parties and violating data privacy regulations.

### Remediation

#### Using Console

To remediate unauthorized deletion, data loss, and unauthorized modification of object replication policies in Azure Storage using the Azure console, you can follow these steps:

1. Enable Azure Storage Account Soft Delete: Soft Delete is a feature in Azure Storage that allows you to recover deleted data within a specified retention period. By enabling Soft Delete, you can mitigate the risk of data loss caused by accidental or malicious deletion.

- Open the Azure portal and navigate to the Azure Storage account.
- Go to the "Configuration" section of the Storage account.
- Under the "Blob service" tab, enable the "Soft delete" feature.
- Set the retention period for deleted data according to your requirements.

2. Implement Access Control and RBAC: To prevent unauthorized access and modification of object replication policies, it is crucial to implement proper access control and Role-Based Access Control (RBAC) in Azure.

- Navigate to the Azure Storage account in the Azure portal.
- Go to the "Access control (IAM)" section.
- Assign appropriate RBAC roles to users and groups based on their responsibilities and access requirements.
- Regularly review and update access permissions to ensure they align with the principle of least privilege.

3. Enable Azure Storage Account Monitoring and Alerts: Monitoring and alerting can help you detect and respond to unauthorized activities or changes in object replication policies promptly.

- In the Azure portal, go to the Azure Storage account.
- Navigate to the "Monitoring" section.
- Enable diagnostic settings to capture relevant logs and metrics.
- Configure alerts based on specific events or conditions related to object replication policies.
- Set up notifications to receive alerts via email, SMS, or other preferred channels.

By following these steps, you can enhance the security and integrity of your Azure Storage account, mitigate the risk of unauthorized deletion, data loss, and unauthorized modification of object replication policies, and ensure compliance with data retention and privacy requirements.

#### Using CLI

1. Unauthorized deletion: To remediate unauthorized deletion of object replication policies in Azure Storage using Azure CLI, you can follow these steps:

- Identify the affected storage account: `az storage account list`
- Enable soft delete for the storage account: `az storage account update --name <storage_account_name> --resource-group <resource_group_name> --enable-soft-delete true`
- Configure RBAC permissions: Grant appropriate access control to prevent unauthorized users from accessing or modifying object replication policies.
- Enable auditing and monitoring: Set up Azure Monitor or Azure Security Center to monitor and alert on any unauthorized deletion attempts.

2. Data loss: To remediate accidental or malicious deletion of object replication policies in Azure Storage using Azure CLI, you can take the following actions:

- Enable soft delete for the storage account: `az storage account update --name <storage_account_name> --resource-group <resource_group_name> --enable-soft-delete true`
- Implement versioning for the storage account: `az storage account blob-service-properties update --name <storage_account_name> --resource-group <resource_group_name> --enable-versioning true`
- Regularly back up the object replication policies: Use Azure Blob Storage lifecycle management or Azure Backup to create regular backups of the object replication policies.

3. Unauthorized modification: To remediate unauthorized modification of object replication policies in Azure Storage using Azure CLI, you can consider the following steps:

- Enable soft delete for the storage account: `az storage account update --name <storage_account_name> --resource-group <resource_group_name> --enable-soft-delete true`
- Implement RBAC permissions: Restrict access to the storage account and object replication policies to authorized users only. Use Azure AD roles and RBAC to control access.
- Enable auditing and monitoring: Set up Azure Monitor or Azure Security Center to monitor and alert on any unauthorized modification attempts.

#### Using Python

To remediate unauthorized deletion, data loss, and unauthorized modification in Azure Storage using Python, you can utilize the Azure SDK for Python. Here are some example Python scripts to help you get started:

1. Unauthorized deletion:
To prevent unauthorized deletion of object replication policies, you can implement RBAC (Role-Based Access Control) and assign appropriate permissions to users. Here's an example script to revoke the delete permission for object replication policies:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.storage import StorageManagementClient

# Authenticate using DefaultAzureCredential
credential = DefaultAzureCredential()
storage_client = StorageManagementClient(credential, subscription_id)

# Get the storage account
storage_account = storage_client.storage_accounts.get(resource_group_name, account_name)

# Revoke delete permission for object replication policies
storage_account.object_replication_policies.delete = False

# Update the storage account
storage_client.storage_accounts.begin_create_or_update(resource_group_name, account_name, storage_account)
```

2. Data loss:
To prevent accidental or malicious deletion of object replication policies, you can enable soft delete for Azure Storage. Soft delete allows you to recover deleted data within a specified retention period. Here's an example script to enable soft delete for object replication policies:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.storage import StorageManagementClient

# Authenticate using DefaultAzureCredential
credential = DefaultAzureCredential()
storage_client = StorageManagementClient(credential, subscription_id)

# Get the storage account
storage_account = storage_client.storage_accounts.get(resource_group_name, account_name)

# Enable soft delete for object replication policies
storage_account.soft_delete.enabled = True

# Set the retention period for soft deleted data (in days)
storage_account.soft_delete.retention_days = 30

# Update the storage account
storage_client.storage_accounts.begin_create_or_update(resource_group_name, account_name, storage_account)
```

3. Unauthorized modification:
To prevent unauthorized modification of object replication policies, you can enable Azure Storage firewall and virtual network service endpoints. This restricts access to the storage account only from trusted networks. Here's an example script to enable firewall and virtual network service endpoints:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.storage import StorageManagementClient

# Authenticate using DefaultAzureCredential
credential = DefaultAzureCredential()
storage_client = StorageManagementClient(credential, subscription_id)

# Get the storage account
storage_account = storage_client.storage_accounts.get(resource_group_name, account_name)

# Enable firewall and virtual network service endpoints
storage_account.network_rule_set.default_action = "Deny"
storage_account.network_rule_set.bypass = "AzureServices"
storage_account.network_rule_set.ip_rules = []

# Add IP rules to allow access from trusted networks
storage_account.network_rule_set.ip_rules.append({
    "ip_address_or_range": "x.x.x.x",
    "action": "Allow"
})

# Update the storage account
storage_client.storage_accounts.begin_create_or_update(resource_group_name, account_name, storage_account)
```

Note: Replace `subscription_id`, `resource_group_name`, `account_name`, and `x.x.x.x` with your actual values. Make sure you have the necessary permissions and dependencies installed before running these scripts.


 