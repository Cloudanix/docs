

<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the Azure portal.
2. Navigate to the Virtual Machines service. You can do this by searching for "Virtual Machines" in the search bar at the top of the portal.
3. Select the virtual machine you want to check.
4. In the left-hand menu under 'Settings', click on 'Boot diagnostics'. If the status is 'On', then Boot Diagnostics is enabled. If the status is 'Off', then Boot Diagnostics is not enabled.

#### Using CLI

1. Install Azure CLI: Before you can use Azure CLI commands, you need to have it installed on your local machine. You can download and install it from the official Microsoft Azure website.

2. Login to Azure: Open your command line interface and type the following command to login to your Azure account:
   ```
   az login
   ```
   Follow the prompts in your browser to complete the login process.

3. List all VMs: Once you are logged in, you can list all the virtual machines in your subscription by running the following command:
   ```
   az vm list --output table
   ```
   This command will display a table that includes the name, resource group, location, and power state of each VM.

4. Check Boot Diagnostics: To check if Boot Diagnostics is enabled for a specific VM, you can use the following command:
   ```
   az vm boot-diagnostics get --name MyVm --resource-group MyResourceGroup
   ```
   Replace 'MyVm' and 'MyResourceGroup' with the name of your VM and its resource group respectively. If Boot Diagnostics is enabled, the command will return a JSON object with the storageUri and consoleScreenshotBlobUri properties. If these properties are not present, Boot Diagnostics is not enabled.

#### Using Python

To check if Virtual Machine Boot Diagnostics is enabled in Azure Compute using Python scripts, you can follow these steps:

1. **Install Azure SDK for Python**: Azure SDK for Python is a set of libraries that allow you to manage your Azure resources. To install it, you can use pip:
   ```
   pip install azure-mgmt-compute
   ```
2. **Authenticate to Azure**: Before you can interact with Azure resources, you need to authenticate. You can use Azure Identity library for this. Here is an example of how to authenticate using a service principal:
   ```python
   from azure.identity import ClientSecretCredential
   from azure.mgmt.compute import ComputeManagementClient

   tenant_id = "your-tenant-id"
   client_id = "your-client-id"
   client_secret = "your-client-secret"

   credential = ClientSecretCredential(tenant_id, client_id, client_secret)
   compute_client = ComputeManagementClient(credential, "your-subscription-id")
   ```
3. **List all VMs and check Boot Diagnostics status**: Once you have authenticated, you can list all VMs in your subscription and check if Boot Diagnostics is enabled:
   ```python
   for vm in compute_client.virtual_machines.list_all():
       if vm.diagnostics_profile is not None and vm.diagnostics_profile.boot_diagnostics is not None:
           print(f"VM {vm.name} has Boot Diagnostics enabled: {vm.diagnostics_profile.boot_diagnostics.enabled}")
       else:
           print(f"VM {vm.name} does not have Boot Diagnostics enabled")
   ```
4. **Interpret the results**: The script will print out the status of Boot Diagnostics for each VM. If Boot Diagnostics is enabled, it will print "VM [vm-name] has Boot Diagnostics enabled: True". If it is not enabled, it will print "VM [vm-name] does not have Boot Diagnostics enabled".

Remember to replace "your-tenant-id", "your-client-id", "your-client-secret", and "your-subscription-id" with your actual Azure tenant ID, client ID, client secret, and subscription ID.

</Tab>

<Tab title='Remediation'>
### Remediation

#### Using Console

To enable Virtual Machine Boot Diagnostics in Azure using the Azure console, please follow these steps:

1. Log in to the Azure portal using your credentials.

2. Navigate to the virtual machine that you want to enable boot diagnostics for.

3. In the virtual machine's blade, click on "Boot diagnostics" under the "Support + troubleshooting" section.

4. In the "Boot diagnostics" blade, click on the "Enable" button.

5. In the "Enable boot diagnostics" blade, select the storage account you want to use for storing the boot diagnostics logs.

6. Click on "OK" to enable boot diagnostics for the virtual machine.

7. Once boot diagnostics are enabled, you can view the boot logs by clicking on the "Serial log" tab in the "Boot diagnostics" blade.

That's it! You have successfully enabled Virtual Machine Boot Diagnostics in Azure using the Azure console.

#### Using CLI

To remediate the misconfiguration "Enable Virtual Machine Boot Diagnostics" for AZURE using AZURE CLI, you can follow the below steps:

1. Open the AZURE CLI on your system.

2. Login to your AZURE account using the command: `az login`

3. After logging in, select the subscription in which the virtual machine is present using the command: `az account set --subscription <subscription-id>`

4. Next, enable boot diagnostics for the virtual machine using the command: `az vm boot-diagnostics enable --name <vm-name> --resource-group <resource-group-name> --storage <storage-account-name>`

   Here, replace `<vm-name>` with the name of the virtual machine for which you want to enable boot diagnostics, `<resource-group-name>` with the name of the resource group in which the virtual machine is present, and `<storage-account-name>` with the name of the storage account where the boot diagnostics data will be stored.

5. Once the command is executed successfully, boot diagnostics will be enabled for the virtual machine.

   You can verify the same by logging in to the Azure portal, navigating to the virtual machine, and checking if boot diagnostics are enabled under the "Boot Diagnostics" section.

By following the above steps, you can remediate the misconfiguration "Enable Virtual Machine Boot Diagnostics" for AZURE using AZURE CLI.

#### Using Python

To remediate the misconfiguration of "Enable Virtual Machine Boot Diagnostics" in Azure using Python, you can use the Azure SDK for Python. Here are the step-by-step instructions:

1. Install the Azure SDK for Python by running the following command in your terminal:

   `pip install azure-mgmt-compute`

2. Authenticate with Azure by following the instructions in the Azure SDK for Python documentation.

3. Get the resource group and virtual machine name that you want to remediate.

   ```
   resource_group_name = "my_resource_group"
   vm_name = "my_vm"
   ```

4. Get the virtual machine object using the Azure SDK for Python.

   ```
   from azure.mgmt.compute import ComputeManagementClient

   compute_client = ComputeManagementClient(credentials, subscription_id)
   vm = compute_client.virtual_machines.get(resource_group_name, vm_name, expand='instanceView')
   ```

5. Check if boot diagnostics are already enabled for the virtual machine.

   ```
   if vm.diagnostics_profile.boot_diagnostics is not None:
       print("Boot diagnostics are already enabled.")
   else:
       print("Boot diagnostics are not enabled.")
   ```

6. If boot diagnostics are not enabled, enable them using the Azure SDK for Python.

   ```
   from azure.mgmt.compute.models import BootDiagnostics

   storage_account_uri = "/subscriptions/{subscription_id}/resourceGroups/{resource_group_name}/providers/Microsoft.Storage/storageAccounts/{storage_account_name}".format(
       subscription_id=subscription_id,
       resource_group_name=resource_group_name,
       storage_account_name=storage_account_name
   )

   boot_diagnostics = BootDiagnostics(enabled=True, storage_uri=storage_account_uri)
   vm.diagnostics_profile.boot_diagnostics = boot_diagnostics
   compute_client.virtual_machines.create_or_update(resource_group_name, vm_name, vm)
   ```

   Note: Replace `storage_account_name` with the name of the storage account that you want to use for boot diagnostics.

7. Verify that boot diagnostics are enabled for the virtual machine.

   ```
   vm = compute_client.virtual_machines.get(resource_group_name, vm_name, expand='instanceView')
   if vm.diagnostics_profile.boot_diagnostics is not None:
       print("Boot diagnostics are enabled.")
   else:
       print("Boot diagnostics are not enabled.")
   ```

That's it! You have successfully remediated the misconfiguration of "Enable Virtual Machine Boot Diagnostics" in Azure using Python.


</Tab>
</Tabs>