

<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the Azure portal.
2. In the left-hand menu, click on "All services". In the "All services" box, search for "Network Watcher".
3. In the "Network Watcher" blade, check the "Status" column. If Network Watcher is not enabled, the status will be displayed as "Disabled".
4. To confirm, you can also check the "Region" column. If Network Watcher is not enabled for a particular region, it will be listed as "Not Started".

#### Using CLI

1. Install Azure CLI: Before you can use Azure CLI commands, you need to have Azure CLI installed on your system. You can download it from the official Azure website and install it on your system.

2. Login to Azure: Open your command line interface and type the following command to login to your Azure account.
   ```
   az login
   ```
   Follow the instructions on the screen to complete the login process.

3. List Network Watchers: Use the following command to list all the Network Watchers in your Azure account.
   ```
   az network watcher list
   ```
   This command will return a list of all the Network Watchers in your account. If Network Watchers are not enabled, the list will be empty.

4. Check Network Watchers Status: For each Network Watcher, check its provisioning state. If the provisioning state is not 'Succeeded', then the Network Watcher is not enabled. You can use the following command to check the provisioning state of a Network Watcher.
   ```
   az network watcher show --name MyNetworkWatcher --resource-group MyResourceGroup --query provisioningState
   ```
   Replace 'MyNetworkWatcher' and 'MyResourceGroup' with the name of your Network Watcher and its resource group respectively. If the command returns anything other than 'Succeeded', then the Network Watcher is not enabled.

#### Using Python

To detect if Network Watchers are not enabled in Azure using Python scripts, you can follow these steps:

1. **Install Azure SDK for Python**: Azure SDK for Python is a set of libraries that allow you to manage your Azure resources. To install it, you can use pip:
   ```
   pip install azure-mgmt-network
   ```
2. **Authenticate to Azure**: Before you can interact with your Azure resources, you need to authenticate. You can use Azure Identity library for this. Here is an example of how to authenticate using a service principal:
   ```python
   from azure.identity import ClientSecretCredential
   from azure.mgmt.network import NetworkManagementClient

   tenant_id = "your-tenant-id"
   client_id = "your-client-id"
   client_secret = "your-client-secret"

   credential = ClientSecretCredential(tenant_id, client_id, client_secret)
   network_client = NetworkManagementClient(credential, "your-subscription-id")
   ```
3. **List all Network Watchers**: Now you can use the `network_client` to list all Network Watchers in your subscription. If the list is empty, it means that Network Watchers are not enabled.
   ```python
   network_watchers = network_client.network_watchers.list_all()
   if not network_watchers:
       print("Network Watchers are not enabled")
   ```
4. **Check the status of each Network Watcher**: Even if there are Network Watchers, they might not be enabled. You can check the status of each Network Watcher like this:
   ```python
   for watcher in network_watchers:
       if not watcher.provisioning_state == "Succeeded":
           print(f"Network Watcher {watcher.name} is not enabled")
   ```
This script will print a message for each Network Watcher that is not enabled. If there are no messages, it means that all Network Watchers are enabled.

</Tab>

<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the "Network Watchers Not Enabled" misconfiguration in Azure using the Azure console, follow these steps:

1. Log in to your Azure portal.
2. In the left-hand menu, click on "All services" and type "Network Watcher" in the search bar.
3. Click on "Network Watcher" to open the service.
4. In the left-hand menu of the Network Watcher service, click on "Network Watcher" again.
5. Click on the subscription that you want to enable Network Watcher for.
6. Click on "Enable Network Watcher" at the top of the page.
7. Select the region where you want to enable Network Watcher.
8. Click on "Enable" to enable Network Watcher for the selected region.
9. Repeat steps 7-8 for all the regions where you want to enable Network Watcher.
10. Once you have enabled Network Watcher for all the regions, click on "Network Watcher" in the left-hand menu again.
11. Click on "Topology" to verify that Network Watcher is now enabled.

By following these steps, you should be able to remediate the "Network Watchers Not Enabled" misconfiguration in Azure using the Azure console.

#### Using CLI

To remediate the misconfiguration of Network Watchers not enabled on Azure using Azure CLI, follow these steps:

1. Open the Azure CLI on your local machine or use the Azure Cloud Shell.

2. Run the following command to check if Network Watchers are already enabled on your Azure subscription:
```
az network watcher list
```

3. If Network Watchers are not enabled, run the following command to enable them:
```
az feature register --namespace Microsoft.Network --name NetworkWatcher
```

4. After running the above command, you need to wait for a few minutes for the registration to complete. You can check the status of the registration by running the following command:
```
az feature list -o table --query "[?contains(name, 'Microsoft.Network/NetworkWatcher')].{Name:name,State:properties.state}"
```

5. Once the registration is complete, you can create a Network Watcher in the region of your choice by running the following command:
```
az network watcher create --location <region>
```
Note: Replace `<region>` with the name of the region where you want to create the Network Watcher.

6. Finally, you can verify that Network Watchers are enabled by running the following command:
```
az network watcher list
```

This should remediate the misconfiguration of Network Watchers not enabled on Azure using Azure CLI.

#### Using Python

To remediate the "Network Watchers Not Enabled" misconfiguration in Azure using Python, follow these steps:

1. Import the necessary libraries:

```
from azure.common.credentials import ServicePrincipalCredentials
from azure.mgmt.network import NetworkManagementClient
```

2. Set up the Azure credentials:

```
subscription_id = 'your_subscription_id'
credentials = ServicePrincipalCredentials(
    client_id = 'your_client_id',
    secret = 'your_client_secret',
    tenant = 'your_tenant_id'
)
```

3. Instantiate the NetworkManagementClient:

```
network_client = NetworkManagementClient(
    credentials,
    subscription_id
)
```

4. Check if Network Watcher is enabled:

```
watcher = network_client.network_watchers.get('your_resource_group', 'your_network_watcher_name')
if watcher.provisioning_state != 'Succeeded':
    print("Network Watcher is not enabled.")
```

5. If Network Watcher is not enabled, enable it:

```
watcher = network_client.network_watchers.create_or_update(
    'your_resource_group',
    'your_network_watcher_name',
    {
        'location': 'your_location'
    }
)
```

6. Verify that Network Watcher is now enabled:

```
if watcher.provisioning_state == 'Succeeded':
    print("Network Watcher is now enabled.")
```

Note: Replace the placeholders (your_subscription_id, your_client_id, your_client_secret, your_tenant_id, your_resource_group, your_network_watcher_name, and your_location) with the appropriate values for your Azure environment.


</Tab>
</Tabs>