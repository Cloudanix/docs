---
slug: azure_cnames_records_vulnerable
title: Azure CName Records Vulnerable
sidebar_label: Azure CName Records Vulnerable
---

### More Info:

Ensure Azure CName Records are not vulnerable

### Risk Level

Medium

### Address

Security

### Compliance Standards

CBP


### Triage and Remediation
<Tabs>
<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the CName Records vulnerability in Azure, follow these steps using the Azure console:

1. Sign in to the Azure portal (https://portal.azure.com) using your credentials.

2. Navigate to the Azure DNS service by searching for "DNS" in the search bar at the top of the portal and selecting "DNS zones" from the results.

3. Select the DNS zone that contains the vulnerable CName record.

4. In the DNS zone overview, locate the CName record that needs to be remediated.

5. Click on the CName record to open its settings.

6. Review the CName record and ensure it is pointing to a trusted and valid destination.

7. If the CName record is pointing to an unauthorized or suspicious destination, click on the "Edit" button to modify the record.

8. In the edit mode, update the CName record to the correct and trusted destination.

9. Save the changes by clicking on the "Save" button.

10. After saving the changes, verify that the CName record is now pointing to the intended destination.

11. Repeat the above steps for any other vulnerable CName records in the DNS zone.

By following these steps, you can remediate the CName Records vulnerability in Azure by ensuring that the CName records are correctly configured and pointing to trusted destinations.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the Azure CName Records Vulnerability, you can follow the steps below using Azure CLI:

1. Install and configure Azure CLI: 
   - Install Azure CLI by following the instructions provided in the official documentation: https://docs.microsoft.com/en-us/cli/azure/install-azure-cli
   - Once installed, authenticate with your Azure account using the command: `az login`

2. Identify the affected CName records:
   - List all the DNS zones in your Azure subscription using the command: `az network dns zone list`
   - Identify the DNS zone that contains the vulnerable CName record.

3. Delete the vulnerable CName record:
   - Use the command `az network dns record-set cname delete` to delete the CName record.
   - Specify the DNS zone name and the name of the CName record to delete.
   - Example command: `az network dns record-set cname delete -g <resource_group_name> -z <dns_zone_name> -n <cname_record_name>`

4. Verify the deletion:
   - Confirm that the CName record has been successfully deleted by listing the DNS records in the DNS zone using the command: `az network dns record-set list -g <resource_group_name> -z <dns_zone_name>`

5. Repeat steps 3 and 4 for all affected CName records.

By following the above steps, you will be able to remediate the Azure CName Records Vulnerability using Azure CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the CName Records vulnerability in Azure Network using Python, follow these steps:

1. Install the required Python packages:
   ```python
   pip install azure-mgmt-dns
   ```

2. Import the necessary modules:
   ```python
   from azure.identity import DefaultAzureCredential
   from azure.mgmt.dns import DnsManagementClient
   ```

3. Authenticate with Azure using your credentials:
   ```python
   credential = DefaultAzureCredential()
   dns_client = DnsManagementClient(credential, subscription_id)
   ```

4. Get the list of DNS zones in your Azure subscription:
   ```python
   zones = dns_client.zones.list()
   ```

5. Iterate through each DNS zone and check for CName records:
   ```python
   for zone in zones:
       cname_records = dns_client.record_sets.list_by_type(zone.resource_group, zone.name, 'CNAME')
       for record in cname_records:
           # Delete the CName record
           dns_client.record_sets.delete(zone.resource_group, zone.name, record.name, 'CNAME')
   ```

6. Save and run the Python script. It will delete all the CName records in your Azure DNS zones.

Note: Make sure to replace `subscription_id` with your Azure subscription ID.

Please ensure that you understand the impact of deleting CName records before executing the script. It is recommended to test the script in a non-production environment first.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>

