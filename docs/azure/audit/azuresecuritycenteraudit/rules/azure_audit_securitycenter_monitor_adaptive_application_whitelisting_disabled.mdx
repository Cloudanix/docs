---
slug: azure_audit_securitycenter_monitor_adaptive_application_whitelisting_disabled
title: Monitor Adaptive Application Whitelisting setting is not enabled
sidebar_label: Monitor Adaptive Application Whitelisting setting is not enabled
---

### More Info:

Enable Adaptive Application Whitelisting recommendations for virtual machines.

### Risk Level

Low

### Address

Security, Operational Maturity

### Compliance Standards

HIPAA, ISO27001


<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the Azure portal: Navigate to portal.azure.com and sign in with your Azure account credentials.

2. Open Security Center: On the left-hand side menu, click on "Security Center". This will open the Security Center dashboard where you can view and manage your security policies and configurations.

3. Navigate to Adaptive Application Controls: In the Security Center dashboard, click on "Adaptive application controls" under the "Advanced cloud defense" section. This will open a page where you can view all the application control policies.

4. Check the Status: In the Adaptive Application Controls page, you can see the status of the Monitor Adaptive Application Whitelisting setting. If it is not enabled, it will show as "Not enabled" or "Off". If it is enabled, it will show as "Enabled" or "On".

#### Using CLI

1. Install Azure CLI: Before you can use Azure CLI, you need to install it on your local machine. You can download it from the official Microsoft website and follow the installation instructions.

2. Login to Azure: Open your command line interface and type the following command to login to your Azure account:
   ```
   az login
   ```
   Follow the prompts in your browser to complete the sign-in process.

3. Select the Subscription: If you have multiple subscriptions, you need to select the subscription where you want to check the Adaptive Application Whitelisting setting. Use the following command to list all your subscriptions:
   ```
   az account list --output table
   ```
   Then, use the following command to set your desired subscription:
   ```
   az account set --subscription "My Subscription"
   ```

4. Check Adaptive Application Whitelisting Setting: Use the following command to check the Adaptive Application Whitelisting setting in Security Center:
   ```
   az security adaptive-application-controls list
   ```
   This command will list all the Adaptive Application Controls in your selected subscription. If the Monitor Adaptive Application Whitelisting setting is not enabled, it will not appear in this list.

#### Using Python

To check if the Monitor Adaptive Application Whitelisting setting is not enabled in Azure Security Center using Python scripts, you can follow these steps:

1. **Install Azure SDK for Python**: Azure SDK for Python is a set of libraries that allow you to work with Azure services like Security Center. You can install it using pip:
   ```bash
   pip install azure-mgmt-security
   ```
2. **Authenticate to Azure**: Before you can interact with Azure services, you need to authenticate. You can use Azure Identity library for this. Here is an example of how to authenticate using a service principal:
   ```python
   from azure.identity import ClientSecretCredential
   from azure.mgmt.security import SecurityCenter

   tenant_id = "your-tenant-id"
   client_id = "your-client-id"
   client_secret = "your-client-secret"

   credential = ClientSecretCredential(tenant_id, client_id, client_secret)
   client = SecurityCenter(credential, "your-subscription-id")
   ```
3. **Get Adaptive Application Controls**: Now you can use the client to get the adaptive application controls. Here is an example:
   ```python
   aac = client.adaptive_application_controls.list()
   for control in aac:
       print(control)
   ```
4. **Check if Monitor Adaptive Application Whitelisting is enabled**: You can check if the Monitor Adaptive Application Whitelisting setting is enabled by checking the properties of the adaptive application controls. Here is an example:
   ```python
   aac = client.adaptive_application_controls.list()
   for control in aac:
       if control.properties.enforcementMode == "Disabled":
           print(f"Monitor Adaptive Application Whitelisting is not enabled for {control.name}")
   ```
This script will print the names of the adaptive application controls for which the Monitor Adaptive Application Whitelisting setting is not enabled.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration "Monitor Adaptive Application Whitelisting setting is not enabled" in Azure using the Azure console, follow the below steps:

1. Log in to the Azure portal (https://portal.azure.com/).
2. Click on the "Security Center" option from the left-hand menu.
3. Click on the "Security Policy" option from the Security Center menu.
4. Select the security policy that you want to remediate.
5. Click on the "Edit Policy" button located at the top of the screen.
6. Scroll down to the "Adaptive Application Controls" section and click on "Edit".
7. Enable the "Monitor Adaptive Application Whitelisting setting" option.
8. Click on the "Save" button to save the changes.

Once you have completed these steps, the "Monitor Adaptive Application Whitelisting setting" will be enabled, and the misconfiguration will be remediated.

#### Using CLI

To remediate the "Monitor Adaptive Application Whitelisting setting is not enabled" misconfiguration in Azure using Azure CLI, follow these steps:

1. Open the Azure CLI in your terminal or command prompt.
2. Login to your Azure account using the command "az login".
3. Once you are logged in, select the Azure subscription where the misconfiguration exists using the command `az account set --subscription <subscription_id>`.
4. Check the current status of the Monitor Adaptive Application Whitelisting setting using the command "az security assessment-metadata show --name "Monitor Adaptive Application Whitelisting setting is not enabled" --query status".
5. If the current status is "NotApplicable" or "Healthy", then the misconfiguration does not exist and no further action is required.
6. If the current status is "Unhealthy", then the misconfiguration exists and needs to be remediated.
7. To remediate the misconfiguration, enable the Monitor Adaptive Application Whitelisting setting using the command "az security assessment set --name "Monitor Adaptive Application Whitelisting setting is not enabled" --status Healthy".
8. Verify that the misconfiguration has been remediated by checking the status again using the command "az security assessment-metadata show --name "Monitor Adaptive Application Whitelisting setting is not enabled" --query status".

By following these steps, you can remediate the "Monitor Adaptive Application Whitelisting setting is not enabled" misconfiguration in Azure using Azure CLI.

#### Using Python

To remediate the "Monitor Adaptive Application Whitelisting setting is not enabled" misconfiguration in Azure using Python, you can use the Azure SDK for Python. Here are the steps to follow:

1. Install the Azure SDK for Python using pip:

```
pip install azure-mgmt-security
```

2. Import the necessary modules:

```
from azure.common.credentials import ServicePrincipalCredentials
from azure.mgmt.security import SecurityCenter
```

3. Set up the credentials for the Azure account:

```
subscription_id = '<subscription_id>'
client_id = '<client_id>'
client_secret = '<client_secret>'
tenant_id = '<tenant_id>'

credentials = ServicePrincipalCredentials(
    client_id=client_id,
    secret=client_secret,
    tenant=tenant_id
)
```

4. Create a SecurityCenter client object:

```
security_center_client = SecurityCenter(credentials, subscription_id)
```

5. Get the security policy for the subscription:

```
policy = security_center_client.policies.get('default')
```

6. Check if the "Monitor Adaptive Application Whitelisting" setting is enabled:

```
monitor_aaw = False
for setting in policy.settings:
    if setting.name == 'monitorAdaptiveApplicationWhitelisting':
        monitor_aaw = setting.value
        break
```

7. If the setting is not enabled, enable it:

```
if not monitor_aaw:
    for setting in policy.settings:
        if setting.name == 'monitorAdaptiveApplicationWhitelisting':
            setting.value = True
            break

    updated_policy = security_center_client.policies.create_or_update('default', policy)
```

These steps will remediate the "Monitor Adaptive Application Whitelisting setting is not enabled" misconfiguration in Azure using Python.


</Tab>
</Tabs>