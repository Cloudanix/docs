---
slug: azure_audit_securitycenter_security_tasks
title: Ensure that Microsoft Azure Security Center recommendations are examined and resolved.
sidebar_label: Ensure that Microsoft Azure Security Center recommendations are examined and resolved.
---

### More Info:

Ensure that Microsoft Azure Security Center recommendations are examined and resolved.

### Risk Level

High

### Address

Security, Operational Maturity

### Compliance Standards

CBP


<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the Azure portal: Open your web browser, navigate to the Azure portal (https://portal.azure.com/), and sign in with your Azure account credentials.

2. Open Security Center: Once you're logged in, locate the "Security Center" in the left-hand menu. If it's not visible, you can find it by using the search bar at the top of the Azure portal.

3. Check Security Center recommendations: In the Security Center dashboard, click on the "Recommendations" tab. This will display a list of all the current security recommendations for your Azure resources.

4. Review and resolve recommendations: Go through each recommendation one by one. Each recommendation will provide a description of the issue, the impacted resources, and the potential impact on your security posture. It's important to review these recommendations regularly and take appropriate actions to resolve them to maintain a secure and compliant environment.

#### Using CLI

1. Install Azure CLI: Before you can use Azure CLI, you need to install it on your local machine. You can download it from the official Microsoft Azure website. Once installed, open your command prompt or terminal and type `az login` to log in to your Azure account.

2. Check Azure Security Center Recommendations: To check the recommendations from Azure Security Center, you can use the following command:

   ```
   az security task list
   ```
   This command will list all the security tasks recommended by Azure Security Center.

3. Filter Unresolved Recommendations: If you want to filter out the unresolved recommendations, you can use the following command:

   ```
   az security task list --query "[?status.state=='Unresolved']"
   ```
   This command will list all the unresolved security tasks.

4. Check Details of a Specific Recommendation: If you want to check the details of a specific recommendation, you can use the following command:

   ```
   az security task show --name "Name of the Task"
   ```
   Replace "Name of the Task" with the actual name of the task. This command will show the details of the specified task.

#### Using Python

1. Install Azure SDK: To interact with Azure services, you need to install Azure SDK in your Python environment. You can do this by running the command `pip install azure-mgmt-security`.

2. Import Required Libraries: Import the necessary libraries into your Python script. You will need the `azure.identity` and `azure.mgmt.security` libraries. Here is an example of how to import these libraries:

```python
from azure.identity import DefaultAzureCredential
from azure.mgmt.security import SecurityCenter
```

3. Authenticate to Azure: Before you can interact with Azure services, you need to authenticate. You can use the `DefaultAzureCredential` class to authenticate using your Azure account. Here is an example:

```python
credential = DefaultAzureCredential()
subscription_id = 'your-subscription-id'
```

4. Check Security Center Recommendations: Now you can use the `SecurityCenter` client to interact with the Azure Security Center. You can use the `security_recommendations` method to get a list of all security recommendations. Here is an example:

```python
client = SecurityCenter(credential, subscription_id)
recommendations = client.security_recommendations.list()
for recommendation in recommendations:
    print(recommendation.name)
```

This script will print the names of all security recommendations in the Azure Security Center. If there are any unresolved recommendations, they will be included in this list.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate this misconfiguration in Azure using Azure console, follow the steps below:

1. Log in to the Azure portal (https://portal.azure.com/).
2. Navigate to the Security Center from the left-hand menu.
3. Click on the Recommendations tab to view all the recommendations.
4. Select the recommendation that you want to remediate.
5. Click on the Remediate button to start the remediation process.
6. Follow the on-screen instructions to complete the remediation process.

Alternatively, you can also perform the remediation process using PowerShell. Here are the steps:

1. Open PowerShell on your local machine.
2. Connect to your Azure account using the following command: Connect-AzAccount
3. Run the following command to get the list of recommendations: Get-AzSecurityRecommendation
4. Select the recommendation that you want to remediate.
5. Run the following command to remediate the recommendation: `Invoke-AzSecurityRecommendationRemediation -ResourceId <resource-id> -RecommendationId <recommendation-id>`

Note: Replace `<resource-id>` and `<recommendation-id>` with the actual values for the resource and recommendation that you want to remediate.

#### Using CLI

To remediate the misconfiguration of ensuring that Microsoft Azure Security Center recommendations are examined and resolved using Azure CLI, you can follow the below steps:

Step 1: Install Azure CLI

If you haven't already installed Azure CLI, you can follow the instructions provided in the Microsoft documentation to install Azure CLI for your operating system.

Step 2: Login to your Azure account

Login to your Azure account using the below command in Azure CLI:

```
az login
```

Step 3: Enable Azure Security Center

If you haven't already enabled Azure Security Center, you can follow the below command to enable it:

```
az security pricing create --name default --tier standard
```

Step 4: Check Azure Security Center recommendations

To check the Azure Security Center recommendations, you can use the below command:

```
az security recommendation list --resource-group <resource-group-name> --security-solution-name "Azure Security Center"
```

Note: Replace `<resource-group-name>` with the name of your resource group.

Step 5: Remediate the recommendations

To remediate the recommendations, you can use the below command:

```
az security recommendation update --ids <recommendation-id> --status "remediated"
```

Note: Replace `<recommendation-id>` with the ID of the recommendation that you want to remediate.

By following these steps, you can remediate the misconfiguration of ensuring that Microsoft Azure Security Center recommendations are examined and resolved using Azure CLI.

#### Using Python

To remediate this issue using Python, you can use the Azure SDK for Python. Here are the steps to remediate the misconfiguration:

1. Install the Azure SDK for Python using pip:

```
pip install azure-mgmt-resource
pip install azure-mgmt-security
```

2. Authenticate with Azure using the Azure CLI:

```
az login
```

3. Import the required modules and authenticate with Azure using the Azure SDK for Python:

```python
from azure.identity import AzureCliCredential
from azure.mgmt.security import SecurityCenter

credential = AzureCliCredential()
security_center_client = SecurityCenter(
    credential=credential,
    subscription_id='<subscription_id>'
)
```

4. Get the list of recommendations from Azure Security Center:

```python
recommendations = security_center_client.recommendations.list()
```

5. Iterate through the recommendations and remediate them:

```python
for recommendation in recommendations:
    if recommendation.status == 'Active':
        remediation = security_center_client.remediations.begin_create(
            recommendation_id=recommendation.id,
            properties={}
        )
        print(f'Remediation created: {remediation.id}')
```

This code will create remediation tasks for all active recommendations in Azure Security Center. Once the remediation tasks are completed, the misconfigurations will be remediated.


</Tab>
</Tabs>