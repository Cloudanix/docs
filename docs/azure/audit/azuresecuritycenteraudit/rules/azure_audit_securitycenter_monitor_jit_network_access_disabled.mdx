---
slug: azure_audit_securitycenter_monitor_jit_network_access_disabled
title: Monitor JIT Network Access setting is not enabled
sidebar_label: Monitor JIT Network Access setting is not enabled
---

### More Info:

Enable JIT Network Access recommendations for virtual machines.

### Risk Level

Low

### Address

Security, Operational Maturity

### Compliance Standards

SOC2, ISO27001, HIPAA, HITRUST


<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the Azure portal: Navigate to the Azure portal by entering "https://portal.azure.com" in your web browser. Enter your Azure account credentials to log in.

2. Open Security Center: Once you are logged in, look for the "Security Center" option in the left-hand side menu. Click on it to open the Azure Security Center dashboard.

3. Navigate to Adaptive Network Hardening: In the Security Center dashboard, look for the "Adaptive Network Hardening" option under the "Advanced Cloud Defense" section. Click on it to open the Adaptive Network Hardening settings.

4. Check JIT Network Access setting: In the Adaptive Network Hardening settings, look for the "Just-In-Time Network Access" setting. If it is not enabled, it means that the Monitor JIT Network Access setting is not enabled in Security Center.

#### Using CLI

1. Install Azure CLI: Before you can use Azure CLI, you need to install it on your local machine. You can download it from the official Microsoft website and follow the installation instructions.

2. Login to Azure: After installing Azure CLI, open your command line interface and type the following command to login to your Azure account:

   ```
   az login
   ```
   Follow the prompts in your command line interface to complete the login process.

3. Select the Subscription: If you have multiple subscriptions, you need to select the subscription where you want to check the JIT Network Access setting. Use the following command to set the subscription:

   ```
   az account set --subscription "mySubscription"
   ```

4. Check JIT Network Access Setting: Now, you can check the JIT Network Access setting in Security Center by running the following command:

   ```
   az security jit-network-access-policies list
   ```
   This command will list all the JIT Network Access policies. If the Monitor JIT Network Access setting is not enabled, it will not appear in this list.

#### Using Python

Just-In-Time (JIT) Network Access control in Azure Security Center helps you lock down inbound traffic to your Azure VMs, reducing exposure to attacks while providing easy access to connect to VMs when needed.

Here are the steps to detect if JIT Network Access setting is not enabled in Security Center using Python scripts:

1. Install Azure SDK for Python: Azure SDK for Python is a set of libraries that allow you to work with Azure services like Azure Storage, Azure Cosmos DB, etc. You can install it using pip:

   ```python
   pip install azure
   ```

2. Authenticate to Azure: Before you can interact with Azure services, you need to authenticate. You can authenticate using Azure Active Directory (Azure AD) credentials. Here is a sample code snippet:

   ```python
   from azure.common.credentials import ServicePrincipalCredentials

   credentials = ServicePrincipalCredentials(
       client_id = 'your_client_id',
       secret = 'your_secret',
       tenant = 'your_tenant_id'
   )
   ```

3. Connect to Azure Security Center: Once you have authenticated, you can connect to Azure Security Center using the Azure SDK for Python. Here is a sample code snippet:

   ```python
   from azure.mgmt.security import SecurityCenter

   sc = SecurityCenter(credentials, 'your_subscription_id')
   ```

4. Check JIT Network Access setting: You can check if JIT Network Access setting is enabled or not using the `get_setting` method of the `SecurityCenter` class. Here is a sample code snippet:

   ```python
   jit_setting = sc.jit_network_access_policies.get('default')

   if jit_setting.provisioning_state != 'Succeeded':
       print('JIT Network Access setting is not enabled.')
   else:
       print('JIT Network Access setting is enabled.')
   ```

Please replace 'your_client_id', 'your_secret', 'your_tenant_id', and 'your_subscription_id' with your actual Azure AD credentials and Azure subscription ID.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the "Monitor JIT Network Access setting is not enabled" misconfiguration for Azure using the Azure console, follow the below steps:

1. Log in to the Azure portal using your credentials.

2. Navigate to the "Security Center" service from the left-hand menu.

3. In the Security Center dashboard, click on the "Security policy" tab.

4. In the Security policy tab, scroll down to the "Just-in-Time network access" policy and click on the "Edit" button.

5. In the "Just-in-Time network access" policy page, enable the "Monitor" option by toggling it to "On".

6. Click on the "Save" button to save the changes.

7. Once the policy is saved, Azure will start monitoring the Just-in-Time network access setting and provide recommendations for remediation if any misconfiguration is detected.

By following the above steps, you can remediate the "Monitor JIT Network Access setting is not enabled" misconfiguration for Azure using the Azure console.

#### Using CLI

To remediate the "Monitor JIT Network Access setting is not enabled" misconfiguration in AZURE using AZURE CLI, follow these steps:

1. Open the AZURE CLI on your local machine or on the AZURE Cloud Shell.

2. Run the following command to check the current status of the JIT Network Access setting:

   ```
   az monitor activity-log list --resource-type Microsoft.Network/networkSecurityGroups --query "[?contains(properties.description,'Just-In-Time')].{Time: eventTimestamp, Description: properties.description, Status: properties.status.value}" --output table
   ```

   This command will list all the NSGs (Network Security Groups) that have JIT (Just-In-Time) Network Access enabled or disabled.

3. If the output shows that the JIT Network Access setting is not enabled for any NSG, run the following command to enable it:

   ```
   az network nsg update --name <NSG_NAME> --resource-group <RESOURCE_GROUP_NAME> --set "properties.securityRules[?name=='AllowAzureBastion'].properties.destinationPortRange='3389'" --add "properties.securityRules[?name=='AllowAzureBastion'].properties.destinationPortRanges=3389" --set "properties.securityRules[?name=='AllowAzureBastion'].properties.direction='Inbound'" --set "properties.securityRules[?name=='AllowAzureBastion'].properties.access='Allow'" --set "properties.securityRules[?name=='AllowAzureBastion'].properties.priority=1001" --set "properties.securityRules[?name=='AllowAzureBastion'].properties.protocol='Tcp'" --set "properties.securityRules[?name=='AllowAzureBastion'].properties.sourceAddressPrefixes='*'"

   ```

   Replace `<NSG_NAME>` with the name of the NSG that you want to enable JIT Network Access for, and `<RESOURCE_GROUP_NAME>` with the name of the resource group that the NSG belongs to.

4. Once the command is executed successfully, the JIT Network Access setting will be enabled for the specified NSG.

5. Verify the change by running the command in step 2 again. The output should show that the JIT Network Access setting is now enabled for the specified NSG.

#### Using Python

To remediate the "Monitor JIT Network Access setting is not enabled" misconfiguration in Azure using Python, you can use the Azure Python SDK to enable the Just-In-Time (JIT) Network Access setting for your virtual machines. Here are the step-by-step instructions:

1. Install the Azure Python SDK by running the following command in your terminal:

```
pip install azure-mgmt-compute
```

2. Authenticate with your Azure account using the SDK. You can use the following code snippet to authenticate:

```
from azure.common.credentials import ServicePrincipalCredentials
from azure.mgmt.compute import ComputeManagementClient

# Replace the values below with your Azure account details
subscription_id = '<subscription_id>'
tenant_id = '<tenant_id>'
client_id = '<client_id>'
client_secret = '<client_secret>'

# Authenticate with Azure using a service principal
credentials = ServicePrincipalCredentials(
    client_id=client_id,
    secret=client_secret,
    tenant=tenant_id
)

# Create a ComputeManagementClient object
compute_client = ComputeManagementClient(credentials, subscription_id)
```

3. Get the virtual machine resource group and name for which you want to enable JIT Network Access. You can use the following code snippet to get the virtual machine details:

```
# Replace the values below with your virtual machine details
resource_group_name = '<resource_group_name>'
vm_name = '<vm_name>'

# Get the virtual machine details
vm = compute_client.virtual_machines.get(resource_group_name, vm_name)
```

4. Enable JIT Network Access for the virtual machine by updating its network profile. You can use the following code snippet to enable JIT Network Access:

```
# Enable JIT Network Access for the virtual machine
vm.network_profile.network_interface_configurations[0].enable_accelerated_networking = True
vm.network_profile.network_interface_configurations[0].enable_ip_forwarding = True
vm.network_profile.network_interface_configurations[0].network_security_group = None
vm.network_profile.network_interface_configurations[0].enable_network_security_group_flow_logging = True
vm.network_profile.network_interface_configurations[0].enable_jit_network_access = True

# Update the virtual machine with the new network profile
compute_client.virtual_machines.create_or_update(resource_group_name, vm_name, vm)
```

With these steps, you should be able to remediate the "Monitor JIT Network Access setting is not enabled" misconfiguration for your Azure virtual machine using Python.




</Tab>
</Tabs>