---
slug: azure_audit_securitycenter_monitor_ddos_protection_public_networks
title: Enable DDoS Protection Standard Monitoring for Public Virtual Networks
sidebar_label: Enable DDoS Protection Standard Monitoring for Public Virtual Networks
---

### More Info:

Ensure that monitoring of DDoS protection at the Azure virtual network level is enabled.

### Risk Level

High

### Address

Security, Operational Maturity

### Compliance Standards

CBP


<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the Azure portal: Navigate to the Azure portal by entering "https://portal.azure.com" in your web browser. Enter your Azure account credentials to log in.

2. Open Azure Security Center: Once you are logged in, look for the "Security Center" in the left-hand menu. If you can't find it, use the search bar at the top of the dashboard and type "Security Center", then select it from the dropdown list.

3. Check Security Policy: In the Security Center dashboard, click on "Security policy" in the Management section. This will open a list of your subscriptions. Click on the subscription you want to check.

4. Check DDoS Protection: In the Security Policy dashboard, scroll down to the "NETWORKING" section. Here, you should see a policy named "Enable DDoS Protection Standard". The status next to it will show whether it is enabled or not. If it's not enabled, it means there is a misconfiguration.

#### Using CLI

1. Install Azure CLI: Before you can use Azure CLI, you need to install it on your local machine. You can download it from the official Microsoft website and follow the installation instructions.

2. Login to Azure: After installing Azure CLI, you need to login to your Azure account. Open your command prompt and type the following command:
   ```
   az login
   ```
   This will open a new browser window asking you to sign in to your Azure account.

3. Select the Subscription: Once you are logged in, you need to select the subscription where your virtual networks are located. Use the following command to list all your subscriptions:
   ```
   az account list --output table
   ```
   Then, set the subscription you want to use:
   ```
   az account set --subscription "My Demos"
   ```

4. Check DDoS Protection: Now, you can check if DDoS Protection Standard Monitoring is enabled for your public virtual networks. Use the following command to list all your virtual networks and their DDoS protection plans:
   ```
   az network vnet list --query "[].{Name:name, DDoSProtectionPlan:enableDdosProtection}" --output table
   ```
   This command will output a table with the names of your virtual networks and whether they have DDoS Protection enabled or not. If the DDoSProtectionPlan column shows 'false', then DDoS Protection Standard Monitoring is not enabled for that virtual network.

#### Using Python

To check if DDoS Protection Standard Monitoring is enabled for Public Virtual Networks in Azure Security Center using Python scripts, you can follow these steps:

1. **Install Azure SDK for Python**: Azure SDK for Python is a set of libraries that allow you to manage and utilize Azure services. You can install it using pip:
   ```
   pip install azure-mgmt-security
   ```
2. **Authenticate to Azure**: Before you can interact with Azure services, you need to authenticate. You can use Azure Identity library for this. Here is a sample code snippet:
   ```python
   from azure.identity import DefaultAzureCredential
   from azure.mgmt.security import SecurityCenter

   credential = DefaultAzureCredential()
   security_center = SecurityCenter(credential, "<subscription_id>")
   ```
   Replace `<subscription_id>` with your Azure subscription ID.

3. **Get DDoS Protection Settings**: You can use the `ddos_protection_settings` method of the `SecurityCenter` client to get the DDoS Protection settings. Here is a sample code snippet:
   ```python
   ddos_protection_settings = security_center.ddos_protection_settings.get("<resource_group_name>")
   ```
   Replace `<resource_group_name>` with the name of your resource group.

4. **Check if DDoS Protection Standard Monitoring is Enabled**: You can check the `ddos_protection_standard_enabled` property of the DDoS Protection settings to see if it is enabled. Here is a sample code snippet:
   ```python
   if ddos_protection_settings.ddos_protection_standard_enabled:
       print("DDoS Protection Standard Monitoring is enabled.")
   else:
       print("DDoS Protection Standard Monitoring is not enabled.")
   ```
   This will print whether DDoS Protection Standard Monitoring is enabled or not.

Please note that you need appropriate permissions to read the DDoS Protection settings. If you encounter any permission errors, make sure your account has the necessary permissions.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

Sure, here are the step-by-step instructions to remediate the misconfiguration "Enable DDoS Protection Standard Monitoring for Public Virtual Networks" in Azure using the Azure console:

1. Login to the Azure Portal (https://portal.azure.com/)
2. Select the subscription and resource group that contains the virtual network you want to protect.
3. In the Azure portal, search for "DDoS protection plans" in the search bar.
4. Select "DDoS protection plans" from the search results.
5. Click on "+ Add" to create a new DDoS protection plan.
6. In the "Basics" tab, enter a name for the plan and select the subscription and resource group that contains the virtual network you want to protect.
7. In the "Settings" tab, select "Standard" as the DDoS protection plan tier.
8. In the "Review + create" tab, review the settings and click on "Create" to create the DDoS protection plan.
9. Once the DDoS protection plan is created, go to the virtual network that you want to protect.
10. In the virtual network's "Settings" menu, select "DDoS protection".
11. Under "DDoS protection plan", select the DDoS protection plan that you created in step 5.
12. Click on "Save" to save the changes.

That's it! You have now enabled DDoS Protection Standard Monitoring for Public Virtual Networks in Azure.

#### Using CLI

To remediate the misconfiguration "Enable DDoS Protection Standard Monitoring for Public Virtual Networks" in AZURE using AZURE CLI, follow the below steps:

Step 1: Open the AZURE CLI on your local machine or use the AZURE Cloud Shell.

Step 2: Login to your AZURE account using the below command:
```
az login
```

Step 3: Once you are logged in, set the default subscription using the below command:
```
az account set --subscription <subscription_id>
```

Step 4: To enable DDoS Protection Standard Monitoring for Public Virtual Networks, run the below command:
```
az network ddos-protection create --name <ddos_protection_name> --resource-group <resource_group_name> --location <location_name> --tags <tags>
```
Replace the below placeholders with appropriate values:
- `<ddos_protection_name>`: Name of the DDoS protection plan.
- `<resource_group_name>`: Name of the resource group where the DDoS protection plan needs to be created.
- `<location_name>`: Location where the DDoS protection plan needs to be created.
- `<tags>`: Tags for the DDoS protection plan.

Note: If you want to enable DDoS protection for an existing virtual network, you need to update the virtual network configuration to associate it with the DDoS protection plan.

Step 5: Verify the DDoS Protection Standard Monitoring is enabled for the Public Virtual Network by running the below command:
```
az network vnet list --resource-group <resource_group_name> --query [*].ddosProtectionPlan.id
```

This will return the DDoS protection plan ID associated with the virtual network. If it returns null, it means DDoS protection is not enabled for the virtual network.

With these steps, you have successfully remediated the misconfiguration "Enable DDoS Protection Standard Monitoring for Public Virtual Networks" in AZURE using AZURE CLI.

#### Using Python

To remediate the misconfiguration "Enable DDoS Protection Standard Monitoring for Public Virtual Networks" in Azure using Python, you can follow the below steps:

1. Import the necessary modules:

```python
from azure.mgmt.network import NetworkManagementClient
from azure.common.credentials import ServicePrincipalCredentials
```

2. Set the credentials:

```python
subscription_id = '<subscription_id>'
credentials = ServicePrincipalCredentials(
    client_id='<client_id>',
    secret='<client_secret>',
    tenant='<tenant_id>'
)
```

3. Instantiate the NetworkManagementClient:

```python
network_client = NetworkManagementClient(
    credentials,
    subscription_id
)
```

4. Get the list of public IP addresses:

```python
public_ips = network_client.public_ip_addresses.list_all()
```

5. For each public IP address, check if DDoS protection is enabled. If not, enable it:

```python
for public_ip in public_ips:
    if not public_ip.ddos_settings:
        public_ip.ddos_settings = DdosSettings(
            protection_coverage='Standard',
            protected_ip=True
        )
        network_client.public_ip_addresses.create_or_update(
            resource_group_name='<resource_group_name>',
            public_ip_address_name=public_ip.name,
            parameters=public_ip
        )
```

This code will check for all the public IP addresses in your Azure subscription and enable DDoS protection standard monitoring for each public IP address that does not already have it enabled.

Note: Make sure to replace the placeholders like `<subscription_id>`, `<client_id>`, `<client_secret>`, `<tenant_id>`, `<resource_group_name>` with the appropriate values for your Azure environment.


</Tab>
</Tabs>