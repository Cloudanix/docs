### Remediation

#### Using Console

Sure, here are the step-by-step instructions to remediate the "Unsafe TLS Version Supported" misconfiguration in the Azure console:

1. Log in to the Azure portal.
2. Navigate to the affected resource.
3. Click on the "Networking" tab on the left-hand side menu.
4. Click on the "TLS/SSL settings" option.
5. Under the "Protocol Settings" section, you will see a list of available TLS versions.
6. Uncheck the box next to any unsafe TLS versions (such as TLS 1.0 or TLS 1.1).
7. Click the "Save" button to apply the changes.

After completing these steps, your resource will no longer support unsafe TLS versions and will be remediated against the misconfiguration.

#### Using CLI

To remediate the "Unsafe TLS Version Supported" misconfiguration in Azure CLI, you can follow these steps:

1. Log in to your Azure account using the Azure CLI command "az login".

2. Once you are logged in, run the following command to check the TLS versions supported by your Azure App Service:

   ```
   az webapp config ssl list --resource-group <resource-group-name> --name <app-service-name> --query "[].{name:to_string(name), minVersion:minTlsVersion, maxVersion:maxTlsVersion}" --output table
   ```

   Replace `<resource-group-name>` with the name of your resource group and `<app-service-name>` with the name of your Azure App Service.

3. The output of the above command will show you the minimum and maximum TLS versions supported by your App Service. If any unsafe TLS versions are supported, you need to disable them.

4. To disable unsafe TLS versions, run the following command:

   ```
   az webapp config ssl update --resource-group <resource-group-name> --name <app-service-name> --min-tls-version 1.2
   ```

   This command will disable all TLS versions except TLS 1.2, which is considered safe.

5. After running the above command, run the first command again to verify that only TLS 1.2 is now supported.

6. Finally, restart your Azure App Service to apply the changes by running the following command:

   ```
   az webapp restart --resource-group <resource-group-name> --name <app-service-name>
   ```

   Replace `<resource-group-name>` with the name of your resource group and `<app-service-name>` with the name of your Azure App Service.

By following these steps, you should be able to remediate the "Unsafe TLS Version Supported" misconfiguration in Azure CLI.

#### Using Python

To remediate the "Unsafe TLS Version Supported" misconfiguration in Python, you can follow the below steps:

1. Identify the TLS version supported by your Python code using the `ssl` module:

```python
import ssl

context = ssl.create_default_context()
print(context.minimum_version)  # This will print the minimum TLS version supported
print(context.maximum_version)  # This will print the maximum TLS version supported
```

2. If the minimum TLS version supported is TLS 1.0 or TLS 1.1, then you need to disable these unsafe versions and enable only TLS 1.2 or higher. This can be done by setting the `PROTOCOL_TLS` constant to `ssl.PROTOCOL_TLSv1_2`:

```python
import ssl

context = ssl.create_default_context(ssl.Purpose.CLIENT_AUTH)
context.options |= ssl.OP_NO_TLSv1 | ssl.OP_NO_TLSv1_1  # Disable TLS 1.0 and TLS 1.1
context.minimum_version = ssl.TLSVersion.TLSv1_2  # Set minimum TLS version to TLS 1.2
```

3. If you are using a third-party library that uses the `requests` module, then you can disable unsafe TLS versions by setting the `REQUESTS_CA_BUNDLE` environment variable to the path of a CA bundle that only includes certificates for TLS 1.2 or higher:

```python
import os
import requests

os.environ['REQUESTS_CA_BUNDLE'] = '/path/to/ca/bundle'
requests.get('https://example.com')
```

By following the above steps, you can remediate the "Unsafe TLS Version Supported" misconfiguration in Python.

