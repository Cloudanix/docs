

<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the Azure portal.
2. Navigate to the Storage Accounts service. Here, you will see a list of all the storage accounts associated with your Azure subscription.
3. Select the storage account you want to check for the minimum TLS version configuration.
4. In the storage account window, scroll down to the "Settings" section and click on "Configuration". Here, you will see the "Minimum TLS version" setting.
5. Check the value of the "Minimum TLS version". If it is not set to the desired version (for example, TLS 1.2), then it is a misconfiguration.

#### Using CLI

1. Install Azure CLI: Before you can use Azure CLI commands, you need to have Azure CLI installed on your system. You can download it from the official Azure website and install it on your system.

2. Login to Azure: Use the following command to login to your Azure account. You will be redirected to the browser for login. Enter your credentials and login.
   ```
   az login
   ```
3. List all storage accounts: Use the following command to list all the storage accounts in your Azure subscription. This will give you a list of all storage accounts along with their details.
   ```
   az storage account list
   ```
4. Check Minimum TLS Version: For each storage account, use the following command to check the minimum TLS version. Replace `<storage-account-name>` with the name of your storage account. The output will show the minimum TLS version for that storage account.
   ```
   az storage account show --name <storage-account-name> --query minimumTlsVersion
   ```
If the output is not TLS1.2, then the storage account is misconfigured.

#### Using Python

To check the minimum TLS version in Azure Storage using Python scripts, you can follow these steps:

1. Install Azure SDK: Azure SDK is required to interact with Azure resources. You can install it using pip:
```python
pip install azure-storage-blob
```

2. Import Required Libraries: Import the necessary libraries into your Python script:
```python
from azure.storage.blob import BlobServiceClient
from azure.core.exceptions import ResourceNotFoundError
```

3. Create a BlobServiceClient: You need to create a BlobServiceClient object by providing the connection string to your Azure storage account. You can get the connection string from the Azure portal.
```python
try:
    blob_service_client = BlobServiceClient.from_connection_string(my_connection_string)
except Exception as ex:
    print('Exception:', ex)
```

4. Check Minimum TLS Version: Now, you can use the get_blob_service_properties method to get the properties of the Blob service, including the minimum TLS version. If the minimum TLS version is less than 1.2, it's a misconfiguration.
```python
try:
    props = blob_service_client.get_blob_service_properties()
    min_tls_version = props.minimum_tls_version
    if min_tls_version < 'TLS1_2':
        print('Misconfiguration Detected: Minimum TLS version is less than 1.2')
    else:
        print('No Misconfiguration Detected: Minimum TLS version is 1.2 or higher')
except ResourceNotFoundError:
    print('Storage account not found.')
except Exception as ex:
    print('Exception:', ex)
```
Please replace 'my_connection_string' with your actual Azure Storage connection string.

</Tab>

<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the "Configure Minimum TLS Version" misconfiguration in Azure using the Azure console, follow these steps:

1. Log in to the Azure portal.

2. Navigate to the resource group containing the affected resource.

3. Select the resource that needs to be remediated.

4. Click on the "Networking" tab in the left-hand menu.

5. Scroll down to the "SSL/TLS settings" section and click on "Edit".

6. In the "Minimum TLS version" dropdown, select the desired minimum version of TLS that should be used.

7. Click on "Save" to apply the changes.

8. Verify that the changes have been applied by running a scan or checking the security compliance report.

Note: It is recommended to use TLS 1.2 or higher as the minimum version to ensure the security of your resources.

#### Using CLI

To remediate the "Configure Minimum TLS Version" misconfiguration for AZURE using AZURE CLI, follow these steps:

1. Open the Azure CLI and log in to your Azure account.

2. Run the following command to set the minimum TLS version to 1.2 for all web apps in your subscription:

   ```
   az webapp config set --min-tls-version 1.2 --ids $(az webapp list --query "[].id" --output tsv)
   ```

   This command uses the `az webapp config set` command to set the minimum TLS version to 1.2 for all web apps in your subscription. The `--ids` parameter uses the `az webapp list` command to get a list of all web app IDs in your subscription and passes them to the `az webapp config set` command.

3. Verify that the minimum TLS version has been set correctly by running the following command:

   ```
   az webapp config show --query "minTlsVersion" --ids $(az webapp list --query "[].id" --output tsv)
   ```

   This command uses the `az webapp config show` command to display the minimum TLS version for all web apps in your subscription.

4. Repeat the above steps for all web apps in your subscription to ensure that the minimum TLS version is set correctly for each app.

By following these steps, you can remediate the "Configure Minimum TLS Version" misconfiguration for AZURE using AZURE CLI.

#### Using Python

To remediate the "Configure Minimum TLS Version" misconfiguration in Azure using Python, you can follow the below steps:

1. Import the necessary libraries:

```python
from azure.mgmt.web import WebSiteManagementClient
from azure.common.credentials import ServicePrincipalCredentials
```

2. Set the credentials for your Azure account using ServicePrincipalCredentials:

```python
subscription_id = 'your_subscription_id'
client_id = 'your_client_id'
secret = 'your_client_secret'
tenant = 'your_tenant_id'

credentials = ServicePrincipalCredentials(
    client_id=client_id,
    secret=secret,
    tenant=tenant
)
```

3. Create a WebSiteManagementClient object using the credentials:

```python
web_client = WebSiteManagementClient(credentials, subscription_id)
```

4. Get the resource group name and app service name for the app you want to remediate:

```python
resource_group_name = 'your_resource_group_name'
app_service_name = 'your_app_service_name'
```

5. Get the current TLS version settings for the app:

```python
app_settings = web_client.web_apps.list_application_settings(resource_group_name, app_service_name)
tls_version = app_settings.properties['WEBSITE_TLS_MIN_VERSION']
```

6. Check if the current TLS version is less than the desired version (e.g. TLS 1.2):

```python
if tls_version != '1.2':
    app_settings.properties['WEBSITE_TLS_MIN_VERSION'] = '1.2'
    web_client.web_apps.update_application_settings(resource_group_name, app_service_name, app_settings)
```

7. If the current TLS version is less than the desired version, update the app settings to set the minimum TLS version to TLS 1.2.

This will remediate the "Configure Minimum TLS Version" misconfiguration for your Azure app using Python.


</Tab>
</Tabs>