---
slug: azure_audit_storageaccount_blob_public_access_allowed
title: Blob Containers Allowing Public Access
sidebar_label: Blob Containers Allowing Public Access
---

### More Info:

Anonymous, public read access to a container and its blobs can be enabled in Azure Blob storage. It grants read-only access to these resources without sharing the account key, and without requiring a shared access signature. It is recommended not to provide anonymous access to blob containers until, and unless, it is strongly desired. A shared access signature token should be used for providing controlled and timed access to blob containers.

### Risk Level

Medium

### Address

Security

### Compliance Standards

SOC2, ISO27001, GDPR, CISAZURE, CBP, NISTCSF



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the Azure portal.
2. Navigate to the Storage Accounts section. Here, you will see a list of all your storage accounts.
3. Select the storage account you want to check. This will open the storage account page.
4. In the storage account page, under the 'Blob service' section, click on 'Containers'. Here, you can see all your blob containers. Check the 'Public access level' for each container. If it is set to 'Blob (anonymous read access for blobs only)' or 'Container (anonymous read access for containers and blobs)', then the blob container is allowing public access.

#### Using CLI

1. Install Azure CLI: Before you can run any Azure CLI commands, you need to install the Azure CLI on your local machine. You can download it from the official Microsoft Azure website.

2. Login to Azure: After installing the Azure CLI, you need to login to your Azure account. You can do this by running the following command in your terminal or command prompt:
   ```
   az login
   ```
   Follow the instructions on the screen to complete the login process.

3. List all storage accounts: Once you are logged in, you can list all the storage accounts in your Azure subscription by running the following command:
   ```
   az storage account list
   ```
   This command will return a JSON object with all the storage accounts. Look for the "name" property in each object, this is the name of the storage account.

4. Check Blob Container Public Access Level: For each storage account, you can check the public access level of the blob containers by running the following command:
   ```
   az storage container list --account-name <storage-account-name> --query "[].{Name:name, PublicAccess:publicAccess}"
   ```
   Replace `<storage-account-name>` with the name of your storage account. This command will return a JSON object with the name of each blob container and its public access level. If the public access level is "blob" or "container", then the blob container allows public access.

#### Using Python

1. Install Azure SDK: To interact with Azure services, you need to install Azure SDK in your Python environment. You can do this using pip:
   ```
   pip install azure-storage-blob
   ```

2. Import Required Libraries: Import the necessary libraries into your Python script:
   ```python
   from azure.storage.blob import BlobServiceClient
   ```

3. Connect to Azure Blob Storage: Use your Azure Blob Storage connection string to connect to your Blob Storage. Replace 'my_connection_string' with your actual connection string.
   ```python
   blob_service_client = BlobServiceClient.from_connection_string('my_connection_string')
   ```

4. Check for Public Access: Iterate over all the blob containers in your storage account and check their public access level. If the access level is not 'None', then the container allows public access.
   ```python
   all_containers = blob_service_client.list_containers(include_metadata=True)
   for container in all_containers:
       if container.public_access is not None:
           print(f"Container {container.name} allows public access.")
   ```
This script will print the names of all containers that allow public access. If no such containers exist, it will print nothing.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

Sure, here are the step-by-step instructions to remediate the issue of Blob Containers Allowing Public Access in Azure:

1. Login to your Azure portal (https://portal.azure.com/).

2. Navigate to the storage account that contains the Blob Container that has public access enabled.

3. Click on the Blob Container that has public access enabled.

4. Click on the "Access Policy" option from the left-hand menu.

5. From the "Public access level" dropdown, select the option "Private (no anonymous access)".

6. Click on the "Save" button to save the changes.

7. Repeat the above steps for all Blob Containers that have public access enabled.

By following the above steps, you have successfully remediated the issue of Blob Containers Allowing Public Access in Azure.

#### Using CLI

The following are the step-by-step instructions to remediate the misconfiguration of Blob Containers Allowing Public Access in AZURE using AZURE CLI:

1. Open the AZURE CLI in your terminal or command prompt.

2. Login to your AZURE account using the following command:
   
   ```
   az login
   ```

3. Once you are logged in, you need to identify the storage account that has the Blob Containers Allowing Public Access. You can list all the storage accounts in your subscription using the following command:

   ```
   az storage account list
   ```

4. From the list of storage accounts, identify the one that has the Blob Containers Allowing Public Access and make a note of its name.

5. Next, you need to list all the containers within the storage account using the following command:

   ```
   az storage container list --account-name <storage-account-name> --query "[].name"
   ```

   Replace `<storage-account-name>` with the name of the storage account that you identified in step 4.

6. From the list of containers, identify the one that has public access and make a note of its name.

7. To revoke public access to the container, you need to set the access level of the container to private using the following command:

   ```
   az storage container set-permission --account-name <storage-account-name> --name <container-name> --public-access off
   ```

   Replace `<storage-account-name>` with the name of the storage account that you identified in step 4 and `<container-name>` with the name of the container that you identified in step 6.

8. Once you have executed the above command, public access to the container will be revoked and only authorized users will be able to access it.

9. Verify that the public access has been revoked by listing the container again using the command in step 5. The output should show that the access level of the container is private.

By following these steps, you can remediate the misconfiguration of Blob Containers Allowing Public Access in AZURE using AZURE CLI.

#### Using Python

To remediate the issue of Blob Containers Allowing Public Access in Azure using Python, you can use the Azure Storage SDK for Python. Here are the steps to follow:

1. Install the Azure Storage SDK for Python using the following command:
   ```
   pip install azure-storage-blob
   ```

2. Use the following code to get a list of all the containers in your storage account:
   ```python
   from azure.storage.blob import BlobServiceClient

   connection_string = "<your_connection_string>"
   blob_service_client = BlobServiceClient.from_connection_string(connection_string)

   container_names = []
   containers = blob_service_client.list_containers()
   for container in containers:
       container_names.append(container.name)
   ```

3. Once you have a list of all the containers, you can iterate over them and set the public access level to `None` using the following code:
   ```python
   from azure.storage.blob import PublicAccess

   for container_name in container_names:
       container_client = blob_service_client.get_container_client(container_name)
       container_client.set_container_access_policy(PublicAccess.None, public_access_duration=None)
   ```

4. Finally, you can check if the public access has been removed by using the following code:
   ```python
   for container_name in container_names:
       container_client = blob_service_client.get_container_client(container_name)
       container_properties = container_client.get_container_properties()
       public_access = container_properties.public_access
       if public_access != PublicAccess.None:
           print(f"Public access is still allowed for container {container_name}")
   ```

By following these steps, you can remediate the issue of Blob Containers Allowing Public Access in Azure using Python.


### Additional Reading:

- [https://docs.microsoft.com/en-us/azure/storage/blobs/storage-manage-access-to-resources](https://docs.microsoft.com/en-us/azure/storage/blobs/storage-manage-access-to-resources) 


</Tab>
</Tabs>