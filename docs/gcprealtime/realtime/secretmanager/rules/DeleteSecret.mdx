--- 
slug: gcp_rt_secretmanager_delete_secret
eventname: google.cloud.secretmanager.v1.SecretManagerService.DeleteSecret
title: DeleteSecret
sidebar_label: google.cloud.secretmanager.v1.SecretManagerService.DeleteSecret
---
                       
### Event Information

#### Meaning

- The `google.cloud.secretmanager.v1.SecretManagerService.DeleteSecret` event in GCP Realtime for SecretManager indicates that a secret has been deleted from the Secret Manager service.
- This event signifies that the specified secret, along with its associated versions and metadata, has been permanently removed from the Secret Manager.
- It is important to note that this event does not provide any details about the specific secret that was deleted, so additional logging or monitoring may be required to track the specific secret being deleted.

#### Example

1. Example of security impact: If an unauthorized user gains access to the event triggering the deletion of a secret in Google Cloud Secret Manager, they could potentially delete sensitive information or credentials stored in the secret. This could lead to unauthorized access to systems or data, compromising the security of the application or infrastructure.

Remediation:
- Implement proper access controls and permissions for the Secret Manager service, ensuring that only authorized users or roles have the necessary privileges to delete secrets.
- Regularly review and audit the access logs and permissions to identify any unauthorized access attempts or suspicious activities.
- Enable versioning for secrets in Secret Manager, so that even if a secret is accidentally deleted, previous versions can be restored.

Example CLI command to delete a secret in Secret Manager:
```
gcloud secrets delete [SECRET_NAME] --project [PROJECT_ID]
```

2. Example of security impact: If the event triggering the deletion of a secret is triggered by a malicious actor or a compromised system, it could result in the deletion of critical secrets used for authentication, encryption, or other security purposes. This could lead to service disruptions, data breaches, or unauthorized access to sensitive information.

Remediation:
- Implement multi-factor authentication (MFA) for the accounts with access to Secret Manager, reducing the risk of unauthorized deletion by compromised credentials.
- Regularly rotate and update the secrets stored in Secret Manager to minimize the impact of potential deletions.
- Enable audit logging for Secret Manager to track and monitor any deletion events, allowing for quick detection and response to any security incidents.

Example CLI command to enable audit logging for Secret Manager:
```
gcloud secrets update [SECRET_NAME] --project [PROJECT_ID] --log-based-acl allAuthenticatedUsers:WRITE
```

3. Example of security impact: If the event triggering the deletion of a secret is triggered by a misconfiguration or a bug in the application or infrastructure, it could result in the accidental deletion of critical secrets. This could lead to service disruptions, data loss, or unauthorized access to sensitive information.

Remediation:
- Implement proper testing and validation procedures for any changes or updates that could potentially trigger the deletion of secrets in Secret Manager.
- Implement backup and recovery mechanisms for secrets, ensuring that deleted secrets can be restored in case of accidental deletions.
- Regularly monitor and review the event logs and metrics related to Secret Manager to identify any abnormal or unexpected deletion events.

Example CLI command to restore a deleted secret in Secret Manager:
```
gcloud secrets versions undelete [SECRET_VERSION] --secret=[SECRET_NAME] --project [PROJECT_ID]
```


 