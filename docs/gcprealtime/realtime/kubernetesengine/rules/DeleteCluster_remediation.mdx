
### Event Information

#### Meaning

- The google.container.v1.ClusterManager.DeleteCluster event in gcprealtime for KubernetesEngine indicates that a cluster in Google Cloud Platform's Kubernetes Engine is being deleted.
- This event signifies that the user or an automated process has initiated the deletion of a Kubernetes cluster.
- It is important to note that this event does not provide details about the reason for deletion or any specific parameters used during the deletion process.

#### Example

- One possible scenario where the security can be impacted with the `google.container.v1.ClusterManager.DeleteCluster` event in GCP Realtime for Kubernetes Engine is if an unauthorized user gains access to the event and deletes a cluster without proper authorization.

Remediation:
- Implement strict access controls and permissions for managing clusters in Kubernetes Engine. Ensure that only authorized users or service accounts have the necessary privileges to delete clusters.
- Enable audit logging for Kubernetes Engine to track and monitor cluster management activities. This will help in identifying any unauthorized deletion attempts and take appropriate actions.

Example CLI command to enable audit logging for Kubernetes Engine:
```
gcloud container clusters update [CLUSTER_NAME] --enable-stackdriver-kubernetes --zone [ZONE]
```

Example Bash script to create a custom IAM role with limited permissions for cluster deletion:
```bash
gcloud iam roles create custom.kubernetes.cluster.deletion --project [PROJECT_ID] --title "Custom Kubernetes Cluster Deletion" --description "Custom role for deleting Kubernetes clusters" --permissions "container.clusters.delete"
```

Example CLI command to assign the custom IAM role to a user or service account:
```
gcloud projects add-iam-policy-binding [PROJECT_ID] --member=[USER_OR_SERVICE_ACCOUNT] --role=projects/[PROJECT_ID]/roles/custom.kubernetes.cluster.deletion
```

