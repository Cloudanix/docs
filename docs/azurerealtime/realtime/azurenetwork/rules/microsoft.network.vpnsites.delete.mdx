--- 
slug: Microsoft.Network.vpnsites.delete
eventname: Microsoft.Network.vpnsites.delete
title: Microsoft.Network.vpnsites.delete
sidebar_label: Microsoft.Network.vpnsites.delete
---
                       
### Event Information

#### Meaning

- The Microsoft.Network.vpnsites.delete event in AzureRealTime for AzureNetwork indicates that a VPN site has been deleted in the Azure network.
- This event signifies that the configuration and resources associated with the VPN site, such as virtual network gateways and connections, have been removed.
- It is important to monitor this event to ensure that the deletion of VPN sites is intentional and does not impact the connectivity and security of the Azure network.

#### Example

1. Example of security impact: If the Microsoft.Network.vpnsites.delete event is triggered in AzureRealTime for AzureNetwork, it could indicate that a VPN site has been deleted from the network. This can potentially impact security if the VPN site was being used for secure communication between on-premises resources and the Azure network. Without the VPN site, the communication may become insecure or unavailable.

Remediation:
- Validate the deletion: Confirm if the VPN site deletion was intentional or accidental. Check the audit logs and review any recent changes made to the network configuration.
- Restore or recreate the VPN site: If the deletion was accidental or unauthorized, restore the VPN site from a backup or recreate it using the appropriate configuration. Ensure that the necessary security measures, such as encryption and authentication, are properly configured.
- Monitor network traffic: Implement network monitoring tools to detect any unauthorized access or unusual network traffic patterns. Regularly review the logs and alerts to identify any potential security breaches.

Azure CLI command to restore a deleted VPN site:
```
az network vnet-gateway update --name <gateway-name> --resource-group <resource-group-name> --set vpnSiteConfigurations=<site-configurations>
```

2. Example of security impact: If the Microsoft.Network.vpnsites.delete event is triggered in AzureRealTime for AzureNetwork, it could indicate that a VPN site with sensitive or confidential data has been deleted. This can lead to data exposure and potential security breaches if the deleted VPN site contained critical information.

Remediation:
- Assess data exposure: Determine the extent of data exposure resulting from the deletion of the VPN site. Identify the types of data that were stored on the site and evaluate the potential impact on security and compliance.
- Activate incident response plan: Follow the organization's incident response plan to mitigate the security risks. This may involve notifying relevant stakeholders, initiating forensic analysis, and implementing additional security measures.
- Enhance data protection: Review and enhance data protection measures, such as encryption, access controls, and data backup strategies. Consider implementing data loss prevention (DLP) solutions to prevent unauthorized data disclosure.

Azure CLI command to enable data loss prevention (DLP) policies:
```
az network vnet-gateway update --name <gateway-name> --resource-group <resource-group-name> --set vpnClientConfiguration.enableBgp=<true/false>
```

3. Example of security impact: If the Microsoft.Network.vpnsites.delete event is triggered in AzureRealTime for AzureNetwork, it could indicate a potential security breach or unauthorized access. An attacker may have gained access to the Azure network and deleted a VPN site to disrupt communication or gain further access to resources.

Remediation:
- Investigate the breach: Conduct a thorough investigation to identify the root cause of the security breach. Analyze the logs, network traffic, and any other available evidence to determine how the attacker gained access and deleted the VPN site.
- Implement security enhancements: Strengthen the security measures in the Azure network by implementing multi-factor authentication, network segmentation, and intrusion detection systems. Regularly update and patch all network components to mitigate known vulnerabilities.
- Incident response and recovery: Follow the incident response plan to contain the breach, remove any malicious presence, and restore the network to a secure state. Monitor the network for any further suspicious activities and apply lessons learned to improve future incident response.

Azure CLI command to enable multi-factor authentication for Azure AD:
```
az ad user update --id <user-id> --password <new-password> --force-change-password-next-login true
```


 