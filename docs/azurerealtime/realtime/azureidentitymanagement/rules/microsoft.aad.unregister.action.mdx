--- 
slug: Microsoft.AAD.unregister.action
eventname: Microsoft.AAD.unregister.action
title: Microsoft.AAD.unregister.action
sidebar_label: Microsoft.AAD.unregister.action
---
                       
### Event Information

#### Meaning

- The Microsoft.AAD.unregister.action event in AzureRealTime for AzureIdentityManagement refers to the action of unregistering an application or service principal from Azure Active Directory (AAD).
- This event indicates that a specific application or service principal has been removed from the Azure AD tenant, and will no longer have access to resources or permissions granted through Azure AD.
- It is important to monitor and track these events to ensure proper management of application and service principal registrations, and to maintain the security and access control of Azure resources.

#### Example

1. Example of security impact: The Microsoft.AAD.unregister.action event in AzureIdentityManagement can potentially impact security if it is triggered by an unauthorized user attempting to unregister an Azure Active Directory (AAD) application. This action can lead to the removal of important permissions and access controls associated with the application, potentially compromising the security of the Azure resources and data it was authorized to access.

Remediation:
- Immediately investigate the event and identify the unauthorized user who triggered the unregister action.
- Disable or revoke the user's access to the Azure portal or any other means they used to perform the action.
- Assess the impact of the unregister action and restore any necessary permissions or access controls that were removed.
- Review and update the security policies and access controls to prevent similar unauthorized actions in the future.
- Enable Azure AD auditing and monitoring to detect and alert on any suspicious or unauthorized activities related to AzureIdentityManagement.

Azure CLI command to enable Azure AD auditing:
```
az monitor diagnostic-settings create --name <diagnostic-settings-name> --resource <resource-id> --resource-type Microsoft.Authorization/policyAssignments --logs '[{"category": "AuditEvent", "enabled": true}]'
```

2. Example of security impact: Another possible security impact of the Microsoft.AAD.unregister.action event in AzureIdentityManagement is if it is triggered by a compromised account or a malicious insider. In this scenario, the unregister action could be used as a way to remove an application's access to Azure resources without proper authorization, potentially leading to unauthorized access or data breaches.

Remediation:
- Immediately disable or revoke the compromised or malicious user's access to the Azure portal or any other means they used to perform the action.
- Assess the impact of the unregister action and restore any necessary permissions or access controls that were removed.
- Conduct a thorough investigation to identify any unauthorized access or data breaches that may have occurred as a result of the unregister action.
- Implement multi-factor authentication (MFA) for all user accounts to prevent unauthorized access even in case of compromised credentials.
- Regularly review and update the security policies, access controls, and user permissions to ensure they align with the principle of least privilege.

Azure CLI command to enable MFA for a user:
```
az ad user update --id <user-id> --force-change-password-next-login true
```

3. Example of security impact: The Microsoft.AAD.unregister.action event in AzureIdentityManagement can also have security implications if it is triggered by a misconfiguration or a mistake made by an authorized user. For example, if an administrator accidentally unregisters a critical AAD application, it can result in service disruptions or loss of access to important resources.

Remediation:
- Immediately investigate the event and identify the user who triggered the unregister action.
- Communicate with the user to understand the reason behind the action and assess the impact of the unregister action.
- If necessary, restore the AAD application or re-register it to regain access to the affected resources.
- Conduct a post-incident review to identify the root cause of the misconfiguration or mistake and implement measures to prevent similar incidents in the future.
- Provide additional training or guidance to administrators to ensure they are aware of the potential consequences of unregistering critical AAD applications.

Azure CLI command to re-register an AAD application:
```
az ad app create --display-name <app-display-name> --identifier-uris <identifier-uris> --reply-urls <reply-urls>
```


 