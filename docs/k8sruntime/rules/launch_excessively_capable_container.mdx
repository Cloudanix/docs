--- 
slug: Launch Excessively Capable Container
rule: Launch Excessively Capable Container
title: Launch Excessively Capable Container
sidebar_label: Launch Excessively Capable Container
---
                   

### Event Information

#### Meaning

- The Launch Excessively Capable Container event in a Kubernetes cluster indicates that a container has been launched with more capabilities than necessary, potentially increasing the attack surface and violating the principle of least privilege.
- This event could be a potential security risk as it allows the container to perform actions that it doesn't require, increasing the chances of unauthorized access or privilege escalation.
- To address this event, it is recommended to review the container's capabilities and ensure that only the necessary capabilities are granted. This can be done by modifying the container's security context or using Kubernetes Pod Security Policies to enforce restrictions on container capabilities.

#### Remediation

Bash Script:
1. Identify the excessively capable container by checking its resource limits and requests using the following command:
   - `kubectl describe pod <pod_name> -n <namespace>`

2. Modify the container's resource limits and requests to align with the desired compliance standards. You can use the following command to edit the pod:
   - `kubectl edit pod <pod_name> -n <namespace>`

3. Update the container's resource limits and requests in the YAML file. For example, if the container name is "my-container" and you want to set CPU limit to 1 core and memory limit to 1GB, modify the YAML as follows:
   ```yaml
   spec:
     containers:
     - name: my-container
       resources:
         limits:
           cpu: "1"
           memory: 1Gi
         requests:
           cpu: "1"
           memory: 1Gi
   ```

Python Script:
1. Use the Kubernetes Python client library to interact with the Kubernetes API and modify the container's resource limits and requests. Install the library using pip:
   - `pip install kubernetes`

2. Import the necessary modules in your Python script:
   ```python
   from kubernetes import client, config
   ```

3. Use the following code snippet to modify the container's resource limits and requests:
   ```python
   # Load the Kubernetes configuration
   config.load_kube_config()

   # Create an instance of the Kubernetes API client
   api = client.CoreV1Api()

   # Get the pod object
   pod = api.read_namespaced_pod(name="<pod_name>", namespace="<namespace>")

   # Modify the container's resource limits and requests
   pod.spec.containers[0].resources.limits = {"cpu": "1", "memory": "1Gi"}
   pod.spec.containers[0].resources.requests = {"cpu": "1", "memory": "1Gi"}

   # Update the pod
   api.patch_namespaced_pod(name="<pod_name>", namespace="<namespace>", body=pod)
   ```

Note: Replace `<pod_name>` and `<namespace>` with the actual pod name and namespace where the excessively capable container is running.

 