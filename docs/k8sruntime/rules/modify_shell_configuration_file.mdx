--- 
slug: Modify Shell Configuration File
rule: Modify Shell Configuration File
title: Modify Shell Configuration File
sidebar_label: Modify Shell Configuration File
---
                   

### Event Information

#### Meaning

- The Modify Shell Configuration File event in a Kubernetes cluster indicates that there has been an attempt to modify the configuration file of the shell (e.g., bashrc, profile) within a container.
- This event could potentially indicate unauthorized access or an attempt to escalate privileges within the container.
- It is important to investigate this event further to determine the intent and impact of the modification, as it may violate compliance standards and security best practices.

To investigate further:
1. Use the `kubectl exec` command to access the container where the event occurred: `kubectl exec -it <pod_name> -c <container_name> -- /bin/bash`
2. Check the shell configuration file for any unauthorized modifications: `cat <shell_config_file>`
3. Review the container's logs and audit logs to identify any suspicious activities or potential security breaches.

#### Remediation

To remediate the falco event "Modify Shell Configuration File" using a bash script or kubectl commands, you can follow these steps:

1. Bash Script:
   - Create a bash script, e.g., `remediate.sh`, with the following content:
     ```bash
     #!/bin/bash
     cp /path/to/original/shell/config /path/to/backup/shell/config
     cp /path/to/new/shell/config /path/to/original/shell/config
     ```
   - Replace `/path/to/original/shell/config` with the actual path to the original shell configuration file.
   - Replace `/path/to/backup/shell/config` with the actual path where you want to store the backup of the original shell configuration file.
   - Replace `/path/to/new/shell/config` with the actual path to the new shell configuration file that you want to replace the original file with.
   - Make the script executable: `chmod +x remediate.sh`
   - Run the script: `./remediate.sh`

2. Kubectl Commands:
   - If the shell configuration file is stored in a Kubernetes ConfigMap, you can update it using the following kubectl command:
     ```bash
     kubectl create configmap shell-config --from-file=/path/to/new/shell/config --dry-run=client -o yaml | kubectl apply -f -
     ```
   - Replace `/path/to/new/shell/config` with the actual path to the new shell configuration file.
   - This command creates a new ConfigMap named `shell-config` and updates it with the contents of the new shell configuration file.
   - If the ConfigMap already exists, it will be updated with the new contents.

3. Python Script:
   - If you want to use the remediation script within a Python script, you can execute the bash script or kubectl command using the `subprocess` module.
   - Example using `subprocess` module to execute the bash script:
     ```python
     import subprocess
     
     subprocess.run(["./remediate.sh"], check=True)
     ```
   - Example using `subprocess` module to execute the kubectl command:
     ```python
     import subprocess
     
     subprocess.run(["kubectl", "create", "configmap", "shell-config", "--from-file=/path/to/new/shell/config", "--dry-run=client", "-o", "yaml"], check=True)
     ```
   - Replace `/path/to/new/shell/config` with the actual path to the new shell configuration file.

 