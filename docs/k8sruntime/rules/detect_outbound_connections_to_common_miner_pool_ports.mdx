--- 
slug: Detect outbound connections to common miner pool ports
rule: Detect outbound connections to common miner pool ports
title: Detect outbound connections to common miner pool ports
sidebar_label: Detect outbound connections to common miner pool ports
---
                   

### Event Information

#### Meaning

- This event indicates that a pod in the Kubernetes cluster is making outbound connections to common miner pool ports. Miner pool ports are commonly used by cryptocurrency mining software to connect to mining pools for resource-intensive mining operations.
- It could be a sign of unauthorized cryptocurrency mining activity taking place within the cluster, which can consume significant computing resources and impact the performance of other applications running in the cluster.
- To investigate this event, you can use the following kubectl command to identify the pod making the outbound connections: `kubectl get pods --all-namespaces -o wide`. This will provide information about the pods running in the cluster, including their IP addresses and namespaces.

#### Remediation

1. Bash script:
   - Use `netstat` command to identify outbound connections to common miner pool ports. For example, to check for connections to port 3333, you can use the following command:
     ```bash
     netstat -tn | awk '$4 ~ /:3333$/ {print $5}'
     ```
   - Iterate over the output of the above command and take appropriate actions, such as terminating the connection or blocking the IP address.

2. Kubectl commands:
   - Use `kubectl get pods` command to list all running pods in the cluster.
   - Use `kubectl exec` command to execute a command inside a specific pod. For example, to execute `netstat` command inside a pod named `my-pod`, you can use the following command:
     ```bash
     kubectl exec my-pod -- netstat -tn | awk '$4 ~ /:3333$/ {print $5}'
     ```
   - Iterate over the output of the above command and take appropriate actions, such as terminating the connection or blocking the IP address.

3. Python script:
   - Use the `subprocess` module in Python to execute the `netstat` command or the `kubectl exec` command.
   - Parse the output of the command to identify the outbound connections to common miner pool ports.
   - Implement the necessary logic to take appropriate actions, such as terminating the connection or blocking the IP address, within your Python script.

 