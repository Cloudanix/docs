
### Event Information

#### Meaning

- The "Run shell untrusted" event in a Kubernetes cluster indicates that a shell command was executed within a container running in the cluster, and it was flagged as untrusted.
- This event typically occurs when a user or process attempts to run a shell command that is not allowed or violates the security policies defined for the cluster.
- It is important to investigate this event further to determine the source of the command and assess whether it poses a security risk or violates any compliance standards.

To investigate the "Run shell untrusted" event in a Kubernetes cluster, you can:
1. Use the `kubectl get pods` command to identify the pod in which the event occurred.
2. Use the `kubectl logs <pod-name>` command to view the logs of the container associated with the pod, which may provide more information about the untrusted shell command.
3. Review the security policies and access controls in place to identify any potential vulnerabilities or misconfigurations that allowed the untrusted command to be executed.

Note: The specific commands may vary depending on the Kubernetes distribution and configuration.

#### Remediation

1. Identify the affected pod: Use the `kubectl get pods` command to list all the pods in the cluster. Look for the pod that triggered the "Run shell untrusted" event in the falco logs.

2. Review the pod's configuration: Use the `kubectl describe pod <pod_name>` command to get detailed information about the pod. Check if any untrusted shell commands are being executed within the pod.

3. Update the pod's security context: If the pod allows untrusted shell commands, update its security context to restrict shell access. Modify the pod's YAML file and add the `securityContext` section with appropriate settings, such as setting `runAsNonRoot: true` and `allowPrivilegeEscalation: false`. Then, apply the changes using `kubectl apply -f <pod_yaml_file>`.

Note: It is important to review the specific requirements and constraints of your environment and compliance standards before implementing any changes.

