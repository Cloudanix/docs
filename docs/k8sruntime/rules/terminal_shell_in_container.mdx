--- 
slug: Terminal shell in container
rule: Terminal shell in container
title: Terminal shell in container
sidebar_label: Terminal shell in container
---
                   

### Event Information

#### Meaning

- The Terminal shell in container event in a Kubernetes cluster refers to a situation where a shell is opened within a container running in the cluster.
- This event can indicate potential security risks, as it may suggest unauthorized access or an attacker gaining control over the container.
- To investigate this event, you can use the `kubectl exec` command to access the container and inspect the shell activity. For example, `kubectl exec -it <pod-name> -- /bin/bash` allows you to open a shell within the container and analyze any suspicious activities or unauthorized access.

#### Remediation

To remediate the falco event "Terminal shell in container", you can follow these steps:

1. Identify the affected container:
   - Use the `kubectl get pods` command to list all the running pods in the cluster.
   - Find the pod that corresponds to the container where the event occurred.
   - Note down the pod name.

2. Delete the affected pod:
   - Use the `kubectl delete pod <pod-name>` command to delete the pod.
   - Kubernetes will automatically create a new pod to replace the deleted one.

3. Implement preventive measures:
   - Consider implementing Pod Security Policies (PSP) to restrict the usage of privileged containers or host namespaces.
   - Regularly review and update the security policies to align with compliance standards.
   - Monitor and audit container activities using tools like Kubernetes Audit Logs or Falco to detect and prevent unauthorized access.

Here's an example of a bash script that incorporates the above steps:

```bash
#!/bin/bash

# Step 1: Identify the affected container
pod_name="<pod-name>"

# Step 2: Delete the affected pod
kubectl delete pod "$pod_name"

# Step 3: Implement preventive measures (optional)
# Implement Pod Security Policies or other security measures as per your requirements
```

You can use this script in your Python script by calling it using the `subprocess` module. Here's an example:

```python
import subprocess

script_path = "/path/to/remediation_script.sh"
subprocess.run(["bash", script_path], check=True)
```

Make sure to replace `<pod-name>` with the actual name of the affected pod in the bash script.

 