--- 
slug: Polkit Local Privilege Escalation Vulnerability (CVE-2021-4034)
rule: Polkit Local Privilege Escalation Vulnerability (CVE-2021-4034)
title: Polkit Local Privilege Escalation Vulnerability (CVE-2021-4034)
sidebar_label: Polkit Local Privilege Escalation Vulnerability (CVE-2021-4034)
---
                   
### Event Information

#### Meaning

- The Polkit Local Privilege Escalation Vulnerability (CVE-2021-4034) event indicates a potential security vulnerability in the Polkit service running within the Kubernetes cluster.
- This vulnerability allows a local attacker to escalate their privileges and gain unauthorized access to sensitive resources or perform unauthorized actions.
- To mitigate this vulnerability, it is recommended to update the affected Polkit package to a patched version. You can use the following kubectl command to check if any pods are using the vulnerable Polkit version: `kubectl get pods --all-namespaces -o=jsonpath='{range .items[*]}{.metadata.name}{"\t"}{.spec.containers[*].image}{"\n"}{end}' | grep polkit`. If any pods are using the vulnerable version, update the respective container images to a patched version.

Note: The specific steps to update the Polkit package may vary depending on the Linux distribution used in the Kubernetes cluster. It is recommended to refer to the official documentation or consult with the Linux distribution's support for detailed instructions.

#### Remediation

1. Identify the affected nodes: Use the kubectl command `kubectl get nodes` to list all the nodes in your Kubernetes cluster. Look for the nodes that are running the vulnerable version of Polkit.

2. Update the affected nodes: SSH into each affected node and update the Polkit package to the latest version that includes the fix for CVE-2021-4034. The specific command may vary depending on the Linux distribution used in your cluster. For example, on Ubuntu, you can use the command `sudo apt-get update && sudo apt-get upgrade polkit` to update the package.

3. Verify the fix: After updating the Polkit package on all affected nodes, verify that the vulnerable version is no longer present. You can use the command `dpkg -l | grep polkit` to check the installed version. Ensure that the version number corresponds to the patched version that addresses CVE-2021-4034.


 