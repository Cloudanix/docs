--- 
slug: Drop and execute new binary in container
rule: Drop and execute new binary in container
title: Drop and execute new binary in container
sidebar_label: Drop and execute new binary in container
---
                   

### Event Information

#### Meaning

- The "Drop and execute new binary in container" event in a Kubernetes cluster indicates that a container has attempted to drop a file and execute it as a binary within the container.
- This event could potentially indicate a malicious activity, as dropping and executing new binaries within a container can be a security risk.
- To investigate this event, you can use the following steps:
  1. Identify the affected container using the container name or ID.
  2. Inspect the dropped file to determine its origin and purpose.
  3. Analyze the container's configuration and image to identify any potential vulnerabilities or misconfigurations that may have allowed this event to occur.

#### Remediation

1. Create a bash script to download and execute the new binary in the container:
```bash
#!/bin/bash

# Download the new binary
wget <binary_url> -O /tmp/new_binary

# Make the binary executable
chmod +x /tmp/new_binary

# Execute the new binary
/tmp/new_binary
```

2. Use kubectl commands to execute the bash script in the container:
```bash
# Copy the bash script to the container
kubectl cp <path_to_script.sh> <pod_name>:/tmp/script.sh

# Execute the bash script in the container
kubectl exec -it <pod_name> -- /bin/bash /tmp/script.sh
```

3. Modify the python script to include the execution of the new binary:
```python
import subprocess

# Execute the new binary using subprocess
subprocess.call(['/tmp/new_binary'])
```

Note: Replace `<binary_url>` with the actual URL of the new binary, `<path_to_script.sh>` with the path to the bash script, and `<pod_name>` with the name of the pod where the container is running.

 