--- 
slug: Write below root
rule: Write below root
title: Write below root
sidebar_label: Write below root
---
                   

### Event Information

#### Meaning

- The "Write below root" event in a Kubernetes cluster indicates that a process running within a container attempted to write or modify files or directories that are located below the root directory ("/") of the file system.
- This event can be a potential security concern as it may indicate unauthorized access or tampering with critical system files.
- To investigate further, you can use the kubectl command to check the logs of the container where the event occurred, and analyze the specific file or directory that was being modified. For example: `kubectl logs <pod_name> -c <container_name>`.

#### Remediation

To remediate the falco event "Write below root" using a bash script or kubectl commands, you can follow these steps:

1. Bash Script:
   - Create a bash script, e.g., `remediate.sh`, with the following content:
     ```bash
     #!/bin/bash
     sudo chown root:root /path/to/file
     sudo chmod 644 /path/to/file
     ```
   - Replace `/path/to/file` with the actual path of the file that was written below root.
   - Make the script executable by running `chmod +x remediate.sh`.
   - Run the script using `./remediate.sh` to remediate the issue.

2. Kubectl Commands:
   - If the file is located inside a Kubernetes pod, you can use the following kubectl commands to remediate the issue:
     ```bash
     kubectl exec <pod_name> -- chown root:root /path/to/file
     kubectl exec <pod_name> -- chmod 644 /path/to/file
     ```
   - Replace `<pod_name>` with the actual name of the pod where the file is located.
   - Replace `/path/to/file` with the actual path of the file that was written below root.

3. Python Script:
   - If you want to incorporate the remediation steps into a Python script, you can use the `subprocess` module to execute the bash commands.
   - Here's an example:
     ```python
     import subprocess
     
     file_path = "/path/to/file"
     
     subprocess.run(["sudo", "chown", "root:root", file_path])
     subprocess.run(["sudo", "chmod", "644", file_path])
     ```
   - Replace `/path/to/file` with the actual path of the file that was written below root.
   - Make sure the Python script is executed with appropriate privileges to run the `sudo` commands.

 