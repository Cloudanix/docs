--- 
slug: Program run with disallowed http proxy env
rule: Program run with disallowed http proxy env
title: Program run with disallowed http proxy env
sidebar_label: Program run with disallowed http proxy env
---
                   
### Event Information

#### Meaning

- This event indicates that a program running in the Kubernetes cluster is attempting to use an HTTP proxy environment variable that is not allowed.
- It suggests that the program is trying to bypass network restrictions or security measures by using an unauthorized proxy.
- This event could be a potential violation of compliance standards, as it may indicate an attempt to access unauthorized resources or bypass network monitoring.

To investigate and mitigate this event, you can:
1. Identify the specific program causing the event by checking the `proc.name` field in the Falco output.
2. Inspect the deployment or pod configuration of the identified program using `kubectl describe deployment <deployment-name>` or `kubectl describe pod <pod-name>` to check if any unauthorized proxy environment variables are set.
3. Remove or modify the unauthorized proxy environment variables in the deployment or pod configuration to ensure compliance with the organization's policies.

#### Remediation

1. Identify the affected pod: Use the `kubectl get pods` command to list all the pods in the cluster. Look for the pod that triggered the "Program run with disallowed http proxy env" event.

2. Update the pod's configuration: Edit the pod's YAML file using `kubectl edit pod <pod_name>` and remove or modify the environment variable that specifies the disallowed HTTP proxy. Save the changes and exit the editor.

3. Restart the pod: Use the `kubectl delete pod <pod_name>` command to delete the pod. Kubernetes will automatically create a new pod based on the updated configuration. Monitor the new pod to ensure it starts successfully and the event is no longer triggered.

Note: It is important to review and understand the compliance standards and policies in place before making any changes to the pod's configuration.


 