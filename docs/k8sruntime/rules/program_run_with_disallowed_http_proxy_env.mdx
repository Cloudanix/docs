--- 
slug: Program run with disallowed http proxy env
rule: Program run with disallowed http proxy env
title: Program run with disallowed http proxy env
sidebar_label: Program run with disallowed http proxy env
---
                   


### Event Information

#### Meaning

- This event indicates that a program running in the Kubernetes cluster is attempting to use an HTTP proxy environment variable that is not allowed.
- It suggests that the program is trying to bypass network restrictions or security measures by using an unauthorized proxy.
- This event could be a potential violation of compliance standards, as it may indicate an attempt to access unauthorized resources or bypass network monitoring.

To investigate and mitigate this event, you can:
- Identify the specific program causing the event by checking the `proc.name` field in the event output.
- Use `kubectl exec` to access the container running the program and inspect its environment variables using the command `kubectl exec <pod-name> -- env`.
- Remove or modify the disallowed HTTP proxy environment variable from the program's configuration or deployment manifest.
- Ensure that only authorized HTTP proxy environment variables are allowed in the cluster, following compliance standards and security best practices.

#### Remediation

1. Identify the pod that triggered the event:
   - Use `kubectl get pods` to list all the pods in the cluster.
   - Look for the pod that triggered the event based on the timestamp or other relevant information.

2. Update the pod's YAML manifest file:
   - Use `kubectl get pod <pod_name> -o yaml > pod.yaml` to export the pod's YAML manifest to a file.
   - Open the `pod.yaml` file and locate the `env` section under `spec.containers`.
   - Remove or comment out any environment variables related to the disallowed http proxy.

3. Apply the updated manifest file:
   - Use `kubectl apply -f pod.yaml` to apply the changes and update the pod.
   - Verify that the pod is running without the disallowed http proxy environment variable using `kubectl get pods` or `kubectl describe pod <pod_name>`.

 