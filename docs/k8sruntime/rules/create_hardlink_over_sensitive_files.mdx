--- 
slug: Create Hardlink Over Sensitive Files
rule: Create Hardlink Over Sensitive Files
title: Create Hardlink Over Sensitive Files
sidebar_label: Create Hardlink Over Sensitive Files
---
                   

### Event Information

#### Meaning

- The Create Hardlink Over Sensitive Files event in a Kubernetes cluster indicates that a process attempted to create a hardlink to a sensitive file. 
- This event could potentially be a security concern as it may indicate an unauthorized attempt to modify or access sensitive data. 
- It is important to investigate the source of this event and take appropriate actions to ensure the integrity and confidentiality of the sensitive files in the cluster. 

To investigate further, you can:
- Use kubectl to check the logs of the relevant pod or container to identify the process that triggered the event.
- Inspect the file system permissions and ownership of the sensitive files to ensure they are properly secured.
- Consider implementing file integrity monitoring tools or auditing mechanisms to detect and prevent unauthorized modifications to sensitive files.

#### Remediation

To remediate the falco event "Create Hardlink Over Sensitive Files" using a bash script or kubectl commands, you can follow these steps:

1. Bash Script:
   - Identify the sensitive files that should not have hardlinks created. This could be a predefined list or a pattern-based approach.
   - Use the `find` command to search for any hardlinks to these sensitive files.
   - Use the `rm` command to remove the hardlinks found in the previous step.
   - Save the script as a `.sh` file and make it executable using the `chmod +x` command.
   - Run the script whenever the falco event is triggered.

2. Kubectl Commands:
   - Identify the Kubernetes pod where the falco event occurred.
   - Use the `kubectl exec` command to execute a shell command inside the pod.
   - Inside the pod, run the necessary commands to identify and remove the hardlinks, similar to the bash script approach.
   - You can use tools like `find` and `rm` inside the pod to perform the required operations.
   - Automate the execution of the kubectl commands by integrating them into a Python script using the `subprocess` module.

3. Python Script:
   - Use the `subprocess` module in Python to execute the kubectl commands mentioned in the previous step.
   - Write a Python script that captures the falco event and triggers the execution of the kubectl commands.
   - You can use libraries like `pyinotify` or `watchdog` to monitor the falco events in real-time.
   - When the event is detected, the Python script should execute the kubectl commands to remediate the issue.
   - Ensure that the Python script is running continuously to monitor and remediate any future occurrences of the falco event.

Remember to test the remediation script thoroughly in a non-production environment before deploying it to a production environment.

 