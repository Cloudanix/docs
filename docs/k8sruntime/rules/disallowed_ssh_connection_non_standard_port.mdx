--- 
slug: Disallowed SSH Connection Non Standard Port
rule: Disallowed SSH Connection Non Standard Port
title: Disallowed SSH Connection Non Standard Port
sidebar_label: Disallowed SSH Connection Non Standard Port
---
                   

### Event Information

#### Meaning

- The Disallowed SSH Connection Non Standard Port event in a Kubernetes cluster indicates that an attempt was made to establish an SSH connection using a non-standard port.
- This event suggests a potential security risk as SSH connections on non-standard ports are often used to evade detection or exploit vulnerabilities.
- To investigate this event, you can use kubectl to check the logs of the relevant pod or container where the event occurred. For example, you can use the command `kubectl logs <pod_name>` to view the logs and look for any suspicious activities related to SSH connections.

#### Remediation

To generate a remediation script for the "Disallowed SSH Connection Non Standard Port" event, you can use a bash script or kubectl commands. Here's an example of how you can achieve this:

Bash Script:
1. Create a bash script file, e.g., "remediate_ssh.sh".
2. Use the "sed" command to modify the SSH configuration file (usually "/etc/ssh/sshd_config") and change the port to the standard SSH port (22).
   - Example command: `sed -i 's/Port [0-9]*/Port 22/' /etc/ssh/sshd_config`
3. Restart the SSH service to apply the changes.
   - Example command: `service ssh restart`

Python Script:
1. Import the "subprocess" module in your Python script.
2. Use the "subprocess.run()" function to execute the necessary kubectl commands.
   - Example command: `subprocess.run(["kubectl", "edit", "configmap/falco-config"])`
3. In the kubectl command, modify the "falco-config" ConfigMap to update the SSH port to the standard port (22).
   - Example command: `subprocess.run(["kubectl", "edit", "configmap/falco-config"])`

Please note that the actual commands may vary depending on your specific environment and configurations. Ensure that you have the necessary permissions to execute these commands and consider compliance standards before making any changes.

 