--- 
slug: ChangeResourceRecordSets
eventname: ChangeResourceRecordSets
title: ChangeResourceRecordSets
sidebar_label: ChangeResourceRecordSets
---
                       
### Event Information

#### Meaning

- The ChangeResourceRecordSets event in AWS Route53 refers to a change made to the resource record sets associated with a hosted zone.
- This event indicates that a modification has been made to the DNS records, such as adding, updating, or deleting resource record sets.
- It is a real-time event that can be used to track changes to the DNS configuration and monitor the health and availability of the associated resources.

#### Example

1. Example of security impact: If an unauthorized user gains access to the AWS account and performs a ChangeResourceRecordSets event in Route53, they can potentially modify DNS records to redirect traffic to malicious websites or intercept sensitive information.

Remediation:
- Enable multi-factor authentication (MFA) for the AWS account to add an extra layer of security.
- Regularly review and monitor AWS CloudTrail logs to detect any unauthorized or suspicious activities.
- Implement AWS Identity and Access Management (IAM) policies to restrict access to Route53 resources only to authorized users or roles.
- Enable AWS Config to continuously monitor and assess the compliance of Route53 configurations.
- Regularly backup Route53 DNS records to quickly restore them in case of any unauthorized changes.

Example CLI commands:
- Enable MFA for the AWS account:
  ```
  aws iam enable-mfa-device --user-name <user-name> --serial-number <mfa-serial-number> --authentication-code1 <code1> --authentication-code2 <code2>
  ```

- Review CloudTrail logs:
  ```
  aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=ChangeResourceRecordSets
  ```

- Restrict access to Route53 resources using IAM policies:
  ```
  aws iam create-policy --policy-name <policy-name> --policy-document file://policy.json
  ```

- Enable AWS Config for Route53:
  ```
  aws configservice put-configuration-recorder --configuration-recorder-name default --recording-group allSupported
  ```

- Backup Route53 DNS records:
  ```
  aws route53 create-hosted-zone-backup --id <hosted-zone-id> --name <backup-name>
  ```


2. Example of security impact: If a misconfiguration occurs during a ChangeResourceRecordSets event in Route53, it can lead to unintended exposure of sensitive information or services, such as exposing internal IP addresses or redirecting traffic to incorrect resources.

Remediation:
- Implement infrastructure as code (IaC) practices using tools like AWS CloudFormation or Terraform to ensure consistent and secure Route53 configurations.
- Regularly perform security assessments and vulnerability scans to identify any misconfigurations or weaknesses in Route53 setups.
- Implement AWS WAF (Web Application Firewall) to protect against common web exploits and attacks.
- Enable DNSSEC (Domain Name System Security Extensions) to add an extra layer of security and prevent DNS spoofing or tampering.

Example CLI commands:
- Deploy Route53 configurations using AWS CloudFormation:
  ```
  aws cloudformation create-stack --stack-name <stack-name> --template-body file://template.yaml
  ```

- Perform security assessment using AWS Inspector:
  ```
  aws inspector start-assessment-run --assessment-template-arn <template-arn>
  ```

- Configure AWS WAF for Route53:
  ```
  aws wafv2 create-web-acl --name <acl-name> --scope REGIONAL --default-action Allow --rules file://rules.json
  ```

- Enable DNSSEC for a hosted zone:
  ```
  aws route53 enable-hosted-zone-dnssec --hosted-zone-id <hosted-zone-id>
  ```


3. Example of security impact: If an attacker gains access to the AWS account and performs a ChangeResourceRecordSets event in Route53, they can potentially modify DNS records to perform DNS hijacking attacks, redirecting legitimate traffic to malicious servers.

Remediation:
- Implement strong access controls and regularly rotate AWS access keys to minimize the risk of unauthorized access.
- Enable AWS CloudTrail logging and configure alerts for any ChangeResourceRecordSets events to detect and respond to unauthorized changes promptly.
- Implement DNS-based security solutions like DNS filtering or DNSSEC to protect against DNS hijacking attacks.
- Regularly review and monitor DNS records for any unauthorized changes or suspicious activities.

Example CLI commands:
- Rotate AWS access keys:
  ```
  aws iam update-access-key --access-key-id <access-key-id> --status Inactive
  aws iam create-access-key --user-name <user-name>
  ```

- Enable CloudTrail logging:
  ```
  aws cloudtrail create-trail --name <trail-name> --s3-bucket-name <bucket-name> --is-multi-region-trail
  ```

- Implement DNS filtering using AWS Firewall Manager:
  ```
  aws fms put-policy --policy <policy-json>
  ```

- Monitor DNS records for changes:
  ```
  aws route53 list-resource-record-sets --hosted-zone-id <hosted-zone-id>
  ```


 