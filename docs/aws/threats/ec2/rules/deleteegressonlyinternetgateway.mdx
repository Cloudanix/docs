--- 
slug: DeleteEgressOnlyInternetGateway
eventname: DeleteEgressOnlyInternetGateway
title: DeleteEgressOnlyInternetGateway
sidebar_label: DeleteEgressOnlyInternetGateway
---
                       
### Event Information

#### Meaning

- The DeleteEgressOnlyInternetGateway event in AWS for EC2 refers to the deletion of an egress-only internet gateway.
- An egress-only internet gateway is a horizontally scaled, redundant, and highly available VPC component that allows outbound communication over IPv6 from instances in a VPC to the internet, while preventing inbound communication from the internet.
- This event indicates that the egress-only internet gateway has been successfully deleted, removing the ability for instances in the VPC to communicate with the internet over IPv6.

### Remediation

#### Using Console

- Example of security impact: If an attacker gains unauthorized access to an EC2 instance and deletes the egress-only internet gateway, it can potentially allow the instance to communicate with the internet directly, bypassing any security controls or network restrictions in place.

- Remediation steps using AWS console:
  1. Log in to the AWS Management Console.
  2. Navigate to the EC2 service.
  3. Select the desired EC2 instance that needs to be secured.
  4. In the "Actions" dropdown menu, choose "Modify Instance Security Groups".
  5. Review the existing security groups associated with the instance.
  6. Add or modify the security groups to ensure that the instance only allows necessary inbound and outbound traffic.
  7. Save the changes and verify that the egress-only internet gateway is not deleted or modified.
  8. Regularly monitor the security groups and network configurations to detect any unauthorized changes.

#### Using CLI

- Example of security impact: If an attacker gains unauthorized access to an EC2 instance and deletes the egress-only internet gateway, it can potentially allow the instance to establish outbound connections to the internet, bypassing any network security controls or restrictions in place.

- Remediation using AWS CLI:
  1. Identify the affected EC2 instance: `aws ec2 describe-instances --instance-ids <instance-id>`
  2. Check if the egress-only internet gateway is deleted: `aws ec2 describe-instances --instance-ids <instance-id> --query 'Reservations[].Instances[].NetworkInterfaces[].Attachment[].EgressOnlyInternetGatewayId'`
  3. If the egress-only internet gateway is deleted, recreate it: `aws ec2 create-egress-only-internet-gateway --vpc-id <vpc-id>`

Note: Replace `<instance-id>` with the actual instance ID and `<vpc-id>` with the actual VPC ID in the above commands.

#### Using Python

1. Example of security impact with DeleteEgressOnlyInternetGateway in AWS EC2:
   - If the DeleteEgressOnlyInternetGateway action is misused or unauthorized, it can lead to the removal of an egress-only internet gateway (EIGW) associated with an EC2 instance. This can result in loss of outbound internet connectivity for the affected instance, potentially impacting the availability and functionality of applications or services running on that instance.

2. Remediation for AWS EC2 using Python:
   - To remediate the security impact of unauthorized DeleteEgressOnlyInternetGateway actions in AWS EC2, you can implement the following steps using Python and the AWS SDK (boto3):

   ```python
   import boto3

   def remediate_delete_egress_only_internet_gateway(instance_id):
       ec2_client = boto3.client('ec2')

       # Get the EgressOnlyInternetGatewayId associated with the instance
       response = ec2_client.describe_instances(InstanceIds=[instance_id])
       egress_only_internet_gateway_id = response['Reservations'][0]['Instances'][0]['NetworkInterfaces'][0]['Attachment']['EgressOnlyInternetGatewayId']

       # Reattach the EgressOnlyInternetGateway to the instance
       response = ec2_client.attach_internet_gateway(
           InternetGatewayId=egress_only_internet_gateway_id,
           VpcId=response['Reservations'][0]['Instances'][0]['VpcId']
       )

       # Verify the attachment status
       if response['ResponseMetadata']['HTTPStatusCode'] == 200:
           print("EgressOnlyInternetGateway reattached successfully.")
       else:
           print("Failed to reattach EgressOnlyInternetGateway.")

   # Provide the EC2 instance ID as an argument to the remediation function
   remediate_delete_egress_only_internet_gateway('your-instance-id')
   ```

   This Python script retrieves the EgressOnlyInternetGatewayId associated with the specified EC2 instance and reattaches it to the instance's VPC using the `attach_internet_gateway` API. This restores the outbound internet connectivity for the affected instance, mitigating the security impact of the unauthorized DeleteEgressOnlyInternetGateway action.


 