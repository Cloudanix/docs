--- 
slug: CreatePolicyVersion
eventname: CreatePolicyVersion
title: CreatePolicyVersion
sidebar_label: CreatePolicyVersion
---
                       
### Event Information

- The CreatePolicyVersion event in AWS for IAM refers to the action of creating a new version of an IAM policy.
- This event is triggered when a user or an automated process creates a new version of an existing IAM policy.
- Each version of an IAM policy represents a snapshot of the policy at a specific point in time and can be used to track changes and manage policy updates.


### Examples

1. Insecure permissions: When creating a new policy version using CreatePolicyVersion in AWS IAM, it is important to ensure that the permissions granted in the policy are secure. For example, if the policy allows unrestricted access to sensitive resources or actions, it can lead to unauthorized access and compromise the security of the system.

2. Misconfigured policies: Creating a new policy version can introduce misconfigurations if not carefully reviewed. For instance, if the policy version inadvertently grants excessive permissions or includes incorrect resource identifiers, it can result in unintended access or resource exposure.

3. Lack of version control: CreatePolicyVersion allows for the creation of multiple versions of a policy. If proper version control is not maintained, it can lead to confusion and potential security issues. For example, if an outdated or insecure policy version is mistakenly applied, it can result in unauthorized access or compromise the system's security posture.

### Remediation

#### Using Console

1. Insecure permissions:
   - Step 1: Log in to the AWS Management Console.
   - Step 2: Navigate to the IAM service.
   - Step 3: Select "Policies" from the left-hand menu.
   - Step 4: Search for the policy you want to create a new version for and click on its name.
   - Step 5: In the policy details page, click on the "Create version" button.
   - Step 6: Review the policy document and ensure that the permissions granted are secure and follow the principle of least privilege.
   - Step 7: Click on the "Create version" button to create the new policy version.
   - Step 8: Once the new version is created, you can review and manage the policy versions from the policy details page.

2. Misconfigured policies:
   - Follow steps 1 to 5 from the previous instructions.
   - Step 6: Review the policy document and carefully check for any misconfigurations, such as excessive permissions or incorrect resource identifiers.
   - Step 7: Make the necessary changes to the policy document to correct any misconfigurations.
   - Step 8: Click on the "Create version" button to create the new policy version with the corrected configuration.
   - Step 9: Once the new version is created, you can review and manage the policy versions from the policy details page.

3. Lack of version control:
   - Follow steps 1 to 5 from the first set of instructions.
   - Step 6: Review the policy document and ensure that it reflects the desired changes for the new version.
   - Step 7: Click on the "Create version" button to create the new policy version.
   - Step 8: Once the new version is created, you can review and manage the policy versions from the policy details page.
   - Step 9: Regularly review and update the policy versions as needed, ensuring that the most up-to-date and secure version is applied when necessary.

#### Using CLI

1. Insecure permissions: To remediate insecure permissions when creating a new policy version in AWS IAM using AWS CLI, follow these steps:
   - Review the policy document to ensure that only necessary and least privilege permissions are granted.
   - Use the `create-policy-version` command to create a new policy version, specifying the policy ARN and the updated policy document.
   - Before promoting the new policy version to the default version, thoroughly test it to ensure it does not grant unrestricted access to sensitive resources or actions.

2. Misconfigured policies: To remediate misconfigured policies when creating a new policy version in AWS IAM using AWS CLI, take the following actions:
   - Carefully review the policy document to identify any excessive permissions or incorrect resource identifiers.
   - Use the `create-policy-version` command to create a new policy version, providing the correct policy document with the necessary corrections.
   - Test the new policy version thoroughly before promoting it to the default version to ensure it grants the intended permissions and does not introduce any unintended access or resource exposure.

3. Lack of version control: To address the lack of version control when creating policy versions in AWS IAM using AWS CLI, consider the following steps:
   - Implement a version control system or process to track and manage policy versions effectively.
   - Use the `create-policy-version` command to create new policy versions, ensuring that each version is appropriately labeled or tagged for easy identification.
   - Regularly review and update the default policy version to ensure it reflects the latest secure configuration, and retire or delete outdated or insecure policy versions using the `delete-policy-version` command.

#### Using Python

1. Insecure permissions: To remediate insecure permissions when creating a new policy version in AWS IAM using Python, you can follow these steps:
   - Use the `boto3` library to interact with the IAM service.
   - Before creating a new policy version, ensure that you have a well-defined and secure policy document.
   - Validate the policy document to ensure it only grants necessary and least privilege permissions.
   - Use the `create_policy_version` method of the `iam` client to create a new policy version, providing the policy ARN and the updated policy document.
   - Once the new policy version is created, review and test it thoroughly to ensure it meets the desired security requirements.

2. Misconfigured policies: To remediate misconfigured policies when creating a new policy version in AWS IAM using Python, you can follow these steps:
   - Before creating a new policy version, thoroughly review the policy document to identify any potential misconfigurations.
   - Use the `boto3` library to interact with the IAM service.
   - Validate the policy document to ensure it grants the correct permissions and includes accurate resource identifiers.
   - If any misconfigurations are identified, update the policy document accordingly.
   - Use the `create_policy_version` method of the `iam` client to create a new policy version, providing the policy ARN and the updated policy document.
   - Test the new policy version to ensure it functions as expected and does not introduce any unintended access or resource exposure.

3. Lack of version control: To remediate the lack of version control when creating policy versions in AWS IAM using Python, you can follow these steps:
   - Use a version control system (e.g., Git) to track and manage your policy documents.
   - Before creating a new policy version, ensure that you have a clear naming convention for your policy versions.
   - Use the `boto3` library to interact with the IAM service.
   - Implement a process to maintain a single source of truth for your policy documents and their versions.
   - When creating a new policy version, update the version number or identifier in the policy document and commit it to your version control system.
   - Regularly review and audit your policy versions to ensure they are up to date and align with your security requirements.


 