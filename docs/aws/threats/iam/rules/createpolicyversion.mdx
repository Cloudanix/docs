--- 
slug: CreatePolicyVersion
eventname: CreatePolicyVersion
title: CreatePolicyVersion
sidebar_label: CreatePolicyVersion
---
                       
### Event Information

- The CreatePolicyVersion event in AWS for IAM refers to the action of creating a new version of an IAM policy.
- This event is triggered when a user or an automated process creates a new version of an existing IAM policy.
- Each version of an IAM policy represents a snapshot of the policy at a specific point in time and can be used to track changes and manage policy updates.


### Examples

1. Insecure permissions: When creating a new policy version using CreatePolicyVersion in AWS IAM, it is important to ensure that the permissions granted in the policy are secure. For example, if the policy allows unrestricted access to sensitive resources or actions, it can lead to unauthorized access and compromise the security of the system.

2. Misconfigured policies: Creating a new policy version can introduce misconfigurations if not carefully reviewed. For instance, if the policy version inadvertently grants excessive permissions or includes incorrect resource identifiers, it can result in unintended access or resource exposure.

3. Lack of policy version control: If proper version control is not maintained while using CreatePolicyVersion, it can lead to security issues. For example, if an outdated or deprecated policy version is mistakenly used, it may contain vulnerabilities or outdated permissions that can be exploited by attackers. It is crucial to regularly review and manage policy versions to ensure the most secure and up-to-date configurations are in place.

### Remediation

#### Using Console

1. Insecure permissions:
   - Step 1: Log in to the AWS Management Console.
   - Step 2: Navigate to the IAM service.
   - Step 3: Select "Policies" from the left-hand menu.
   - Step 4: Search for the policy you want to create a new version for and click on its name.
   - Step 5: In the policy details page, click on the "Create version" button.
   - Step 6: Review the policy document and ensure that the permissions granted are secure and follow the principle of least privilege.
   - Step 7: Click on the "Create version" button to create the new policy version.
   - Step 8: Once the new version is created, you can manage the policy versions by selecting the policy and clicking on the "Manage versions" button.

2. Misconfigured policies:
   - Follow steps 1 to 4 from the previous instructions.
   - Step 5: In the policy details page, click on the "Create version" button.
   - Step 6: Review the policy document carefully and ensure that it grants the intended permissions and includes correct resource identifiers.
   - Step 7: If any misconfigurations are identified, modify the policy document accordingly.
   - Step 8: Click on the "Create version" button to create the new policy version.
   - Step 9: Once the new version is created, you can manage the policy versions by selecting the policy and clicking on the "Manage versions" button.

3. Lack of version control:
   - Follow steps 1 to 4 from the first set of instructions.
   - Step 5: In the policy details page, click on the "Create version" button.
   - Step 6: Review the policy document and ensure that it grants the intended permissions.
   - Step 7: Add a meaningful version description to help with version control and tracking.
   - Step 8: Click on the "Create version" button to create the new policy version.
   - Step 9: Once the new version is created, you can manage the policy versions by selecting the policy and clicking on the "Manage versions" button.

#### Using CLI

1. Insecure permissions: To remediate insecure permissions when creating a new policy version in AWS IAM using AWS CLI commands, follow these steps:
   - Use the `create-policy-version` command to create a new version of the policy: 
     ```
     aws iam create-policy-version --policy-arn <policy-arn> --policy-document <policy-document> --set-as-default
     ```
   - Ensure that the `<policy-document>` contains only the necessary and secure permissions, restricting access to sensitive resources or actions.
   - Review and validate the policy document before setting it as the default version.

2. Misconfigured policies: To remediate misconfigured policies when creating a new policy version in AWS IAM using AWS CLI commands, follow these steps:
   - Use the `create-policy-version` command to create a new version of the policy: 
     ```
     aws iam create-policy-version --policy-arn <policy-arn> --policy-document <policy-document> --set-as-default
     ```
   - Double-check the `<policy-document>` to ensure that it grants the correct and necessary permissions, avoiding excessive access or incorrect resource identifiers.
   - Review and validate the policy document before setting it as the default version.

3. Lack of version control: To remediate the lack of version control when creating a new policy version in AWS IAM using AWS CLI commands, follow these steps:
   - Use the `create-policy-version` command to create a new version of the policy: 
     ```
     aws iam create-policy-version --policy-arn <policy-arn> --policy-document <policy-document> --set-as-default
     ```
   - Implement a proper version control system to track and manage policy versions. This can be done by maintaining a clear naming convention or using a version control tool.
   - Regularly review and update policies, ensuring that only the latest and secure versions are applied.

#### Using Python

1. Insecure permissions: To remediate insecure permissions when creating a new policy version in AWS IAM using Python scripts, you can follow these steps:
   - Before creating a new policy version, thoroughly review the permissions granted in the policy.
   - Use the AWS IAM Policy Simulator to simulate the effects of the policy and ensure that it only allows the necessary and secure actions.
   - Implement the principle of least privilege by granting the minimum required permissions to perform the intended actions.
   - Regularly review and audit the policies to identify and remove any unnecessary or overly permissive permissions.

2. Misconfigured policies: To remediate misconfigured policies when creating a new policy version in AWS IAM using Python scripts, consider the following:
   - Implement a code review process to ensure that the policy version being created is thoroughly reviewed for any misconfigurations.
   - Utilize linting tools or static code analysis tools specific to AWS IAM policies to identify potential misconfigurations.
   - Implement automated testing or validation scripts that check for common misconfigurations, such as excessive permissions or incorrect resource identifiers.
   - Regularly review and audit the policies to identify and correct any misconfigurations.

3. Lack of version control: To remediate the lack of version control when creating policy versions in AWS IAM using Python scripts, you can:
   - Implement a version control system, such as Git, to track changes to the policy documents.
   - Utilize a CI/CD pipeline to automate the creation and deployment of policy versions, ensuring that the correct version is applied.
   - Implement a policy versioning strategy, such as using semantic versioning, to clearly identify and manage different versions of the policies.
   - Regularly review and clean up old or unused policy versions to avoid confusion and potential security issues.


 