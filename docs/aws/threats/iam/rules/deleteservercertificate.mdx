--- 
slug: DeleteServerCertificate
eventname: DeleteServerCertificate
title: DeleteServerCertificate
sidebar_label: DeleteServerCertificate
---
                       
### Event Information

#### Meaning

- The DeleteServerCertificate event in AWS for IAM refers to the action of deleting a server certificate from the IAM (Identity and Access Management) service.
- This event indicates that a server certificate, which is used for SSL/TLS encryption in AWS services like Elastic Load Balancer or CloudFront, has been removed from the IAM account.
- Deleting a server certificate can impact any resources or services that rely on this certificate for secure communication, and it is important to ensure that appropriate replacements or updates are made to avoid service disruptions.

### Remediation

#### Using Console

None

#### Using CLI

- Example of security impact: If an attacker gains unauthorized access to an IAM user's credentials and uses the `DeleteServerCertificate` action, they can delete a server certificate that is being used for secure communication between services or applications. This can lead to a loss of confidentiality and integrity of data transmitted over the network.

- Remediation steps using AWS CLI:
  1. Enable multi-factor authentication (MFA) for IAM users to add an extra layer of security to their credentials. This can be done using the following command:
     ```
     aws iam enable-mfa-device --user-name <IAM-USER-NAME> --serial-number <MFA-DEVICE-SERIAL-NUMBER> --authentication-code1 <CODE1> --authentication-code2 <CODE2>
     ```

  2. Implement IAM policies with least privilege to restrict the `DeleteServerCertificate` action only to authorized users or roles. Create a policy that denies the `DeleteServerCertificate` action and attach it to the IAM user or role. For example:
     ```
     aws iam put-user-policy --user-name <IAM-USER-NAME> --policy-name DenyDeleteServerCertificate --policy-document file://deny-delete-server-certificate-policy.json
     ```

  3. Regularly monitor and review IAM user activity logs using AWS CloudTrail. This helps in identifying any unauthorized or suspicious activities related to the `DeleteServerCertificate` action.

#### Using Python

1. Example of security impact with DeleteServerCertificate in AWS IAM:
   - If an unauthorized user gains access to the AWS IAM credentials and performs the DeleteServerCertificate action, they can delete a server certificate that is being used for secure communication between services. This can lead to a loss of confidentiality and integrity of data transmitted between services.

2. Remediation for AWS IAM using Python:
   - To remediate the security impact of unauthorized DeleteServerCertificate action in AWS IAM, you can implement the following steps using Python:
     - Implement strict access control policies for IAM users and roles to ensure that only authorized users have the necessary permissions to perform the DeleteServerCertificate action.
     - Regularly monitor and review IAM access logs to identify any unauthorized or suspicious activities related to server certificate deletion.
     - Implement automated alerts or notifications to notify administrators when a server certificate is deleted, allowing them to take immediate action.

3. Python script example for monitoring and alerting on DeleteServerCertificate action:
   ```python
   import boto3

   def monitor_delete_server_certificate():
       client = boto3.client('cloudtrail')
       response = client.lookup_events(
           LookupAttributes=[
               {
                   'AttributeKey': 'EventName',
                   'AttributeValue': 'DeleteServerCertificate'
               },
           ],
           MaxResults=10
       )
       for event in response['Events']:
           # Send alert/notification to administrators
           send_alert(event['EventName'], event['EventTime'], event['Username'])

   def send_alert(event_name, event_time, username):
       # Implement your alert/notification mechanism here
       print(f"Alert: DeleteServerCertificate action detected at {event_time} by {username}")

   if __name__ == '__main__':
       monitor_delete_server_certificate()
   ```
   This script uses the AWS CloudTrail service to lookup events related to the DeleteServerCertificate action. It retrieves the latest 10 events and sends an alert/notification to administrators for each event detected. You can customize the `send_alert` function to integrate with your preferred alerting/notification mechanism.


 