--- 
slug: CreateAccessKey
eventname: CreateAccessKey
title: CreateAccessKey
sidebar_label: CreateAccessKey
---
                       
### Event Information

- The CreateAccessKey event in AWS for IAM refers to the action of creating an access key for an IAM user.
- An access key is a set of credentials (access key ID and secret access key) that allows programmatic access to AWS services and resources.
- This event indicates that a new access key has been generated for an IAM user, which can be used to authenticate and authorize API requests to AWS services.


### Examples

- Unauthorized access: Creating an access key without proper authorization can lead to unauthorized individuals gaining access to sensitive resources and data within the AWS environment. This can result in data breaches, unauthorized modifications, or even complete compromise of the infrastructure.

- Lack of accountability: When access keys are created without proper documentation or tracking, it becomes difficult to attribute actions or changes to specific individuals. This can hinder incident response efforts and make it challenging to identify and mitigate security incidents or policy violations.

- Increased attack surface: Each access key created represents a potential entry point for attackers. If access keys are not properly managed, revoked, or rotated, they can be exploited by malicious actors to gain unauthorized access to the AWS environment. This can lead to further compromise of resources, data exfiltration, or disruption of services.

### Remediation

#### Using Console

1. Log in to the AWS Management Console using your AWS account credentials.
2. Navigate to the IAM service by searching for "IAM" in the AWS Management Console search bar and selecting the IAM service.
3. In the left navigation pane, click on "Users" to view the list of IAM users in your account.
4. Locate the user for whom you want to create an access key and click on their username.
5. In the "Security credentials" tab, scroll down to the "Access keys" section and click on the "Create access key" button.
6. A pop-up window will appear displaying the newly created access key ID and secret access key. Make sure to copy and securely store the secret access key as it will not be shown again.
7. Click on the "Download .csv file" button to download a CSV file containing the access key details. This file can be used for reference or to provide the access key details to the user.
8. Once you have copied the access key ID and secret access key, click on the "Close" button to complete the process.

Note: It is important to follow the principle of least privilege when creating access keys. Ensure that the user has only the necessary permissions required to perform their intended tasks and regularly review and revoke access keys that are no longer needed.

#### Using CLI

To remediate unauthorized access and lack of accountability related to creating access keys without proper authorization in AWS IAM, you can follow these steps:

1. Identify and delete unauthorized access keys:
   - List all access keys associated with IAM users: `aws iam list-access-keys --user-name <user-name>`
   - Identify unauthorized access keys based on the creation date, user, or any other relevant criteria.
   - Delete unauthorized access keys: `aws iam delete-access-key --user-name <user-name> --access-key-id <access-key-id>`

2. Implement access key rotation and management:
   - Enable access key rotation for IAM users: `aws iam update-access-key --user-name <user-name> --access-key-id <access-key-id> --status Active --rotate`
   - Set up a process to regularly rotate access keys for IAM users, following best practices and compliance requirements.
   - Implement strong password policies and enforce the use of multi-factor authentication (MFA) to enhance security.

3. Establish proper documentation and tracking:
   - Maintain an inventory of authorized access keys, including details such as the associated user, purpose, and creation date.
   - Implement a process to review and validate access key creation requests, ensuring proper authorization and documentation.
   - Regularly audit access keys and their usage to identify any anomalies or unauthorized activities.

By following these steps, you can remediate unauthorized access and improve accountability in AWS IAM by properly managing access keys and enforcing security best practices.

#### Using Python

To remediate unauthorized access and lack of accountability related to creating access keys in AWS IAM, you can follow these steps:

1. Implement strict access control policies: Ensure that only authorized individuals have the necessary permissions to create access keys. Use AWS Identity and Access Management (IAM) policies to define granular permissions and restrict access to sensitive resources and actions.

2. Enable AWS CloudTrail: AWS CloudTrail provides detailed logs of API activity within your AWS account. By enabling CloudTrail, you can track and monitor access key creation events, allowing you to identify any unauthorized or suspicious activities. You can use the CloudTrail API or AWS CLI to retrieve access key creation events programmatically.

3. Automate access key management: Implement a process to automatically rotate access keys on a regular basis. This can be achieved using Python scripts and the AWS SDK (boto3). The script can list all access keys, identify keys that have not been used recently, and rotate them by creating new keys and disabling the old ones. Here's an example script:

```python
import boto3

def rotate_access_keys(user_name):
    iam_client = boto3.client('iam')
    
    # List all access keys for the user
    response = iam_client.list_access_keys(UserName=user_name)
    access_keys = response['AccessKeyMetadata']
    
    for key in access_keys:
        # Check if the access key has been used recently
        response = iam_client.get_access_key_last_used(AccessKeyId=key['AccessKeyId'])
        last_used_date = response['AccessKeyLastUsed']['LastUsedDate']
        
        # Rotate the access key if it hasn't been used in the last 90 days
        if last_used_date is None or (datetime.now() - last_used_date).days > 90:
            # Create a new access key
            response = iam_client.create_access_key(UserName=user_name)
            new_access_key = response['AccessKey']
            
            # Disable the old access key
            iam_client.update_access_key(AccessKeyId=key['AccessKeyId'], Status='Inactive')
            
            print(f"Access key {key['AccessKeyId']} rotated. New access key: {new_access_key['AccessKeyId']}")
```

Note: Make sure to replace `user_name` with the actual IAM user name you want to rotate access keys for. Also, ensure that you have the necessary permissions to perform these actions in your AWS account.


 