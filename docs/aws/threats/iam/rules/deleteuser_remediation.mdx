
### Event Information

#### Meaning

- The DeleteUser event in AWS IAM (Identity and Access Management) refers to the event of a user being deleted from the AWS account.
- This event is triggered when an IAM user is permanently removed from the account, along with all associated permissions and access keys.
- The DeleteUser event can be useful for monitoring and auditing purposes, allowing administrators to track user deletions and maintain a record of user management activities.

#### Example

1. Example of security impact: If an unauthorized user gains access to the AWS Management Console or API credentials of an IAM user with the necessary permissions, they can potentially execute the `DeleteUser` API call to delete IAM users. This can lead to unauthorized access, data loss, and disruption of services.

Remediation:
- Enable multi-factor authentication (MFA) for IAM users to add an extra layer of security.
- Regularly review and audit IAM user permissions to ensure they have the least privilege necessary.
- Implement strong password policies and enforce regular password rotation.
- Enable CloudTrail to monitor and log all API activities, including `DeleteUser` events, for auditing and investigation purposes.
- Implement IAM policies that restrict the ability to delete IAM users to only trusted administrators.

Example CLI command to enable MFA for an IAM user:
```
aws iam enable-mfa-device --user-name <IAM-USER-NAME> --serial-number <MFA-DEVICE-ARN> --authentication-code1 <CODE1> --authentication-code2 <CODE2>
```

Example CLI command to create an IAM policy that allows only trusted administrators to delete IAM users:
```
aws iam create-policy --policy-name <POLICY-NAME> --policy-document file://policy.json
```
where `policy.json` contains the policy document with appropriate conditions and permissions.

2. Example of security impact: If an attacker gains unauthorized access to an EC2 instance with IAM roles assigned, they can potentially execute the `aws iam delete-user` command from within the instance to delete IAM users. This can lead to unauthorized access, data loss, and disruption of services.

Remediation:
- Regularly update and patch EC2 instances to mitigate vulnerabilities that can be exploited for unauthorized access.
- Implement strong security group rules and network access control lists (ACLs) to restrict inbound and outbound traffic to only necessary ports and protocols.
- Use AWS Systems Manager or other configuration management tools to enforce security configurations and policies on EC2 instances.
- Implement VPC Flow Logs to monitor and analyze network traffic for any suspicious activities.
- Enable CloudTrail to monitor and log all API activities, including `DeleteUser` events, for auditing and investigation purposes.

Example CLI command to update EC2 instances with the latest patches:
```
aws ssm send-command --instance-ids <INSTANCE-ID> --document-name "AWS-RunPatchBaseline" --comment "Patch EC2 instances" --parameters '{"Operation":["Install"],"SnapshotId":[""],"InstallOverrideList":[""],"RebootOption":["RebootIfNeeded"]}' --timeout-seconds 600 --max-concurrency "50" --max-errors "0"
```

Example CLI command to create a VPC Flow Log:
```
aws ec2 create-flow-logs --resource-ids <VPC-ID> --resource-type VPC --traffic-type ALL --log-group-name <LOG-GROUP-NAME> --deliver-logs-permission-arn <LOG-DELIVERY-ROLE-ARN>
```

3. Example of security impact: If an attacker gains unauthorized access to an AWS Lambda function with IAM permissions, they can potentially execute the `deleteUser` function code to delete IAM users. This can lead to unauthorized access, data loss, and disruption of services.

Remediation:
- Implement least privilege IAM roles for Lambda functions, ensuring that they only have the necessary permissions to perform their intended tasks.
- Enable AWS Lambda function versioning and aliasing to prevent accidental deletion or modification of production functions.
- Implement AWS CloudTrail to monitor and log all API activities, including Lambda function invocations and modifications, for auditing and investigation purposes.
- Regularly review and audit Lambda function permissions and configurations to identify and mitigate any potential security vulnerabilities.
- Implement AWS WAF or other security measures to protect against common web application attacks that can be used to gain unauthorized access to Lambda functions.

Example CLI command to create an IAM role with least privilege permissions for a Lambda function:
```
aws iam create-role --role-name <ROLE-NAME> --assume-role-policy-document file://trust-policy.json
aws iam attach-role-policy --role-name <ROLE-NAME> --policy-arn <POLICY-ARN>
```
where `trust-policy.json` contains the trust policy document specifying the trusted entities.

Example CLI command to enable AWS CloudTrail for Lambda function activities:
```
aws cloudtrail create-trail --name <TRAIL-NAME> --s3-bucket-name <BUCKET-NAME> --is-multi-region-trail --include-global-service-events --enable-log-file-validation
```

