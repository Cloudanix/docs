--- 
slug: CreateGrant
eventname: CreateGrant
title: CreateGrant
sidebar_label: CreateGrant
---
                       
### Event Information

#### Meaning

- The CreateGrant event in AWS Real-time for KMS refers to the action of creating a grant for a specified AWS Key Management Service (KMS) key.
- A grant in KMS is a permission that allows a specified AWS identity or AWS account to use a KMS key to perform cryptographic operations.
- The CreateGrant event can be used to track and monitor the creation of grants, which can help in auditing and ensuring proper access controls for KMS keys.

#### Example

1. Example of security impact: If an unauthorized user gains access to the AWS account and creates a grant for a KMS key, they can potentially gain access to sensitive data encrypted with that key. This can lead to a data breach and compromise the security of the system.

Remediation:
- Regularly monitor and review IAM policies and user permissions to ensure that only authorized users have access to create grants for KMS keys.
- Enable AWS CloudTrail to capture all API calls related to KMS key management and regularly review the logs for any suspicious activity.
- Implement strong access control measures, such as multi-factor authentication (MFA) and strong password policies, to prevent unauthorized access to the AWS account.
- Consider using AWS Key Management Service (KMS) custom key stores, which allow you to control the underlying hardware security modules (HSMs) used to protect your keys.

Example CLI command to list grants for a KMS key:
```
aws kms list-grants --key-id <key-id>
```

Example CLI command to revoke a grant for a KMS key:
```
aws kms revoke-grant --key-id <key-id> --grant-id <grant-id>
```

2. Example of security impact: If a malicious insider with sufficient privileges creates a grant for a KMS key and then deletes the grant, they can effectively bypass the key's encryption and gain unauthorized access to the encrypted data.

Remediation:
- Implement strict access controls and least privilege principles to limit the number of users with the ability to create and delete grants for KMS keys.
- Regularly review and audit IAM policies and user permissions to ensure that only authorized users have the necessary privileges.
- Enable AWS CloudTrail to capture all API calls related to KMS key management and regularly review the logs for any suspicious activity.
- Implement strong monitoring and alerting mechanisms to detect and respond to any unauthorized grant creation or deletion.

Example CLI command to create a grant for a KMS key:
```
aws kms create-grant --key-id <key-id> --grantee-principal <grantee-principal> --operations <operations>
```

Example CLI command to delete a grant for a KMS key:
```
aws kms retire-grant --key-id <key-id> --grant-id <grant-id>
```

3. Example of security impact: If an attacker gains access to the AWS account and creates a grant for a KMS key with overly permissive permissions, they can potentially escalate their privileges and gain unauthorized access to sensitive data.

Remediation:
- Implement strict access controls and least privilege principles to limit the permissions granted to users creating grants for KMS keys.
- Regularly review and audit IAM policies and user permissions to ensure that only necessary permissions are granted.
- Enable AWS CloudTrail to capture all API calls related to KMS key management and regularly review the logs for any suspicious activity.
- Implement strong monitoring and alerting mechanisms to detect and respond to any unauthorized grant creation with overly permissive permissions.

Example CLI command to create a grant for a KMS key with specific permissions:
```
aws kms create-grant --key-id <key-id> --grantee-principal <grantee-principal> --operations <operations> --constraints <constraints>
```

Example CLI command to update a grant for a KMS key with more restrictive permissions:
```
aws kms update-grant --key-id <key-id> --grant-id <grant-id> --operations <operations> --constraints <constraints>
```


 