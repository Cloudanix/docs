--- 
slug: CreateKey
eventname: CreateKey
title: CreateKey
sidebar_label: CreateKey
---
                       
### Event Information

- The CreateKey event in AWS Key Management Service (KMS) refers to the action of creating a new customer master key (CMK) in KMS.
- When this event occurs, it indicates that a new CMK has been generated, which can be used to encrypt and decrypt data in AWS services and applications.
- This event is important for auditing and compliance purposes, as it allows organizations to track the creation of new encryption keys and monitor the usage of KMS for data protection.


### Examples

1. Inadequate key management: If security is impacted with CreateKey in AWS KMS, it could be due to inadequate key management practices. For example, if the key is not properly protected or if it is shared with unauthorized users, it can compromise the security of the data encrypted with that key.

2. Weak key configuration: Another example of security impact with CreateKey in AWS KMS could be weak key configuration. If the key is generated with weak cryptographic algorithms or insufficient key length, it can make the encrypted data more vulnerable to attacks.

3. Lack of access controls: If proper access controls are not implemented while creating a key with CreateKey in AWS KMS, it can lead to security issues. For instance, if the key is accessible to users or services that do not require it, it increases the risk of unauthorized access and potential data breaches.

### Remediation

#### Using Console

1. Inadequate key management:
- Ensure that the key is properly protected by using strong access controls and permissions. Only authorized users should have access to the key.
- Regularly review and update the key policies to ensure that they align with the security requirements of your organization.
- Implement auditing and monitoring mechanisms to track key usage and detect any unauthorized access attempts.

2. Weak key configuration:
- When creating a key with CreateKey in AWS KMS, choose strong cryptographic algorithms and key lengths that meet industry best practices and compliance standards.
- Regularly review and update the key configuration to ensure that it remains secure against emerging threats.
- Consider using AWS Key Management Service (KMS) custom key store feature to have more control over the key management process and ensure stronger security.

3. Lack of access controls:
- Implement least privilege access controls for the key by granting permissions only to the users or services that require it.
- Regularly review and update the access policies to ensure that they align with the principle of least privilege.
- Utilize AWS Identity and Access Management (IAM) policies to enforce fine-grained access controls and restrict access to the key based on user roles and responsibilities.

#### Using CLI

1. Inadequate key management: To remediate inadequate key management practices in AWS KMS, follow these steps:
   - Ensure that the key is properly protected by using appropriate IAM policies to restrict access to authorized users only.
   - Regularly review and update the key policies to remove any unnecessary permissions or shared access.
   - Enable AWS CloudTrail to monitor and log key management activities for auditing purposes.

   CLI command example: `aws kms put-key-policy --key-id <key-id> --policy-name default --policy <policy-json>`

2. Weak key configuration: To remediate weak key configuration in AWS KMS, take the following actions:
   - Generate keys using strong cryptographic algorithms and sufficient key lengths. AWS KMS supports various algorithms and key lengths, so choose the appropriate ones based on your security requirements.
   - Regularly rotate keys to ensure that any potential vulnerabilities are mitigated.

   CLI command example: `aws kms create-key --description "Strong Key" --key-usage ENCRYPT_DECRYPT --origin AWS_KMS --customer-master-key-spec SYMMETRIC_DEFAULT --policy <policy-json>`

3. Lack of access controls: To remediate the lack of access controls in AWS KMS, implement the following measures:
   - Use IAM policies to grant access to the key only to the users or services that require it.
   - Regularly review and update the IAM policies to remove any unnecessary or excessive permissions.
   - Enable AWS CloudTrail to monitor and log key access activities for auditing and detecting any unauthorized access attempts.

   CLI command example: `aws kms create-key --description "Restricted Key" --key-usage ENCRYPT_DECRYPT --origin AWS_KMS --customer-master-key-spec SYMMETRIC_DEFAULT --policy <policy-json>`

#### Using Python

To remediate inadequate key management, you can follow these steps in AWS KMS using Python scripts:

1. Implement proper key protection: Ensure that the key is properly protected by using AWS Identity and Access Management (IAM) policies to restrict access to authorized users only. You can use the `boto3` library in Python to create and manage IAM policies.

```python
import boto3

kms_client = boto3.client('kms')

response = kms_client.create_key(
    KeyUsage='ENCRYPT_DECRYPT',
    Origin='AWS_KMS',
    Description='My encryption key'
)

key_id = response['KeyMetadata']['KeyId']

# Apply IAM policy to restrict access to authorized users
kms_client.put_key_policy(
    KeyId=key_id,
    PolicyName='MyKeyPolicy',
    Policy='''{
        "Version": "2012-10-17",
        "Statement": [
            {
                "Sid": "AllowAdminsOnly",
                "Effect": "Deny",
                "Principal": "*",
                "Action": "kms:*",
                "Resource": "*",
                "Condition": {
                    "StringNotLike": {
                        "aws:username": [
                            "admin@example.com",
                            "backup@example.com"
                        ]
                    }
                }
            }
        ]
    }'''
)
```

2. Ensure strong key configuration: Generate keys with strong cryptographic algorithms and sufficient key length. You can specify the key specifications while creating the key using the `KeySpec` parameter in the `create_key` method.

```python
response = kms_client.create_key(
    KeyUsage='ENCRYPT_DECRYPT',
    Origin='AWS_KMS',
    Description='My encryption key',
    KeySpec='AES_256'
)
```

3. Implement proper access controls: Use IAM policies to control access to the key. You can grant permissions to specific IAM users, roles, or groups that require access to the key. Here's an example of granting access to an IAM user:

```python
kms_client.create_key(
    KeyUsage='ENCRYPT_DECRYPT',
    Origin='AWS_KMS',
    Description='My encryption key'
)

# Grant access to an IAM user
kms_client.create_grant(
    KeyId=key_id,
    GranteePrincipal='arn:aws:iam::123456789012:user/myuser',
    Operations=['Encrypt', 'Decrypt']
)
```

By implementing these steps, you can remediate inadequate key management and enhance the security of your AWS KMS keys.


 