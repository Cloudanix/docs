--- 
slug: ReEncrypt
eventname: ReEncrypt
title: ReEncrypt
sidebar_label: ReEncrypt
---
                       
### Event Information

#### Meaning

- The ReEncrypt event in AWS KMS (Key Management Service) refers to the process of re-encrypting data using a different customer master key (CMK).
- This event occurs when there is a need to change the encryption key used to protect sensitive data, while ensuring the data remains encrypted and secure.
- The ReEncrypt event in AWS KMS can be triggered manually by the user or automatically through scheduled key rotation, key expiration, or other key management operations.

#### Example

1. Example of security impact: If an unauthorized user gains access to the AWS Key Management Service (KMS) and performs a ReEncrypt event, they could potentially decrypt and re-encrypt sensitive data with a different key, effectively bypassing any access controls or encryption policies in place. This could lead to unauthorized access to sensitive information.

Remediation:
- Enable AWS CloudTrail to monitor and log all KMS API calls, including ReEncrypt events. This will provide visibility into any unauthorized or suspicious activity.
- Implement strict IAM policies to control access to the KMS service and keys. Follow the principle of least privilege, ensuring that only authorized users or roles have the necessary permissions to perform ReEncrypt operations.
- Regularly rotate and manage your KMS keys to minimize the impact of any potential security breaches. This includes disabling or deleting any unused or compromised keys.

AWS CLI command to enable CloudTrail for KMS:
```
aws cloudtrail create-trail --name my-kms-trail --s3-bucket-name my-kms-trail-bucket --is-multi-region-trail --include-global-service-events --enable-log-file-validation
```

AWS CLI command to create an IAM policy for KMS access control:
```
aws iam create-policy --policy-name kms-access-policy --policy-document file://kms-access-policy.json
```

AWS CLI command to rotate a KMS key:
```
aws kms schedule-key-deletion --key-id <key-id> --pending-window-in-days 7
```

2. Example of security impact: If a malicious user gains access to the AWS KMS and performs a ReEncrypt event, they could potentially modify the encryption context associated with the data. This could result in unauthorized access to the decrypted data, as the modified encryption context may not match the expected values.

Remediation:
- Implement strong access controls and authentication mechanisms for the AWS KMS service, such as multi-factor authentication (MFA) and strong password policies.
- Regularly review and audit the encryption context associated with your data to ensure its integrity. Monitor for any unexpected changes or modifications.
- Enable AWS CloudTrail to capture and log all KMS API calls, including ReEncrypt events. This will help in identifying any unauthorized or suspicious activity.

AWS CLI command to enable MFA for KMS:
```
aws kms enable-key-rotation --key-id <key-id> --rotation-interval 365
```

AWS CLI command to enable CloudTrail for KMS:
```
aws cloudtrail create-trail --name my-kms-trail --s3-bucket-name my-kms-trail-bucket --is-multi-region-trail --include-global-service-events --enable-log-file-validation
```

AWS CLI command to review encryption context for a KMS key:
```
aws kms get-key-policy --key-id <key-id> --policy-name default --query "Policy" --output text
```

3. Example of security impact: If an attacker gains access to the AWS KMS and performs a ReEncrypt event, they could potentially modify the key policy associated with the KMS key. This could result in unauthorized access to the encrypted data, as the modified key policy may grant additional permissions to the attacker.

Remediation:
- Regularly review and audit the key policies associated with your KMS keys to ensure they are properly configured and do not grant excessive permissions.
- Implement strict IAM policies to control access to the KMS service and keys. Follow the principle of least privilege, ensuring that only authorized users or roles have the necessary permissions to modify key policies.
- Enable AWS CloudTrail to capture and log all KMS API calls, including ReEncrypt events and key policy modifications. This will provide visibility into any unauthorized or suspicious activity.

AWS CLI command to review key policy for a KMS key:
```
aws kms get-key-policy --key-id <key-id> --policy-name default --query "Policy" --output text
```

AWS CLI command to create an IAM policy for KMS access control:
```
aws iam create-policy --policy-name kms-access-policy --policy-document file://kms-access-policy.json
```

AWS CLI command to enable CloudTrail for KMS:
```
aws cloudtrail create-trail --name my-kms-trail --s3-bucket-name my-kms-trail-bucket --is-multi-region-trail --include-global-service-events --enable-log-file-validation
```


 