--- 
slug: PutKeyPolicy
eventname: PutKeyPolicy
title: PutKeyPolicy
sidebar_label: PutKeyPolicy
---
                       
### Event Information

#### Meaning

- The PutKeyPolicy event in AWS Real-time for KMS refers to an action where a key policy is updated or created for a Key Management Service (KMS) key.
- This event indicates that a user or an application has modified the permissions associated with a specific KMS key.
- The PutKeyPolicy event is important for monitoring and auditing purposes, as it allows tracking changes to key policies and ensuring that the appropriate access controls are in place for KMS keys.

#### Example

1. Example of security impact: If an unauthorized user gains access to the AWS account and performs a PutKeyPolicy event in AWS KMS, they can potentially modify the key policy of a KMS key. This can lead to unauthorized access to encrypted data or the ability to decrypt data that should be protected.

Remediation:
- Enable multi-factor authentication (MFA) for all IAM users and roles that have permission to modify KMS key policies. This adds an extra layer of security to prevent unauthorized access.
- Regularly review and audit IAM policies and permissions to ensure that only authorized users have the necessary permissions to modify KMS key policies.
- Monitor CloudTrail logs for any PutKeyPolicy events and set up alerts to notify administrators of any unauthorized modifications. 

Example CLI command to enable MFA for an IAM user:
```
aws iam enable-mfa-device --user-name <IAM_USER_NAME> --serial-number <MFA_DEVICE_SERIAL_NUMBER> --authentication-code1 <CODE1> --authentication-code2 <CODE2>
```

2. Example of security impact: If a malicious insider gains access to an EC2 instance with IAM role permissions to modify KMS key policies, they can perform a PutKeyPolicy event to grant themselves additional permissions or escalate their privileges within the AWS account.

Remediation:
- Implement the principle of least privilege by regularly reviewing and updating IAM roles and policies associated with EC2 instances. Remove unnecessary permissions and restrict access to KMS key policies.
- Enable AWS CloudTrail to log all API calls related to KMS key policies and regularly monitor the logs for any suspicious activity.
- Implement strong security practices such as regularly rotating IAM credentials, using strong passwords, and enforcing password policies.

Example CLI command to update an IAM role's trust policy to restrict access to KMS key policies:
```
aws iam update-assume-role-policy --role-name <ROLE_NAME> --policy-document file://trust-policy.json
```

3. Example of security impact: If an attacker gains access to an AWS account with administrative privileges, they can perform a PutKeyPolicy event to modify the key policy of a KMS key and grant themselves unauthorized access to sensitive data.

Remediation:
- Implement strong access control measures such as using AWS Identity and Access Management (IAM) policies to restrict access to KMS key policies. Only grant necessary permissions to trusted users and roles.
- Enable AWS CloudTrail to log all API calls related to KMS key policies and regularly monitor the logs for any unauthorized modifications.
- Regularly rotate and manage AWS access keys and credentials to minimize the risk of compromise.

Example CLI command to update an IAM policy to restrict access to KMS key policies:
```
aws iam put-role-policy --role-name <ROLE_NAME> --policy-name <POLICY_NAME> --policy-document file://policy.json
```


 