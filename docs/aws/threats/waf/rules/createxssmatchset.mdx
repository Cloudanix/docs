--- 
slug: CreateXssMatchSet
eventname: CreateXssMatchSet
title: CreateXssMatchSet
sidebar_label: CreateXssMatchSet
---
                       
### Event Information

#### Meaning

- The CreateXssMatchSet event in AWS WAF refers to the creation of a Cross-Site Scripting (XSS) match set. 
- XSS match sets are used in AWS WAF to define patterns or rules that can be used to identify and block requests that contain XSS attacks. 
- This event indicates that a new XSS match set has been created, which can then be associated with a web ACL to protect against XSS attacks.

### Remediation

#### Using Console

- Example of security impact: If the CreateXssMatchSet in AWS WAF is not properly configured, it can lead to a vulnerability where cross-site scripting (XSS) attacks can bypass the WAF protection and potentially compromise the application or data.

To remediate this for AWS WAF using the AWS console, follow these steps:

1. Log in to the AWS Management Console and navigate to the AWS WAF service.
2. In the AWS WAF console, select the appropriate region where the WAF is deployed.
3. Click on "Web ACLs" in the left navigation pane and select the Web ACL that contains the XSS Match Set you want to modify.
4. In the Web ACL details page, scroll down to the "Rules" section and click on the rule that is associated with the XSS Match Set.
5. In the rule details page, locate the condition that uses the XSS Match Set and click on the "Edit" button next to it.
6. In the condition editor, review the existing XSS Match Set and ensure that it includes the necessary regular expressions or patterns to effectively detect and block XSS attacks.
7. If the XSS Match Set is incomplete or needs modification, click on the "Add condition" button to add a new condition or modify the existing conditions.
8. Configure the condition with the appropriate regular expressions or patterns to match and block XSS attacks.
9. Once the XSS Match Set is properly configured, click on the "Update" button to save the changes.
10. Test the updated WAF configuration by simulating various XSS attack scenarios and ensure that the WAF is effectively blocking them.
11. Monitor the WAF logs and metrics to verify that the XSS attacks are being detected and blocked as expected.
12. Regularly review and update the XSS Match Set as new XSS attack patterns emerge or application changes require additional protection.

By following these steps, you can remediate the security impact of CreateXssMatchSet in AWS WAF and enhance the protection against XSS attacks.

#### Using CLI

- Example of security impact: If the CreateXssMatchSet operation in AWS WAF is not properly configured, it can lead to a potential security vulnerability where cross-site scripting (XSS) attacks can bypass the WAF protection and compromise the application.

- Remediation steps using AWS CLI:
  1. Identify the impacted XssMatchSet: Use the `list-xss-match-sets` command to list all the existing XSS match sets in AWS WAF.
  ```
  aws wafv2 list-xss-match-sets --scope CLOUDFRONT --region <region>
  ```

  2. Update the XssMatchSet: Use the `update-xss-match-set` command to modify the XssMatchSet and add appropriate rules to mitigate the XSS vulnerability.
  ```
  aws wafv2 update-xss-match-set --name <xss-match-set-name> --scope CLOUDFRONT --region <region> --updates Action=INSERT,Predicate=FieldToMatch=QUERY_STRING,TextTransformation=HTML_ENTITY_DECODE,Text="example.com"
  ```

  3. Validate the changes: Use the `get-xss-match-set` command to verify that the XssMatchSet has been updated with the necessary rules.
  ```
  aws wafv2 get-xss-match-set --name <xss-match-set-name> --scope CLOUDFRONT --region <region>
  ```

Note: Replace `<xss-match-set-name>` with the actual name of the XSS match set, and `<region>` with the appropriate AWS region.

#### Using Python

- Example of security impact: If the CreateXssMatchSet operation in AWS WAF is not properly configured, it can lead to a potential security vulnerability where cross-site scripting (XSS) attacks can bypass the WAF protection and compromise the application.

- Remediation steps using Python:
  1. Import the necessary AWS SDK for Python (Boto3) library.
  2. Create a new XssMatchSet using the `create_xss_match_set` method from the AWS WAF client.
  3. Add one or more XssMatchTuple objects to the XssMatchSet using the `update_xss_match_set` method.

Python script example:
```python
import boto3

# Create a new XssMatchSet
def create_xss_match_set(waf_client, xss_match_set_name):
    response = waf_client.create_xss_match_set(
        Name=xss_match_set_name
    )
    return response['XssMatchSet']['XssMatchSetId']

# Add XssMatchTuple to XssMatchSet
def add_xss_match_tuple(waf_client, xss_match_set_id, field_to_match_type, field_to_match_data):
    response = waf_client.update_xss_match_set(
        XssMatchSetId=xss_match_set_id,
        Updates=[
            {
                'Action': 'INSERT',
                'XssMatchTuple': {
                    'FieldToMatch': {
                        'Type': field_to_match_type,
                        'Data': field_to_match_data
                    },
                    'TextTransformation': 'NONE'
                }
            }
        ]
    )
    return response

# Usage example
waf_client = boto3.client('waf')
xss_match_set_id = create_xss_match_set(waf_client, 'MyXssMatchSet')
add_xss_match_tuple(waf_client, xss_match_set_id, 'QUERY_STRING', 'example')
```

Please note that the above script is a basic example and may need to be customized based on your specific requirements and environment.


 