--- 
slug: CreateIPSet
eventname: CreateIPSet
title: CreateIPSet
sidebar_label: CreateIPSet
---
                       
### Event Information

#### Meaning

- The CreateIPSet event in awsrealtime for WAF refers to the action of creating an IP set in AWS Web Application Firewall (WAF).
- An IP set is a collection of IP addresses or IP address ranges that can be used to define the source or destination of web requests in WAF rules.
- This event indicates that a new IP set has been created, which can be used to block or allow specific IP addresses or ranges in WAF rules to protect web applications from malicious traffic.

#### Example

1. Example of security impact: If an unauthorized user gains access to the CreateIPSet event in AWS WAF, they could potentially create a malicious IP set that allows them to bypass WAF rules and gain unauthorized access to the protected resources. This could lead to data breaches, unauthorized modifications, or disruption of services.

Remediation:
- Regularly monitor and review the AWS CloudTrail logs for any unauthorized CreateIPSet events.
- Implement strict access controls and permissions for AWS WAF, ensuring that only authorized users have the necessary privileges to create or modify IP sets.
- Enable AWS WAF logging and integrate it with a centralized logging and monitoring solution to detect and alert on any suspicious activity related to IP set creation.
- Consider implementing AWS WAF automation using AWS Lambda functions to automatically validate and approve IP set creation requests, reducing the risk of unauthorized access.

Example CLI command to enable AWS WAF logging:
```
aws wafv2 put-logging-configuration --logging-configuration '{"LogDestinationConfigs": ["arn:aws:logs:us-west-2:123456789012:log-group:/aws/wafv2/MyWAFLogGroup"]}' --resource-arn arn:aws:wafv2:us-west-2:123456789012:regional/webacl/MyWebACL/12345678-1234-1234-1234-123456789012
```

2. Example of security impact: If an attacker gains access to the AWS WAF CreateIPSet event, they could potentially create a malicious IP set that blocks legitimate traffic, leading to service disruptions or denial of service attacks. This could result in degraded performance, loss of revenue, or reputational damage.

Remediation:
- Implement strong access controls and multi-factor authentication (MFA) for AWS accounts to prevent unauthorized access to the CreateIPSet event.
- Regularly review and audit the IP sets created in AWS WAF to identify any suspicious or unauthorized entries.
- Enable AWS WAF rate-based rules to limit the number of IP set creations within a specific time frame, preventing potential abuse or rapid creation of malicious IP sets.
- Implement AWS WAF automation using AWS CloudFormation templates or AWS SDKs to enforce standardized IP set creation processes and reduce the risk of human error or malicious intent.

Example AWS CLI command to enable rate-based rule for IP set creation:
```
aws wafv2 create-rate-based-rule --name MyRateBasedRule --metric-name MyRateBasedRuleMetric --rate-key IPSetCreate --rate-limit 1000 --scope REGIONAL --rule-action BLOCK --override-action NONE --description "Rate-based rule to limit IP set creation"
```

3. Example of security impact: If an unauthorized user gains access to the CreateIPSet event in AWS WAF, they could potentially create an IP set that whitelists their own IP address, allowing them to bypass WAF protections and gain unrestricted access to the protected resources. This could lead to unauthorized data access, privilege escalation, or compromise of sensitive information.

Remediation:
- Implement strict access controls and least privilege principles for AWS WAF, ensuring that only authorized users or roles have the necessary permissions to create or modify IP sets.
- Regularly review and monitor the IP sets created in AWS WAF to detect any unauthorized or suspicious entries.
- Enable AWS WAF geo-blocking rules to restrict IP set creation from specific geographic regions or countries, reducing the risk of unauthorized access from known malicious sources.
- Implement AWS WAF automation using AWS Lambda functions or AWS CloudWatch Events to automatically validate and verify IP set creation requests, reducing the risk of unauthorized whitelisting.

Example AWS CLI command to enable geo-blocking rule for IP set creation:
```
aws wafv2 create-geo-match-set --name MyGeoMatchSet --scope REGIONAL --description "Geo-blocking rule for IP set creation" --addresses "US" "CA" "GB"
```


 