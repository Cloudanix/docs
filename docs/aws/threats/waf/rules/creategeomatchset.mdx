--- 
slug: CreateGeoMatchSet
eventname: CreateGeoMatchSet
title: CreateGeoMatchSet
sidebar_label: CreateGeoMatchSet
---
                       
### Event Information

#### Meaning

- The CreateGeoMatchSet event in AWS WAF refers to the action of creating a Geo Match Set, which is a collection of geographic locations that can be used to create rules for AWS WAF.
- This event is triggered when a user or an automated process initiates the creation of a new Geo Match Set in AWS WAF.
- The Geo Match Set allows you to define rules based on the geographic location of the incoming requests, enabling you to block or allow traffic from specific countries or regions.

#### Example

1. Example of security impact: If an attacker successfully creates a malicious GeoMatchSet in AWS WAF, they can potentially bypass geographic restrictions and gain unauthorized access to resources. This can lead to data breaches, unauthorized modifications, or disruptions to the application.

Remediation:
- Regularly monitor and review WAF logs and CloudTrail logs to identify any unauthorized changes or suspicious activities.
- Implement strict IAM policies to limit access to WAF resources and restrict the ability to create or modify GeoMatchSets.
- Enable AWS WAF Security Automations to automatically block common attack patterns and update WAF rulesets.
- Use AWS Config to continuously monitor and enforce compliance with WAF configuration rules.
- Consider implementing AWS WAF Managed Rules to provide additional protection against common web application attacks.

Example CLI command to list all GeoMatchSets in AWS WAF:
```
aws wafv2 list-geo-match-sets --scope CLOUDWATCH_METRICS
```

2. Example of security impact: If the CreateGeoMatchSet event is triggered by an unauthorized user or a compromised account, they can potentially create a GeoMatchSet with overly permissive rules. This can result in false positives or false negatives, allowing malicious traffic to bypass WAF protections or legitimate traffic to be blocked.

Remediation:
- Implement strong access controls and enforce the principle of least privilege to restrict the ability to create or modify GeoMatchSets.
- Regularly review and validate the rules defined in GeoMatchSets to ensure they align with the intended security policies.
- Enable AWS WAF logging and integrate it with a centralized logging and monitoring solution to detect and respond to any suspicious activities.
- Implement a robust change management process to review and approve any changes to WAF configurations, including GeoMatchSets.
- Regularly update and patch the underlying infrastructure and applications to minimize the risk of vulnerabilities that could be exploited.

Example CLI command to create a GeoMatchSet in AWS WAF:
```
aws wafv2 create-geo-match-set --name MyGeoMatchSet --scope CLOUDWATCH_METRICS
```

3. Example of security impact: If the CreateGeoMatchSet event is triggered without proper validation or input sanitization, it can potentially lead to injection attacks or allow the creation of malicious GeoMatchSets with unexpected behavior. This can result in bypassing WAF protections or causing false positives/negatives.

Remediation:
- Implement input validation and sanitization mechanisms to prevent injection attacks when creating GeoMatchSets.
- Apply strict input validation rules to ensure that only valid and expected values are accepted for the GeoMatchSet rules.
- Regularly review and test the GeoMatchSet creation process for any vulnerabilities or weaknesses.
- Implement automated testing and security scanning tools to identify any potential security issues in the GeoMatchSet creation process.
- Regularly update and patch the WAF service and underlying infrastructure to mitigate any known vulnerabilities.

Example CLI command to update a GeoMatchSet in AWS WAF:
```
aws wafv2 update-geo-match-set --name MyGeoMatchSet --scope CLOUDWATCH_METRICS --description "Updated GeoMatchSet"
```


 