--- 
slug: DeleteRegexMatchSet
eventname: DeleteRegexMatchSet
title: DeleteRegexMatchSet
sidebar_label: DeleteRegexMatchSet
---
                       
### Event Information

- The DeleteRegexMatchSet event in AWS WAF refers to the action of deleting a regular expression (regex) match set. 
- A regex match set is a collection of regex patterns that are used to match against web request data in order to identify and block malicious or unwanted traffic. 
- When the DeleteRegexMatchSet event occurs, it means that a specific regex match set has been removed from the AWS WAF configuration, and any rules or conditions associated with that match set will no longer be applied.


### Examples

1. Inadequate protection against malicious regex patterns: If security is impacted with DeleteRegexMatchSet in AWS WAF, one example could be the inadvertent removal of a regex pattern that was effectively blocking a specific type of malicious input. This could result in an increased risk of attacks exploiting that specific pattern, potentially leading to unauthorized access or data breaches.

2. Weakening of overall WAF protection: Another example could be the accidental deletion of a regex match set that was an integral part of the overall WAF protection strategy. This could result in a reduced effectiveness of the WAF in detecting and blocking malicious requests, leaving the application more vulnerable to various types of attacks such as SQL injection or cross-site scripting.

3. Compliance violations: Deleting a regex match set without proper consideration of compliance requirements can also impact security. For example, if the regex match set was specifically designed to enforce compliance with certain regulations or industry standards (e.g., PCI DSS), its deletion could result in non-compliance and potential penalties. It is crucial to carefully assess the impact on compliance before deleting any regex match set in AWS WAF.

### Remediation

#### Using Console

1. Log in to the AWS Management Console and navigate to the AWS WAF service.
2. In the left navigation pane, click on "Web ACLs" to view the list of available web ACLs.
3. Select the web ACL that contains the regex match set you want to delete.
4. In the "Rules" tab, locate the rule that includes the regex match set you want to delete.
5. Click on the rule to expand its details and view the associated regex match sets.
6. Identify the specific regex match set you want to delete and click on the "Delete" button next to it.
7. A confirmation prompt will appear, asking you to confirm the deletion. Review the details and click "Delete" to proceed.
8. The regex match set will be deleted, and the associated rule will be updated accordingly.
9. It is recommended to review the overall impact of the deletion on your WAF protection and compliance requirements to ensure there are no unintended consequences.
10. Monitor your application's behavior and security after the deletion to ensure that there are no adverse effects or vulnerabilities introduced.

#### Using CLI

1. To remediate inadequate protection against malicious regex patterns in AWS WAF, you can use the AWS CLI command `create-regex-match-set` to recreate the deleted regex match set. Make sure to include the necessary regex patterns that were previously blocking the specific type of malicious input.

2. If the overall WAF protection has been weakened due to the accidental deletion of a regex match set, you can use the AWS CLI command `update-web-acl` to update the web ACL associated with the WAF. Include the missing regex match set in the updated web ACL to restore the comprehensive protection against various types of attacks.

3. To address compliance violations caused by the deletion of a regex match set, you should first identify the specific compliance requirements that were being enforced by the match set. Then, use the AWS CLI command `create-regex-match-set` to recreate the match set with the necessary regex patterns. Finally, update the web ACL associated with the WAF using the AWS CLI command `update-web-acl` to include the re-created match set and ensure compliance with the relevant regulations or industry standards.

#### Using Python

To remediate inadequate protection against malicious regex patterns in AWS WAF, you can follow these steps using Python scripts:

1. Regular Expression Backup: Before making any changes to the regex match set, it is recommended to create a backup of the existing regex patterns. You can use the AWS SDK for Python (Boto3) to retrieve the current regex match set and store it in a secure location.

```python
import boto3

# Create a client for AWS WAF
waf_client = boto3.client('waf')

# Retrieve the regex match set
response = waf_client.get_regex_match_set(
    RegexMatchSetId='your_regex_match_set_id'
)

# Store the regex patterns in a file or database
regex_patterns = response['RegexMatchSet']['RegexMatchTuples']
# Store the regex patterns securely
# ...
```

2. Validate Changes: Before deleting any regex pattern, it is important to validate the impact of the change. You can use Python scripts to test the application with the regex pattern temporarily disabled and ensure that it doesn't introduce any vulnerabilities.

```python
# Disable the regex pattern temporarily
response = waf_client.update_regex_match_set(
    RegexMatchSetId='your_regex_match_set_id',
    Updates=[
        {
            'Action': 'DELETE',
            'RegexMatchTuple': {
                'FieldToMatch': {
                    'Type': 'URI'
                },
                'TextTransformation': 'NONE',
                'RegexPatternSetId': 'your_regex_pattern_set_id'
            }
        }
    ]
)

# Test the application with the disabled regex pattern
# ...
```

3. Monitor and Audit: Implement a monitoring and auditing mechanism to track any changes made to the regex match set. This can help identify any accidental deletions or modifications and allow for quick remediation.

```python
# Enable CloudTrail for AWS WAF
# ...

# Set up CloudWatch Events to monitor changes to the regex match set
# ...

# Implement a process to review and analyze the logs regularly
# ...
```

By following these steps and using Python scripts, you can remediate inadequate protection against malicious regex patterns in AWS WAF while ensuring the security and compliance of your application.


 