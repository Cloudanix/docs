--- 
slug: DeleteSizeConstraintSet
eventname: DeleteSizeConstraintSet
title: DeleteSizeConstraintSet
sidebar_label: DeleteSizeConstraintSet
---
                       
### Event Information

#### Meaning

- The DeleteSizeConstraintSet event in AWS WAF refers to the action of deleting a size constraint set within the Web Application Firewall (WAF) service.
- Size constraint sets in AWS WAF are used to define rules that limit the size of specific parts of HTTP requests or responses. These rules help protect against attacks that exploit vulnerabilities related to oversized requests or responses.
- When the DeleteSizeConstraintSet event occurs, it means that a size constraint set has been removed from the WAF configuration, and any associated rules or conditions related to that set will no longer be enforced.

### Remediation

#### Using Console

- Example: If security is impacted with DeleteSizeConstraintSet in AWS WAF, an attacker could potentially delete a size constraint set that is crucial for protecting against large HTTP requests. This could lead to an increased risk of denial-of-service (DoS) attacks or data breaches.

- Remediation steps using AWS console:
  1. Sign in to the AWS Management Console and open the AWS WAF console.
  2. In the navigation pane, choose "Web ACLs" and select the web ACL that contains the size constraint set you want to protect.
  3. In the "Rules" tab, select the rule that references the size constraint set.
  4. Click on the "Edit" button next to the rule.
  5. In the rule editor, remove the action that allows the deletion of the size constraint set (e.g., DeleteSizeConstraintSet).
  6. Click on the "Update" button to save the changes to the rule.
  7. Test the updated web ACL to ensure that the size constraint set cannot be deleted anymore.

Note: It is important to regularly monitor and review the AWS WAF configuration to identify any unauthorized changes or potential security risks. Additionally, implementing appropriate IAM policies and access controls can help prevent unauthorized access to the AWS WAF console and API actions.

#### Using CLI

- Example: If security is impacted with DeleteSizeConstraintSet in AWS WAF, it could potentially lead to the removal of a size constraint set that is actively protecting against malicious requests based on size limits. This can result in an increased risk of attacks such as DDoS or data exfiltration.

- Remediation steps using AWS CLI:
  1. First, ensure you have the AWS CLI installed and configured with appropriate credentials.
  2. To remediate the impact of DeleteSizeConstraintSet, you can restore the deleted size constraint set using the `create-size-constraint-set` command. This command allows you to recreate the size constraint set with the same or updated configurations.
  3. Use the `create-size-constraint-set` command with the necessary parameters such as `Name`, `ChangeToken`, and `SizeConstraints` to recreate the size constraint set. For example:
     ```
     aws wafv2 create-size-constraint-set --name <name-of-size-constraint-set> --scope <scope-of-the-set> --change-token <change-token> --size-constraints <size-constraints>
     ```
     Replace `<name-of-size-constraint-set>`, `<scope-of-the-set>`, `<change-token>`, and `<size-constraints>` with the appropriate values specific to your environment.

Note: It is crucial to regularly backup and version control your WAF configurations to avoid accidental deletions and ensure quick recovery in case of security impacts.

#### Using Python

- Example: If security is impacted with DeleteSizeConstraintSet in AWS WAF, an attacker could potentially delete a size constraint set that is crucial for protecting against large HTTP requests. This could lead to an increased risk of denial-of-service (DoS) attacks or data breaches.

- Remediation steps for AWS WAF using Python:
  1. Implement proper access controls: Ensure that only authorized users or roles have permissions to delete size constraint sets in AWS WAF. Use AWS Identity and Access Management (IAM) policies to restrict access to the necessary individuals or roles.
  
  ```python
  import boto3

  def restrict_delete_size_constraint_set():
      waf_client = boto3.client('waf')
      response = waf_client.update_permission_policy(
          ResourceArn='arn:aws:waf:us-west-2:123456789012:rulegroup/size-constraint-set',
          Policy='{"Version":"2012-10-17","Statement":[{"Sid":"RestrictDeleteSizeConstraintSet","Effect":"Deny","Principal":"*","Action":"waf:DeleteSizeConstraintSet","Resource":"arn:aws:waf:us-west-2:123456789012:rulegroup/size-constraint-set"}]}'
      )
      print(response)

  restrict_delete_size_constraint_set()
  ```
  
  2. Enable AWS CloudTrail logging: Enable AWS CloudTrail to capture all API calls made to AWS WAF, including delete operations. This will provide an audit trail and help in identifying any unauthorized or suspicious activities.
  
  ```python
  import boto3

  def enable_cloudtrail_logging():
      cloudtrail_client = boto3.client('cloudtrail')
      response = cloudtrail_client.update_trail(
          Name='my-cloudtrail',
          CloudWatchLogsLogGroupArn='arn:aws:logs:us-west-2:123456789012:log-group:/aws/cloudtrail/my-cloudtrail',
          CloudWatchLogsRoleArn='arn:aws:iam::123456789012:role/CloudTrail_CloudWatchLogs_Role',
          EnableLogFileValidation=True
      )
      print(response)

  enable_cloudtrail_logging()
  ```
  
  3. Implement automated backups: Regularly backup the AWS WAF configuration, including size constraint sets, using AWS Backup or a custom script. This will allow for easy restoration in case of accidental deletion or malicious actions.
  
  ```python
  import boto3

  def create_aws_backup_plan():
      backup_client = boto3.client('backup')
      response = backup_client.create_backup_plan(
          BackupPlan={
              'BackupPlanName': 'my-waf-backup-plan',
              'BackupPlanRule': [
                  {
                      'RuleName': 'waf-size-constraint-set-backup',
                      'TargetBackupVaultName': 'my-waf-backup-vault',
                      'ScheduleExpression': 'cron(0 0 * * ? *)',
                      'StartWindowMinutes': 60,
                      'CompletionWindowMinutes': 10080
                  }
              ]
          }
      )
      print(response)

  create_aws_backup_plan()
  ```


 