

<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and navigate to the EC2 dashboard.
2. In the navigation pane, under "Load Balancing", click on "Load Balancers".
3. Select the load balancer you want to inspect. In the bottom panel, click on the "Listeners" tab.
4. Check the "SSL Certificate" column. If the SSL certificate is not listed for the HTTPS or SSL protocols, it means that the load balancer is not using SSL/TLS for traffic encryption.

#### Using CLI

1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Make sure you have the necessary permissions to access the Elastic Load Balancer (ELB) resources.

2. Once the AWS CLI is set up, you can list all the load balancers in your account using the following command:

   ```
   aws elbv2 describe-load-balancers
   ```

   This command will return a JSON output with details of all the load balancers.

3. To check the SSL policies of the load balancers, you need to describe the listener configurations. You can do this using the following command:

   ```
   aws elbv2 describe-listeners --load-balancer-arn <load-balancer-arn>
   ```

   Replace `<load-balancer-arn>` with the ARN of your load balancer. This command will return a JSON output with details of all the listeners for the specified load balancer.

4. From the output of the previous command, you can check the SSL policy of each listener. The SSL policy is specified in the `SslPolicy` field of the `DefaultActions` object. If the SSL policy is not the latest, then it is a misconfiguration.

#### Using Python

1. Install the necessary Python libraries: Before you can start writing the script, you need to install the necessary Python libraries. The AWS SDK for Python (Boto3) allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, etc. You can install it using pip:

   ```bash
   pip install boto3
   ```

2. Set up AWS credentials: You need to configure your AWS credentials. You can do this by using the AWS CLI, or by manually adding them to your AWS credentials file (located at ~/.aws/credentials). For example:

   ```bash
   aws configure
   ```

   Then input your AWS Access Key ID, AWS Secret Access Key, Default region name, and Default output format when prompted.

3. Write the Python script: Now you can write a Python script that uses Boto3 to check the SSL Negotiations policy for App-Tier ELBs. Here's an example:

   ```python
   import boto3

   def check_ssl_policy():
       elb = boto3.client('elbv2')
       elbs = elb.describe_load_balancers()
       for elb in elbs['LoadBalancers']:
           if elb['Type'] == 'application':
               policies = elb.describe_ssl_policies(Names=[elb['SslPolicy']])
               for policy in policies['SslPolicies']:
                   if policy['Name'] == 'ELBSecurityPolicy-TLS-1-2-2017-01':
                       print(f"ELB {elb['LoadBalancerName']} is using the latest SSL policy.")
                   else:
                       print(f"ELB {elb['LoadBalancerName']} is not using the latest SSL policy.")

   if __name__ == "__main__":
       check_ssl_policy()
   ```

4. Run the Python script: Finally, you can run the Python script. It will print out the names of all the application load balancers and whether they are using the latest SSL policy or not. If a load balancer is not using the latest SSL policy, it means there is a misconfiguration.

   ```bash
   python check_ssl_policy.py
   ```

</Tab>

<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration "Latest AWS Security Policy for SSL Negotiations Should Be Used For App-Tier ELBs" in AWS using the AWS console, follow these steps:

1. Log in to the AWS Management Console.
2. Navigate to the EC2 dashboard.
3. Click on the "Load Balancers" link in the left-hand navigation menu.
4. Select the App-Tier ELB that needs remediation.
5. Click on the "Listeners" tab.
6. Select the HTTPS listener that needs remediation.
7. Click on the "Edit" button.
8. In the "Edit Listener" dialog box, select the latest AWS Security Policy from the "Security policy" drop-down menu.
9. Click the "Save" button to save the changes.

Once the above steps are completed, the App-Tier ELB will be configured to use the latest AWS Security Policy for SSL negotiations.

#### Using CLI

To remediate the misconfiguration of using the latest AWS Security Policy for SSL negotiations for App-Tier ELBs in AWS using AWS CLI, follow these steps:

1. Open your AWS CLI on your local machine or EC2 instance.

2. Run the following command to get the current SSL policy for your App-Tier ELB:

   ```
   aws elb describe-load-balancers --load-balancer-name <your-ELB-name> --query "LoadBalancerDescriptions[].ListenerDescriptions[].PolicyNames[]"
   ```

   Replace `<your-ELB-name>` with the name of your App-Tier ELB.

3. If the output includes any SSL policies other than the latest AWS Security Policy, you need to update the SSL policy. Run the following command to update the SSL policy for your App-Tier ELB:

   ```
   aws elb set-load-balancer-policies-of-listener --load-balancer-name <your-ELB-name> --load-balancer-port 443 --policy-names ELBSecurityPolicy-2016-08
   ```

   Replace `<your-ELB-name>` with the name of your App-Tier ELB.

4. Verify that the SSL policy has been updated by running the command in step 2 again.

5. Repeat steps 2-4 for all App-Tier ELBs in your AWS environment.

By following these steps, you can remediate the misconfiguration of using the latest AWS Security Policy for SSL negotiations for App-Tier ELBs in AWS using AWS CLI.

#### Using Python

To remediate the misconfiguration "Latest AWS Security Policy for SSL Negotiations Should Be Used For App-Tier ELBs" in AWS using Python, follow the steps below:

1. Import the necessary AWS libraries and modules:

```python
import boto3
from botocore.exceptions import ClientError
```

2. Create an ELB client object:

```python
elb_client = boto3.client('elbv2')
```

3. Get a list of all the existing load balancers:

```python
response = elb_client.describe_load_balancers()
load_balancers = response['LoadBalancers']
```

4. Loop through the list of load balancers and check if they are application tier ELBs:

```python
for lb in load_balancers:
    if lb['Type'] == 'application':
        # Do something
```

5. Once you have identified the application tier ELBs, update their SSL policy to use the latest AWS security policy:

```python
try:
    response = elb_client.set_security_groups(
        LoadBalancerArn=lb['LoadBalancerArn'],
        SecurityGroups=[
            'security_group_id'
        ]
    )
except ClientError as e:
    print(e)
```

6. Replace `'security_group_id'` with the ID of the security group that you want to associate with the ELB.

7. Finally, run the Python script to remediate the misconfiguration.


</Tab>
</Tabs>