---
slug: elb_alb_security_policy
title: ALBs Should Have Latest SSL/TLS Configurations
sidebar_label: ALBs Should Have Latest SSL/TLS Configurations
---

### More Info:

Your Amazon ALBs should be using the latest predefined security policy for their SSL negotiation configuration in order to follow security best practices and protect their front-end connections against SSL/TLS vulnerabilities.

### Risk Level

Medium

### Address

Security

### Compliance Standards

AWSWAF, HIPAA, GDPR, NIST



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and navigate to the EC2 Dashboard. 

2. In the left navigation pane, under the "Load Balancing" section, click on "Load Balancers". This will display a list of all the Application Load Balancers (ALBs) currently deployed within your AWS account.

3. Select the ALB that you want to check for SSL/TLS configuration. In the bottom panel, click on the "Listeners" tab. This will display the protocols and ports used by the selected ALB.

4. Check the SSL/TLS protocol version and cipher suites used by the ALB. If the ALB is not using the latest SSL/TLS configurations, it is a misconfiguration. The latest SSL/TLS configurations should be TLS 1.2 or TLS 1.3, and the cipher suites should be the latest secure ones recommended by AWS.

#### Using CLI

1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Make sure you have the necessary permissions to access the Elastic Load Balancer (ELB) services.

2. Once the AWS CLI is set up, you can list all the Application Load Balancers (ALBs) in your account using the following command:

   ```
   aws elbv2 describe-load-balancers
   ```

   This command will return a JSON output with details of all the ALBs in your account.

3. To check the SSL/TLS configurations of each ALB, you need to describe the listener configuration. You can do this using the following command:

   ```
   aws elbv2 describe-listeners --load-balancer-arn <LoadBalancerArn>
   ```

   Replace `<LoadBalancerArn>` with the ARN of the ALB you want to check. This command will return a JSON output with details of the listener configuration.

4. From the output of the previous command, you can check the SSL/TLS configurations under the "Certificates" and "SslPolicy" fields. The "Certificates" field will show the SSL/TLS certificate used by the ALB, and the "SslPolicy" field will show the SSL/TLS policy. If the SSL/TLS policy is not the latest, then the ALB does not have the latest SSL/TLS configurations.

#### Using Python

1. Install the necessary Python libraries: Before you start, make sure you have the necessary Python libraries installed. You will need the boto3 library, which is the Amazon Web Services (AWS) SDK for Python. It allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, and others. You can install it using pip:

   ```python
   pip install boto3
   ```

2. Set up AWS credentials: You need to configure your AWS credentials. You can set your credentials via the AWS CLI, or by manually creating the files yourself. The default location for the file is `~/.aws/credentials`. At a minimum, the credentials file should look like this:

   ```python
   [default]
   aws_access_key_id = YOUR_ACCESS_KEY
   aws_secret_access_key = YOUR_SECRET_KEY
   ```

3. Create a Python script to check ALBs SSL/TLS configurations: Now you can create a Python script that uses the boto3 library to interact with AWS and check the SSL/TLS configurations of your ALBs. Here is a basic example:

   ```python
   import boto3

   def check_alb_ssl_configurations():
       client = boto3.client('elbv2')
       load_balancers = client.describe_load_balancers()
       for lb in load_balancers['LoadBalancers']:
           if lb['Type'] == 'application':
               listeners = client.describe_listeners(LoadBalancerArn=lb['LoadBalancerArn'])
               for listener in listeners['Listeners']:
                   if listener['Protocol'] == 'HTTPS':
                       if 'SslPolicy' in listener:
                           if listener['SslPolicy'] != 'ELBSecurityPolicy-TLS-1-2-2017-01':
                               print(f"ALB {lb['LoadBalancerName']} does not have the latest SSL/TLS configuration.")

   if __name__ == "__main__":
       check_alb_ssl_configurations()
   ```

4. Run the Python script: Finally, you can run the Python script. It will print out the names of any ALBs that do not have the latest SSL/TLS configuration. If no output is produced, that means all your ALBs have the latest SSL/TLS configuration.

   ```python
   python check_alb_ssl_configurations.py
   ```

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

Sure, here are the step-by-step instructions to remediate the misconfiguration of ALBs not having latest SSL/TLS configurations in AWS:

1. Login to your AWS Management Console.
2. Navigate to the EC2 dashboard.
3. Click on the "Load Balancers" option under the "LOAD BALANCING" section in the left-hand menu.
4. Select the ALB that you want to remediate and click on its name to open its configuration page.
5. Click on the "Listeners" tab in the ALB configuration page.
6. Click on the "Edit" button next to the listener that you want to update the SSL/TLS configuration for.
7. In the "Edit Listener" dialog box, select the "HTTPS" protocol.
8. Under the "SSL/TLS certificates" section, select the certificate that you want to use for the listener.
9. Under the "Security policy" section, select the latest SSL/TLS policy that is available in the drop-down list.
10. Click on the "Save" button to save the changes.

After following these steps, your ALB will have the latest SSL/TLS configurations.

#### Using CLI

To remediate this misconfiguration for AWS using AWS CLI, you can follow the below steps:

1. Check the current SSL/TLS configuration of your Application Load Balancer (ALB) using the following AWS CLI command:
```
aws elbv2 describe-load-balancers --load-balancer-arns <your-alb-arn> --query "LoadBalancers[].{Name:LoadBalancerName, Scheme:Scheme, SecurityGroups:SecurityGroups, SSLPolicy:SSLPolicy}"
```
Note: Replace `<your-alb-arn>` with the ARN of your ALB.

2. Identify the latest SSL/TLS configuration that you want to apply to your ALB. You can refer to the AWS documentation to find the latest SSL/TLS configurations supported by ALBs.

3. Update the SSL/TLS configuration of your ALB using the following AWS CLI command:
```
aws elbv2 modify-listener --listener-arn <your-listener-arn> --ssl-policy <your-ssl-policy>
```
Note: Replace `<your-listener-arn>` with the ARN of your listener and `<your-ssl-policy>` with the name of the SSL/TLS policy that you want to apply.

4. Verify the SSL/TLS configuration of your ALB using the following AWS CLI command:
```
aws elbv2 describe-listeners --listener-arns <your-listener-arn> --query "Listeners[].{Protocol:Protocol, Port:Port, SSLPolicy:SSLPolicy}"
```
Note: Replace `<your-listener-arn>` with the ARN of your listener.

5. Repeat steps 1-4 for all your ALBs to ensure that they have the latest SSL/TLS configurations.

Note: Make sure to test your application after updating the SSL/TLS configuration of your ALB to ensure that it is working as expected.

#### Using Python

To remediate the misconfiguration of ALBs not having the latest SSL/TLS configurations in AWS using Python, you can follow the below steps:

1. Install the required Python libraries: boto3 and botocore. You can install them using the following command:

```
pip install boto3 botocore
```

2. Create a boto3 client for AWS Application Load Balancer (ALB) using the following code:

```python
import boto3

elbv2 = boto3.client('elbv2')
```

3. Get the list of all the existing ALBs using the following code:

```python
response = elbv2.describe_load_balancers()
load_balancers = response['LoadBalancers']
```

4. Loop through all the ALBs and check if they are using the latest SSL/TLS configurations. You can use the following code to check if the ALB is using the latest SSL/TLS configurations:

```python
for lb in load_balancers:
    arn = lb['LoadBalancerArn']
    response = elbv2.describe_listeners(LoadBalancerArn=arn)
    listeners = response['Listeners']
    for listener in listeners:
        if listener['Protocol'] == 'HTTPS':
            ssl_policy = listener.get('SslPolicy')
            if ssl_policy != 'ELBSecurityPolicy-TLS-1-2-2017-01':
                # Update the SSL/TLS configuration
                elbv2.modify_listener(
                    ListenerArn=listener['ListenerArn'],
                    SslPolicy='ELBSecurityPolicy-TLS-1-2-2017-01'
                )
```

5. The above code will update the SSL/TLS configuration of the ALB to the latest one if it is not already using it.

6. You can schedule this Python script to run periodically to ensure that all the ALBs are using the latest SSL/TLS configurations.

### Additional Reading:

- [https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/environments-cfg-alb.html](https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/environments-cfg-alb.html) 


</Tab>
</Tabs>