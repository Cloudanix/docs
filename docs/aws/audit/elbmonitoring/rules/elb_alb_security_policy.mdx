---
slug: elb_alb_security_policy
title: ALBs Should Have Latest SSL/TLS Configurations
sidebar_label: ALBs Should Have Latest SSL/TLS Configurations
---

### More Info:

Your Amazon ALBs should be using the latest predefined security policy for their SSL negotiation configuration in order to follow security best practices and protect their front-end connections against SSL/TLS vulnerabilities.

### Risk Level

Medium

### Address

Security

### Compliance Standards

AWSWAF, HIPAA, GDPR, NIST


### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console and open the Amazon EC2 console at https://console.aws.amazon.com/ec2/.
   
2. In the navigation pane, under LOAD BALANCING, choose Load Balancers.

3. Select the Application Load Balancer (ALB) that you want to inspect.

4. In the bottom panel, select the "Listeners" tab. Here you can see the protocols and ciphers used by the ALB.

5. Click on "View/edit certificates" under SSL certificate to check the SSL/TLS configurations. 

Note: The latest SSL/TLS configurations are TLS 1.2 or TLS 1.3. If the ALB is using any protocol lower than these, it is not using the latest SSL/TLS configurations.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start, you need to install the AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Once installed, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your AWS Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all the load balancers: Use the following command to list all the load balancers in your account.

   ```
   aws elbv2 describe-load-balancers
   ```

   This command will return a JSON object with details about all your load balancers.

3. Describe the SSL policies: For each load balancer, you need to describe the SSL policies. You can do this by running the following command:

   ```
   aws elbv2 describe-ssl-policies --names [policy-name]
   ```

   Replace `[policy-name]` with the name of the SSL policy you want to describe. This command will return a JSON object with details about the SSL policy.

4. Check the SSL/TLS configurations: In the JSON object returned by the previous command, look for the `SslProtocols` and `CipherSuites` fields. These fields contain the SSL/TLS protocols and cipher suites used by the load balancer. Make sure that they are up-to-date and secure. If they are not, then your load balancer does not have the latest SSL/TLS configurations.
</Accordion>

<Accordion title='Using Python'>
1. Install the necessary Python libraries: Boto3 is the Amazon Web Services (AWS) Software Development Kit (SDK) for Python, which allows Python developers to write software that makes use of AWS services like Amazon S3, Amazon EC2, etc. You can install it using pip:

   ```python
   pip install boto3
   ```

2. Configure your AWS credentials: Boto3 needs your AWS credentials (access key and secret access key) to call the AWS services. You can configure it in several ways. One way is to use the AWS CLI:

   ```bash
   aws configure
   AWS Access Key ID [None]: YOUR_ACCESS_KEY
   AWS Secret Access Key [None]: YOUR_SECRET_KEY
   Default region name [None]: YOUR_REGION_NAME
   Default output format [None]: json
   ```

3. Write a Python script to list all the ALBs and their SSL/TLS configurations:

   ```python
   import boto3

   # Create a client
   client = boto3.client('elbv2')

   # List all the load balancers
   response = client.describe_load_balancers()

   for lb in response['LoadBalancers']:
       # Get the listeners for the load balancer
       listeners = client.describe_listeners(LoadBalancerArn=lb['LoadBalancerArn'])

       for listener in listeners['Listeners']:
           # Get the SSL policy if the protocol is HTTPS
           if listener['Protocol'] == 'HTTPS':
               policy = client.describe_ssl_policies(Names=[listener['SslPolicy']])
               print(f"Load Balancer: {lb['LoadBalancerName']}, SSL Policy: {policy['SslPolicies'][0]['Name']}")
   ```

4. Run the Python script: This script will print the name of each ALB and its SSL/TLS policy. If the policy is not the latest, it means the ALB does not have the latest SSL/TLS configurations. You can run the script using the Python command:

   ```bash
   python check_ssl_policy.py
   ```

This script only checks the SSL/TLS policy of the ALBs. It does not check other configurations like cipher suites, protocol versions, etc. You may need to modify the script to check those configurations based on your requirements.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
Sure, here are the step-by-step instructions to remediate the misconfiguration of ALBs not having latest SSL/TLS configurations in AWS:

1. Login to your AWS Management Console.
2. Navigate to the EC2 dashboard.
3. Click on the "Load Balancers" option under the "LOAD BALANCING" section in the left-hand menu.
4. Select the ALB that you want to remediate and click on its name to open its configuration page.
5. Click on the "Listeners" tab in the ALB configuration page.
6. Click on the "Edit" button next to the listener that you want to update the SSL/TLS configuration for.
7. In the "Edit Listener" dialog box, select the "HTTPS" protocol.
8. Under the "SSL/TLS certificates" section, select the certificate that you want to use for the listener.
9. Under the "Security policy" section, select the latest SSL/TLS policy that is available in the drop-down list.
10. Click on the "Save" button to save the changes.

After following these steps, your ALB will have the latest SSL/TLS configurations.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate this misconfiguration for AWS using AWS CLI, you can follow the below steps:

1. Check the current SSL/TLS configuration of your Application Load Balancer (ALB) using the following AWS CLI command:
```
aws elbv2 describe-load-balancers --load-balancer-arns <your-alb-arn> --query "LoadBalancers[].{Name:LoadBalancerName, Scheme:Scheme, SecurityGroups:SecurityGroups, SSLPolicy:SSLPolicy}"
```
Note: Replace `<your-alb-arn>` with the ARN of your ALB.

2. Identify the latest SSL/TLS configuration that you want to apply to your ALB. You can refer to the AWS documentation to find the latest SSL/TLS configurations supported by ALBs.

3. Update the SSL/TLS configuration of your ALB using the following AWS CLI command:
```
aws elbv2 modify-listener --listener-arn <your-listener-arn> --ssl-policy <your-ssl-policy>
```
Note: Replace `<your-listener-arn>` with the ARN of your listener and `<your-ssl-policy>` with the name of the SSL/TLS policy that you want to apply.

4. Verify the SSL/TLS configuration of your ALB using the following AWS CLI command:
```
aws elbv2 describe-listeners --listener-arns <your-listener-arn> --query "Listeners[].{Protocol:Protocol, Port:Port, SSLPolicy:SSLPolicy}"
```
Note: Replace `<your-listener-arn>` with the ARN of your listener.

5. Repeat steps 1-4 for all your ALBs to ensure that they have the latest SSL/TLS configurations.

Note: Make sure to test your application after updating the SSL/TLS configuration of your ALB to ensure that it is working as expected.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of ALBs not having the latest SSL/TLS configurations in AWS using Python, you can follow the below steps:

1. Install the required Python libraries: boto3 and botocore. You can install them using the following command:

```
pip install boto3 botocore
```

2. Create a boto3 client for AWS Application Load Balancer (ALB) using the following code:

```python
import boto3

elbv2 = boto3.client('elbv2')
```

3. Get the list of all the existing ALBs using the following code:

```python
response = elbv2.describe_load_balancers()
load_balancers = response['LoadBalancers']
```

4. Loop through all the ALBs and check if they are using the latest SSL/TLS configurations. You can use the following code to check if the ALB is using the latest SSL/TLS configurations:

```python
for lb in load_balancers:
    arn = lb['LoadBalancerArn']
    response = elbv2.describe_listeners(LoadBalancerArn=arn)
    listeners = response['Listeners']
    for listener in listeners:
        if listener['Protocol'] == 'HTTPS':
            ssl_policy = listener.get('SslPolicy')
            if ssl_policy != 'ELBSecurityPolicy-TLS-1-2-2017-01':
                # Update the SSL/TLS configuration
                elbv2.modify_listener(
                    ListenerArn=listener['ListenerArn'],
                    SslPolicy='ELBSecurityPolicy-TLS-1-2-2017-01'
                )
```

5. The above code will update the SSL/TLS configuration of the ALB to the latest one if it is not already using it.

6. You can schedule this Python script to run periodically to ensure that all the ALBs are using the latest SSL/TLS configurations.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/environments-cfg-alb.html](https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/environments-cfg-alb.html) 

