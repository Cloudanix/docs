---
slug: internet_facing_elb
title: Internet Facing ELBs Should Be Regularly Reviewed
sidebar_label: Internet Facing ELBs Should Be Regularly Reviewed
---

### More Info:

All Amazon internet-facing load balancers (Classic Load Balancers and Application Load Balancers) provisioned within your AWS account should be regularly reviewed for security purposes.

### Risk Level

Low

### Address

Security

### Compliance Standards

CBP



### Triage and Remediation
<Tabs>


<Tab title='Prevention'>
### How to Prevent
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To prevent Internet Facing Elastic Load Balancers (ELBs) from being misconfigured in AWS, you can follow these steps using the AWS Management Console:

1. **Regularly Review ELB Configurations:**
   - Navigate to the **EC2 Dashboard** in the AWS Management Console.
   - Select **Load Balancers** from the left-hand menu.
   - Review the list of Internet-facing ELBs and their configurations, ensuring they meet your security and compliance requirements.

2. **Implement Tagging for Easy Identification:**
   - Tag your ELBs with relevant information such as environment (e.g., production, staging), owner, and purpose.
   - This helps in easily identifying and reviewing the ELBs regularly.

3. **Enable Logging and Monitoring:**
   - Enable **Access Logs** for your ELBs to capture detailed information about the requests sent to your load balancer.
   - Use **AWS CloudTrail** to log API calls and monitor changes to your ELB configurations.

4. **Set Up Alerts and Notifications:**
   - Use **Amazon CloudWatch** to set up alarms for any unusual activity or configuration changes in your ELBs.
   - Configure **SNS (Simple Notification Service)** to send notifications to the relevant teams for immediate review and action.

By following these steps, you can ensure that your Internet-facing ELBs are regularly reviewed and maintained in a secure and compliant state.
</Accordion>

<Accordion title='Using CLI'>
To prevent Internet-facing Elastic Load Balancers (ELBs) from being misconfigured in AWS, you can follow these steps using the AWS CLI:

1. **List All Internet-Facing ELBs:**
   First, identify all the internet-facing ELBs in your account. This can be done using the `describe-load-balancers` command and filtering for internet-facing ELBs.

   ```sh
   aws elb describe-load-balancers --query 'LoadBalancerDescriptions[?Scheme==`internet-facing`].[LoadBalancerName, DNSName, Scheme]' --output table
   ```

2. **Tagging ELBs for Review:**
   Tag the internet-facing ELBs with a specific tag to mark them for regular review. This helps in identifying which ELBs need to be reviewed periodically.

   ```sh
   aws elb add-tags --load-balancer-names <your-elb-name> --tags Key=Review,Value=Pending
   ```

3. **Set Up CloudWatch Alarms:**
   Create CloudWatch alarms to monitor the traffic and usage of these internet-facing ELBs. This helps in identifying unusual patterns that might indicate a misconfiguration.

   ```sh
   aws cloudwatch put-metric-alarm --alarm-name "ELB-Internet-Facing-Traffic" --metric-name RequestCount --namespace AWS/ELB --statistic Sum --period 300 --threshold 1000 --comparison-operator GreaterThanThreshold --dimensions Name=LoadBalancerName,Value=<your-elb-name> --evaluation-periods 1 --alarm-actions <sns-topic-arn>
   ```

4. **Automate Regular Reviews:**
   Use AWS Config to set up a rule that checks for internet-facing ELBs and triggers a Lambda function to review their configurations periodically.

   ```sh
   aws configservice put-config-rule --config-rule file://internet-facing-elb-rule.json
   ```

   Example `internet-facing-elb-rule.json`:
   ```json
   {
     "ConfigRuleName": "internet-facing-elb-check",
     "Description": "Check for internet-facing ELBs",
     "Scope": {
       "ComplianceResourceTypes": [
         "AWS::ElasticLoadBalancing::LoadBalancer"
       ]
     },
     "Source": {
       "Owner": "AWS",
       "SourceIdentifier": "ELB_INTERNET_FACING"
     }
   }
   ```

By following these steps, you can ensure that your internet-facing ELBs are regularly reviewed and monitored, reducing the risk of misconfigurations.
</Accordion>

<Accordion title='Using Python'>
To prevent Internet-facing Elastic Load Balancers (ELBs) from being misconfigured in AWS, you can use Python scripts to regularly review and manage these resources. Below are the steps to achieve this:

### 1. **Set Up AWS SDK for Python (Boto3)**
First, ensure you have Boto3 installed and configured with the necessary AWS credentials.

```bash
pip install boto3
```

### 2. **List All Internet-Facing ELBs**
Create a Python script to list all Internet-facing ELBs. This will help you identify which ELBs need to be reviewed.

```python
import boto3

def list_internet_facing_elbs():
    client = boto3.client('elbv2')
    response = client.describe_load_balancers()
    
    internet_facing_elbs = []
    for elb in response['LoadBalancers']:
        if elb['Scheme'] == 'internet-facing':
            internet_facing_elbs.append(elb['LoadBalancerArn'])
    
    return internet_facing_elbs

if __name__ == "__main__":
    elbs = list_internet_facing_elbs()
    print("Internet-facing ELBs:", elbs)
```

### 3. **Tagging ELBs for Review**
Tag the identified Internet-facing ELBs for regular review. This can be done by adding a specific tag to these ELBs.

```python
def tag_elbs_for_review(elb_arns):
    client = boto3.client('elbv2')
    for elb_arn in elb_arns:
        client.add_tags(
            ResourceArns=[elb_arn],
            Tags=[
                {
                    'Key': 'Review',
                    'Value': 'Pending'
                },
            ]
        )

if __name__ == "__main__":
    elbs = list_internet_facing_elbs()
    tag_elbs_for_review(elbs)
    print("Tagged ELBs for review.")
```

### 4. **Automate Regular Reviews**
Set up a scheduled job (e.g., using AWS Lambda and CloudWatch Events) to run the above scripts regularly. This ensures that Internet-facing ELBs are reviewed periodically.

```python
import boto3
from datetime import datetime, timedelta

def review_elbs():
    client = boto3.client('elbv2')
    elbs = list_internet_facing_elbs()
    
    for elb_arn in elbs:
        response = client.describe_tags(ResourceArns=[elb_arn])
        tags = response['TagDescriptions'][0]['Tags']
        
        for tag in tags:
            if tag['Key'] == 'Review' and tag['Value'] == 'Pending':
                # Perform your review logic here
                print(f"Reviewing ELB: {elb_arn}")
                # After review, update the tag
                client.add_tags(
                    ResourceArns=[elb_arn],
                    Tags=[
                        {
                            'Key': 'Review',
                            'Value': 'Completed'
                        },
                    ]
                )

if __name__ == "__main__":
    review_elbs()
    print("Reviewed and updated ELBs.")
```

### Summary
1. **Set Up AWS SDK for Python (Boto3)**: Install and configure Boto3.
2. **List All Internet-Facing ELBs**: Create a script to list all Internet-facing ELBs.
3. **Tagging ELBs for Review**: Tag these ELBs for regular review.
4. **Automate Regular Reviews**: Set up a scheduled job to run the review script periodically.

By following these steps, you can ensure that Internet-facing ELBs are regularly reviewed and managed to prevent misconfigurations.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Log in to the AWS Management Console and navigate to the EC2 dashboard.
2. In the navigation pane, under LOAD BALANCING, click on Load Balancers.
3. In the Load Balancers dashboard, you will see a list of all your load balancers. Click on the load balancer you want to check.
4. In the Description tab, under Basic Configuration, check the Scheme. If it is set to "internet-facing", it means that the load balancer is exposed to the internet.
</Accordion>

<Accordion title='Using CLI'>
1. **Install and Configure AWS CLI**: Before you can start using AWS CLI, you need to install it on your local system. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. **List all Load Balancers**: The first step to detect internet-facing ELBs is to list all the load balancers in your account. You can do this by running the following command:

    ```
    aws elbv2 describe-load-balancers
    ```

    This command will return a JSON object with details about all the load balancers in your account.

3. **Filter Internet-facing Load Balancers**: The next step is to filter out the internet-facing load balancers from the list. You can do this by looking at the `Scheme` attribute of each load balancer. If the `Scheme` is `internet-facing`, then the load balancer is exposed to the internet. You can use the following command to filter out the internet-facing load balancers:

    ```
    aws elbv2 describe-load-balancers --query 'LoadBalancers[?Scheme==`internet-facing`]'
    ```

4. **Review Regularly**: The final step is to regularly review the list of internet-facing load balancers. You can do this by running the above command at regular intervals. You can also automate this process by writing a script that runs the command and sends you an alert if any new internet-facing load balancers are detected.
</Accordion>

<Accordion title='Using Python'>
1. Install the necessary Python libraries: To interact with AWS services, you need to install the boto3 library. You can install it using pip:

   ```python
   pip install boto3
   ```

2. Configure AWS credentials: Before you can interact with AWS services, you need to set up your AWS credentials. You can do this by creating a file at ~/.aws/credentials. At the very least, the contents of the file should be:

   ```python
   [default]
   aws_access_key_id = YOUR_ACCESS_KEY
   aws_secret_access_key = YOUR_SECRET_KEY
   ```

3. Write a Python script to list all ELBs and check if they are internet-facing:

   ```python
   import boto3

   def check_internet_facing_elbs():
       client = boto3.client('elbv2')
       elbs = client.describe_load_balancers()
       for elb in elbs['LoadBalancers']:
           if elb['Scheme'] == 'internet-facing':
               print(f"Internet Facing ELB: {elb['LoadBalancerName']}")

   check_internet_facing_elbs()
   ```

   This script will print the names of all internet-facing ELBs.

4. Regularly run the script: To regularly review your ELBs, you should run this script at regular intervals. You could set up a cron job to run this script daily, weekly, or at whatever interval makes sense for your organization.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
The following are the step by step instructions to remediate the misconfiguration "Internet Facing ELBs Should Be Regularly Reviewed" in AWS using the AWS console:

1. Log in to the AWS Management Console.
2. Navigate to the EC2 service.
3. Click on the "Load Balancers" option in the left-hand menu.
4. Select the Internet-facing ELB that needs to be reviewed.
5. Click on the "Listeners" tab.
6. Review the protocol and port configuration for each listener. Ensure that they are configured according to your organization's security policies.
7. Click on the "Security" tab.
8. Review the security groups associated with the ELB. Ensure that only necessary ports are open and that the source IP ranges are restricted to only authorized IPs.
9. Click on the "Instances" tab.
10. Review the instances associated with the ELB. Ensure that they are running the latest security patches and that they are not exposing any unnecessary services.
11. Click on the "Health Check" tab.
12. Review the health check configuration. Ensure that it is configured according to your organization's security policies.
13. Click on the "Attributes" tab.
14. Review the attributes associated with the ELB. Ensure that they are configured according to your organization's security policies.
15. Make any necessary changes to the ELB configuration.
16. Click on the "Save" button to save the changes.

By following the above steps, the misconfiguration "Internet Facing ELBs Should Be Regularly Reviewed" can be remediated in AWS using the AWS console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration for AWS using AWS CLI, follow these steps:

1. Open the AWS CLI and run the following command to list all the internet-facing Elastic Load Balancers (ELBs) in your account:

   ```
   aws elbv2 describe-load-balancers --query "LoadBalancers[?Scheme=='internet-facing'].LoadBalancerArn" --output text
   ```

2. Review the output and identify any ELBs that are no longer needed or should not be internet-facing.

3. For each internet-facing ELB that needs to be reviewed, run the following command to modify the scheme to internal:

   ```
   aws elbv2 modify-load-balancer-attributes --load-balancer-arn <ELB_ARN> --attributes Key=scheme,Value=internal
   ```

   Replace `<ELB_ARN>` with the ARN of the ELB that needs to be modified.

4. Verify that the ELB's scheme has been changed to internal by running the following command:

   ```
   aws elbv2 describe-load-balancers --load-balancer-arns <ELB_ARN> --query "LoadBalancers[0].Scheme" --output text
   ```

   Replace `<ELB_ARN>` with the ARN of the ELB that was modified.

5. Repeat steps 3-4 for each internet-facing ELB that needs to be reviewed.

6. Once all internet-facing ELBs have been reviewed and modified, run the first command again to verify that all internet-facing ELBs have been remediated.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of Internet Facing ELBs in AWS, you can use the following Python script:

```
import boto3

# Create a boto3 client for ELB
elb_client = boto3.client('elbv2')

# Define the ELB ARN
elb_arn = 'arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/my-load-balancer/50dc6c495c0c9188'

# Set the desired security group ID
security_group_id = 'sg-1234567890abcdef'

# Update the ELB security group
response = elb_client.set_security_groups(
    LoadBalancerArn=elb_arn,
    SecurityGroups=[
        security_group_id,
    ]
)

# Print the response
print(response)
```

This script uses the boto3 library to create a client for Elastic Load Balancing (ELB) in AWS. It then sets the desired security group ID for the specified ELB ARN using the `set_security_groups` function. Finally, it prints the response from the API call.

To use this script, replace the `elb_arn` and `security_group_id` values with the appropriate values for your environment. You can then run the script to remediate the misconfiguration of Internet Facing ELBs in AWS.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/elb-internet-facing-load-balancers.html](https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/elb-internet-facing-load-balancers.html) 

