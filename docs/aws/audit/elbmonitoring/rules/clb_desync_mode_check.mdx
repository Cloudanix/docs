---
slug: clb_desync_mode_check
title: CLB With Desync Mitigation Mode Should Be Enabled
sidebar_label: CLB With Desync Mitigation Mode Should Be Enabled
---

### More Info:

This rule checks if Classic Load Balancers (CLB) are configured with a user defined Desync mitigation mode. The rule is NON_COMPLIANT if CLB Desync mitigation mode does not match with user defined Desync mitigation mode.

### Risk Level

Medium

### Address

Configuration

### Compliance Standards

CBP

### Remediation

#### Using Console

To remediate the misconfiguration of enabling Desync Mitigation Mode for an AWS Elastic Load Balancer (ELB) using the AWS Management Console, follow these steps:

1. **Log in to the AWS Management Console**: Go to https://aws.amazon.com/ and log in to your AWS account.

2. **Navigate to the EC2 Dashboard**: Click on the "Services" dropdown menu at the top of the page, and then select "EC2" under the "Compute" section.

3. **Access Load Balancers**: In the EC2 Dashboard, locate and click on the "Load Balancers" option in the navigation pane on the left side of the screen.

4. **Select the Load Balancer**: From the list of available load balancers, click on the name of the ELB for which you want to enable Desync Mitigation Mode.

5. **Edit the Load Balancer**: In the ELB details page, click on the "Listeners" tab.

6. **Enable Desync Mitigation Mode**: Under the "Listeners" tab, locate the listener for which you want to enable Desync Mitigation Mode. Click on the "Edit" button next to the listener.

7. **Enable Desync Mitigation Mode**: In the listener configuration window, scroll down to the "Desync Mitigation Mode" section. Check the box to enable Desync Mitigation Mode for the selected listener.

8. **Save Changes**: After enabling Desync Mitigation Mode, click on the "Save" button to apply the changes to the ELB configuration.

9. **Verify Configuration**: Once the changes are saved, you can verify that Desync Mitigation Mode is enabled for the ELB by checking the listener configuration details.

By following these steps, you can remediate the misconfiguration of enabling Desync Mitigation Mode for an AWS Elastic Load Balancer using the AWS Management Console.

#### Using CLI

To remediate the misconfiguration of Cloud Load Balancer (CLB) with Desync Mitigation Mode disabled in AWS Elastic Load Balancer using AWS CLI, follow these steps:

1. Install and configure the AWS CLI on your local machine if you haven't already. You can refer to the official AWS documentation for instructions on how to do this.

2. Run the following AWS CLI command to enable Desync Mitigation Mode for your CLB:
   
```bash
aws elb modify-load-balancer-attributes --load-balancer-name YOUR_LOAD_BALANCER_NAME --load-balancer-attributes "DesyncMitigationMode.enabled=true"
```
Replace `YOUR_LOAD_BALANCER_NAME` with the name of your CLB.

3. Verify that the Desync Mitigation Mode has been enabled successfully by running the following command:
   
```bash
aws elb describe-load-balancer-attributes --load-balancer-name YOUR_LOAD_BALANCER_NAME
```
Replace `YOUR_LOAD_BALANCER_NAME` with the name of your CLB.

4. Check the output of the above command to ensure that the Desync Mitigation Mode is set to enabled for your CLB.

By following these steps, you will successfully remediate the misconfiguration of a Cloud Load Balancer with Desync Mitigation Mode disabled in AWS Elastic Load Balancer using AWS CLI.

#### Using Python

To remediate the misconfiguration of CLB with Desync Mitigation Mode not enabled for AWS Elastic Load Balancer using Python, you can use the AWS SDK for Python (Boto3) to update the load balancer configuration. Here's a step-by-step guide on how to achieve this:

1. Install Boto3:
If you haven't already installed Boto3, you can do so using pip:
```bash
pip install boto3
```

2. Write a Python script to update the CLB configuration:
Create a Python script with the following code to enable Desync Mitigation Mode for the specified Classic Load Balancer (CLB):

```python
import boto3

# Specify the region and the name of the Classic Load Balancer
elb_region = 'your_region'
elb_name = 'your_elb_name'

# Create an ELB client
elb_client = boto3.client('elb', region_name=elb_region)

# Enable Desync Mitigation Mode for the specified Classic Load Balancer
response = elb_client.modify_load_balancer_attributes(
    LoadBalancerName=elb_name,
    LoadBalancerAttributes={
        'DesyncMitigationMode': {
            'Enabled': True
        }
    }
)

print("Desync Mitigation Mode has been enabled for the Classic Load Balancer.")
```

3. Configure AWS credentials:
Ensure that your AWS credentials are properly configured on your system. You can set them up using the AWS CLI or by setting environment variables.

4. Run the Python script:
Execute the Python script you created in step 2 to enable Desync Mitigation Mode for the specified Classic Load Balancer in your AWS account.

By following these steps, you can remediate the misconfiguration of CLB with Desync Mitigation Mode not enabled for AWS Elastic Load Balancer using Python.

