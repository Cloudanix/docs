---
slug: elb_cross_zone_enabled
title: ELBs Should Have Cross Zone Enabled
sidebar_label: ELBs Should Have Cross Zone Enabled
---

### More Info:

For higher availability and reliability, ELBs should work with cross zone nodes.

### Risk Level

Low

### Address

Reliability, Security

### Compliance Standards

NIST, SOC2, GDPR, HITRUST, NISTCSF



### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console and open the Amazon EC2 console at https://console.aws.amazon.com/ec2/.
   
2. In the navigation pane, under LOAD BALANCING, choose Load Balancers.

3. Select the load balancer that you want to check.

4. In the bottom panel, select the "Attributes" tab.

5. Under "Cross-Zone Load Balancing", check the status. If it's set to "Disabled", then the ELB does not have Cross Zone enabled.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local system and configure it with your AWS account credentials. You can do this by running the following commands:

   ```
   pip install awscli
   aws configure
   ```

   During the configuration process, you will be asked to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. List all the Load Balancers: Once your AWS CLI is set up, you can list all the Elastic Load Balancers in your account by running the following command:

   ```
   aws elbv2 describe-load-balancers
   ```

   This command will return a JSON object containing details about all the Load Balancers in your account.

3. Check Cross Zone Load Balancing: For each Load Balancer, you need to check if the Cross Zone Load Balancing is enabled or not. You can do this by running the following command:

   ```
   aws elbv2 describe-load-balancer-attributes --load-balancer-arn <Load_Balancer_Arn>
   ```

   Replace `<Load_Balancer_Arn>` with the ARN of the Load Balancer you want to check. This command will return a JSON object containing the attributes of the Load Balancer.

4. Parse the output: The output of the above command will contain a field named `cross_zone_load_balancing.enabled`. If this field is set to `false`, it means that Cross Zone Load Balancing is not enabled for the Load Balancer. If it is set to `true`, it means that Cross Zone Load Balancing is enabled. You can parse the output using a tool like `jq` or a scripting language like Python to automate the process.
</Accordion>

<Accordion title='Using Python'>
1. Install the necessary Python libraries: Before you can start writing the script, you need to install the necessary Python libraries. The Boto3 library is the Amazon Web Services (AWS) Software Development Kit (SDK) for Python, which allows Python developers to write software that makes use of AWS services like Amazon S3, Amazon EC2, etc. You can install it using pip:

   ```bash
   pip install boto3
   ```

2. Configure AWS Credentials: Boto3 needs your AWS credentials (access key and secret access key) to call AWS services on your behalf. These can be configured in several ways, but the simplest is to use the AWS CLI. Run `aws configure` and then enter your credentials at the prompts.

3. Write the Python script: The following Python script uses Boto3 to check if Cross Zone Load Balancing is enabled for all Elastic Load Balancers (ELBs) in a region.

   ```python
   import boto3

   def check_cross_zone_load_balancing():
       elb = boto3.client('elbv2')
       elbs = elb.describe_load_balancers()
       for elb in elbs['LoadBalancers']:
           attributes = elb.describe_load_balancer_attributes(LoadBalancerArn=elb['LoadBalancerArn'])
           for attr in attributes['Attributes']:
               if attr['Key'] == 'load_balancing.cross_zone.enabled':
                   print(f"ELB {elb['LoadBalancerName']} Cross Zone Load Balancing: {attr['Value']}")

   check_cross_zone_load_balancing()
   ```
   This script will print the name of each ELB and whether or not Cross Zone Load Balancing is enabled.

4. Run the script: Save the script to a file, then run it with Python. The script will print out the status of Cross Zone Load Balancing for each ELB in the region. If Cross Zone Load Balancing is not enabled for an ELB, it will print 'false'. If it is enabled, it will print 'true'. 

   ```bash
   python check_elb_cross_zone.py
   ```
   
Please note that this script only checks ELBs in the default region. If you have ELBs in other regions, you will need to modify the script to check those regions as well.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
Sure, here are the step-by-step instructions to remediate the ELBs should have cross-zone enabled misconfiguration for AWS using the AWS Console:

1. Open the AWS Management Console and navigate to the EC2 Dashboard.

2. From the left-hand menu, select "Load Balancers".

3. Select the ELB that you want to remediate.

4. Click on the "Attributes" tab.

5. Scroll down to the "Cross-Zone Load Balancing" section and click on the "Edit" button.

6. Select "Yes" for the "Enable Cross-Zone Load Balancing" option.

7. Click on the "Save" button to save the changes.

That's it! You have now successfully remediated the ELBs should have cross-zone enabled misconfiguration for AWS using the AWS Console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration "ELBs should have cross-zone enabled" in AWS using AWS CLI, follow these steps:

1. Open the AWS CLI on your local machine.

2. Run the following command to enable cross-zone load balancing for all existing ELBs in the current region:
```
aws elb modify-load-balancer-attributes --load-balancer-name <ELB_NAME> --load-balancer-attributes "{\"CrossZoneLoadBalancing\":{\"Enabled\":true}}"
```
Replace `<ELB_NAME>` with the name of the ELB that needs to be remediated.

3. Run the following command to enable cross-zone load balancing for all new ELBs created in the current region:
```
aws elb create-lb-cookie-stickiness-policy --load-balancer-name <ELB_NAME> --policy-name "cross-zone-policy" --cookie-expiration-period 60
```
Replace `<ELB_NAME>` with the name of the ELB that needs to be remediated.

4. Verify that cross-zone load balancing is enabled for the ELB by running the following command:
```
aws elb describe-load-balancer-attributes --load-balancer-name <ELB_NAME> --query 'LoadBalancerAttributes.CrossZoneLoadBalancing.Enabled'
```
Replace `<ELB_NAME>` with the name of the ELB that was remediated.

5. Repeat these steps for all ELBs in the current region that require remediation.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of ELBs not having cross-zone enabled in AWS using Python, you can follow the below steps:

1. Import the necessary libraries:
```python
import boto3
```

2. Create an AWS client for Elastic Load Balancing:
```python
elb_client = boto3.client('elbv2')
```

3. Get the list of all the ELBs:
```python
elbs = elb_client.describe_load_balancers()
```

4. Loop through each ELB and check if cross-zone load balancing is enabled. If not, enable it:
```python
for elb in elbs['LoadBalancers']:
    elb_arn = elb['LoadBalancerArn']
    elb_attributes = elb_client.describe_load_balancer_attributes(LoadBalancerArn=elb_arn)
    if not elb_attributes['Attributes'][0]['Value']:
        elb_client.modify_load_balancer_attributes(
            LoadBalancerArn=elb_arn,
            Attributes=[
                {
                    'Key': 'load_balancing.cross_zone.enabled',
                    'Value': 'true'
                }
            ]
        )
```

5. Verify that cross-zone load balancing is enabled for all the ELBs:
```python
for elb in elbs['LoadBalancers']:
    elb_arn = elb['LoadBalancerArn']
    elb_attributes = elb_client.describe_load_balancer_attributes(LoadBalancerArn=elb_arn)
    if not elb_attributes['Attributes'][0]['Value']:
        print(f"{elb['LoadBalancerName']} - Cross-Zone Load Balancing is not Enabled")
    else:
        print(f"{elb['LoadBalancerName']} - Cross-Zone Load Balancing is Enabled")
```

By following these steps, you can remediate the misconfiguration of ELBs not having cross-zone enabled in AWS using Python.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-subnets.html](https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-subnets.html) 

