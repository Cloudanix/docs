---
slug: elb_cross_zone_enabled
title: ELBs Should Have Cross Zone Enabled
sidebar_label: ELBs Should Have Cross Zone Enabled
---

### More Info:

For higher availability and reliability, ELBs should work with cross zone nodes.

### Risk Level

Low

### Address

Reliability, Security

### Compliance Standards

NIST, SOC2, GDPR, HITRUST, NISTCSF




<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to the EC2 Dashboard by selecting "Services" from the top menu and then selecting "EC2" under the "Compute" section.
3. In the EC2 Dashboard, under the "Load Balancing" section in the left navigation pane, click on "Load Balancers".
4. Select the Load Balancer you want to check. In the bottom pane, click on the "Attributes" tab. Here, you can see whether the "Cross-Zone Load Balancing" attribute is enabled or not. If it is enabled, it will show "Cross-Zone Load Balancing: Enabled". If it is not enabled, it will show "Cross-Zone Load Balancing: Disabled".

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local system and configure it with your AWS account credentials. You can do this by running the following commands:

   Installation:
   ```
   pip install awscli
   ```
   Configuration:
   ```
   aws configure
   ```
   You will be prompted to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. List all the Load Balancers: Use the following command to list all the load balancers in your AWS account:

   ```
   aws elbv2 describe-load-balancers
   ```
   This command will return a JSON output with details of all the load balancers.

3. Extract Load Balancer ARNs: From the JSON output, extract the ARN of each load balancer. You can use the 'jq' command-line JSON processor for this:

   ```
   aws elbv2 describe-load-balancers | jq -r '.LoadBalancers[].LoadBalancerArn'
   ```
   This command will return a list of all the load balancer ARNs.

4. Check Cross-Zone Load Balancing: For each load balancer ARN, use the following command to check if cross-zone load balancing is enabled:

   ```
   aws elbv2 describe-load-balancer-attributes --load-balancer-arn <LoadBalancerArn>
   ```
   Replace `<LoadBalancerArn>` with the ARN of the load balancer. This command will return a JSON output with the attributes of the load balancer. If the 'CrossZoneLoadBalancing' attribute is set to 'false', then cross-zone load balancing is not enabled for that load balancer.

#### Using Python

1. Install the necessary Python libraries: To interact with AWS services, you need to install the Boto3 library. You can install it using pip:

   ```
   pip install boto3
   ```

2. Configure AWS credentials: Before you can interact with AWS services, you need to set up your AWS credentials. You can do this by creating a file at ~/.aws/credentials. At the very least, the contents of the file should be:

   ```
   [default]
   aws_access_key_id = YOUR_ACCESS_KEY
   aws_secret_access_key = YOUR_SECRET_KEY
   ```

3. Create a Python script to check ELBs for Cross Zone Enabled: Here's a simple script that will list all ELBs and their Cross Zone Load Balancing status:

   ```python
   import boto3

   def check_cross_zone_enabled():
       elb = boto3.client('elbv2')
       load_balancers = elb.describe_load_balancers()
       for lb in load_balancers['LoadBalancers']:
           attributes = elb.describe_load_balancer_attributes(LoadBalancerArn=lb['LoadBalancerArn'])
           for attr in attributes['Attributes']:
               if attr['Key'] == 'load_balancing.cross_zone.enabled':
                   print(f"Load Balancer: {lb['LoadBalancerName']}, Cross Zone Enabled: {attr['Value']}")

   if __name__ == "__main__":
       check_cross_zone_enabled()
   ```

4. Run the script: You can run the script using the Python interpreter from your command line:

   ```
   python check_elb_cross_zone.py
   ```

This script will print the name of each load balancer and whether or not it has Cross Zone Load Balancing enabled. If the value is 'false', then the ELB does not have Cross Zone Load Balancing enabled.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

Sure, here are the step-by-step instructions to remediate the ELBs should have cross-zone enabled misconfiguration for AWS using the AWS Console:

1. Open the AWS Management Console and navigate to the EC2 Dashboard.

2. From the left-hand menu, select "Load Balancers".

3. Select the ELB that you want to remediate.

4. Click on the "Attributes" tab.

5. Scroll down to the "Cross-Zone Load Balancing" section and click on the "Edit" button.

6. Select "Yes" for the "Enable Cross-Zone Load Balancing" option.

7. Click on the "Save" button to save the changes.

That's it! You have now successfully remediated the ELBs should have cross-zone enabled misconfiguration for AWS using the AWS Console.

#### Using CLI

To remediate the misconfiguration "ELBs should have cross-zone enabled" in AWS using AWS CLI, follow these steps:

1. Open the AWS CLI on your local machine.

2. Run the following command to enable cross-zone load balancing for all existing ELBs in the current region:
```
aws elb modify-load-balancer-attributes --load-balancer-name <ELB_NAME> --load-balancer-attributes "{\"CrossZoneLoadBalancing\":{\"Enabled\":true}}"
```
Replace `<ELB_NAME>` with the name of the ELB that needs to be remediated.

3. Run the following command to enable cross-zone load balancing for all new ELBs created in the current region:
```
aws elb create-lb-cookie-stickiness-policy --load-balancer-name <ELB_NAME> --policy-name "cross-zone-policy" --cookie-expiration-period 60
```
Replace `<ELB_NAME>` with the name of the ELB that needs to be remediated.

4. Verify that cross-zone load balancing is enabled for the ELB by running the following command:
```
aws elb describe-load-balancer-attributes --load-balancer-name <ELB_NAME> --query 'LoadBalancerAttributes.CrossZoneLoadBalancing.Enabled'
```
Replace `<ELB_NAME>` with the name of the ELB that was remediated.

5. Repeat these steps for all ELBs in the current region that require remediation.

#### Using Python

To remediate the misconfiguration of ELBs not having cross-zone enabled in AWS using Python, you can follow the below steps:

1. Import the necessary libraries:
```python
import boto3
```

2. Create an AWS client for Elastic Load Balancing:
```python
elb_client = boto3.client('elbv2')
```

3. Get the list of all the ELBs:
```python
elbs = elb_client.describe_load_balancers()
```

4. Loop through each ELB and check if cross-zone load balancing is enabled. If not, enable it:
```python
for elb in elbs['LoadBalancers']:
    elb_arn = elb['LoadBalancerArn']
    elb_attributes = elb_client.describe_load_balancer_attributes(LoadBalancerArn=elb_arn)
    if not elb_attributes['Attributes'][0]['Value']:
        elb_client.modify_load_balancer_attributes(
            LoadBalancerArn=elb_arn,
            Attributes=[
                {
                    'Key': 'load_balancing.cross_zone.enabled',
                    'Value': 'true'
                }
            ]
        )
```

5. Verify that cross-zone load balancing is enabled for all the ELBs:
```python
for elb in elbs['LoadBalancers']:
    elb_arn = elb['LoadBalancerArn']
    elb_attributes = elb_client.describe_load_balancer_attributes(LoadBalancerArn=elb_arn)
    if not elb_attributes['Attributes'][0]['Value']:
        print(f"{elb['LoadBalancerName']} - Cross-Zone Load Balancing is not Enabled")
    else:
        print(f"{elb['LoadBalancerName']} - Cross-Zone Load Balancing is Enabled")
```

By following these steps, you can remediate the misconfiguration of ELBs not having cross-zone enabled in AWS using Python.


### Additional Reading:

- [https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-subnets.html](https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-subnets.html) 


</Tab>
</Tabs>