

<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console and open the Amazon EC2 console at https://console.aws.amazon.com/ec2/.

2. In the navigation pane, choose 'Instances'.

3. Select the instance that you want to check.

4. In the 'Description' tab, look for 'Termination protection' field. If it's set to 'Yes', then termination protection is enabled. If it's set to 'No', then termination protection is not enabled.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your AWS Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all EC2 instances: Use the following command to list all the EC2 instances in your AWS account.

   ```
   aws ec2 describe-instances --query 'Reservations[*].Instances[*].{Instance:InstanceId}' --output text
   ```

3. Check termination protection status: For each instance ID retrieved from the previous step, run the following command to check the termination protection status.

   ```
   aws ec2 describe-instance-attribute --instance-id <instance-id> --attribute disableApiTermination
   ```

   Replace `<instance-id>` with the ID of the instance you want to check. This command will return the termination protection status of the specified instance.

4. Analyze the output: If the output of the above command shows `"DisableApiTermination": false`, it means that termination protection is not enabled for the instance. If it shows `"DisableApiTermination": true`, it means that termination protection is enabled.

#### Using Python

1. Install the necessary Python libraries: Before you can start writing the script, you need to install the necessary Python libraries. The AWS SDK for Python (Boto3) allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, and others. You can install it using pip:

   ```bash
   pip install boto3
   ```

2. Configure AWS Credentials: You need to configure your AWS credentials. You can configure credentials by using the AWS CLI or by directly inserting your credentials into the code. However, the latter is not recommended due to security reasons. Here is how you can configure using AWS CLI:

   ```bash
   aws configure
   ```

   It will prompt you to enter the AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

3. Write the Python script: Now you can write a Python script to check if termination protection is enabled for EC2 instances. Here is a simple script:

   ```python
   import boto3

   def check_termination_protection():
       ec2 = boto3.client('ec2')
       response = ec2.describe_instances()
       for reservation in response["Reservations"]:
           for instance in reservation["Instances"]:
               instance_id = instance["InstanceId"]
               termination_protection = ec2.describe_instance_attribute(InstanceId=instance_id, Attribute='disableApiTermination')
               if termination_protection['DisableApiTermination']['Value'] == False:
                   print(f"Termination Protection is not enabled for instance: {instance_id}")

   check_termination_protection()
   ```

   This script will list all the EC2 instances for which termination protection is not enabled.

4. Run the Python script: Finally, you can run the Python script using any Python environment. If everything is set up correctly, it should print out the instance IDs for which termination protection is not enabled.

</Tab>

<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the Termination Protection Should Be Enabled misconfiguration in AWS using the AWS console, follow these steps:

1. Login to the AWS Management Console.

2. Navigate to the EC2 Dashboard.

3. Select the instance that you want to enable termination protection for.

4. Click on the "Actions" button and select "Instance Settings".

5. Click on "Change Termination Protection".

6. Select the "Enable" option and click "Save".

7. A confirmation message will appear indicating that the termination protection has been enabled.

8. Repeat steps 3-7 for each instance that needs termination protection enabled.

By following these steps, you will have successfully remediated the Termination Protection Should Be Enabled misconfiguration for your AWS environment.

#### Using CLI

To remediate the misconfiguration "Termination Protection Should Be Enabled" for an EC2 instance in AWS using AWS CLI, follow the below steps:

1. Open the AWS CLI on your local machine.

2. Run the following command to enable termination protection for an EC2 instance:
   
   ```
   aws ec2 modify-instance-attribute --instance-id <instance-id> --no-disable-api-termination
   ```
   Replace `<instance-id>` with the ID of the EC2 instance for which you want to enable termination protection.

3. Verify that the termination protection is enabled for the instance by running the following command:
   
   ```
   aws ec2 describe-instance-attribute --instance-id <instance-id> --attribute disableApiTermination
   ```
   If the output shows `"Value": false`, it means that termination protection is enabled for the instance.

4. Repeat the above steps for all the EC2 instances in your AWS account to ensure that termination protection is enabled for all of them.

Note: Enabling termination protection is a safety measure to prevent accidental termination of instances. However, it should not be used as a substitute for proper backup and disaster recovery planning.

#### Using Python

The following steps can be followed to remediate the "Termination Protection Should Be Enabled" misconfiguration in AWS using Python:

1. Import the necessary libraries:

```
import boto3
```

2. Create an EC2 client:

```
ec2 = boto3.client('ec2')
```

3. Get a list of all instances:

```
response = ec2.describe_instances()
instances = []
for reservation in response['Reservations']:
    for instance in reservation['Instances']:
        instances.append(instance['InstanceId'])
```

4. Enable termination protection for each instance:

```
for instance in instances:
    ec2.modify_instance_attribute(InstanceId=instance, DisableApiTermination={'Value': True})
```

This will enable termination protection for all instances in your AWS account.


</Tab>
</Tabs>