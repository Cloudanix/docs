---
slug: ec2_last_backup_recovery_point_created
title: Elastic Compute Cloud Should Have Recovery Point
sidebar_label: Elastic Compute Cloud Should Have Recovery Point
---

### More Info:

This rule checks if a recovery point was created for Amazon Elastic Compute Cloud (Amazon EC2) instances. The rule is NON_COMPLIANT if the Amazon EC2 instance does not have a corresponding recovery point created .

### Risk Level

High

### Address

Configuration

### Compliance Standards

CBP



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and navigate to the EC2 dashboard.
2. In the navigation pane, select "Instances" to view all the EC2 instances.
3. Select the EC2 instance you want to check for recovery points. In the "Description" tab at the bottom of the page, look for the "AMI ID" field. This is the ID of the Amazon Machine Image (AMI) that was used to launch the instance.
4. Navigate to "AMIs" in the navigation pane. Here, you can check if there are any AMIs (which serve as recovery points) available for the instance. If there are no AMIs available, it means the EC2 instance does not have a recovery point.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all EC2 instances: Use the following command to list all the EC2 instances in your AWS account.

   ```
   aws ec2 describe-instances --query 'Reservations[*].Instances[*].[InstanceId]' --output text
   ```

3. Check for recovery points: Unfortunately, AWS CLI does not provide a direct command to check for recovery points. However, you can check for the existence of Amazon Machine Images (AMIs) which serve as recovery points for EC2 instances. Use the following command to list all AMIs associated with your AWS account.

   ```
   aws ec2 describe-images --owners self
   ```

4. Analyze the output: The output of the above command will give you a list of all AMIs in your AWS account. If an EC2 instance does not have an associated AMI, it means it does not have a recovery point. You need to manually compare the list of EC2 instances from step 2 with the list of AMIs from step 3 to identify any instances without recovery points.

#### Using Python

1. Install the necessary Python libraries: Before you can start writing your Python script, you need to install the necessary libraries. The Boto3 library is the Amazon Web Services (AWS) Software Development Kit (SDK) for Python, which allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, and others. You can install it using pip:

   ```python
   pip install boto3
   ```

2. Configure AWS Credentials: Boto3 needs your AWS credentials (access key and secret access key) to call AWS services on your behalf. You can configure your credentials in several ways, but the simplest is to use the AWS CLI:

   ```bash
   aws configure
   ```

   You'll be prompted to enter your AWS Access Key ID, Secret Access Key, default region name, and default output format.

3. Write the Python script: Now you can write a Python script that uses Boto3 to check if EC2 instances have a recovery point. Here's a simple script that lists all EC2 instances and checks if they have a recovery point:

   ```python
   import boto3

   # Create a session using your AWS credentials
   session = boto3.Session(
       aws_access_key_id='YOUR_ACCESS_KEY',
       aws_secret_access_key='YOUR_SECRET_KEY',
       region_name='us-west-2'
   )

   # Create an EC2 resource object using the session
   ec2_resource = session.resource('ec2')

   # Iterate over all your EC2 instances
   for instance in ec2_resource.instances.all():
       # Get the instance ID
       instance_id = instance.id

       # Create a client for the 'backup' service
       backup_client = session.client('backup')

       # Get the recovery points for the instance
       response = backup_client.list_recovery_points_by_resource(
           ResourceType='EC2',
           ResourceArn=instance_id
       )

       # Check if there are any recovery points
       if not response['RecoveryPoints']:
           print(f'Instance {instance_id} does not have a recovery point.')
   ```

4. Run the Python script: Finally, you can run your Python script. If there are any EC2 instances without a recovery point, their instance IDs will be printed to the console.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of AWS Elastic Compute Cloud (EC2) instances not having a recovery point, you can set up automated backups using Amazon EC2's built-in feature called Amazon EC2 Instance Recovery. Here's a step-by-step guide on how to remediate this issue using the AWS Management Console:

1. **Login to AWS Console**: Go to the AWS Management Console (https://aws.amazon.com/console/) and log in to your AWS account.

2. **Navigate to EC2 Dashboard**: From the AWS Management Console, navigate to the EC2 Dashboard by clicking on "Services" at the top of the page and selecting "EC2" under the Compute section.

3. **Select EC2 Instances**: In the EC2 Dashboard, select the EC2 instance for which you want to enable recovery points by clicking on the checkbox next to the instance ID.

4. **Enable Instance Recovery**: With the instance selected, click on the "Actions" dropdown menu at the top of the page, navigate to the "Instance Settings" option, and then select "Enable Instance Recovery" from the submenu.

5. **Configure Recovery Settings**: In the Enable Instance Recovery dialog box, you can configure the recovery settings such as the "Recovery Time Objective (RTO)" which specifies the maximum time in minutes that the instance can be unavailable during recovery. Set the RTO value based on your recovery point objective.

6. **Enable Recovery**: After configuring the recovery settings, click on the "Enable Instance Recovery" button to enable automated recovery points for the selected EC2 instance.

7. **Verify Recovery Point**: To verify that the recovery point feature is enabled for the EC2 instance, you can check the instance details and look for the "Instance Recovery" status under the "Description" tab.

By following these steps, you have successfully remediated the misconfiguration of not having a recovery point for the AWS EC2 instance by enabling the Amazon EC2 Instance Recovery feature through the AWS Management Console.

#### Using CLI

To remediate the misconfiguration of not having a recovery point for an AWS EC2 instance using AWS CLI, follow these steps:

1. **Create an Amazon EBS Snapshot**:
   - Run the following AWS CLI command to create a snapshot of the EBS volume attached to your EC2 instance:
     ```
     aws ec2 create-snapshot --volume-id <VOLUME_ID> --description "Snapshot for recovery point"
     ```
     Replace `<VOLUME_ID>` with the ID of the EBS volume attached to your EC2 instance.

2. **Tag the Snapshot** (Optional but recommended):
   - It is a best practice to tag your snapshots for better organization and management. You can add tags to the snapshot using the following command:
     ```
     aws ec2 create-tags --resources <SNAPSHOT_ID> --tags Key=Name,Value=<SNAPSHOT_NAME>
     ```
     Replace `<SNAPSHOT_ID>` with the ID of the snapshot created in the previous step and `<SNAPSHOT_NAME>` with a descriptive name for the snapshot.

3. **Verify the Snapshot**:
   - You can verify that the snapshot has been created successfully by running the following command:
     ```
     aws ec2 describe-snapshots --snapshot-ids <SNAPSHOT_ID>
     ```
     Replace `<SNAPSHOT_ID>` with the ID of the snapshot created in step 1.

4. **Automate Snapshot Creation** (Optional):
   - To ensure regular snapshots are created for your EC2 instances, you can set up automated snapshot creation using AWS Lambda functions or AWS Backup.

By following these steps, you have successfully remediated the misconfiguration by creating a recovery point for your AWS EC2 instance using AWS CLI.

#### Using Python

To remediate the misconfiguration of AWS EC2 instances not having a recovery point, you can create a backup or snapshot of the EC2 instance using Python and AWS Boto3 library. Here are the steps to remediate this issue:

1. Install the Boto3 library:
```bash
pip install boto3
```

2. Create a Python script to take a snapshot of the EC2 instance. Here is an example script:

```python
import boto3

# Initialize the EC2 client
ec2 = boto3.client('ec2')

# Get the instance ID of the EC2 instance for which you want to create a snapshot
instance_id = 'YOUR_INSTANCE_ID'

# Create a snapshot of the EC2 instance
response = ec2.create_snapshot(
    Description='Snapshot for recovery point',
    VolumeId='YOUR_VOLUME_ID'
)

print(response)
```

3. Replace `'YOUR_INSTANCE_ID'` and `'YOUR_VOLUME_ID'` with the actual instance ID and volume ID of the EC2 instance for which you want to create a recovery point.

4. Run the Python script to create a snapshot of the EC2 instance. This snapshot can be used as a recovery point in case of any issues with the EC2 instance.

By following these steps, you can remediate the misconfiguration of AWS EC2 instances not having a recovery point by creating a snapshot of the instance using Python and Boto3.



</Tab>
</Tabs>