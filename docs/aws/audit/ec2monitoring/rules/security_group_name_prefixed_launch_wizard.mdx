---
slug: security_group_name_prefixed_launch_wizard
title: Security Group Name Prefixed With launch-wizard Should Not Be Used
sidebar_label: Security Group Name Prefixed With launch-wizard Should Not Be Used
---

### More Info:

EC2 security groups prefixed with launch-wizard should not be in use in order to follow AWS security best practices.

### Risk Level

Low

### Address

Security

### Compliance Standards

CBP


### Triage and Remediation
<Tabs>


<Tab title='Prevention'>
### How to Prevent
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To prevent the use of Security Group names prefixed with "launch-wizard" in EC2 using the AWS Management Console, follow these steps:

1. **Navigate to the EC2 Dashboard:**
   - Open the AWS Management Console.
   - In the Services menu, select "EC2" to go to the EC2 Dashboard.

2. **Access Security Groups:**
   - In the left-hand navigation pane, under "Network & Security," click on "Security Groups."

3. **Create a New Security Group:**
   - Click the "Create security group" button.
   - Provide a meaningful name that does not start with "launch-wizard" and fill in the required details such as description, VPC, and rules.

4. **Review and Save:**
   - Review the configuration to ensure the name does not start with "launch-wizard."
   - Click "Create security group" to save the new security group.

By following these steps, you can ensure that new security groups are created with appropriate names, avoiding the default "launch-wizard" prefix.
</Accordion>

<Accordion title='Using CLI'>
To prevent the use of Security Group names prefixed with "launch-wizard" in EC2 using AWS CLI, you can follow these steps:

1. **List Existing Security Groups**:
   - First, you need to list all existing security groups to identify any that are prefixed with "launch-wizard".
   ```sh
   aws ec2 describe-security-groups --query "SecurityGroups[?starts_with(GroupName, 'launch-wizard')].{ID:GroupId,Name:GroupName}"
   ```

2. **Create a New Security Group**:
   - Create a new security group with a more appropriate name that does not start with "launch-wizard".
   ```sh
   aws ec2 create-security-group --group-name <NewSecurityGroupName> --description "Description of the new security group"
   ```

3. **Update Instances to Use the New Security Group**:
   - Identify instances using the old security group and update them to use the new security group.
   ```sh
   INSTANCE_IDS=$(aws ec2 describe-instances --filters "Name=instance.group-name,Values=launch-wizard*" --query "Reservations[*].Instances[*].InstanceId" --output text)
   for INSTANCE_ID in $INSTANCE_IDS; do
       aws ec2 modify-instance-attribute --instance-id $INSTANCE_ID --groups <NewSecurityGroupId>
   done
   ```

4. **Delete the Old Security Group**:
   - Once all instances have been updated, delete the old security group to prevent its use.
   ```sh
   aws ec2 delete-security-group --group-id <OldSecurityGroupId>
   ```

By following these steps, you can ensure that security groups prefixed with "launch-wizard" are not used in your AWS environment.
</Accordion>

<Accordion title='Using Python'>
To prevent the use of Security Group names prefixed with "launch-wizard" in EC2 using Python scripts, you can follow these steps:

1. **Set Up AWS SDK (Boto3) and Authentication:**
   Ensure you have the AWS SDK for Python (Boto3) installed and properly configured with your AWS credentials.

   ```bash
   pip install boto3
   ```

2. **List Existing Security Groups:**
   Use Boto3 to list all existing security groups and check for any that are prefixed with "launch-wizard". This will help you identify and manage them.

   ```python
   import boto3

   ec2 = boto3.client('ec2')

   def list_security_groups():
       response = ec2.describe_security_groups()
       for sg in response['SecurityGroups']:
           if sg['GroupName'].startswith('launch-wizard'):
               print(f"Security Group with launch-wizard prefix found: {sg['GroupName']} (ID: {sg['GroupId']})")

   list_security_groups()
   ```

3. **Create Security Group with Valid Name:**
   When creating a new security group, ensure the name does not start with "launch-wizard". You can enforce this by adding a validation step in your script.

   ```python
   def create_security_group(group_name, description, vpc_id):
       if group_name.startswith('launch-wizard'):
           raise ValueError("Security Group name cannot start with 'launch-wizard'")
       
       response = ec2.create_security_group(
           GroupName=group_name,
           Description=description,
           VpcId=vpc_id
       )
       print(f"Security Group created: {response['GroupId']}")

   # Example usage
   create_security_group('my-secure-group', 'My secure group description', 'vpc-12345678')
   ```

4. **Automate Checks and Enforce Naming Conventions:**
   Implement a function to automate the check and enforce naming conventions whenever a new security group is created.

   ```python
   def enforce_naming_convention(group_name):
       if group_name.startswith('launch-wizard'):
           raise ValueError("Security Group name cannot start with 'launch-wizard'")
       return True

   def create_security_group_with_enforcement(group_name, description, vpc_id):
       if enforce_naming_convention(group_name):
           response = ec2.create_security_group(
               GroupName=group_name,
               Description=description,
               VpcId=vpc_id
           )
           print(f"Security Group created: {response['GroupId']}")

   # Example usage
   try:
       create_security_group_with_enforcement('my-secure-group', 'My secure group description', 'vpc-12345678')
   except ValueError as e:
       print(e)
   ```

By following these steps, you can prevent the creation of security groups with names prefixed with "launch-wizard" using Python scripts. This ensures that your security group naming conventions are enforced programmatically.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Log in to the AWS Management Console and navigate to the EC2 dashboard.
2. In the left navigation pane, under the "Network & Security" section, click on "Security Groups".
3. In the main panel, you will see a list of all the security groups associated with your AWS account. Look for any security group names that are prefixed with "launch-wizard".
4. If you find any, it indicates that the default security group created by the EC2 launch wizard is being used, which is a potential misconfiguration.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can run any AWS CLI commands, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   Installation:
   ```
   pip install awscli
   ```
   Configuration:
   ```
   aws configure
   ```
   You will be prompted to enter your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. List all Security Groups: Use the AWS CLI command `describe-security-groups` to list all the security groups in your AWS account. This command will return a JSON output with details of all the security groups.

   ```
   aws ec2 describe-security-groups
   ```
3. Filter Security Groups with Prefix 'launch-wizard': You can use the `jq` command-line JSON processor to filter the security groups whose name starts with 'launch-wizard'. 

   ```
   aws ec2 describe-security-groups | jq -r '.SecurityGroups[] | select(.GroupName | startswith("launch-wizard"))'
   ```
   This command will return a list of security groups whose name starts with 'launch-wizard'.

4. Review the Output: The output will contain details of all the security groups with names starting with 'launch-wizard'. You can review this output to identify any misconfigurations. If there are no security groups with names starting with 'launch-wizard', the command will return an empty output.
</Accordion>

<Accordion title='Using Python'>
1. Install and configure AWS SDK for Python (Boto3):
   You need to install Boto3 in your local environment. You can install it using pip:
   ```
   pip install boto3
   ```
   After installing Boto3, you need to configure it. You can configure it using AWS CLI:
   ```
   aws configure
   ```
   It will ask for the AWS Access Key ID, Secret Access Key, Default region name, and Default output format. You can get these details from your AWS account.

2. Write a Python script to list all the security groups:
   You can use the `describe_security_groups` method provided by Boto3 to list all the security groups. Here is a sample script:
   ```python
   import boto3

   def list_security_groups():
       ec2 = boto3.client('ec2')
       response = ec2.describe_security_groups()
       return response['SecurityGroups']

   print(list_security_groups())
   ```
   This script will print all the security groups in your AWS account.

3. Write a Python script to check if the security group name is prefixed with 'launch-wizard':
   You can modify the above script to check if the security group name is prefixed with 'launch-wizard'. Here is a sample script:
   ```python
   import boto3

   def check_security_group_name():
       ec2 = boto3.client('ec2')
       response = ec2.describe_security_groups()
       for sg in response['SecurityGroups']:
           if 'GroupName' in sg and sg['GroupName'].startswith('launch-wizard'):
               print(f"Security Group ID: {sg['GroupId']} with Name: {sg['GroupName']} is prefixed with 'launch-wizard'")

   check_security_group_name()
   ```
   This script will print the ID and name of the security groups which are prefixed with 'launch-wizard'.

4. Run the Python script:
   You can run the Python script using the following command:
   ```
   python script_name.py
   ```
   Replace `script_name.py` with the name of your Python script. This will print the ID and name of the security groups which are prefixed with 'launch-wizard'.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
Here are the step by step instructions to remediate the "Security Group Name Prefixed With launch-wizard Should Not Be Used" misconfiguration in AWS using the AWS console:

1. Log in to the AWS Management Console.
2. Go to the EC2 Dashboard.
3. Click on the "Security Groups" option in the left-hand menu.
4. Identify the security group(s) that have a name prefixed with "launch-wizard".
5. Select the security group(s) that need to be remediated.
6. Click on the "Actions" button, and then select "Edit Group Name".
7. Rename the security group(s) to a more descriptive and meaningful name that does not include the "launch-wizard" prefix.
8. Click on the "Save" button to save the changes.

Once you have completed these steps, the security group(s) will no longer have a name prefixed with "launch-wizard", and the misconfiguration will be remediated.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration "Security Group Name Prefixed With launch-wizard Should Not Be Used" for AWS using AWS CLI, follow these steps:

1. Open the AWS CLI on your local machine or on the AWS EC2 instance.

2. Run the following command to list all the security groups in your account:

   ```
   aws ec2 describe-security-groups
   ```

3. Identify the security group that has a name prefixed with "launch-wizard".

4. Run the following command to rename the security group:

   ```
   aws ec2 update-security-group-name --group-id <security-group-id> --group-name <new-security-group-name>
   ```

   Replace `<security-group-id>` with the ID of the security group that you want to rename, and `<new-security-group-name>` with a new name for the security group that does not have "launch-wizard" prefix.

   For example:

   ```
   aws ec2 update-security-group-name --group-id sg-0123456789abcdef0 --group-name my-security-group
   ```

5. Verify that the security group has been renamed successfully by running the following command:

   ```
   aws ec2 describe-security-groups --group-ids <security-group-id>
   ```

   Replace `<security-group-id>` with the ID of the security group that you have renamed.

   The output should show the new name of the security group.
</Accordion>

<Accordion title='Using Python'>
To remediate the security group name prefixed with `launch-wizard` in AWS using Python, you can follow the below steps:

1. Import the required modules:

```python
import boto3
```

2. Connect to the AWS account:

```python
client = boto3.client('ec2')
```

3. Get all the security groups:

```python
response = client.describe_security_groups()
```

4. Loop through all the security groups and check if the name is prefixed with `launch-wizard`:

```python
for sg in response['SecurityGroups']:
    if sg['GroupName'].startswith('launch-wizard'):
        # Delete the security group
        client.delete_security_group(GroupId=sg['GroupId'])
```

5. The above code will delete all the security groups that have a name prefixed with `launch-wizard`. If you want to rename the security group, you can use the below code:

```python
for sg in response['SecurityGroups']:
    if sg['GroupName'].startswith('launch-wizard'):
        new_name = sg['GroupName'].replace('launch-wizard', 'new-name')
        # Rename the security group
        client.update_security_group_name_description(GroupId=sg['GroupId'], GroupName=new_name, Description='New Description')
```

6. The above code will rename all the security groups that have a name prefixed with `launch-wizard` to `new-name`. You can also update the description of the security group as per your requirement.

Note: Before deleting or renaming the security group, make sure that it is not being used by any instances or services.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/launchwizard/latest/userguide/launch-wizard-sap-security-groups.html](https://docs.aws.amazon.com/launchwizard/latest/userguide/launch-wizard-sap-security-groups.html) 

