---
slug: ec2_detailed_monitoring
title: Detailed Monitoring for EC2 Instances Should Be Enabled
sidebar_label: Detailed Monitoring for EC2 Instances Should Be Enabled
---

### More Info:

Detailed monitoring should be enabled on EC2 instances.

### Risk Level

Informational

### Address

Operational Efficiency

### Compliance Standards

NIST, SOC2, HITRUST



### Triage and Remediation
<Tabs>


<Tab title='Prevention'>
### How to Prevent
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To prevent the misconfiguration of not having Detailed Monitoring enabled for EC2 instances in AWS using the AWS Management Console, follow these steps:

1. **Navigate to the EC2 Dashboard:**
   - Sign in to the AWS Management Console.
   - In the top navigation bar, select "Services" and then choose "EC2" under the "Compute" section.

2. **Select the Instance:**
   - In the left-hand navigation pane, click on "Instances" to view all your EC2 instances.
   - Select the instance for which you want to enable Detailed Monitoring by clicking the checkbox next to the instance ID.

3. **Enable Detailed Monitoring:**
   - With the instance selected, click on the "Actions" button at the top of the page.
   - From the dropdown menu, choose "Monitor and troubleshoot" and then select "Manage detailed monitoring."

4. **Confirm and Apply:**
   - In the "Manage detailed monitoring" dialog box, check the option to enable Detailed Monitoring.
   - Click the "Save" button to apply the changes.

By following these steps, you ensure that Detailed Monitoring is enabled for your EC2 instances, providing more granular monitoring data and better insights into instance performance.
</Accordion>

<Accordion title='Using CLI'>
To ensure that Detailed Monitoring for EC2 instances is enabled using the AWS CLI, follow these steps:

1. **Install and Configure AWS CLI:**
   Ensure that the AWS CLI is installed and configured with the necessary permissions to manage EC2 instances.
   ```sh
   aws configure
   ```

2. **Enable Detailed Monitoring for a New EC2 Instance:**
   When launching a new EC2 instance, you can enable detailed monitoring by using the `--monitoring` parameter.
   ```sh
   aws ec2 run-instances --image-id ami-0abcdef1234567890 --count 1 --instance-type t2.micro --key-name MyKeyPair --monitoring Enabled
   ```

3. **Enable Detailed Monitoring for an Existing EC2 Instance:**
   To enable detailed monitoring for an existing EC2 instance, use the `monitor-instances` command.
   ```sh
   aws ec2 monitor-instances --instance-ids i-1234567890abcdef0
   ```

4. **Verify Detailed Monitoring Status:**
   To verify that detailed monitoring is enabled for your EC2 instance, describe the instance and check the `Monitoring` state.
   ```sh
   aws ec2 describe-instances --instance-ids i-1234567890abcdef0 --query 'Reservations[*].Instances[*].Monitoring.State'
   ```

By following these steps, you can ensure that detailed monitoring is enabled for your EC2 instances using the AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To prevent the misconfiguration of not having Detailed Monitoring enabled for EC2 instances in AWS using Python scripts, you can follow these steps:

1. **Install Boto3 Library**:
   Ensure you have the Boto3 library installed, which is the AWS SDK for Python. You can install it using pip if you haven't already.

   ```bash
   pip install boto3
   ```

2. **Create a Python Script to Enable Detailed Monitoring**:
   Write a Python script that will enable detailed monitoring for your EC2 instances. Below is an example script:

   ```python
   import boto3

   # Initialize a session using Amazon EC2
   ec2 = boto3.client('ec2')

   # Function to enable detailed monitoring for all instances
   def enable_detailed_monitoring():
       # Describe all instances
       response = ec2.describe_instances()
       instances = [instance['InstanceId'] for reservation in response['Reservations'] for instance in reservation['Instances']]

       # Enable detailed monitoring for each instance
       for instance_id in instances:
           ec2.monitor_instances(InstanceIds=[instance_id])
           print(f"Enabled detailed monitoring for instance: {instance_id}")

   if __name__ == "__main__":
       enable_detailed_monitoring()
   ```

3. **Set Up AWS Credentials**:
   Ensure your AWS credentials are configured properly. You can set them up using the AWS CLI or by configuring the `~/.aws/credentials` file.

   ```bash
   aws configure
   ```

4. **Run the Script**:
   Execute the Python script to enable detailed monitoring for all your EC2 instances.

   ```bash
   python enable_detailed_monitoring.py
   ```

By following these steps, you can ensure that detailed monitoring is enabled for your EC2 instances, thereby preventing the misconfiguration.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console and open the Amazon EC2 console at https://console.aws.amazon.com/ec2/.

2. In the navigation pane, choose 'Instances'.

3. Select the instance that you want to check for detailed monitoring.

4. In the bottom pane, choose the 'Monitoring' tab.

5. In the 'CloudWatch Monitoring' section, check the 'Detailed Monitoring' status. If it is disabled, then Detailed Monitoring for that EC2 instance is not enabled.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine and configure it with your AWS account details. You can download AWS CLI from the official AWS website and configure it using the "aws configure" command.

2. List all EC2 instances: Use the following command to list all the EC2 instances in your AWS account.

   ```
   aws ec2 describe-instances --query 'Reservations[*].Instances[*].[InstanceId]' --output text
   ```

3. Check detailed monitoring status: For each instance ID retrieved from the previous step, use the following command to check the detailed monitoring status.

   ```
   aws ec2 describe-instances --instance-ids <instance-id> --query 'Reservations[*].Instances[*].[Monitoring]'
   ```

   Replace `<instance-id>` with the ID of the EC2 instance you want to check. The command will return the monitoring status for the specified EC2 instance.

4. Analyze the output: If the State value in the output is "disabled", then detailed monitoring is not enabled for the EC2 instance. If the State value is "enabled", then detailed monitoring is enabled. Repeat steps 3 and 4 for each EC2 instance in your AWS account.
</Accordion>

<Accordion title='Using Python'>
1. Install and configure AWS SDK for Python (Boto3): Boto3 makes it easy to integrate your Python application, library, or script with AWS services including AWS S3, AWS EC2, and more. You can install it using pip:

```python
pip install boto3
```
After installation, you need to configure it. You can do this in several ways, but the simplest is to use the AWS CLI:

```bash
aws configure
```
This will prompt you for your AWS Access Key ID, Secret Access Key, AWS Region. These are used to make programmatic calls to AWS from your machine.

2. Use Boto3 to interact with AWS EC2: Once Boto3 is installed and configured, you can start using it to check if Detailed Monitoring is enabled for your EC2 instances. Here is a simple script that lists all EC2 instances and their monitoring status:

```python
import boto3

def check_detailed_monitoring():
    ec2 = boto3.resource('ec2')
    for instance in ec2.instances.all():
        print('ID: {}, State: {}, Monitoring: {}'.format(instance.id, instance.state, instance.monitoring))

check_detailed_monitoring()
```
This script will print the ID, state, and monitoring status of all EC2 instances. If the monitoring status is 'enabled', then Detailed Monitoring is enabled.

3. Analyze the output: The output of the script will give you the monitoring status of each EC2 instance. If the monitoring status is 'disabled', then Detailed Monitoring is not enabled for that instance.

4. Automate the process: You can automate this process by running this script at regular intervals, or by triggering it based on certain events. This way, you can continuously monitor the status of Detailed Monitoring for your EC2 instances and take action if it is not enabled.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration "Detailed Monitoring for EC2 Instances Should Be Enabled" for AWS using AWS console, please follow the below steps:

Step 1: Login to AWS console using your credentials.

Step 2: Go to the EC2 dashboard by clicking on the EC2 service from the AWS console home page.

Step 3: From the left-hand side panel, select "Instances" to view all the instances in the region.

Step 4: Select the instance for which you want to enable detailed monitoring.

Step 5: Right-click on the instance and select "Monitor and troubleshoot" from the drop-down list.

Step 6: Click on "Enable detailed monitoring" from the list.

Step 7: A pop-up will appear asking you to confirm the action, click on "Enable" to enable detailed monitoring.

Step 8: Once the detailed monitoring is enabled, you can view the metrics by selecting the instance and clicking on the "Monitoring" tab from the bottom panel.

Step 9: You can also enable detailed monitoring for multiple instances at once by selecting them and clicking on the "Actions" button from the top panel and selecting "Monitor with CloudWatch" from the drop-down list.

Step 10: Click on "Enable detailed monitoring" and confirm the action.

By following these steps, you can remediate the misconfiguration "Detailed Monitoring for EC2 Instances Should Be Enabled" for AWS using AWS console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration "Detailed Monitoring for EC2 Instances Should Be Enabled" for AWS using AWS CLI, follow the steps below:

1. Open the AWS CLI on your local machine or EC2 instance.

2. Run the following command to enable detailed monitoring for all EC2 instances in the default region:

```
aws ec2 monitor-instances --instance-ids $(aws ec2 describe-instances --query 'Reservations[].Instances[].InstanceId' --output text)
```

This command uses the `aws ec2 describe-instances` command to list all EC2 instances in the default region, and the `aws ec2 monitor-instances` command to enable detailed monitoring for each instance.

3. If you want to enable detailed monitoring for specific instances, you can replace `$(aws ec2 describe-instances --query 'Reservations[].Instances[].InstanceId' --output text)` with a comma-separated list of instance IDs.

```
aws ec2 monitor-instances --instance-ids i-1234567890abcdef0,i-0987654321fedcba0
```

4. Verify that detailed monitoring is enabled for the instances by running the following command:

```
aws ec2 describe-instances --instance-ids $(aws ec2 describe-instances --query 'Reservations[].Instances[].InstanceId' --output text) --query 'Reservations[].Instances[].Monitoring.State'
```

This command uses the `aws ec2 describe-instances` command to list the monitoring state for each instance.

If the monitoring state is `disabled`, wait a few minutes and run the command again to verify that it has been enabled.

By following these steps, you can remediate the "Detailed Monitoring for EC2 Instances Should Be Enabled" misconfiguration for AWS using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of detailed monitoring for EC2 instances not being enabled in AWS using python, you can follow the below steps:

1. Import the necessary libraries:
```
import boto3
```

2. Create a boto3 client for EC2:
```
ec2 = boto3.client('ec2')
```

3. Get a list of all EC2 instances:
```
instances = ec2.describe_instances()
```

4. Loop through each instance and check if detailed monitoring is enabled or not:
```
for reservation in instances['Reservations']:
    for instance in reservation['Instances']:
        instance_id = instance['InstanceId']
        monitoring = instance['Monitoring']['State']
        if monitoring == 'disabled':
            # Enable detailed monitoring for the instance
            ec2.monitor_instances(InstanceIds=[instance_id])
```

5. If detailed monitoring is disabled for an instance, enable it using the `monitor_instances` method of the EC2 client.

6. Once detailed monitoring is enabled, you can verify it by checking the monitoring state of the instance using the `describe_instances` method.

7. You can also create a CloudWatch alarm to monitor the status of detailed monitoring for all EC2 instances and get notified if it is disabled.

By following these steps, you can remediate the misconfiguration of detailed monitoring for EC2 instances not being enabled in AWS using python.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-cloudwatch-new.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-cloudwatch-new.html) 

