---
title: Restrict data-tier subnet connectivity to VPC NAT Gateway
---

### More Info:

Ensuring that the Amazon VPC route table associated with the data-tier subnets has no default route configured to allow access to an AWS NAT Gateway in order to restrict Internet connectivity for the EC2 instances available within the data tier.

### Risk Level

Medium

### Address

Security

### Compliance Standards

CBP

### Remediation

How to restrict data-tier subnet connectivity to VPC NAT Gateway?

#### Using AWS Console

1. Open the Amazon VPC console.
2. In the navigation pane, choose Route Tables.
    (In the Cloudanix Console, navigate to "Misconfig" page and look for Affected Assets for "Restrict data-tier subnet connectivity to VPC NAT Gateway" Policy.)
3. Select the route table associated with the data-tier subnets.
4. Choose the Routes tab.
5. Identify the default route (0.0.0.0/0) that points to the NAT Gateway.
6. Choose Edit.
7. In the Edit route dialog box, delete the default route.
8. Choose Save routes.

### Additional Reading:

- [https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Subnets.html](https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Subnets.html)
- [https://docs.aws.amazon.com/vpc/latest/userguide/vpc-nat-gateway.html](https://docs.aws.amazon.com/vpc/latest/userguide/vpc-nat-gateway.html)
