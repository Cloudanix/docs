---
slug: unused_elastic_network_interfaces
title: Unused Elastic Network Interfaces Should Be Removed
sidebar_label: Unused Elastic Network Interfaces Should Be Removed
---

### More Info:

Unused AWS Elastic Network Interfaces (ENIs) should be removed to follow best practices.

### Risk Level

Informational

### Address

Cost optimization, Operational Maturity

### Compliance Standards

AWSWAF, HITRUST, SOC2, NISTCSF



### Triage and Remediation
<Tabs>


<Tab title='Prevention'>
### How to Prevent
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To prevent unused Elastic Network Interfaces (ENIs) from lingering in your AWS environment using the AWS Management Console, follow these steps:

1. **Regular Monitoring:**
   - Navigate to the **EC2 Dashboard** in the AWS Management Console.
   - Select **Network Interfaces** from the left-hand menu.
   - Regularly review the list of ENIs to identify any that are not attached to any instances or resources.

2. **Tagging and Documentation:**
   - Implement a tagging strategy for ENIs to easily identify their purpose and associated resources.
   - Ensure that each ENI has appropriate tags such as `Name`, `Environment`, `Owner`, and `Purpose`.
   - Maintain documentation or use AWS Config to track the lifecycle and usage of each ENI.

3. **Automated Alerts:**
   - Set up AWS CloudWatch Alarms or AWS Config Rules to monitor for unused ENIs.
   - Create a rule to trigger an alert when an ENI is detected that is not attached to any resource for a specified period.

4. **Lifecycle Policies:**
   - Establish and enforce policies for the lifecycle management of ENIs.
   - Define procedures for the regular review and cleanup of unused ENIs as part of your operational best practices.

By following these steps, you can proactively manage and prevent the accumulation of unused Elastic Network Interfaces in your AWS environment.
</Accordion>

<Accordion title='Using CLI'>
To prevent unused Elastic Network Interfaces (ENIs) in EC2 using AWS CLI, you can follow these steps:

1. **List All Network Interfaces:**
   Use the following command to list all network interfaces in your account. This will help you identify which ENIs are currently in use and which are not.

   ```sh
   aws ec2 describe-network-interfaces
   ```

2. **Filter Unused Network Interfaces:**
   To filter out the unused network interfaces, you can use the `--filters` option. For example, you can filter by status to find those that are `available` (not attached to any instance).

   ```sh
   aws ec2 describe-network-interfaces --filters Name=status,Values=available
   ```

3. **Automate Detection of Unused ENIs:**
   Create a script to automate the detection of unused ENIs. This script will periodically check for ENIs that are not in use and log their details.

   ```sh
   #!/bin/bash
   unused_enis=$(aws ec2 describe-network-interfaces --filters Name=status,Values=available --query 'NetworkInterfaces[*].NetworkInterfaceId' --output text)
   echo "Unused ENIs: $unused_enis"
   ```

4. **Set Up Monitoring and Alerts:**
   Use AWS CloudWatch to set up monitoring and alerts for unused ENIs. This can be done by creating a CloudWatch rule that triggers a Lambda function to check for unused ENIs and send notifications.

   ```sh
   aws events put-rule --name "CheckUnusedENIs" --schedule-expression "rate(1 day)"
   ```

   Then, create a Lambda function that uses the AWS CLI to check for unused ENIs and send notifications if any are found.

By following these steps, you can proactively monitor and manage unused Elastic Network Interfaces in your AWS environment, helping to prevent misconfigurations and optimize resource usage.
</Accordion>

<Accordion title='Using Python'>
To prevent unused Elastic Network Interfaces (ENIs) in EC2 using Python scripts, you can follow these steps:

1. **Set Up AWS SDK for Python (Boto3):**
   Ensure you have Boto3 installed and configured with the necessary AWS credentials.

   ```bash
   pip install boto3
   ```

2. **List All Elastic Network Interfaces:**
   Use Boto3 to list all ENIs in your account.

   ```python
   import boto3

   ec2_client = boto3.client('ec2')

   def list_enis():
       response = ec2_client.describe_network_interfaces()
       return response['NetworkInterfaces']

   enis = list_enis()
   ```

3. **Identify Unused ENIs:**
   Check each ENI to see if it is attached to any instance. If it is not attached, it is considered unused.

   ```python
   def find_unused_enis(enis):
       unused_enis = []
       for eni in enis:
           if not eni['Attachment']:
               unused_enis.append(eni['NetworkInterfaceId'])
       return unused_enis

   unused_enis = find_unused_enis(enis)
   ```

4. **Automate the Removal of Unused ENIs:**
   Create a function to delete the unused ENIs. This function can be scheduled to run periodically to ensure unused ENIs are removed.

   ```python
   def delete_unused_enis(unused_enis):
       for eni_id in unused_enis:
           try:
               ec2_client.delete_network_interface(NetworkInterfaceId=eni_id)
               print(f"Deleted ENI: {eni_id}")
           except Exception as e:
               print(f"Error deleting ENI {eni_id}: {e}")

   delete_unused_enis(unused_enis)
   ```

By following these steps, you can automate the identification and removal of unused Elastic Network Interfaces in your AWS account using Python scripts. This helps in preventing misconfigurations and optimizing resource usage.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console.
2. Navigate to the EC2 dashboard by selecting "Services" from the top menu, then selecting "EC2" under the "Compute" category.
3. In the EC2 dashboard, select "Network Interfaces" from the "Network & Security" section in the left-hand menu.
4. In the "Network Interfaces" page, you can see all the Elastic Network Interfaces (ENIs) that are currently available in your AWS account. Unused ENIs are those that are not attached to any EC2 instances. You can identify them by looking at the "Status" column; if it says "available", it means the ENI is not currently in use.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   ```
   pip install awscli
   aws configure
   ```

   During the configuration process, you will be asked to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format. You can find these details in your AWS Management Console.

2. List all Elastic Network Interfaces (ENIs): Once your AWS CLI is set up, you can list all ENIs in your account by running the following command:

   ```
   aws ec2 describe-network-interfaces
   ```

   This command will return a JSON output with details about all ENIs in your account.

3. Filter unused ENIs: To find unused ENIs, you need to look for ENIs that are not attached to any instance. You can do this by adding a query parameter to the previous command:

   ```
   aws ec2 describe-network-interfaces --query 'NetworkInterfaces[?Status==`available`]'
   ```

   This command will return a list of ENIs that are in the 'available' state, which means they are not attached to any instance.

4. Review the output: The output of the previous command will include details about each unused ENI, such as its ID, subnet ID, VPC ID, and availability zone. You can use this information to identify the unused ENIs that should be removed.
</Accordion>

<Accordion title='Using Python'>
1. Install and configure AWS SDK for Python (Boto3): To interact with AWS services, you need to install and configure Boto3. You can install it using pip:

   ```
   pip install boto3
   ```
   Then, configure your AWS credentials:

   ```
   aws configure
   ```
   You will be asked to provide your AWS Access Key ID and Secret Access Key, which you can find in your AWS Management Console.

2. Import the necessary libraries and establish a session with AWS:

   ```python
   import boto3
   session = boto3.Session(region_name='us-west-2')  # specify your region
   ec2 = session.resource('ec2')
   ```

3. Fetch all the Elastic Network Interfaces (ENIs) and check their status:

   ```python
   enis = ec2.network_interfaces.all()
   unused_enis = [eni for eni in enis if eni.status == 'available']
   ```

   This script fetches all the ENIs in the specified region and filters out the ones that are not in use (status is 'available').

4. Print out the IDs of the unused ENIs:

   ```python
   for eni in unused_enis:
       print(f"Unused ENI: {eni.id}")
   ```

   This script will print out the IDs of all unused ENIs. If there are no unused ENIs, it will not print anything.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the unused Elastic Network Interfaces in AWS, you can follow the below steps using AWS console:

1. Login to AWS console and navigate to the EC2 dashboard.
2. Click on the "Network Interfaces" option from the left-hand menu.
3. Sort the list of network interfaces by the "Status" column, and identify the interfaces that have a status of "available" or "detached". These are the unused interfaces.
4. Select the unused network interfaces that you want to remove.
5. Click on the "Actions" dropdown menu and select "Delete network interface".
6. A confirmation message will appear. Click on "Yes, Delete" to confirm the deletion of the selected network interfaces.

Once the unused network interfaces are deleted, you have successfully remediated the misconfiguration.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of unused Elastic Network Interfaces in AWS, you can follow the below steps using AWS CLI:

1. First, you need to identify the unused Elastic Network Interfaces (ENIs). To do this, run the following command:

```
aws ec2 describe-network-interfaces --filters Name=status,Values=available
```

This command will list all the available ENIs that are not currently attached to any EC2 instances.

2. Once you have identified the unused ENIs, you can delete them using the following command:

```
aws ec2 delete-network-interface --network-interface-id <eni-id>
```

Replace `<eni-id>` with the ID of the unused ENI that you want to delete. You can run this command for each unused ENI that you identified in step 1.

3. Finally, to confirm that the unused ENIs have been deleted, you can run the following command:

```
aws ec2 describe-network-interfaces --filters Name=status,Values=available
```

This command should return an empty list, indicating that there are no more available ENIs that are not currently attached to any EC2 instances.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of unused Elastic Network Interfaces in AWS using Python, you can use the Boto3 library which is the AWS SDK for Python. Here are the steps to remediate the misconfiguration:

1. Import the necessary libraries:

```python
import boto3
import logging
```

2. Set up logging to capture any errors:

```python
logger = logging.getLogger()
logger.setLevel(logging.INFO)
```

3. Create an EC2 client using Boto3:

```python
ec2 = boto3.client('ec2')
```

4. Use the `describe_network_interfaces` method to get a list of all the network interfaces in your account:

```python
response = ec2.describe_network_interfaces()
```

5. Loop through the response to find all the unused network interfaces and delete them:

```python
for network_interface in response['NetworkInterfaces']:
    if not network_interface['Attachment']:
        logger.info(f"Deleting unused network interface {network_interface['NetworkInterfaceId']}")
        ec2.delete_network_interface(NetworkInterfaceId=network_interface['NetworkInterfaceId'])
```

6. Run the script and it will delete all the unused network interfaces in your AWS account.

Note: Please make sure to test this script in a non-production environment before running it in a production environment.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://aws.amazon.com/premiumsupport/knowledge-center/limit-reached-eni/](https://aws.amazon.com/premiumsupport/knowledge-center/limit-reached-eni/) 

