---
slug: unused_elastic_network_interfaces
title: Unused Elastic Network Interfaces Should Be Removed
sidebar_label: Unused Elastic Network Interfaces Should Be Removed
---

### More Info:

Unused AWS Elastic Network Interfaces (ENIs) should be removed to follow best practices.

### Risk Level

Informational

### Address

Cost optimization, Operational Maturity

### Compliance Standards

AWSWAF, HITRUST, SOC2, NISTCSF



### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console.
2. Navigate to the EC2 dashboard by selecting "Services" from the top menu, then selecting "EC2" under the "Compute" category.
3. In the EC2 dashboard, select "Network Interfaces" from the "Network & Security" section in the left-hand menu.
4. In the "Network Interfaces" page, you can see all the Elastic Network Interfaces (ENIs) that are currently available in your AWS account. Unused ENIs are those that are not attached to any EC2 instances. You can identify them by looking at the "Status" column; if it says "available", it means the ENI is not currently in use.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   ```
   pip install awscli
   aws configure
   ```

   During the configuration process, you will be asked to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format. You can find these details in your AWS Management Console.

2. List all Elastic Network Interfaces (ENIs): Once your AWS CLI is set up, you can list all ENIs in your account by running the following command:

   ```
   aws ec2 describe-network-interfaces
   ```

   This command will return a JSON output with details about all ENIs in your account.

3. Filter unused ENIs: To find unused ENIs, you need to look for ENIs that are not attached to any instance. You can do this by adding a query parameter to the previous command:

   ```
   aws ec2 describe-network-interfaces --query 'NetworkInterfaces[?Status==`available`]'
   ```

   This command will return a list of ENIs that are in the 'available' state, which means they are not attached to any instance.

4. Review the output: The output of the previous command will include details about each unused ENI, such as its ID, subnet ID, VPC ID, and availability zone. You can use this information to identify the unused ENIs that should be removed.
</Accordion>

<Accordion title='Using Python'>
1. Install and configure AWS SDK for Python (Boto3): To interact with AWS services, you need to install and configure Boto3. You can install it using pip:

   ```
   pip install boto3
   ```
   Then, configure your AWS credentials:

   ```
   aws configure
   ```
   You will be asked to provide your AWS Access Key ID and Secret Access Key, which you can find in your AWS Management Console.

2. Import the necessary libraries and establish a session with AWS:

   ```python
   import boto3
   session = boto3.Session(region_name='us-west-2')  # specify your region
   ec2 = session.resource('ec2')
   ```

3. Fetch all the Elastic Network Interfaces (ENIs) and check their status:

   ```python
   enis = ec2.network_interfaces.all()
   unused_enis = [eni for eni in enis if eni.status == 'available']
   ```

   This script fetches all the ENIs in the specified region and filters out the ones that are not in use (status is 'available').

4. Print out the IDs of the unused ENIs:

   ```python
   for eni in unused_enis:
       print(f"Unused ENI: {eni.id}")
   ```

   This script will print out the IDs of all unused ENIs. If there are no unused ENIs, it will not print anything.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the unused Elastic Network Interfaces in AWS, you can follow the below steps using AWS console:

1. Login to AWS console and navigate to the EC2 dashboard.
2. Click on the "Network Interfaces" option from the left-hand menu.
3. Sort the list of network interfaces by the "Status" column, and identify the interfaces that have a status of "available" or "detached". These are the unused interfaces.
4. Select the unused network interfaces that you want to remove.
5. Click on the "Actions" dropdown menu and select "Delete network interface".
6. A confirmation message will appear. Click on "Yes, Delete" to confirm the deletion of the selected network interfaces.

Once the unused network interfaces are deleted, you have successfully remediated the misconfiguration.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of unused Elastic Network Interfaces in AWS, you can follow the below steps using AWS CLI:

1. First, you need to identify the unused Elastic Network Interfaces (ENIs). To do this, run the following command:

```
aws ec2 describe-network-interfaces --filters Name=status,Values=available
```

This command will list all the available ENIs that are not currently attached to any EC2 instances.

2. Once you have identified the unused ENIs, you can delete them using the following command:

```
aws ec2 delete-network-interface --network-interface-id <eni-id>
```

Replace `<eni-id>` with the ID of the unused ENI that you want to delete. You can run this command for each unused ENI that you identified in step 1.

3. Finally, to confirm that the unused ENIs have been deleted, you can run the following command:

```
aws ec2 describe-network-interfaces --filters Name=status,Values=available
```

This command should return an empty list, indicating that there are no more available ENIs that are not currently attached to any EC2 instances.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of unused Elastic Network Interfaces in AWS using Python, you can use the Boto3 library which is the AWS SDK for Python. Here are the steps to remediate the misconfiguration:

1. Import the necessary libraries:

```python
import boto3
import logging
```

2. Set up logging to capture any errors:

```python
logger = logging.getLogger()
logger.setLevel(logging.INFO)
```

3. Create an EC2 client using Boto3:

```python
ec2 = boto3.client('ec2')
```

4. Use the `describe_network_interfaces` method to get a list of all the network interfaces in your account:

```python
response = ec2.describe_network_interfaces()
```

5. Loop through the response to find all the unused network interfaces and delete them:

```python
for network_interface in response['NetworkInterfaces']:
    if not network_interface['Attachment']:
        logger.info(f"Deleting unused network interface {network_interface['NetworkInterfaceId']}")
        ec2.delete_network_interface(NetworkInterfaceId=network_interface['NetworkInterfaceId'])
```

6. Run the script and it will delete all the unused network interfaces in your AWS account.

Note: Please make sure to test this script in a non-production environment before running it in a production environment.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://aws.amazon.com/premiumsupport/knowledge-center/limit-reached-eni/](https://aws.amazon.com/premiumsupport/knowledge-center/limit-reached-eni/) 

