---
slug: unused_elastic_network_interfaces
title: Unused Elastic Network Interfaces Should Be Removed
sidebar_label: Unused Elastic Network Interfaces Should Be Removed
---

### More Info:

Unused AWS Elastic Network Interfaces (ENIs) should be removed to follow best practices.

### Risk Level

Informational

### Address

Cost optimization, Operational Maturity

### Compliance Standards

AWSWAF, HITRUST, SOC2, NISTCSF




<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to the EC2 dashboard by selecting "Services" from the top menu, then choosing "EC2" under the "Compute" category.
3. In the EC2 dashboard, select "Network Interfaces" from the "Network & Security" section in the left-hand menu.
4. In the "Network Interfaces" page, you can see all the Elastic Network Interfaces (ENIs) associated with your account. Unused ENIs are those that are not attached to any instance. You can identify them by looking at the "Status" column; if it says "available", it means the ENI is not currently in use.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your AWS Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all Elastic Network Interfaces (ENIs): Use the following AWS CLI command to list all the ENIs in your AWS account:

   ```
   aws ec2 describe-network-interfaces --query 'NetworkInterfaces[].[NetworkInterfaceId,Status]' --output text
   ```

   This command will return a list of all ENIs along with their status. The status can be either 'available' or 'in-use'.

3. Filter unused ENIs: From the list of ENIs, you can identify the unused ones by their status. If the status of an ENI is 'available', it means that it is not attached to any instance and is not in use.

4. Count unused ENIs: To get the count of unused ENIs, you can pipe the output of the above command to the `wc -l` command as follows:

   ```
   aws ec2 describe-network-interfaces --query 'NetworkInterfaces[?Status==`available`].[NetworkInterfaceId]' --output text | wc -l
   ```

   This command will return the number of unused ENIs in your AWS account.

#### Using Python

1. Install and configure AWS SDK for Python (Boto3): Boto3 makes it easy to integrate your Python application, library, or script with AWS services including AWS S3, AWS EC2, and more. You can install it using pip:

```python
pip install boto3
```
After installation, you need to configure it. You can do this in several ways, but the simplest is to use the AWS CLI:

```bash
aws configure
```
This will prompt you for your AWS Access Key ID, Secret Access Key, AWS Region. These are used to make programmatic calls to AWS from your machine.

2. Use Boto3 to interact with AWS EC2: Once Boto3 is installed and configured, we can write a script to check for unused Elastic Network Interfaces (ENIs). Here's a simple script that lists all ENIs and their status:

```python
import boto3

def list_enis():
    ec2 = boto3.resource('ec2')
    for eni in ec2.network_interfaces.all():
        print(f'ENI ID: {eni.id}, Status: {eni.status}')

list_enis()
```
This script will print the ID and status of all ENIs in your configured AWS region.

3. Filter for unused ENIs: An ENI is considered "unused" if it's not attached to any instance. We can modify our script to only print ENIs that are not attached:

```python
import boto3

def list_unused_enis():
    ec2 = boto3.resource('ec2')
    for eni in ec2.network_interfaces.all():
        if not eni.attachment:
            print(f'Unused ENI ID: {eni.id}')

list_unused_enis()
```
This script will print the ID of all unused ENIs in your configured AWS region.

4. Handle multiple regions: If you have resources in multiple AWS regions, you'll need to modify the script to check each region. Here's how you can do that:

```python
import boto3

def list_unused_enis_in_all_regions():
    for region in boto3.session.Session().get_available_regions('ec2'):
        ec2 = boto3.resource('ec2', region_name=region)
        for eni in ec2.network_interfaces.all():
            if not eni.attachment:
                print(f'Unused ENI ID: {eni.id} in region {region}')

list_unused_enis_in_all_regions()
```
This script will print the ID of all unused ENIs in all AWS regions.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the unused Elastic Network Interfaces in AWS, you can follow the below steps using AWS console:

1. Login to AWS console and navigate to the EC2 dashboard.
2. Click on the "Network Interfaces" option from the left-hand menu.
3. Sort the list of network interfaces by the "Status" column, and identify the interfaces that have a status of "available" or "detached". These are the unused interfaces.
4. Select the unused network interfaces that you want to remove.
5. Click on the "Actions" dropdown menu and select "Delete network interface".
6. A confirmation message will appear. Click on "Yes, Delete" to confirm the deletion of the selected network interfaces.

Once the unused network interfaces are deleted, you have successfully remediated the misconfiguration.

#### Using CLI

To remediate the misconfiguration of unused Elastic Network Interfaces in AWS, you can follow the below steps using AWS CLI:

1. First, you need to identify the unused Elastic Network Interfaces (ENIs). To do this, run the following command:

```
aws ec2 describe-network-interfaces --filters Name=status,Values=available
```

This command will list all the available ENIs that are not currently attached to any EC2 instances.

2. Once you have identified the unused ENIs, you can delete them using the following command:

```
aws ec2 delete-network-interface --network-interface-id <eni-id>
```

Replace `<eni-id>` with the ID of the unused ENI that you want to delete. You can run this command for each unused ENI that you identified in step 1.

3. Finally, to confirm that the unused ENIs have been deleted, you can run the following command:

```
aws ec2 describe-network-interfaces --filters Name=status,Values=available
```

This command should return an empty list, indicating that there are no more available ENIs that are not currently attached to any EC2 instances.

#### Using Python

To remediate the misconfiguration of unused Elastic Network Interfaces in AWS using Python, you can use the Boto3 library which is the AWS SDK for Python. Here are the steps to remediate the misconfiguration:

1. Import the necessary libraries:

```python
import boto3
import logging
```

2. Set up logging to capture any errors:

```python
logger = logging.getLogger()
logger.setLevel(logging.INFO)
```

3. Create an EC2 client using Boto3:

```python
ec2 = boto3.client('ec2')
```

4. Use the `describe_network_interfaces` method to get a list of all the network interfaces in your account:

```python
response = ec2.describe_network_interfaces()
```

5. Loop through the response to find all the unused network interfaces and delete them:

```python
for network_interface in response['NetworkInterfaces']:
    if not network_interface['Attachment']:
        logger.info(f"Deleting unused network interface {network_interface['NetworkInterfaceId']}")
        ec2.delete_network_interface(NetworkInterfaceId=network_interface['NetworkInterfaceId'])
```

6. Run the script and it will delete all the unused network interfaces in your AWS account.

Note: Please make sure to test this script in a non-production environment before running it in a production environment.


### Additional Reading:

- [https://aws.amazon.com/premiumsupport/knowledge-center/limit-reached-eni/](https://aws.amazon.com/premiumsupport/knowledge-center/limit-reached-eni/) 


</Tab>
</Tabs>