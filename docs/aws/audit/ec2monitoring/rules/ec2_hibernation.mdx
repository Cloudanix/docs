---
slug: ec2_hibernation
title: AWS EC2 Hibernation Should Be Enabled
sidebar_label: AWS EC2 Hibernation Should Be Enabled
---

### More Info:

The Hibernation feature should be enabled for EBS-backed EC2 instances to retain memory state across instance stop/start cycles.

### Risk Level

Low

### Address

Reliability

### Compliance Standards

CBP



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to the EC2 dashboard by selecting "Services" from the top menu, then selecting "EC2" under the "Compute" category.
3. In the EC2 dashboard, select "Instances" from the left-hand menu.
4. In the Instances page, select the instance you want to check. In the "Description" tab at the bottom of the page, look for the "Root device type" field. If the value is "ebs", the instance is EBS-backed and hibernation can be enabled. If the value is "instance store", the instance is not EBS-backed and hibernation cannot be enabled.
5. Also, check the instance type. Not all instance types support hibernation. You can refer to the AWS documentation for a list of instance types that support hibernation.
6. Finally, check if the instance is encrypted. Hibernation is not supported for instances with unencrypted EBS volumes or instances that use a RAM disk.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   Installation:
   ```
   pip install awscli
   ```
   Configuration:
   ```
   aws configure
   ```
   You will be prompted to enter your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. List all EC2 instances: Use the following command to list all EC2 instances in your AWS account:

   ```
   aws ec2 describe-instances
   ```
   This command will return a JSON output with details about all your EC2 instances.

3. Check hibernation configuration: Unfortunately, AWS CLI does not provide a direct command to check if hibernation is enabled for an EC2 instance. However, you can check if an instance is hibernation-compatible. Hibernation is only available for instances that are both EBS-backed and have instance-initiated shutdown behavior set to 'stop'. You can check these properties with the following command:

   ```
   aws ec2 describe-instance-attribute --instance-id <instance-id> --attribute instanceInitiatedShutdownBehavior
   ```
   Replace `<instance-id>` with the ID of the instance you want to check. The command will return 'stop' if the instance is hibernation-compatible.

4. Check the instance type: Not all instance types support hibernation. You can check the instance type with the following command:

   ```
   aws ec2 describe-instances --instance-ids <instance-id> --query 'Reservations[].Instances[].InstanceType'
   ```
   Replace `<instance-id>` with the ID of the instance you want to check. The command will return the instance type. You can then refer to the AWS documentation to see if this instance type supports hibernation.

#### Using Python

1. Install and configure AWS SDK for Python (Boto3): Boto3 makes it easy to integrate your Python application, library, or script with AWS services including AWS S3, AWS EC2, AWS DynamoDB, and much more. You can install it using pip:

```python
pip install boto3
```

2. Set up AWS credentials: You can set up your AWS credentials in several ways, but here's one example:

```python
import boto3

session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    aws_session_token='SESSION_TOKEN',
)
```

3. Create a script to check EC2 instances for hibernation configuration: You can use the `describe_instances` method to get information about your EC2 instances, and then check the `HibernationOptions` attribute to see if hibernation is enabled.

```python
import boto3

def check_hibernation():
    ec2 = boto3.resource('ec2')
    for instance in ec2.instances.all():
        if instance.state['Name'] == 'running':
            hibernation_options = instance.describe_attribute(Attribute='hibernationOptions')
            if not hibernation_options['HibernationOptions']['Configured']:
                print(f"Instance {instance.id} does not have hibernation enabled.")

check_hibernation()
```

4. Run the script: You can run the script from your command line using the Python interpreter. The script will print out the IDs of any running instances that do not have hibernation enabled.

```bash
python check_hibernation.py
```

Please note that you need to replace 'YOUR_ACCESS_KEY', 'YOUR_SECRET_KEY', and 'SESSION_TOKEN' with your actual AWS credentials. Also, the hibernation feature is only available for instances that meet certain requirements.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

Sure, I can help you with that. Here are the step-by-step instructions to remediate the AWS EC2 hibernation misconfiguration using the AWS console:

1. Login to your AWS console and navigate to the EC2 dashboard.

2. Select the EC2 instance for which you want to enable hibernation.

3. Click on the 'Actions' button and select 'Instance Settings' from the dropdown.

4. Click on the 'Enable Hibernation' option.

5. A pop-up window will appear, click on 'Enable' to confirm the action.

6. Once hibernation is enabled, you need to stop and start the instance to apply the changes. Click on the 'Actions' button and select 'Instance State' from the dropdown.

7. Click on 'Stop' to stop the instance.

8. Once the instance is stopped, click on 'Start' to start the instance again.

9. After the instance is started, hibernation will be enabled.

That's it! You have successfully remediated the AWS EC2 hibernation misconfiguration using the AWS console.

#### Using CLI

To remediate the misconfiguration of AWS EC2 Hibernation not being enabled, follow these steps using AWS CLI:

1. Open the AWS CLI on your local machine and run the following command to enable hibernation for all instances in the region:
```
aws ec2 modify-instance-attribute --instance-id <instance-id> --hibernation-options Configured=true
```
Note: Replace `<instance-id>` with the actual instance ID of the instance for which you want to enable hibernation.

2. Once you have enabled hibernation for all instances in the region, you can verify the same by running the following command:
```
aws ec2 describe-instances --instance-ids <instance-id> --query 'Reservations[].Instances[].HibernationOptions'
```
Note: Replace `<instance-id>` with the actual instance ID of the instance for which you enabled hibernation.

3. If the output of the above command shows that hibernation is enabled, then you have successfully remediated the misconfiguration. If not, then you can try enabling hibernation again using the first command.

4. Repeat the above steps for all instances in the region to ensure that hibernation is enabled for all instances.

Note: Enabling hibernation may require stopping and starting the instance. Make sure to plan accordingly and schedule any necessary downtime.

#### Using Python

To remediate the misconfiguration in AWS EC2 Hibernation should be enabled, you can follow the below steps using Python:

1. First, you need to install the AWS SDK for Python (Boto3) using the following command:

   ```
   pip install boto3
   ```

2. Next, you need to create a Boto3 client for EC2 using the following code:

   ```
   import boto3

   ec2 = boto3.client('ec2')
   ```

3. Then, you can use the describe_instances() method to get a list of all instances in your AWS account:

   ```
   instances = ec2.describe_instances()
   ```

4. Next, you can loop through each instance and check if hibernation is enabled using the describe_instance_attribute() method:

   ```
   for instance in instances['Reservations']:
       instance_id = instance['Instances'][0]['InstanceId']
       hibernation_enabled = ec2.describe_instance_attribute(InstanceId=instance_id, Attribute='hibernation')['Hibernation']['Value']
   ```

5. If hibernation is not enabled, you can use the modify_instance_attribute() method to enable it:

   ```
   if not hibernation_enabled:
       ec2.modify_instance_attribute(InstanceId=instance_id, HibernationOptions={'Configured': True})
   ```

6. Finally, you can print a message indicating that hibernation has been enabled:

   ```
   print(f'Hibernation has been enabled for instance {instance_id}')
   ```

By following these steps, you can remediate the misconfiguration in AWS EC2 Hibernation should be enabled using Python.

### Additional Reading:

- [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Hibernate.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Hibernate.html) 


</Tab>
</Tabs>