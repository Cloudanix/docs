---
slug: unrestricted_oracle_access
title: Unrestricted Oracle Access Should Not Be Allowed
sidebar_label: Unrestricted Oracle Access Should Not Be Allowed
---

### More Info:

No security group should allow unrestricted inbound access to TCP port 1521 (Oracle Database).

### Risk Level

Medium

### Address

Security

### Compliance Standards

SOC2, GDPR, HITRUST, AWSWAF, NISTCSF, PCIDSS, FedRAMP



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and navigate to the EC2 dashboard.
2. In the navigation pane, select 'Security Groups' under the 'Network & Security' section.
3. In the 'Security Groups' page, you will see a list of all security groups associated with your EC2 instances. Select the security group you want to inspect.
4. In the 'Inbound rules' tab at the bottom of the page, check for any rules that allow unrestricted access (0.0.0.0/0) to Oracle ports (typically TCP 1521). If such a rule exists, it indicates that unrestricted Oracle access is allowed.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your AWS Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all security groups: The first step to detect unrestricted Oracle access is to list all the security groups in your AWS account. You can do this by running the following command: `aws ec2 describe-security-groups --query 'SecurityGroups[*].[GroupId]' --output text`

3. Check security group rules: For each security group, you need to check the inbound rules to see if any of them allow unrestricted access to Oracle. Oracle typically uses port 1521, so you need to look for rules that allow traffic on this port. You can do this by running the following command for each security group: `aws ec2 describe-security-groups --group-ids <security-group-id> --query 'SecurityGroups[*].IpPermissions[*].{FromPort:FromPort,ToPort:ToPort,IpRanges:IpRanges}' --output text`

4. Analyze the output: If the output of the above command includes a rule that allows traffic from 0.0.0.0/0 (which means all IP addresses) on port 1521, then unrestricted Oracle access is allowed. If not, then unrestricted Oracle access is not allowed.

#### Using Python

1. Install and configure AWS SDK for Python (Boto3): Boto3 makes it easy to integrate your Python application, library, or script with AWS services including AWS S3, AWS EC2, AWS DynamoDB, and much more. To install Boto3, you can use pip:

   ```
   pip install boto3
   ```

   You also need to configure your AWS credentials. You can do this in several ways, but the simplest is to use the AWS CLI:

   ```
   aws configure
   ```

   Then follow the prompts to input your AWS Access Key ID, Secret Access Key, default region name, and default output format.

2. Create a Python script to list all EC2 instances and their security groups: You can use the `describe_instances()` function to get information about all EC2 instances and the `describe_security_groups()` function to get information about their security groups.

   ```python
   import boto3

   ec2 = boto3.resource('ec2')

   for instance in ec2.instances.all():
       for sg in instance.security_groups:
           print("Instance ID: ", instance.id, "Security Group: ", sg['GroupId'])
   ```

3. Check the inbound rules of each security group: For each security group, you can use the `IpPermissions` attribute to get a list of its inbound rules. You can then check if any of these rules allow unrestricted access to Oracle (port 1521).

   ```python
   import boto3

   ec2 = boto3.client('ec2')

   response = ec2.describe_security_groups()

   for sg in response['SecurityGroups']:
       for rule in sg['IpPermissions']:
           for ip_range in rule['IpRanges']:
               if '0.0.0.0/0' in ip_range['CidrIp'] and rule['FromPort'] == 1521:
                   print("Security Group: ", sg['GroupId'], " allows unrestricted Oracle access.")
   ```

4. Run the script: Finally, you can run the script using Python. If any security groups allow unrestricted Oracle access, their IDs will be printed to the console.

   ```
   python check_oracle_access.py
   ```

This script will help you identify any security groups that allow unrestricted Oracle access, which is a potential security risk.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the issue of unrestricted Oracle access in AWS, you can follow the below steps:

1. Open the AWS Management Console and navigate to the RDS service.

2. Select the affected RDS instance and click on the "Modify" button.

3. Scroll down to the "Network & Security" section and click on the "Additional Configuration" tab.

4. In the "Additional Configuration" tab, locate the "Publicly Accessible" option and set it to "No".

5. Next, locate the "VPC Security Group" option and select the appropriate security group that allows access only to the required IP addresses or CIDR ranges.

6. Click on the "Continue" button and review the changes. If everything is correct, click on the "Modify DB Instance" button to apply the changes.

7. After the changes have been applied, verify that the RDS instance is no longer publicly accessible and that access is restricted to the required IP addresses or CIDR ranges.

By following these steps, you can remediate the issue of unrestricted Oracle access in AWS and ensure that your RDS instance is secure.

#### Using CLI

To remediate the unrestricted Oracle access issue in AWS, you can follow the below steps using AWS CLI:

1. Connect to your AWS account using AWS CLI.

2. Identify the security group that allows unrestricted Oracle access. You can use the following command to list all security groups in your AWS account:

```
aws ec2 describe-security-groups
```

3. Once you have identified the security group, use the following command to update the inbound rules of the security group to restrict access to Oracle:

```
aws ec2 revoke-security-group-ingress --group-id <security-group-id> --protocol tcp --port 1521 --cidr 0.0.0.0/0
```

This command will remove the inbound rule that allows unrestricted access to Oracle on port 1521 from any IP address.

4. After running the above command, you can verify that the rule has been removed by running the following command:

```
aws ec2 describe-security-groups --group-ids <security-group-id>
```

This command will display the details of the security group, including the inbound rules.

5. Finally, you should test the Oracle access to ensure that it is restricted as expected. If necessary, you can modify the security group rules further to allow access only from specific IP addresses or networks.

#### Using Python

To remediate the "Unrestricted Oracle Access Should Not Be Allowed" misconfiguration in AWS using Python, you can follow these steps:

1. Install the Boto3 AWS SDK for Python:

```python
!pip install boto3
```

2. Use Boto3 to connect to the AWS account:

```python
import boto3

session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY_ID',
    aws_secret_access_key='YOUR_SECRET_ACCESS_KEY',
    region_name='YOUR_REGION'
)

ec2 = session.client('ec2')
```

3. Use the `describe_security_groups` method to get a list of all the security groups in the account:

```python
response = ec2.describe_security_groups()
security_groups = response['SecurityGroups']
```

4. Loop through the security groups and check if any of them have unrestricted Oracle access:

```python
for sg in security_groups:
    for rule in sg['IpPermissions']:
        if rule['IpProtocol'] == 'tcp' and rule['FromPort'] == 1521 and rule['ToPort'] == 1521 and rule['IpRanges'] == [{'CidrIp': '0.0.0.0/0'}]:
            print(f"Security group {sg['GroupId']} has unrestricted Oracle access!")
```

5. If you find a security group with unrestricted Oracle access, use the `revoke_security_group_ingress` method to remove the rule:

```python
ec2.revoke_security_group_ingress(
    GroupId=sg['GroupId'],
    IpPermissions=[
        {
            'IpProtocol': 'tcp',
            'FromPort': 1521,
            'ToPort': 1521,
            'IpRanges': [{'CidrIp': '0.0.0.0/0'}]
        }
    ]
)
```

This will remove the unrestricted Oracle access from the security group.

### Additional Reading:

- [https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html#AddRemoveRules](https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html#AddRemoveRules) 


</Tab>
</Tabs>