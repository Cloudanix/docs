---
slug: root_account_activity
title: Root Account Activity Should Be Monitored
sidebar_label: Root Account Activity Should Be Monitored
---

### More Info:

Checks activity of any root user . Using the root account is strongly discouraged for everyday tasks as it carries a high level of privilege and can be risky.  Monitoring this activity can help ensure the root account is only being used for authorized purposes.

### Risk Level

Medium

### Address

Security

### Compliance Standards

CBP



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console and open the IAM console at https://console.aws.amazon.com/iam/.

2. In the navigation pane, choose "Credential Report". This report will list all your account's users and the status of their various credentials.

3. If the report is not ready, choose "Download Report". This will generate a new report.

4. Open the report and look for the "root" account. Check the "password_last_used" or "access_key_1_last_used_date" columns. If these columns show a recent date, it means the root account has been used recently.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all IAM users: To check the activity of the root account, you first need to list all IAM users. You can do this by running the command `aws iam list-users`. This will return a list of all IAM users in your AWS account.

3. Get the last used access details of the root account: You can get the last used access details of the root account by running the command `aws iam get-account-summary`. This will return a summary of the account including the last used access details.

4. Check the activity of the root account: To check the activity of the root account, you can use the AWS CloudTrail service. You can do this by running the command `aws cloudtrail lookup-events --lookup-attributes AttributeKey=Username,AttributeValue=root`. This will return a list of all events where the root account was used.

#### Using Python

1. Install the necessary Python libraries: Before you can start writing the script, you need to install the necessary Python libraries. For AWS, you will need the boto3 library, which is the Amazon Web Services (AWS) SDK for Python. You can install it using pip:

```python
pip install boto3
```

2. Import the necessary libraries and initialize the client: After installing the necessary libraries, you can start writing the script. First, import the necessary libraries and initialize the client:

```python
import boto3
client = boto3.client('iam')
```

3. Get the account summary: The next step is to get the account summary. This will give you information about the account, including the number of users, groups, and roles:

```python
response = client.get_account_summary()
```

4. Check for root account activity: Finally, you can check for root account activity. If the 'AccountMFAEnabled' key in the response dictionary is 0, it means that the root account does not have multi-factor authentication (MFA) enabled, which is a potential security risk:

```python
if response['SummaryMap']['AccountMFAEnabled'] == 0:
    print("Root account does not have MFA enabled.")
else:
    print("Root account has MFA enabled.")
```

This script will only check if MFA is enabled for the root account. To monitor root account activity, you would need to use AWS CloudTrail, which logs all actions taken in your AWS account. You can then analyze these logs to detect any suspicious activity.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of not monitoring root account activity in AWS IAM using the AWS Management Console, follow these step-by-step instructions:

1. **Sign in to the AWS Management Console**: Go to https://aws.amazon.com/ and sign in to your AWS account using your root account credentials.

2. **Navigate to CloudTrail**: In the AWS Management Console, search for "CloudTrail" in the services search bar and click on the CloudTrail service.

3. **Create a new trail**: Click on the "Trails" option in the left-hand navigation pane, then click on the "Create trail" button.

4. **Configure trail settings**:
   - Enter a name for the trail (e.g., "RootAccountMonitoring").
   - Choose the S3 bucket where you want to store the CloudTrail logs.
   - Enable the option for "Read/Write events".
   - Click on "Create" to create the trail.

5. **Enable logging for the root account**: By default, CloudTrail logs all AWS account activity, including actions performed by the root account.

6. **Set up CloudWatch alarms** (optional): You can set up CloudWatch alarms to monitor specific API activity related to the root account. This can help you detect suspicious activity and respond quickly.

7. **Review and monitor the logs**: Regularly review the CloudTrail logs to monitor the activity of the root account and detect any unauthorized actions.

By following these steps, you can remediate the misconfiguration of not monitoring root account activity in AWS IAM using the AWS Management Console and enhance the security of your AWS account.

#### Using CLI

To remediate the misconfiguration of not monitoring root account activity in AWS IAM using AWS CLI, follow these steps:

1. **Enable CloudTrail logging for the AWS account**:
   - Run the following AWS CLI command to enable CloudTrail logging:
     ```
     aws cloudtrail create-trail --name <trail-name> --s3-bucket-name <bucket-name> --is-multi-region-trail
     ```
     Replace `<trail-name>` with a suitable name for the CloudTrail trail, and `<bucket-name>` with the name of the S3 bucket where CloudTrail logs will be stored.

2. **Enable logging for AWS Management Console sign-in events**:
   - Run the following AWS CLI command to enable logging for AWS Management Console sign-in events:
     ```
     aws cloudtrail update-trail --name <trail-name> --enable-log-file-validation
     ```

3. **Configure CloudWatch Events for monitoring root account activity**:
   - Create a CloudWatch Events rule to monitor root account activity by running the following AWS CLI command:
     ```
     aws events put-rule --name MonitorRootAccountActivity --event-pattern "{\"source\": [\"aws.iam\"],\"detail-type\": [\"AWS API Call via CloudTrail\"],\"detail\":{\"userIdentity\":{\"type\":[\"Root\"]}}"
     ```
   
4. **Create a target for the CloudWatch Events rule**:
   - Create a target for the CloudWatch Events rule to specify the action to be taken when the rule is triggered. For example, you can send an SNS notification by running the following AWS CLI command:
     ```
     aws events put-targets --rule MonitorRootAccountActivity --targets "Id"="1","Arn"="<sns-topic-arn>"
     ```
     Replace `<sns-topic-arn>` with the ARN of the SNS topic where notifications will be sent.

5. **Enable the CloudWatch Events rule**:
   - Enable the CloudWatch Events rule to start monitoring root account activity by running the following AWS CLI command:
     ```
     aws events enable-rule --name MonitorRootAccountActivity
     ```

By following these steps, you will successfully remediate the misconfiguration of not monitoring root account activity in AWS IAM using AWS CLI.

#### Using Python

To remediate the misconfiguration of not monitoring root account activity in AWS IAM using Python, you can follow these steps:

1. **Enable AWS CloudTrail for Root Account Activity Logging:**
   - Use the AWS SDK for Python (Boto3) to enable CloudTrail logging for the root account. Here's an example code snippet to enable CloudTrail logging:

   ```python
   import boto3

   client = boto3.client('cloudtrail')

   response = client.update_trail(
       Name='your-cloudtrail-name',
       IncludeGlobalServiceEvents=True,
       IsMultiRegionTrail=True,
       EnableLogFileValidation=True
   )
   ```

2. **Set Up CloudWatch Alarms for Root Account Activity:**
   - Use Boto3 to create CloudWatch alarms that monitor root account activity. Here's an example code snippet to create a CloudWatch alarm for monitoring root account sign-in events:

   ```python
   import boto3

   client = boto3.client('cloudwatch')

   response = client.put_metric_alarm(
       AlarmName='RootAccountSignInAlarm',
       ComparisonOperator='GreaterThanThreshold',
       EvaluationPeriods=1,
       MetricName='SigninSuccesses',
       Namespace='AWS/CloudTrail',
       Period=300,
       Statistic='Sum',
       Threshold=0.0,
       ActionsEnabled=True,
       AlarmDescription='Alarm for Root Account Sign-In Events',
       Dimensions=[
           {
               'Name': 'EventName',
               'Value': 'ConsoleLogin'
           },
           {
               'Name': 'Username',
               'Value': 'root'
           }
       ],
       AlarmActions=[
           'arn:aws:sns:your-region:your-account-id:your-sns-topic'
       ]
   )
   ```

3. **Configure SNS Topic for CloudWatch Alarms:**
   - You need to create an SNS topic and subscribe to it to receive notifications for CloudWatch alarms. Here's an example code snippet to create an SNS topic:

   ```python
   import boto3

   client = boto3.client('sns')

   response = client.create_topic(
       Name='RootAccountActivityTopic'
   )

   topic_arn = response['TopicArn']

   response = client.subscribe(
       TopicArn=topic_arn,
       Protocol='email',
       Endpoint='your-email@example.com'
   )
   ```

By following these steps and regularly monitoring the CloudTrail logs and CloudWatch alarms, you can effectively remediate the misconfiguration of not monitoring root account activity in AWS IAM using Python.



</Tab>
</Tabs>