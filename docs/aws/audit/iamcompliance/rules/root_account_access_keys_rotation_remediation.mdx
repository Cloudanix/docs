

<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console and open the IAM console at https://console.aws.amazon.com/iam/.

2. In the navigation pane, choose "Users". This will display a list of all IAM users associated with the current AWS account.

3. Click on the user name of the root account. This will open the summary page for the selected IAM user.

4. In the "Security Credentials" section, check the "Access keys" section. If the "Last rotated" date is more than 90 days old, it indicates that the root account access keys have not been rotated recently.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   Installation: `pip install awscli`
   
   Configuration: `aws configure`

2. List all IAM users: Use the following command to list all the IAM users in your AWS account:

   `aws iam list-users --query 'Users[*].UserName' --output text`

3. Get access key details: For each user, you can get the details of their access keys by running the following command:

   `aws iam list-access-keys --user-name <username>`

   Replace `<username>` with the name of the IAM user. This command will return a list of access keys for the specified user along with other details like when the keys were last used and when they were created.

4. Check key rotation: To check if the access keys have been rotated, you need to look at the 'CreateDate' field in the output of the previous command. If the 'CreateDate' is more than 90 days old, it means the keys have not been rotated in the last 90 days.

#### Using Python

1. Import the necessary libraries: You will need the boto3 library, which allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, etc.

```python
import boto3
from datetime import datetime, timezone
```

2. Create an IAM client: Use the boto3 library to create a client for AWS Identity and Access Management (IAM).

```python
client = boto3.client('iam')
```

3. Get a list of all access keys: Use the list_access_keys method to get a list of all access keys associated with an AWS account.

```python
response = client.list_access_keys(UserName='root')
```

4. Check the age of each access key: For each access key, check the 'CreateDate' attribute to determine when it was last rotated. If it's been more than 90 days, the key should be rotated.

```python
for key in response['AccessKeyMetadata']:
    create_date = key['CreateDate']
    age = datetime.now(timezone.utc) - create_date
    if age.days > 90:
        print(f"Access key {key['AccessKeyId']} should be rotated.")
```

This script will print a message for each access key that should be rotated. Note that this script only checks the root user's access keys. If you have other IAM users, you should modify the script to check their keys as well.

</Tab>

<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of root account access keys should be rotated in AWS using the AWS console, follow these steps:

1. Login to the AWS Management Console using root account credentials.
2. Go to the IAM dashboard by selecting "Services" from the top navigation bar and selecting "IAM" under the "Security, Identity & Compliance" category.
3. In the IAM dashboard, select "Users" from the left-hand menu and locate the root account user.
4. Click on the root account user to view the details.
5. In the "Security credentials" tab, locate the "Access keys" section and click on "Rotate access key."
6. A dialog box will appear asking you to confirm the rotation of the access keys. Click on "Rotate."
7. The console will generate a new access key pair. Download the new access key and secret key and store them securely.
8. After downloading the new access keys, delete the old access keys by clicking on the "X" next to the key.
9. Repeat this process periodically to ensure that the root account access keys are regularly rotated.

By following these steps, you can remediate the misconfiguration of root account access keys should be rotated in AWS using the AWS console.

#### Using CLI

To remediate the issue of Root Account Access Keys Should Be Rotated in AWS using AWS CLI, follow these steps:

1. Open the AWS CLI on your local machine.

2. Run the following command to list all the access keys associated with the root account:

   ```
   aws iam list-access-keys --user-name <root_account_user_name>
   ```

   Replace `<root_account_user_name>` with the name of your root account user.

3. Identify the access key that needs to be rotated.

4. Run the following command to create a new access key:

   ```
   aws iam create-access-key --user-name <root_account_user_name>
   ```

   This command will create a new access key and secret access key pair.

5. Run the following command to delete the old access key:

   ```
   aws iam delete-access-key --user-name <root_account_user_name> --access-key-id <old_access_key_id>
   ```

   Replace `<old_access_key_id>` with the access key ID of the old access key that needs to be rotated.

6. Update any scripts or applications that use the old access key with the new access key.

7. Verify that the new access key is working properly by running a test command.

   ```
   aws s3 ls
   ```

   This command should list all the S3 buckets in your account.

8. Repeat steps 3-7 for any other access keys associated with the root account.

9. Once all the access keys have been rotated, ensure that the root account password is also strong and has been rotated recently.

By following these steps, you can remediate the issue of Root Account Access Keys Should Be Rotated in AWS using AWS CLI.

#### Using Python

To remediate the misconfiguration of Root Account Access Keys Should Be Rotated in AWS using Python, follow these steps:

1. Install the AWS SDK for Python (Boto3) using pip.

```
pip install boto3
```

2. Create an AWS IAM client using Boto3.

```
import boto3

# Create an IAM client
iam = boto3.client('iam')
```

3. Get the list of access keys for the root account.

```
# Get the list of access keys for the root account
response = iam.list_access_keys(UserName='root')
access_key_list = response['AccessKeyMetadata']
```

4. Loop through the access keys and check the age of each key. If an access key is older than 90 days, create a new key and delete the old key.

```
# Loop through the access keys and check the age of each key
for access_key in access_key_list:
    access_key_id = access_key['AccessKeyId']
    create_date = access_key['CreateDate']
    age = (datetime.now(create_date.tzinfo) - create_date).days

    # If an access key is older than 90 days, create a new key and delete the old key
    if age > 90:
        new_access_key = iam.create_access_key(UserName='root')['AccessKey']
        iam.delete_access_key(UserName='root', AccessKeyId=access_key_id)
```

5. Save the Python script and run it periodically to ensure that the root account access keys are rotated every 90 days.

Note: It is recommended to use AWS Identity and Access Management (IAM) roles instead of root account access keys for accessing AWS services.


</Tab>
</Tabs>