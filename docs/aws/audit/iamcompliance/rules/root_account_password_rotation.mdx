---
slug: root_account_password_rotation
title: Root Account Password Should Be Rotated
sidebar_label: Root Account Password Should Be Rotated
---

### More Info:

This rule ensures that the root account's password is regularly rotated to enhance security and minimize the risk of unauthorized access. It checks if the root account's password has been rotated within a specified time frame, typically following industry best practices and compliance requirements. Failure to rotate the root account's password regularly could increase the likelihood of unauthorized access and compromise sensitive information.

### Risk Level

High

### Address

Security

### Compliance Standards

CBP



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console and open the IAM console at https://console.aws.amazon.com/iam/.
   
2. In the navigation pane, choose "Users". This will display a list of all IAM users associated with the account.

3. Select the root user account from the list. This will open the summary page for the selected user.

4. In the "Security Credentials" section, check the "Password Last Used" column. If the password has not been changed in a long time, it indicates that the root account password has not been rotated.

#### Using CLI

1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Once you have AWS CLI installed and configured, you can proceed to the next steps.

2. Use the following command to list all the users in your AWS account:

   ```
   aws iam list-users
   ```

   This command will return a list of all the users in your AWS account.

3. To get the password last used details for a specific user, use the following command:

   ```
   aws iam get-user --user-name <username>
   ```

   Replace `<username>` with the name of the user you want to check. This command will return the details of the user including the date when the password was last used.

4. If the password last used date is more than 90 days, then it is a misconfiguration as AWS recommends that the root account password should be rotated every 90 days. You can check this manually or write a script to automate this process.

#### Using Python

1. First, you need to install the AWS SDK for Python (Boto3). You can do this by running the command `pip install boto3` in your terminal.

2. Import the necessary libraries and initialize the client for AWS IAM. Here is a sample script:

```python
import boto3
from botocore.exceptions import NoCredentialsError

try:
    client = boto3.client('iam')
except NoCredentialsError:
    print("No AWS credentials found.")
```

3. Now, you can use the `get_account_password_policy` method to retrieve the password policy for the AWS account. This method returns a dictionary that contains the details of the password policy.

```python
try:
    response = client.get_account_password_policy()
except client.exceptions.NoSuchEntityException:
    print("No password policy found.")
```

4. Finally, you can check the `ExpirePasswords` field in the response. If this field is set to `True`, it means that the root account password is configured to be rotated. If it is `False`, it means that the root account password is not configured to be rotated.

```python
if response['PasswordPolicy']['ExpirePasswords']:
    print("Root account password is configured to be rotated.")
else:
    print("Root account password is not configured to be rotated.")
```

Please note that this script only checks if the root account password is configured to be rotated. It does not check when the last rotation occurred. To do that, you would need to use the `list_users` method to get a list of all IAM users, and then use the `get_user` method for each user to get the `PasswordLastUsed` field.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the issue of Root Account Password not being rotated in AWS IAM using the AWS Management Console, follow these step-by-step instructions:

1. **Sign in to the AWS Management Console**: Go to the AWS Management Console (https://aws.amazon.com/) and sign in using your root account credentials.

2. **Navigate to the IAM Dashboard**: Once you are logged in, navigate to the IAM service by searching for it in the AWS Management Console search bar or by clicking on the "Services" dropdown menu and selecting "IAM" under the "Security, Identity, & Compliance" section.

3. **Select the Root User**: In the IAM dashboard, click on the "Users" tab on the left-hand side. Locate and click on the root user in the list of IAM users displayed.

4. **Rotate the Root Account Password**: In the root user details page, scroll down to the "Security credentials" section. Click on the "Manage" button next to "Console password". 

5. **Change the Root Account Password**: Click on the "Enable" button to enable the password reset. Enter a new password that meets the AWS password policy requirements (e.g., minimum length, complexity). 

6. **Save the New Password**: Click on the "Apply" button to save the new password for the root account.

7. **Update Root Account Password Regularly**: It is recommended to set up a schedule to regularly rotate the root account password to enhance security.

8. **Review and Confirm**: After changing the root account password, review the changes to ensure that the password has been successfully rotated.

By following these steps, you have successfully rotated the Root Account Password in AWS IAM using the AWS Management Console, thereby remediating the misconfiguration of not rotating the root account password.

#### Using CLI

To remediate the misconfiguration of not rotating the root account password in AWS IAM using AWS CLI, you can follow these steps:

1. Open your terminal or command prompt.

2. Run the following AWS CLI command to rotate the root account password:
```
aws iam change-password --user-name <root_account_username>
```
Replace `<root_account_username>` with the username of your AWS root account.

3. AWS CLI will prompt you to enter the current password for the root account. Enter the current password and press Enter.

4. Next, AWS CLI will ask you to enter a new password for the root account. Enter a strong and secure password that meets the AWS password policy requirements and press Enter.

5. Confirm the new password by entering it again when prompted.

6. Once the password is successfully changed, you will receive a confirmation message.

By following these steps, you have successfully rotated the root account password for your AWS IAM user using AWS CLI. Remember to store the new password securely and update it in your password manager or secure storage.

#### Using Python

To remediate the misconfiguration of the root account password not being rotated in AWS IAM using Python, you can follow these steps:

1. Install the AWS SDK for Python (Boto3) by running the following command:
   ```
   pip install boto3
   ```

2. Create a Python script with the following code to rotate the root account password:

```python
import boto3

def rotate_root_account_password():
    # Initialize the IAM client
    iam_client = boto3.client('iam')
    
    # Generate a new random password
    new_password = 'your_new_password_here'
    
    # Change the root account password
    iam_client.change_password(
        OldPassword='your_current_root_password_here',
        NewPassword=new_password
    )
    
    print("Root account password rotated successfully.")

if __name__ == '__main__':
    rotate_root_account_password()
```

3. Replace `'your_new_password_here'` with a new secure password and `'your_current_root_password_here'` with the current root account password.

4. Run the Python script to rotate the root account password. This will change the root account password to the new password specified in the script.

5. Make sure to securely store the new root account password and update any necessary documentation or password management tools.

By following these steps, you can remediate the misconfiguration of the root account password not being rotated in AWS IAM using Python.



</Tab>
</Tabs>