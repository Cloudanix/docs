---
slug: root_account_access_keys
title: Root Account Should Not Have Access Keys
sidebar_label: Root Account Should Not Have Access Keys
---

### More Info:

Root account has full permissions across the entire account. Root account should not have access keys. Also, it certainly shouldn't access any service. Instead, create IAM users with predefined roles.

### Risk Level

Critical

### Address

Security

### Compliance Standards

HIPAA, ISO27001, PCIDSS, GDPR, NIST, SOC2, CISAWS, CBP, HITRUST, AWSWAF, NISTCSF, FedRAMP



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console as an IAM user or role.
2. In the navigation pane, choose "Users".
3. In the "User Name" list, choose the name of the intended user which will take you to the "Summary" page.
4. In the "Security Credential" section, look for "Access Keys". If any access keys (Access Key ID and Secret Access Key) are listed, it means the root account has access keys.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all IAM users: Use the following command to list all the IAM users in your AWS account:

   ```
   aws iam list-users
   ```
   This command will return a list of all IAM users along with their details.

3. Check for access keys: For each user returned in the previous step, check if they have any access keys associated with them. You can do this by running the following command:

   ```
   aws iam list-access-keys --user-name <username>
   ```
   Replace `<username>` with the name of the user. This command will return a list of all access keys associated with the specified user.

4. Check if root account has access keys: The root account is the account that you used to create your AWS account. It has complete access to all resources in the account. If the root account has any access keys associated with it, it will be listed in the output of the previous command. If the root account has access keys, it is a misconfiguration because it is a security risk. The root account should not have access keys because if they are compromised, the attacker will have complete control over your AWS account.

#### Using Python

1. First, you need to install the AWS SDK for Python (Boto3) if you haven't done so already. You can install it using pip:

```python
pip install boto3
```

2. Import the necessary modules and create a session using your AWS credentials:

```python
import boto3

session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    region_name='us-west-2'
)
```

3. Now, create a client for IAM and get the list of all users:

```python
iam = session.client('iam')
users = iam.list_users()['Users']
```

4. Finally, iterate over the users and check if the root account has access keys:

```python
for user in users:
    if user['UserName'] == 'root':
        access_keys = iam.list_access_keys(UserName='root')['AccessKeyMetadata']
        if len(access_keys) > 0:
            print("Root account has access keys")
        else:
            print("Root account does not have access keys")
```

This script will print whether the root account has access keys or not. If it does, it means there is a misconfiguration as the root account should not have access keys for security reasons.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

1. **Sign in to the AWS Management Console**.
2. **Navigate to the IAM service**.
3. **Select Users from the navigation pane**.
4. **Identify the root user**:
   - Locate the user with the username "root".
5. **Review Access Keys**:
   - Click on the root user.
   - Go to the Security credentials tab.
   - Review the list of access keys.
6. **Deactivate or Delete Access Keys**:
   - Select the active access key(s) associated with the root user.
   - Choose Deactivate or Delete to make the access key(s) inactive or delete them.
7. **Repeat for other root users**:
   - If you have multiple root users, repeat the above steps for each of them.

#### Using CLI

1. **List Access Keys**:
```bash
aws iam list-access-keys --user-name root
```
2. **Identify Active Access Keys**:
   - Look for active access keys associated with the root user.
3. **Deactivate or Delete Access Keys**:
```bash
aws iam update-access-key --access-key-id ACCESS_KEY_ID --status Inactive --user-name root
```
Replace `ACCESS_KEY_ID` with the ID of the access key to deactivate.
4. **Repeat for other active access keys**:
   - If there are multiple active access keys associated with the root user, repeat the deactivation command for each of them.

#### Using Python

Here's a Python script to identify and deactivate active access keys associated with the root user:

```python
import boto3

class RootAccessKeyChecker:
    def __init__(self):
        self.iam_client = boto3.client('iam')

    def get_active_access_keys(self):
        failures = []
        response = self.iam_client.list_access_keys(UserName='root')
        for key in response['AccessKeyMetadata']:
            if key['Status'] == 'Active':
                failures.append(key)
        return failures

    def deactivate_access_key(self, access_key_id):
        self.iam_client.update_access_key(
            UserName='root',
            AccessKeyId=access_key_id,
            Status='Inactive'
        )
        print(f"Access key {access_key_id} has been deactivated.")

# Instantiate the class
checker = RootAccessKeyChecker()

# Get active access keys for root user
active_access_keys = checker.get_active_access_keys()

# Deactivate active access keys
for key in active_access_keys:
    checker.deactivate_access_key(key['AccessKeyId'])
```

This Python script identifies active access keys associated with the root user and deactivates them.

Make sure to have appropriate IAM permissions for managing access keys if you're using AWS CLI or Python script.

### Additional Reading:

- [https://docs.aws.amazon.com/general/latest/gr/managing-aws-access-keys.html](https://docs.aws.amazon.com/general/latest/gr/managing-aws-access-keys.html) 


</Tab>
</Tabs>