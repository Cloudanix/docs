---
slug: unused_iam_user
title: User Account Without Any Usage Should Be Removed
sidebar_label: User Account Without Any Usage Should Be Removed
---

### More Info:

Any unused IAM user without console access and API access should be removed as an extra security measure for protecting your AWS resources against unapproved access.

### Risk Level

Medium

### Address

Security

### Compliance Standards

CISAWS, CBP, HIPAA, SOC2, ISO27001, HITRUST, NISTCSF, PCIDSS



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and open the IAM console at https://console.aws.amazon.com/iam/.

2. In the navigation pane, choose "Users". This will display a list of all IAM users that are currently configured in your AWS environment.

3. Select a user and then choose the "Access Advisor" tab. This tab shows the service permissions granted to a user and when those services were last accessed.

4. Review the "Last accessed" column. If the column shows "No activity", it means the user has not accessed the service in the tracking period. If the user has not accessed any services for a long period of time, it may indicate that the user account is not in use and should be reviewed for possible removal.

#### Using CLI

1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Once you have AWS CLI installed and configured, you can proceed to the next steps.

2. To list all the IAM users, use the following command:
   ```
   aws iam list-users
   ```
   This command will return a list of all IAM users in your AWS account.

3. To check the usage of each IAM user, you can use the following command:
   ```
   aws iam get-user --user-name <username>
   ```
   Replace `<username>` with the name of the IAM user you want to check. This command will return information about the specified IAM user, including when the user was last used.

4. Repeat step 3 for each IAM user in your AWS account. If the `PasswordLastUsed` field is not present or the date is too old, it means that the IAM user has not been used recently and should be considered for removal.

#### Using Python

1. Install the necessary Python libraries: Before you start, you need to install the AWS SDK for Python (Boto3) which allows Python developer to write software that makes use of services like Amazon S3, Amazon EC2, etc. You can install it using pip:

   ```
   pip install boto3
   ```

2. Set up AWS credentials: You need to configure your AWS credentials. You can set your credentials for use by Boto3 in several ways. The quickest way to get started is to configure them in the AWS CLI:

   ```
   aws configure
   ```

   You will be prompted to provide your AWS Access Key ID and Secret Access Key, which you should have received when you created your AWS account.

3. Write a Python script to list all IAM users and their last used date:

   ```python
   import boto3
   from botocore.exceptions import ClientError

   def list_users():
       try:
           iam = boto3.client('iam')
           users = iam.list_users()['Users']
           for user in users:
               username = user['UserName']
               try:
                   last_used = iam.get_user(UserName=username)['User']['PasswordLastUsed']
               except ClientError:
                   last_used = "Never"
               print(f"User: {username}, Last Used: {last_used}")
       except ClientError as e:
           print(f"Unexpected error: {e}")

   if __name__ == "__main__":
       list_users()
   ```

   This script will print out all IAM users and the last time they used their password. If the password has never been used, it will print "Never".

4. Analyze the output: Run the script and analyze the output. If there are users who have never used their account or haven't used it for a long time, these are potential misconfigurations. You should investigate further and consider removing these users if they are no longer needed.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the issue of user accounts without any usage in AWS, you can follow the below steps:

1. Login to your AWS account using your credentials.
2. Go to the AWS Management Console and navigate to the IAM service.
3. In the IAM console, click on the "Users" option from the left-hand menu.
4. You will see a list of all the users in your AWS account.
5. Sort the users by the "Last Activity" column to identify the users who have not used their accounts.
6. Select the user accounts that have not been used and click on the "Delete User" button.
7. Confirm the deletion of the user account by clicking on the "Yes, Delete" button.

By following these steps, you can remediate the issue of user accounts without any usage in AWS.

#### Using CLI

To remediate the misconfiguration of a user account without any usage in AWS, you can follow these steps using AWS CLI:

1. Open the AWS CLI and run the following command to list all the users in the AWS account:
```
aws iam list-users
```

2. Identify the user accounts that have not been used for a long time.

3. Run the following command to get the details of the user account:
```
aws iam get-user --user-name <username>
```
Replace `<username>` with the name of the user account you want to check.

4. Check the output of the command for the `CreateDate` field. If the user account was created a long time ago and has not been used since, it can be considered for removal.

5. Run the following command to delete the user account:
```
aws iam delete-user --user-name <username>
```
Replace `<username>` with the name of the user account you want to delete.

6. Confirm the deletion by typing `yes` when prompted.

Note: Before deleting a user account, make sure that it is not associated with any resources or services in the AWS account.

#### Using Python

To remediate the misconfiguration of having a user account without any usage in AWS, you can use the following steps in Python:

1. First, you need to identify the user accounts that have not been used for a certain period of time. You can use the AWS SDK for Python (Boto3) to list all the IAM users and check their last activity date.

```python
import boto3
from datetime import datetime, timedelta

# Set the threshold for user inactivity (e.g. 90 days)
threshold_days = 90
threshold_date = datetime.now() - timedelta(days=threshold_days)

# Create an IAM client
iam = boto3.client('iam')

# Get a list of all IAM users
users = iam.list_users()['Users']

# Filter out the users that have been active within the threshold period
inactive_users = []
for user in users:
    access_keys = iam.list_access_keys(UserName=user['UserName'])['AccessKeyMetadata']
    if len(access_keys) == 0:
        last_login = user['CreateDate']
    else:
        last_login = access_keys[0]['CreateDate']
    if last_login < threshold_date:
        inactive_users.append(user['UserName'])
```

2. Once you have identified the inactive users, you can remove them from the AWS account using the `delete_user` method of the IAM client.

```python
# Remove the inactive users
for user in inactive_users:
    iam.delete_user(UserName=user)
```

Note: Before removing any user, make sure to review their permissions and check if they have any active resources or services associated with them. It is also recommended to disable the user account first, rather than deleting it immediately, to allow for a grace period in case the account is still needed.

### Additional Reading:

- [https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html](https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html) 


</Tab>
</Tabs>