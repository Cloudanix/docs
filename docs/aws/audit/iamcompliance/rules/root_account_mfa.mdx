---
slug: root_account_mfa
title: Root Account Should Have MFA
sidebar_label: Root Account Should Have MFA
---

### More Info:

Multifactor Authentication is strongly recommended to be enabled for every account with no exceptions in order to secure your AWS environment and adhere to IAM security best practices.

### Risk Level

Critical

### Address

Security

### Compliance Standards

HIPAA, GDPR, CISAWS, CBP, NIST, SOC2, PCIDSS, HITRUST, AWSWAF, NISTCSF



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console as a root user.
2. In the navigation pane, choose "IAM" to open the IAM dashboard.
3. In the IAM dashboard, you will find the "Security Status" section. Here, you can see the status of MFA on your root account. If it's not enabled, it will be listed as an action item.
4. Click on "Activate MFA on your root account" to see the current MFA status. If MFA is not enabled, it will show "Not enabled".

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   Installation:
   ```
   pip install awscli
   ```
   Configuration:
   ```
   aws configure
   ```
   You will be prompted to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. List all IAM users: Once you have AWS CLI installed and configured, you can list all IAM users in your AWS account by running the following command:
   ```
   aws iam list-users
   ```
   This command will return a list of all IAM users in your AWS account.

3. Check MFA status: For each user returned in the previous step, you can check if MFA is enabled by running the following command:
   ```
   aws iam list-mfa-devices --user-name <username>
   ```
   Replace `<username>` with the name of the IAM user. This command will return a list of all MFA devices associated with the specified IAM user.

4. Analyze the output: If the output from the previous step is empty, it means that MFA is not enabled for the specified IAM user. If the output contains one or more MFA devices, it means that MFA is enabled for the specified IAM user. Repeat steps 3 and 4 for each IAM user in your AWS account.

#### Using Python

1. First, you need to install the AWS SDK for Python (Boto3) if you haven't done so already. You can install it using pip:

```python
pip install boto3
```

2. Import the necessary modules and create a session using your AWS credentials:

```python
import boto3

session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    aws_session_token='SESSION_TOKEN',
)
```

3. Now, you can use the IAM client to get the account's summary:

```python
iam = session.client('iam')
account_summary = iam.get_account_summary()
```

4. Finally, you can check if the root account has MFA enabled:

```python
if account_summary['SummaryMap']['AccountMFAEnabled'] == 1:
    print("MFA is enabled for the root account.")
else:
    print("MFA is not enabled for the root account.")
```

This script will print whether MFA is enabled for the root account or not. If it's not enabled, you've detected a misconfiguration.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

1. **Sign in to the AWS Management Console**.
2. **Navigate to the IAM service**.
3. **Select Users from the navigation pane**.
4. **Identify the root user**:
   - Locate the user with the username "root".
5. **Enable MFA**:
   - Click on the root user.
   - Go to the Security credentials tab.
   - Under Multi-Factor Authentication (MFA), click on Manage MFA.
   - Follow the prompts to set up MFA for the root user.
6. **Repeat for other root users**:
   - If there are multiple root users, repeat the above steps for each of them.

#### Using CLI

1. **Enable MFA for the Root User**:
```bash
aws iam enable-mfa-device --user-name root --authentication-code1 MFA_CODE_1 --authentication-code2 MFA_CODE_2
```
Replace `MFA_CODE_1` and `MFA_CODE_2` with the two MFA codes generated by the MFA device.

#### Using Python

Here's a Python script to enable MFA for the root AWS account:

```python
import boto3

class MFAChecker:
    def __init__(self):
        self.iam_client = boto3.client('iam')

    def enable_mfa_for_root(self, mfa_code1, mfa_code2):
        self.iam_client.enable_mfa_device(
            UserName='root',
            SerialNumber='arn:aws:iam::ACCOUNT_ID:mfa/root',
            AuthenticationCode1=mfa_code1,
            AuthenticationCode2=mfa_code2
        )
        print("MFA has been enabled for the root user.")

# Instantiate the class
checker = MFAChecker()

# Provide the MFA codes
mfa_code1 = '111111'  # Example MFA code 1
mfa_code2 = '222222'  # Example MFA code 2

# Enable MFA for the root user
checker.enable_mfa_for_root(mfa_code1, mfa_code2)
```

Ensure to replace `'111111'` and `'222222'` with the actual MFA codes generated by the MFA device.

Make sure to have appropriate IAM permissions for managing MFA devices if you're using AWS CLI or Python script.
### Additional Reading:

- [https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa.html](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa.html) 


</Tab>
</Tabs>