---
slug: groups_without_users
title: Groups Without Users Should Be Removed
sidebar_label: Groups Without Users Should Be Removed
---

### More Info:

Empty groups should be cleaned up and should not linger around.

### Risk Level

Informational

### Address

Security

### Compliance Standards

CBP

This rule identifies IAM roles that do not require multi-factor authentication (MFA) or external ID for assumed roles. Roles without MFA or external ID can pose security risks, as they may allow unauthorized access or increase the attack surface for potential breaches. Enforcing MFA and external ID requirements adds an additional layer of security to IAM roles and helps prevent unauthorized access.



### Triage and Remediation
<Tabs>
<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the "Groups Without Users Should Be Removed" misconfiguration in AWS using AWS console, you can follow these steps:

1. Open the AWS Management Console and navigate to the Identity and Access Management (IAM) service.

2. In the left navigation pane, click on "Groups".

3. Identify any groups that do not have any users assigned to them.

4. Select the group(s) that do not have any users assigned to them.

5. Click on the "Group Actions" dropdown menu and select "Delete Group".

6. Confirm the group deletion by clicking "Yes, Delete" in the pop-up window.

7. Repeat steps 3-6 for any other groups without users.

By following these steps, you will have successfully remediated the "Groups Without Users Should Be Removed" misconfiguration in AWS using the AWS console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration "Groups Without Users Should Be Removed" in AWS using AWS CLI, follow the below steps:

1. Open the AWS CLI and run the following command to list all the groups in your AWS account:
   ```
   aws iam list-groups
   ```

2. Identify the groups that do not have any users associated with them.

3. Run the following command to delete the group:
   ```
   aws iam delete-group --group-name <group-name>
   ```
   Replace `<group-name>` with the name of the group that you want to delete.

4. Repeat steps 2 and 3 for all the groups that do not have any users associated with them.

5. Verify that all the groups without users have been deleted by running the following command:
   ```
   aws iam list-groups
   ```
   This should return a list of groups that have at least one user associated with them.

By following the above steps, you can remediate the misconfiguration "Groups Without Users Should Be Removed" in AWS using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration "Groups Without Users Should Be Removed" in AWS using Python, follow these steps:

1. Install the AWS SDK for Python (boto3) using pip:

```
pip install boto3
```

2. Create an AWS IAM client using boto3:

```python
import boto3

iam = boto3.client('iam')
```

3. Use the `list_groups` method to get a list of all IAM groups:

```python
response = iam.list_groups()
groups = response['Groups']
```

4. Use a loop to iterate over the list of groups and check if each group has any users:

```python
for group in groups:
    group_name = group['GroupName']
    response = iam.get_group(GroupName=group_name)
    users = response['Users']
    if not users:
        iam.delete_group(GroupName=group_name)
```

5. Use the `delete_group` method to delete any groups that do not have any users.

6. Save the Python script and run it to remediate the misconfiguration.

Note: Before running the script, make sure you have the necessary permissions to delete IAM groups.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/IAM/latest/UserGuide/id_groups_manage_add-remove-users.html](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_groups_manage_add-remove-users.html) 

