---
slug: codebuild_project_restrict_cred_in_environment
title: Plaintext AWS Credentials In Environment Variables CodeBuild Project Should Not Be Set
sidebar_label: Plaintext AWS Credentials In Environment Variables CodeBuild Project Should Not Be Set
---

### More Info:

This rule checks AWS CodeBuild projects for environment variables that contain plaintext AWS credentials (AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY). Storing AWS credentials in plaintext within environment variables poses a significant security risk, as it can lead to unauthorized access if the credentials are exposed. It is recommended to use IAM roles or encrypted secrets management services like AWS Secrets Manager to handle credentials securely.

### Risk Level

High

### Address

Security

### Compliance Standards

CBP

### Remediation

#### Using Console

To remediate plaintext AWS credentials in environment variables in an AWS CodeBuild project, follow these steps using the AWS Management Console:

1. **Access AWS CodeBuild Console**:
   - Log in to your AWS Management Console.
   - Navigate to the AWS CodeBuild console.

2. **Identify the Project**:
   - Locate the CodeBuild project where plaintext AWS credentials are set in environment variables.

3. **Update Environment Variables**:
   - Click on the CodeBuild project name to access its details.
   - In the project details, navigate to the "Environment" section.

4. **Modify Environment Settings**:
   - Look for the environment variables section where plaintext AWS credentials are set.
   - Remove any environment variables that contain AWS credentials in plaintext.

5. **Use AWS Secrets Manager**:
   - Instead of storing credentials in plaintext, consider using AWS Secrets Manager to securely store and retrieve sensitive information.
   - Create a secret in AWS Secrets Manager to store the AWS credentials securely.

6. **Update Build Specification**:
   - If the AWS credentials are being passed through a buildspec file, ensure that the credentials are not hardcoded in the file.
   - Modify the buildspec file to fetch the credentials securely from AWS Secrets Manager or other secure storage mechanisms.

7. **Test the Build**:
   - Save the changes to the CodeBuild project configuration.
   - Trigger a build to ensure that the project can still build successfully without the plaintext AWS credentials.

8. **Monitor and Audit**:
   - Regularly monitor and audit your CodeBuild projects for any insecure configurations.
   - Implement automated checks to prevent plaintext AWS credentials from being introduced in the future.

By following these steps, you can remediate the issue of plaintext AWS credentials in environment variables in an AWS CodeBuild project and ensure that sensitive information is handled securely.

#### Using CLI

To remediate the issue of plaintext AWS credentials in environment variables in an AWS CodeBuild project using AWS CLI, you can follow these steps:

1. **Identify the CodeBuild project**: Use the AWS CLI command `aws codebuild list-projects` to list all the CodeBuild projects in your account. Identify the project where plaintext AWS credentials are set in environment variables.

2. **Update the CodeBuild project**: Use the AWS CLI command `aws codebuild update-project` to update the CodeBuild project configuration. You will need to specify the project name or ARN in the command.

3. **Remove plaintext AWS credentials from environment variables**: In the `environment` section of the CodeBuild project configuration, locate the environment variables that contain plaintext AWS credentials. Remove these environment variables or replace them with secure methods of providing credentials, such as using AWS Systems Manager Parameter Store or AWS Secrets Manager.

4. **Store AWS credentials securely**: If the CodeBuild project requires AWS credentials to access AWS resources, it is recommended to store these credentials securely in AWS Secrets Manager or AWS Systems Manager Parameter Store. Retrieve the credentials securely during the build process instead of passing them as plaintext environment variables.

5. **Update the buildspec file**: If the build process requires AWS credentials, update the buildspec file to include the necessary steps to retrieve the credentials securely from AWS Secrets Manager or AWS Systems Manager Parameter Store.

6. **Test the updated CodeBuild project**: Trigger a build in the CodeBuild project to ensure that the changes made to remove plaintext AWS credentials from environment variables do not impact the build process.

By following these steps, you can remediate the issue of plaintext AWS credentials in environment variables in an AWS CodeBuild project using AWS CLI.

#### Using Python

To remediate the issue of having plaintext AWS credentials in environment variables in an AWS CodeBuild project, you should follow these steps:

1. **Create an IAM Role**: Create an IAM role with the necessary permissions for your CodeBuild project to access AWS resources securely. This role will be assumed by the CodeBuild service when running your build.

2. **Update CodeBuild Project Configuration**:
   - Open the AWS Management Console and navigate to the CodeBuild service.
   - Select your CodeBuild project that contains the plaintext AWS credentials in environment variables.
   - Click on "Edit" to modify the project configuration.
   - In the project configuration, under the "Environment" section, set the "Service role" to the IAM role you created in step 1.
   - Remove any plaintext AWS credentials present in the environment variables.

3. **Use AWS SDK for Python (Boto3)**: Instead of using plaintext AWS credentials in environment variables, utilize the AWS SDK for Python (Boto3) to interact with AWS services securely using the IAM role assigned to your CodeBuild project.

4. **Update Build Spec**: If you are using a `buildspec.yml` file to define the build steps, ensure that you update the build spec to use the AWS SDK for Python (Boto3) to interact with AWS services securely.

5. **Test the Build**: After making these changes, run a test build to ensure that your CodeBuild project can access AWS resources securely without using plaintext AWS credentials in environment variables.

By following these steps, you can remediate the issue of having plaintext AWS credentials in environment variables in an AWS CodeBuild project and ensure secure access to AWS resources.
