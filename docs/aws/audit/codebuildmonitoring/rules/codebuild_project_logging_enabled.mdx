---
slug: codebuild_project_logging_enabled
title: Logging Should Be Enabled CodeBuild Project Environment
sidebar_label: Logging Should Be Enabled CodeBuild Project Environment
---

### More Info:

This rule ensures that logging is enabled for the environment of an AWS CodeBuild project by checking if at least one log option is enabled. Logging provides valuable insights into build execution, errors, and debugging information. Failing to enable logging can hinder troubleshooting efforts and impact the visibility of build activities.

### Risk Level

Medium

### Address

Security

### Compliance Standards

CBP


### Triage and Remediation
<Tabs>


<Tab title='Prevention'>
### How to Prevent
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To prevent the misconfiguration of "Logging Should Be Enabled in CodeBuild Project Environment" using the AWS Management Console, follow these steps:

1. **Navigate to CodeBuild:**
   - Open the AWS Management Console.
   - In the search bar, type "CodeBuild" and select it from the dropdown list.

2. **Select the Project:**
   - In the CodeBuild dashboard, locate and click on the CodeBuild project for which you want to enable logging.

3. **Edit Project Settings:**
   - In the project details page, click on the "Edit" button to modify the project settings.

4. **Enable Logging:**
   - Scroll down to the "Build logs" section.
   - Ensure that the "CloudWatch Logs" option is checked.
   - Optionally, you can also enable "S3 logs" if you want to store logs in an S3 bucket.
   - Click "Update" to save the changes.

By following these steps, you can ensure that logging is enabled for your CodeBuild project environment, which helps in monitoring and troubleshooting build processes.
</Accordion>

<Accordion title='Using CLI'>
To prevent the misconfiguration of "Logging Should Be Enabled" in an AWS CodeBuild project environment using AWS CLI, follow these steps:

1. **Create or Update a CodeBuild Project with Logging Configuration:**
   Ensure that the CodeBuild project is created or updated with the appropriate logging configuration. Use the `create-project` or `update-project` command with the `logsConfig` parameter.

   ```sh
   aws codebuild create-project \
     --name my-codebuild-project \
     --source type=GITHUB,location=https://github.com/my-repo/my-project \
     --artifacts type=NO_ARTIFACTS \
     --environment type=LINUX_CONTAINER,image=aws/codebuild/standard:4.0,computeType=BUILD_GENERAL1_SMALL \
     --service-role arn:aws:iam::123456789012:role/service-role/codebuild-service-role \
     --logsConfig cloudWatchLogs={status=ENABLED,groupName=my-log-group,streamName=my-log-stream}
   ```

   Or, if updating an existing project:

   ```sh
   aws codebuild update-project \
     --name my-codebuild-project \
     --logsConfig cloudWatchLogs={status=ENABLED,groupName=my-log-group,streamName=my-log-stream}
   ```

2. **Verify Logging Configuration:**
   After creating or updating the project, verify that the logging configuration is correctly set by describing the project.

   ```sh
   aws codebuild batch-get-projects --names my-codebuild-project
   ```

   Check the output to ensure that `logsConfig` has `status` set to `ENABLED`.

3. **Ensure IAM Role Permissions:**
   Make sure the IAM role associated with the CodeBuild project has the necessary permissions to write logs to CloudWatch. Attach the `CloudWatchLogsFullAccess` policy or a custom policy with the required permissions.

   ```sh
   aws iam attach-role-policy \
     --role-name codebuild-service-role \
     --policy-arn arn:aws:iam::aws:policy/CloudWatchLogsFullAccess
   ```

4. **Monitor and Audit Logging Configuration:**
   Regularly monitor and audit the logging configuration of your CodeBuild projects to ensure compliance. Use AWS Config rules or CloudFormation templates to enforce logging configurations.

   ```sh
   aws configservice put-config-rule \
     --config-rule file://config-rule.json
   ```

   Example `config-rule.json`:

   ```json
   {
     "ConfigRuleName": "codebuild-logging-enabled",
     "Description": "Ensure that logging is enabled for CodeBuild projects",
     "Scope": {
       "ComplianceResourceTypes": [
         "AWS::CodeBuild::Project"
       ]
     },
     "Source": {
       "Owner": "AWS",
       "SourceIdentifier": "CODEBUILD_PROJECT_LOGGING_ENABLED"
     }
   }
   ```

By following these steps, you can ensure that logging is enabled for your AWS CodeBuild projects using the AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To prevent the misconfiguration of "Logging Should Be Enabled for CodeBuild Project Environment" in AWS CodeBuild using Python scripts, you can use the AWS SDK for Python (Boto3). Here are the steps to ensure logging is enabled for your CodeBuild projects:

1. **Install Boto3**:
   Ensure you have Boto3 installed in your Python environment. You can install it using pip if you haven't already:
   ```bash
   pip install boto3
   ```

2. **Initialize Boto3 Client**:
   Initialize the Boto3 client for CodeBuild. This will allow you to interact with the CodeBuild service.
   ```python
   import boto3

   codebuild_client = boto3.client('codebuild')
   ```

3. **Create or Update CodeBuild Project with Logging Configuration**:
   When creating or updating a CodeBuild project, ensure that the `logsConfig` parameter is set to enable CloudWatch Logs. Here is an example of how to create a new CodeBuild project with logging enabled:
   ```python
   response = codebuild_client.create_project(
       name='MyCodeBuildProject',
       source={
           'type': 'GITHUB',
           'location': 'https://github.com/my-repo/my-project'
       },
       artifacts={
           'type': 'NO_ARTIFACTS'
       },
       environment={
           'type': 'LINUX_CONTAINER',
           'image': 'aws/codebuild/standard:4.0',
           'computeType': 'BUILD_GENERAL1_SMALL'
       },
       serviceRole='arn:aws:iam::123456789012:role/service-role/codebuild-service-role',
       logsConfig={
           'cloudWatchLogs': {
               'status': 'ENABLED',
               'groupName': '/aws/codebuild/MyCodeBuildProject',
               'streamName': 'build-log'
           }
       }
   )
   print(response)
   ```

4. **Verify Logging Configuration**:
   After creating or updating the project, you can verify that the logging configuration is correctly set by describing the project and checking the `logsConfig` attribute.
   ```python
   project_name = 'MyCodeBuildProject'
   response = codebuild_client.batch_get_projects(names=[project_name])
   project = response['projects'][0]

   if project['logsConfig']['cloudWatchLogs']['status'] == 'ENABLED':
       print(f"Logging is enabled for project {project_name}")
   else:
       print(f"Logging is not enabled for project {project_name}")
   ```

By following these steps, you can ensure that logging is enabled for your AWS CodeBuild projects using Python scripts.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console.
2. Navigate to the AWS CodeBuild dashboard. You can do this by typing "CodeBuild" into the search bar and selecting it from the dropdown menu.
3. In the CodeBuild dashboard, you will see a list of your CodeBuild projects. Select the project you want to check.
4. In the project details page, scroll down to the 'Environment' section. Here, you should see a 'CloudWatch logs' field. If logging is enabled, this field will show 'ENABLED'. If it is not, it will show 'DISABLED'.
</Accordion>

<Accordion title='Using CLI'>
1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Make sure you have the necessary permissions to access the CodeBuild project.

2. Once the AWS CLI is set up, you can list all the CodeBuild projects in your AWS account by running the following command:

   ```
   aws codebuild list-projects
   ```

   This command will return a list of all the CodeBuild project names.

3. To get the details of a specific CodeBuild project, you can use the `batch-get-projects` command followed by the name of the project. For example, if your project name is `my-project`, you can run:

   ```
   aws codebuild batch-get-projects --names my-project
   ```

   This command will return a JSON object with all the details of the specified project.

4. To check if logging is enabled for the CodeBuild project, you need to look at the `logsConfig` field in the returned JSON object. If the `cloudWatchLogs` field is set to `ENABLED`, then logging is enabled for the project. If it is set to `DISABLED`, then logging is not enabled.
</Accordion>

<Accordion title='Using Python'>
1. Install the necessary AWS SDK for Python (Boto3) in your environment. Boto3 allows you to directly create, update, and delete AWS services from your Python scripts.

```python
pip install boto3
```

2. Import the necessary libraries and establish a session with AWS using your access keys. 

```python
import boto3

aws_access_key_id = 'YOUR_ACCESS_KEY'
aws_secret_access_key = 'YOUR_SECRET_KEY'
region_name = 'us-west-2' # or your preferred region

session = boto3.Session(
    aws_access_key_id=aws_access_key_id,
    aws_secret_access_key=aws_secret_access_key,
    region_name=region_name
)
```

3. Use the `list_projects` method from the CodeBuild client to get a list of all CodeBuild projects in your account.

```python
codebuild = session.client('codebuild')

response = codebuild.list_projects()

projects = response['projects']
```

4. For each project, use the `batch_get_projects` method to get detailed information about the project, including whether logging is enabled or not. If the `logsConfig` attribute is not present or if `cloudWatchLogs` is set to `DISABLED`, then logging is not enabled for that project.

```python
for project in projects:
    project_details = codebuild.batch_get_projects(names=[project])
    project_info = project_details['projects'][0]
    logs_config = project_info.get('logsConfig', {})
    cloud_watch_logs = logs_config.get('cloudWatchLogs', {})
    if cloud_watch_logs.get('status') != 'ENABLED':
        print(f"Logging is not enabled for project: {project}")
```

This script will print out the names of all CodeBuild projects in your AWS account where logging is not enabled.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of logging not being enabled in an AWS CodeBuild project environment, you can follow these steps using the AWS Management Console:

1. **Sign in to the AWS Management Console**: Go to https://aws.amazon.com/ and sign in to your AWS account.

2. **Navigate to CodeBuild**: In the AWS Management Console, search for "CodeBuild" in the services search bar and click on "CodeBuild" to open the CodeBuild dashboard.

3. **Select the Project**: Locate and select the CodeBuild project for which you want to enable logging.

4. **Edit Project Settings**: Click on the project name to open the project settings.

5. **Enable CloudWatch Logs**: In the project settings, scroll down to the "Logs" section.

6. **Enable CloudWatch Logs**: Toggle the switch to enable CloudWatch Logs for the project. This will ensure that build logs are stored in CloudWatch Logs for future reference and troubleshooting.

7. **Configure Log Group**: You can optionally configure the log group name and stream name for the CloudWatch Logs. If you leave it blank, CodeBuild will create a default log group for the project.

8. **Save Changes**: Click on the "Update Project" button to save the changes and enable logging for the CodeBuild project environment.

9. **Verify Logging**: Trigger a build in the CodeBuild project to verify that logging is now enabled and logs are being sent to CloudWatch Logs.

By following these steps, you will successfully remediate the misconfiguration of logging not being enabled in the AWS CodeBuild project environment.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of logging not being enabled for an AWS CodeBuild project environment, you can follow these steps using the AWS CLI:

Step 1: Get the current settings for the CodeBuild project environment:
```
aws codebuild batch-get-projects --names YOUR_PROJECT_NAME
```

Step 2: Update the CodeBuild project environment to enable logging:
```
aws codebuild update-project --name YOUR_PROJECT_NAME --environment "type=LINUX_CONTAINER,environmentVariables=[{name=CODEBUILD_LOG_CONFIG, value='{\"cloudwatch\": {\"status\":\"ENABLED\"}}'}]"
```

Replace `YOUR_PROJECT_NAME` with the actual name of your CodeBuild project.

Step 3: Verify that the logging configuration has been updated successfully:
```
aws codebuild batch-get-projects --names YOUR_PROJECT_NAME
```

After following these steps, the logging should be enabled for your AWS CodeBuild project environment.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of logging not being enabled for an AWS CodeBuild project environment using Python, you can follow these steps:

Step 1: Import the necessary Python libraries (boto3) to interact with AWS services.

```python
import boto3
```

Step 2: Define the AWS region and the CodeBuild client.

```python
region = 'your_aws_region'
codebuild_client = boto3.client('codebuild', region_name=region)
```

Step 3: Get the current settings of the CodeBuild project environment to check if logging is enabled.

```python
project_name = 'your_codebuild_project_name'

response = codebuild_client.batch_get_projects(names=[project_name])

environment = response['projects'][0]['environment']
```

Step 4: Check if logging is already enabled. If not, update the project environment to enable logging.

```python
if not environment.get('logsConfig'):
    environment['logsConfig'] = {
        'cloudWatchLogs': {
            'status': 'ENABLED'
        }
    }

    codebuild_client.update_project(
        name=project_name,
        environment=environment
    )

    print(f'Logging has been enabled for the CodeBuild project: {project_name}')
else:
    print(f'Logging is already enabled for the CodeBuild project: {project_name}')
```

Step 5: Run the Python script to remediate the misconfiguration by enabling logging for the specified AWS CodeBuild project environment.

Make sure to replace 'your_aws_region' and 'your_codebuild_project_name' with your actual AWS region and CodeBuild project name.

By following these steps and running the Python script, you can successfully remediate the misconfiguration of logging not being enabled for an AWS CodeBuild project environment.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>

