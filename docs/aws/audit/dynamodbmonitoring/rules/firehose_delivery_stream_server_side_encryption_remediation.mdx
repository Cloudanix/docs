

<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and navigate to the Kinesis Firehose dashboard.
2. In the navigation pane, select "Delivery streams".
3. In the list of delivery streams, select the name of the stream that you want to check.
4. In the details pane, under the "Destination" section, check the "Server-side encryption" status. If it's not enabled, then the Firehose Delivery Stream Server-Side Encryption is misconfigured.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   ```
   pip install awscli
   aws configure
   ```

   You will be prompted to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. List all Firehose Delivery Streams: Use the `list-delivery-streams` command to get a list of all Firehose Delivery Streams in your AWS account.

   ```
   aws firehose list-delivery-streams
   ```

   This command will return a list of all the delivery stream names.

3. Describe Delivery Stream: For each delivery stream, use the `describe-delivery-stream` command to get detailed information about the stream.

   ```
   aws firehose describe-delivery-stream --delivery-stream-name <your-delivery-stream-name>
   ```

   Replace `<your-delivery-stream-name>` with the name of your delivery stream.

4. Check Server-Side Encryption: In the output of the `describe-delivery-stream` command, look for the `DeliveryStreamEncryptionConfiguration` field. If the `Status` field under it is `ENABLED`, then Server-Side Encryption is enabled for the delivery stream. If it's not, then Server-Side Encryption is not enabled.

#### Using Python

To check if Firehose Delivery Stream Server-Side Encryption is enabled in DynamoDB using Python scripts, you can use the Boto3 library, which allows you to write software that makes use of services like Amazon S3, Amazon EC2, etc. Here are the steps:

1. **Import the necessary libraries and establish a client:**

```python
import boto3

# Create a low-level service client by name using the default session.
firehose = boto3.client('firehose')
```

2. **List all the delivery streams:**

```python
# This operation lists your delivery streams sorted by the date that they were created.
response = firehose.list_delivery_streams()

delivery_streams = response['DeliveryStreamNames']
```

3. **Describe the delivery stream and check the server-side encryption status:**

```python
for stream in delivery_streams:
    # This operation returns information about a delivery stream.
    response = firehose.describe_delivery_stream(DeliveryStreamName=stream)

    # Check if ServerSideEncryption is enabled
    if 'DeliveryStreamEncryptionConfiguration' in response['DeliveryStreamDescription']:
        encryption_config = response['DeliveryStreamDescription']['DeliveryStreamEncryptionConfiguration']
        if encryption_config['Status'] != 'ENABLED':
            print(f"Firehose Delivery Stream {stream} does not have Server-Side Encryption enabled.")
    else:
        print(f"Firehose Delivery Stream {stream} does not have Server-Side Encryption enabled.")
```

4. **Interpret the results:**

The script will print out the names of the Firehose Delivery Streams that do not have Server-Side Encryption enabled. If no such message is printed, it means that all the Firehose Delivery Streams have Server-Side Encryption enabled.

Please note that you need to have the necessary permissions to list and describe the delivery streams. Also, make sure to handle any exceptions that might occur while running the script.

</Tab>

<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of enabling Firehose Delivery Stream Server-Side Encryption for AWS DynamoDB using the AWS Management Console, follow these step-by-step instructions:

1. **Sign in to the AWS Management Console:**
   - Go to the AWS Management Console (https://aws.amazon.com/console/) and sign in to your AWS account.

2. **Navigate to Amazon Kinesis Data Firehose:**
   - In the AWS Management Console, search for "Kinesis" in the search bar at the top and select "Kinesis" under the Analytics section.

3. **Select the Firehose Delivery Stream:**
   - Click on the "Delivery Streams" option on the left sidebar to view a list of your existing Firehose delivery streams.
   - Select the Firehose delivery stream that is connected to your DynamoDB table and requires server-side encryption.

4. **Enable Server-Side Encryption:**
   - In the selected Firehose delivery stream details page, click on the "Edit" button to modify the settings.
   - Scroll down to the "Server-side encryption" section and select the option for "Enable server-side encryption."
   - Choose the appropriate KMS key from the dropdown menu or create a new KMS key if necessary.

5. **Save Changes:**
   - After enabling server-side encryption and selecting the KMS key, click on the "Save" button to apply the changes to the Firehose delivery stream.

6. **Verify Encryption Configuration:**
   - Once the changes are saved, verify that server-side encryption is enabled for the Firehose delivery stream by checking the settings in the details page.

By following these steps, you will successfully remediate the misconfiguration by enabling Firehose Delivery Stream Server-Side Encryption for AWS DynamoDB using the AWS Management Console.

#### Using CLI

To enable server-side encryption for an AWS Kinesis Data Firehstream using AWS CLI, follow these steps:

1. Open the AWS CLI and run the following command to enable server-side encryption for the Firehose Delivery Stream:

```bash
aws firehose update-delivery-stream \
--delivery-stream-name YOUR_DELIVERY_STREAM_NAME \
--extended-s3-destination-update EncryptionConfiguration.Enabled=true,EncryptionConfiguration.KeyType=AWS_OWNED_CMK
```

Make sure to replace `YOUR_DELIVERY_STREAM_NAME` with the actual name of your Firehose Delivery Stream.

2. Once the command is executed successfully, the server-side encryption will be enabled for the specified Firehose Delivery Stream using the AWS-owned Customer Master Key (CMK).

3. You can verify the changes by describing the delivery stream using the following command:

```bash
aws firehose describe-delivery-stream --delivery-stream-name YOUR_DELIVERY_STREAM_NAME
```

Look for the `EncryptionConfiguration` section in the output to confirm that server-side encryption is enabled.

By following these steps, you can remediate the misconfiguration and enable server-side encryption for an AWS Kinesis Data Firehose Delivery Stream using AWS CLI.

#### Using Python

To remediate the misconfiguration of enabling Firehose Delivery Stream Server-Side Encryption for AWS DynamoDB using Python, follow these steps:

1. Import the necessary libraries:
```python
import boto3
```

2. Initialize the AWS DynamoDB client:
```python
dynamodb = boto3.client('dynamodb')
```

3. Get the list of all the existing DynamoDB tables:
```python
tables = dynamodb.list_tables()
```

4. Iterate through each table and enable server-side encryption for the desired table:
```python
for table_name in tables['TableNames']:
    response = dynamodb.update_table(
        TableName=table_name,
        SSESpecification={
            'Enabled': True,
            'SSEType': 'KMS'
        }
    )
    print(f"Server-side encryption enabled for table: {table_name}")
```

5. Run the Python script to enable server-side encryption for all the DynamoDB tables.

By following these steps, you can remediate the misconfiguration of enabling Firehose Delivery Stream Server-Side Encryption for AWS DynamoDB using Python.


</Tab>
</Tabs>