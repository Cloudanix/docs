---
slug: firehose_delivery_stream_server_side_encryption
title: Enable Firehose Delivery Stream Server-Side Encryption
sidebar_label: Enable Firehose Delivery Stream Server-Side Encryption
---

### More Info:

Ensure that your Amazon Kinesis Data Firehose delivery streams are encrypted using Server-Side Encryption. It is recommended for added security to use KMS Customer-managed Customer Master Keys (CMKs) instead of AWS managed-keys, in order to have full control over the encryption and decryption process and meet regulatory requirements. Amazon Kinesis Data Firehose is a fully managed service designed for real-time streaming data delivery to destinations such as Amazon S3, Amazon Redshift, Amazon ElasticSearch Service, and Splunk.

### Risk Level

High

### Address

Cost optimization, Operational Maturity, Security

### Compliance Standards

CBP

### Remediation

#### Using Console

Sure, here are the step by step instructions to remediate the misconfiguration of enabling Firehose Delivery Stream Server-Side Encryption in AWS:

1. Login to your AWS console and navigate to the Amazon Kinesis Firehose service.

2. Select the Delivery Stream that you want to enable Server-Side Encryption for.

3. Click on the "Edit" button to modify the Delivery Stream configuration.

4. Scroll down to the "Server-side encryption" section and select the "Enable server-side encryption" option.

5. Choose the "AWS KMS managed key" option and select the KMS key that you want to use for encryption.

6. Click on the "Save" button to save the changes.

7. Wait for the Delivery Stream to be updated with the new configuration. This may take a few minutes.

8. Once the Delivery Stream is updated, test it by sending some data to it and verifying that the data is encrypted using the KMS key that you selected.

That's it! You have successfully remediated the misconfiguration of enabling Firehose Delivery Stream Server-Side Encryption in AWS.

#### Using CLI

To remediate the misconfiguration "Enable Firehose Delivery Stream Server-Side Encryption" in AWS using AWS CLI, follow the below steps:

1. Open the AWS CLI on your local machine.
2. Run the following command to enable server-side encryption for an existing Amazon Kinesis Data Firehose delivery stream:

```
aws firehose update-destination --delivery-stream-name <delivery-stream-name> --current-delivery-stream-version-id <delivery-stream-version-id> --destination-id <destination-id> --s3-destination-update '{"EncryptionConfiguration": {"NoEncryptionConfig": "NoEncryption"}}'
```

Note: Replace `<delivery-stream-name>`, `<delivery-stream-version-id>` and `<destination-id>` with the actual values.

3. Once the command is executed, it will return the updated configuration of the delivery stream with the server-side encryption enabled.

By following the above steps, you can remediate the misconfiguration "Enable Firehose Delivery Stream Server-Side Encryption" in AWS using AWS CLI.

#### Using Python

To remediate the misconfiguration "Enable Firehose Delivery Stream Server-Side Encryption" for AWS using Python, you can follow the below steps:

1. First, you need to import the necessary AWS SDKs in Python, such as boto3, which is the AWS SDK for Python.

```
import boto3
```

2. Next, you need to create a Firehose client using the boto3 library.

```
firehose_client = boto3.client('firehose')
```

3. Then, you need to get the delivery stream name for which you want to enable server-side encryption.

```
delivery_stream_name = 'your-delivery-stream-name'
```

4. After that, you need to create an encryption configuration object that includes the encryption key ARN.

```
encryption_config = {
    'NoEncryptionConfig': 'NoEncryption',
    'KMSEncryptionConfig': {
        'AWSKMSKeyARN': 'your-kms-key-arn'
    }
}
```

Note: Replace `your-kms-key-arn` with the actual KMS key ARN that you want to use for server-side encryption.

5. Finally, you need to call the `update_destination` API of the Firehose client and pass the delivery stream name and the encryption configuration object as parameters.

```
response = firehose_client.update_destination(
    DeliveryStreamName=delivery_stream_name,
    ExtendedS3DestinationUpdate={
        'EncryptionConfiguration': encryption_config
    }
)
```

After executing the above code, the specified Firehose delivery stream will be updated to enable server-side encryption using the specified KMS key.

### Additional Reading:

- [https://docs.aws.amazon.com/firehose/latest/dev/encryption.html](https://docs.aws.amazon.com/firehose/latest/dev/encryption.html) 

