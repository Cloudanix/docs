
### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console.
2. Navigate to the DynamoDB service by typing 'DynamoDB' in the search bar and selecting it from the dropdown menu.
3. In the navigation pane on the left, click on 'Tables'.
4. Select the table you want to inspect for encryption settings.
5. In the 'Overview' tab, scroll down to the 'Table details' section. Here, you can see the 'Encryption' field. If it says 'KMS', then the table is encrypted with a KMS key. If it says 'Default', then it is not encrypted with a KMS key.
6. To check which KMS key is being used, click on the 'Key ARN' link next to the 'Encryption' field. This will take you to the KMS console where you can see the details of the key being used for encryption.
</Accordion>

<Accordion title='Using CLI'>
1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Make sure you have the necessary permissions to access the DynamoDB resources.

2. Once the AWS CLI is set up, you can use the `list-tables` command to get a list of all the DynamoDB tables in your account. The command is as follows:

   ```
   aws dynamodb list-tables --region your-region
   ```
   Replace 'your-region' with the region your DynamoDB is located in.

3. After getting the list of tables, you can use the `describe-table` command to get the details of each table. This command will provide you with the information about the KMS key used to encrypt the table. The command is as follows:

   ```
   aws dynamodb describe-table --table-name your-table-name --region your-region
   ```
   Replace 'your-table-name' with the name of your DynamoDB table and 'your-region' with the region your DynamoDB is located in.

4. In the output of the `describe-table` command, look for the `SSEDescription` field. If the `SSEType` is `KMS` and the `KMSMasterKeyArn` is not empty, then the table is encrypted with a KMS Customer Master Key. If the `SSEType` is not `KMS` or the `KMSMasterKeyArn` is empty, then the table is not encrypted with a KMS Customer Master Key.
</Accordion>

<Accordion title='Using Python'>
1. Install and configure AWS SDK for Python (Boto3) on your local system. This will allow you to interact with AWS services including DynamoDB. You can install it using pip:

```python
pip install boto3
```

2. Import the necessary modules and establish a session with AWS using your access keys:

```python
import boto3

session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    region_name='us-west-2'
)
```

3. Create a DynamoDB resource object using the session object. Then, iterate over all the tables in your DynamoDB and check the 'SSEDescription' attribute to determine if the table is encrypted with a KMS Customer Master Key:

```python
dynamodb = session.resource('dynamodb')

for table in dynamodb.tables.all():
    description = table.describe()
    sse_description = description['Table']['SSEDescription']
    if sse_description['SSEType'] == 'KMS' and 'KMSMasterKeyArn' in sse_description:
        print(f"Table {table.name} is encrypted with KMS Customer Master Key: {sse_description['KMSMasterKeyArn']}")
    else:
        print(f"Table {table.name} is not encrypted with a KMS Customer Master Key")
```

4. Run the script. If a table is encrypted with a KMS Customer Master Key, the script will print the table name and the ARN of the key. If a table is not encrypted with a KMS Customer Master Key, the script will simply print the table name.

Please replace 'YOUR_ACCESS_KEY' and 'YOUR_SECRET_KEY' with your actual AWS access key and secret key. Also, replace 'us-west-2' with the AWS region that you're using.
</Accordion>

</AccordionGroup>
</Tab>
<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of Notebook Data Encrypted with KMS Customer Master Keys for AWS DynamoDB using the AWS console, you can follow these step-by-step instructions:

1. **Login to AWS Console**: Go to the AWS Management Console (https://aws.amazon.com/) and log in using your credentials.

2. **Navigate to DynamoDB**: In the AWS Management Console, search for "DynamoDB" in the services search bar and select DynamoDB from the search results.

3. **Select the Table**: From the DynamoDB dashboard, select the table where the notebook data is stored that needs to be encrypted with AWS managed keys.

4. **Enable Encryption**: Click on the "Manage" tab in the table details page and then click on the "Encryption" tab.

5. **Edit Encryption Settings**: Click on the "Edit" button to edit the encryption settings for the DynamoDB table.

6. **Select AWS Managed Key**: In the Encryption settings, select "AWS managed key" as the key provider instead of "KMS Customer Master Key".

7. **Choose AWS Managed CMK**: Choose an AWS managed Customer Master Key (CMK) from the list provided. You can select the default AWS managed CMK or create a new one.

8. **Update Encryption Settings**: After selecting the AWS managed CMK, click on the "Save" button to update the encryption settings for the DynamoDB table.

9. **Monitor Encryption Status**: Once the encryption settings are updated, monitor the status to ensure that the notebook data is now encrypted with the AWS managed key.

By following these steps, you can remediate the misconfiguration of Notebook Data Encrypted with KMS Customer Master Keys for AWS DynamoDB using the AWS console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of Notebook Data Encrypted with KMS Customer Master Keys for AWS DynamoDB using AWS CLI, follow these steps:

Step 1: Identify the DynamoDB table that has the misconfiguration:
```bash
aws dynamodb list-tables
```

Step 2: Update the DynamoDB table to enable encryption with AWS managed keys:
```bash
aws dynamodb update-table \
    --table-name YOUR_TABLE_NAME \
    --sse-specification Enabled=true,SSEType=AES256
```

Step 3: Verify that the encryption has been updated successfully:
```bash
aws dynamodb describe-table \
    --table-name YOUR_TABLE_NAME
```

By following these steps, you can remediate the misconfiguration of Notebook Data Encrypted with KMS Customer Master Keys for AWS DynamoDB using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of notebook data being encrypted with KMS Customer Master Keys in AWS DynamoDB using Python, follow these steps:

1. **Update the DynamoDB Table Encryption**: Configure the DynamoDB table to use AWS managed encryption instead of KMS Customer Master Keys. You can do this by updating the table settings to use the default AWS managed encryption.

2. **Install the AWS SDK for Python (Boto3)**: If you haven't already, install the Boto3 library, which is the AWS SDK for Python. You can install it using pip:

```bash
pip install boto3
```

3. **Update the DynamoDB Table Encryption Settings**: Use the following Python script to update the encryption settings of the DynamoDB table to use the default AWS managed encryption:

```python
import boto3

# Specify the region where your DynamoDB table is located
region = 'your-region'

# Specify the name of the DynamoDB table
table_name = 'your-table-name'

# Create a DynamoDB client
dynamodb = boto3.client('dynamodb', region_name=region)

# Update the table encryption settings to use AWS managed encryption
response = dynamodb.update_table(
    TableName=table_name,
    SSESpecification={
        'Enabled': True,
        'SSEType': 'AES256'
    }
)

print("Table encryption settings updated successfully.")
```

4. **Run the Python Script**: Save the above Python script in a file (e.g., `update_dynamodb_encryption.py`) and run it using the Python interpreter. Make sure to replace `'your-region'` and `'your-table-name'` with the actual values for your DynamoDB table.

```bash
python update_dynamodb_encryption.py
```

5. **Verify the Encryption Settings**: After running the script, verify that the encryption settings for the DynamoDB table have been successfully updated to use the default AWS managed encryption. You can check this in the AWS Management Console or by using the Boto3 library to describe the table.

By following these steps, you can remediate the misconfiguration of notebook data being encrypted with KMS Customer Master Keys in AWS DynamoDB using Python.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
