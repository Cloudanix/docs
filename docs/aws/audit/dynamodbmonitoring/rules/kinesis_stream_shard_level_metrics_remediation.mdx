

<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and open the Amazon Kinesis console at https://console.aws.amazon.com/kinesis.

2. In the navigation pane, choose "Data Streams". This will display a list of all your Kinesis data streams.

3. Click on the name of the Kinesis data stream for which you want to check the shard level metrics. This will open the details page for the selected data stream.

4. In the "Monitoring" tab, you can see the shard level metrics for the selected data stream. The metrics include 'Get Records.Bytes', 'Get Records.Iterator Age', 'Get Records.Latency', 'Get Records.Success', 'Put Record.Bytes', 'Put Record.Latency', 'Put Record.Success', 'Put Records.Bytes', 'Put Records.Latency', and 'Put Records.Success'. 

Note: If you don't see any data, it might be because the monitoring is not enabled or there is no data to display for the selected time range. You can change the time range and refresh the page to check the metrics for a different time period.

#### Using CLI

1. **Install and Configure AWS CLI**: Before you can start using AWS CLI, you need to install it on your local machine. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. **List Streams**: The first step to check Kinesis Stream Shard Level Metrics is to list all the available streams. You can do this by running the following command: `aws kinesis list-streams`. This will return a list of all the stream names.

3. **Describe Stream**: Once you have the name of the stream you want to check, you can describe it to get more information about it. This includes the number of shards in the stream. You can do this by running the following command: `aws kinesis describe-stream --stream-name your_stream_name`. Replace "your_stream_name" with the name of your stream.

4. **Get Shard Iterator**: To get the shard level metrics, you need to get a shard iterator for each shard in the stream. You can do this by running the following command: `aws kinesis get-shard-iterator --stream-name your_stream_name --shard-id your_shard_id --shard-iterator-type TRIM_HORIZON`. Replace "your_stream_name" with the name of your stream and "your_shard_id" with the ID of the shard you want to check.

5. **Get Records**: Once you have the shard iterator, you can use it to get the records from the shard. This will include the metrics for the shard. You can do this by running the following command: `aws kinesis get-records --shard-iterator your_shard_iterator`. Replace "your_shard_iterator" with the shard iterator you got in the previous step.

Please note that these steps will only give you the current metrics for the shard. If you want to monitor these metrics over time, you will need to set up CloudWatch alarms.

#### Using Python

To check Kinesis Stream Shard Level Metrics in DynamoDB using python scripts, you can follow these steps:

1. **Install AWS SDK for Python (Boto3):**
   Boto3 is the Amazon Web Services (AWS) Software Development Kit (SDK) for Python, which allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, etc. You can install it using pip:
   ```
   pip install boto3
   ```
2. **Configure AWS Credentials:**
   Before you can begin using Boto3, you should set up authentication credentials. You can do this by creating a new IAM user in your AWS console and then set your credentials in the AWS credentials file, which is located by default at `~/.aws/credentials`. At a minimum, the credentials file should look like this:
   ```
   [default]
   aws_access_key_id = YOUR_ACCESS_KEY
   aws_secret_access_key = YOUR_SECRET_KEY
   ```
3. **Create a Python Script to Fetch Kinesis Stream Shard Level Metrics:**
   You can use the `boto3` library to interact with AWS services. Here's a simple script to fetch Kinesis Stream Shard Level Metrics:
   ```python
   import boto3

   # Create a Kinesis client
   kinesis = boto3.client('kinesis', region_name='us-west-2')

   # Get the stream description
   response = kinesis.describe_stream(StreamName='your_stream_name')

   # Get the shard Ids
   shard_ids = [shard['ShardId'] for shard in response['StreamDescription']['Shards']]

   # Get the metrics for each shard
   for shard_id in shard_ids:
       response = kinesis.get_shard_iterator(
           StreamName='your_stream_name',
           ShardId=shard_id,
           ShardIteratorType='TRIM_HORIZON'
       )
       shard_iterator = response['ShardIterator']

       response = kinesis.get_records(
           ShardIterator=shard_iterator,
           Limit=100
       )

       print(f"Shard ID: {shard_id}, Records: {len(response['Records'])}")
   ```
   This script will print the number of records in each shard of the specified stream.

4. **Run the Python Script:**
   Save the script in a file, for example `kinesis_metrics.py`, and then run it using Python:
   ```
   python kinesis_metrics.py
   ```
   This will print the number of records in each shard of the specified Kinesis stream.

</Tab>

<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration related to Kinesis Stream Shard Level Metrics in AWS DynamoDB, you can follow these steps using the AWS Management Console:

1. **Login to AWS Console**: Go to the AWS Management Console (https://aws.amazon.com/console/) and login using your credentials.

2. **Navigate to DynamoDB Service**: From the list of AWS services, click on "DynamoDB" to open the DynamoDB dashboard.

3. **Select the Table**: In the DynamoDB dashboard, select the table for which you want to remediate the misconfiguration related to Kinesis Stream Shard Level Metrics.

4. **Edit Table Settings**:
   - Click on the "Overview" tab for the selected table.
   - Scroll down to the "Table details" section and click on the "Manage stream" button.

5. **Update Stream Settings**:
   - In the "Manage stream" dialog box, select the option to enable the stream for the DynamoDB table.
   - Choose the stream view type as "New and old images" or "New images" based on your requirements.
   - Click on the "Create" button to save the changes.

6. **Verify Configuration**:
   - Once the stream is enabled for the DynamoDB table, verify that the Kinesis Stream Shard Level Metrics are now active and functioning properly.

By following these steps, you can successfully remediate the misconfiguration related to Kinesis Stream Shard Level Metrics in AWS DynamoDB using the AWS Management Console.

#### Using CLI

To remediate the misconfiguration related to Kinesis Stream Shard Level Metrics in AWS DynamoDB using AWS CLI, follow these steps:

1. Open your terminal and configure AWS CLI with the necessary credentials by running the following command:
```
aws configure
```
Enter your AWS Access Key ID, Secret Access Key, default region, and default output format as prompted.

2. Enable Kinesis Stream Shard Level Metrics for the DynamoDB table using the AWS CLI by running the following command:
```
aws dynamodb update-continuous-backups --table-name YOUR_TABLE_NAME --point-in-time-recovery-specification PointInTimeRecoveryEnabled=true
```
Replace `YOUR_TABLE_NAME` with the name of your DynamoDB table.

3. Verify that Kinesis Stream Shard Level Metrics have been successfully enabled for the DynamoDB table by running the following command:
```
aws dynamodb describe-continuous-backups --table-name YOUR_TABLE_NAME
```
Replace `YOUR_TABLE_NAME` with the name of your DynamoDB table. Check the output to ensure that `PointInTimeRecoverySpecification` shows `PointInTimeRecoveryEnabled` as `true`.

By following these steps, you can remediate the misconfiguration related to Kinesis Stream Shard Level Metrics in AWS DynamoDB using AWS CLI.

#### Using Python

To remediate the misconfiguration related to Kinesis Stream Shard Level Metrics for AWS DynamoDB using Python, you can follow these steps:

1. **Install boto3**: If you haven't already, install the boto3 library in Python. You can do this using pip by running the following command:
   ```
   pip install boto3
   ```

2. **Update the CloudWatch Metrics Configuration**: Use the following Python script to update the CloudWatch Metrics configuration for the DynamoDB table:

```python
import boto3

def update_dynamodb_cloudwatch_metrics(table_name):
    client = boto3.client('dynamodb')

    response = client.update_continuous_backups(
        TableName=table_name,
        PointInTimeRecoverySpecification={
            'PointInTimeRecoveryEnabled': True
        }
    )

    print(response)

# Replace 'your_table_name' with the name of your DynamoDB table
update_dynamodb_cloudwatch_metrics('your_table_name')
```

3. **Run the Python Script**: Save the above Python script in a file, and run it in your Python environment. This script will enable continuous backups for the specified DynamoDB table, which will ensure that the CloudWatch Metrics for the table are properly configured.

By following these steps, you can remediate the misconfiguration related to Kinesis Stream Shard Level Metrics for AWS DynamoDB using Python.


</Tab>
</Tabs>