

<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to the DynamoDB service by typing 'DynamoDB' in the search bar and selecting it from the dropdown menu.
3. In the navigation pane on the left, click on 'Tables'.
4. Select the table you want to check for encryption. In the 'Overview' tab, scroll down to the 'Table details' section.
5. Look for the 'Encryption' field. If it says 'AWS owned CMK', it means that the table is not using a KMS CMK for encryption. If it says 'AWS managed CMK' or 'Customer managed CMK', it means that the table is using a KMS CMK for encryption.

#### Using CLI

1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Make sure you have the necessary permissions to access the DynamoDB tables and KMS keys.

2. Once AWS CLI is set up, you can list all the DynamoDB tables in your account using the following command:
   ```
   aws dynamodb list-tables --region your-region
   ```
   Replace 'your-region' with the region where your DynamoDB tables are located.

3. For each table, you can describe the table details to check the encryption status. Use the following command:
   ```
   aws dynamodb describe-table --table-name your-table-name --region your-region
   ```
   Replace 'your-table-name' with the name of your DynamoDB table and 'your-region' with the region where your DynamoDB table is located.

4. In the output of the above command, look for the 'SSEDescription' field. If the 'SSEType' is 'KMS' and 'KMSMasterKeyArn' is not 'aws/dynamodb', it means that the table is encrypted with a KMS CMK. If not, it means that the table is not encrypted with a KMS CMK.

#### Using Python

1. Install and configure AWS SDK for Python (Boto3) on your local system. This will allow you to interact with AWS services including DynamoDB. You can install it using pip:

```python
pip install boto3
```

2. Import the necessary modules and create a session using your AWS credentials:

```python
import boto3

session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    region_name='us-west-2'
)
```

3. Create a DynamoDB resource object using the session and get the list of all DynamoDB tables:

```python
dynamodb = session.resource('dynamodb')
tables = dynamodb.list_tables()['TableNames']
```

4. For each table, check the encryption status. If the 'SSEDescription' field is not 'KMS', then the table is not using KMS CMKs for encryption:

```python
for table_name in tables:
    table = dynamodb.Table(table_name)
    if 'SSEDescription' in table and table['SSEDescription']['Status'] != 'ENABLED':
        print(f"Table {table_name} is not using KMS CMKs for encryption.")
```

This script will print out the names of all DynamoDB tables that are not using KMS CMKs for encryption.

</Tab>

<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of AWS DynamoDB tables not using KMS CMKs for encryption, you can follow these steps using the AWS Management Console:

1. **Sign in to the AWS Management Console**: Go to the AWS Management Console and sign in to your account.

2. **Navigate to DynamoDB**: From the services menu, select DynamoDB to access the DynamoDB dashboard.

3. **Select the DynamoDB Table**: Locate the DynamoDB table that you want to remediate and click on its name to open the table details.

4. **Configure Encryption**: In the table details, click on the "Manage" tab and then select the "Encryption" option.

5. **Enable Server-Side Encryption**: In the Encryption settings, select the option to enable server-side encryption.

6. **Choose KMS CMK**: Choose the option to use a KMS key to encrypt the DynamoDB table. You can either select an existing KMS CMK or create a new one.

7. **Save Changes**: Once you have selected the appropriate KMS CMK, save the changes to apply the encryption settings to the DynamoDB table.

8. **Verify Encryption**: After saving the changes, verify that the encryption settings have been successfully applied to the DynamoDB table.

By following these steps, you can remediate the misconfiguration of AWS DynamoDB tables not using KMS CMKs for encryption and ensure that the data in the table is encrypted using a KMS key for improved security.

#### Using CLI

To remediate the misconfiguration of AWS DynamoDB tables not using KMS CMKs for encryption, you can follow these steps using AWS CLI:

1. **List DynamoDB tables without KMS encryption**:
   Run the following command to list all DynamoDB tables that do not use KMS encryption:
   ```
   aws dynamodb list-tables
   ```

2. **Enable encryption with KMS CMK for DynamoDB table**:
   For each DynamoDB table that does not use KMS encryption, you can enable encryption with a KMS CMK by following these steps:
   - Identify the KMS Key ID that you want to use for encryption. You can list the available KMS keys using:
     ```
     aws kms list-keys
     ```
   - Update the DynamoDB table to enable encryption with the chosen KMS key. Replace `TABLE_NAME` and `KMS_KEY_ID` with your actual values:
     ```
     aws dynamodb update-table --table-name TABLE_NAME --sse-specification Enabled=true,KMSMasterKeyId=KMS_KEY_ID
     ```

3. **Verify encryption status**:
   You can verify that encryption with KMS CMK has been enabled for the DynamoDB table by describing the table:
   ```
   aws dynamodb describe-table --table-name TABLE_NAME
   ```

4. **Repeat for other DynamoDB tables**:
   Repeat steps 2 and 3 for each DynamoDB table that does not use KMS encryption.

By following these steps, you can remediate the misconfiguration of AWS DynamoDB tables not using KMS CMKs for encryption.

#### Using Python

To remediate the misconfiguration of AWS DynamoDB tables not using KMS CMKs for encryption, you can follow these steps using Python and the AWS SDK (boto3):

1. Install the AWS SDK for Python (boto3) if you haven't already:
```bash
pip install boto3
```

2. Use the following Python script to update the encryption settings for your DynamoDB tables to use a KMS Customer Master Key (CMK) for encryption:

```python
import boto3

# Initialize the DynamoDB client
dynamodb = boto3.client('dynamodb')

# Get a list of all DynamoDB tables in your account
response = dynamodb.list_tables()
tables = response['TableNames']

# Iterate through each table and update the encryption settings
for table_name in tables:
    try:
        # Update the table to use a KMS CMK for encryption
        response = dynamodb.update_table(
            TableName=table_name,
            SSESpecification={
                'Enabled': True,
                'SSEType': 'KMS',
                'KMSMasterKeyId': 'YOUR_KMS_CMK_ARN'
            }
        )
        print(f"Updated encryption settings for table {table_name}")
    except Exception as e:
        print(f"Error updating encryption settings for table {table_name}: {e}")
```

3. Replace `'YOUR_KMS_CMK_ARN'` with the ARN of the KMS CMK that you want to use for encryption.

4. Run the Python script to update the encryption settings for all DynamoDB tables in your AWS account to use the specified KMS CMK for encryption.

By following these steps, you can remediate the misconfiguration of AWS DynamoDB tables not using KMS CMKs for encryption.


</Tab>
</Tabs>