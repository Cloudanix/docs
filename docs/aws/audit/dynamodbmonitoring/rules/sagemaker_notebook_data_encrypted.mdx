---
slug: sagemaker_notebook_data_encrypted
title: Notebook Data Encrypted
sidebar_label: Notebook Data Encrypted
---

### More Info:

Ensure that the data stored on Machine Learning (ML) storage volumes attached to your AWS SageMaker notebook instances is encrypted in order to meet regulatory requirements and protect your SageMaker data at rest. SageMaker is a fully-managed AWS service that enables developers and data engineers to quickly and easily build, train and deploy machine learning models at any scale. An AWS SageMaker notebook instance is a fully managed ML instance that is running the Jupyter Notebook open-source web application.

### Risk Level

High

### Address

Cost optimization, Operational Maturity, Security

### Compliance Standards

HIPAA, GDPR, CISAWS, CBP, NIST


### Triage and Remediation
<Tabs>


<Tab title='Prevention'>
### How to Prevent
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To prevent unencrypted data in DynamoDB notebooks using the AWS Management Console, follow these steps:

1. **Enable Encryption at Rest:**
   - Navigate to the DynamoDB service in the AWS Management Console.
   - Select the table you want to encrypt.
   - Go to the "Overview" tab and check the "Encryption at rest" section.
   - Ensure that encryption is enabled. If not, create a new table with encryption enabled, as encryption cannot be enabled on an existing table.

2. **Use AWS Key Management Service (KMS):**
   - In the AWS Management Console, go to the KMS service.
   - Create a new Customer Master Key (CMK) if you don't already have one.
   - When creating or configuring your DynamoDB table, select the CMK you created to use for encryption.

3. **IAM Policies and Roles:**
   - Ensure that IAM policies and roles are configured to enforce encryption.
   - Navigate to the IAM service in the AWS Management Console.
   - Attach policies to users, groups, or roles that enforce the use of encrypted tables and restrict access to unencrypted tables.

4. **Enable CloudTrail and Config Rules:**
   - Go to the CloudTrail service in the AWS Management Console.
   - Ensure that CloudTrail is enabled to log all DynamoDB API calls.
   - Navigate to AWS Config and create a rule to check for unencrypted DynamoDB tables.
   - Set up notifications or automated remediation actions if an unencrypted table is detected.

By following these steps, you can ensure that your DynamoDB data is encrypted and secure.
</Accordion>

<Accordion title='Using CLI'>
To prevent misconfigurations related to ensuring that data in DynamoDB is encrypted using the AWS CLI, you can follow these steps:

1. **Create a DynamoDB Table with Encryption Enabled:**
   When creating a new DynamoDB table, you can specify the encryption settings. By default, DynamoDB tables are encrypted at rest using an AWS owned key. However, you can specify a customer-managed key (CMK) if needed.

   ```sh
   aws dynamodb create-table \
       --table-name MyTable \
       --attribute-definitions AttributeName=Id,AttributeType=S \
       --key-schema AttributeName=Id,KeyType=HASH \
       --provisioned-throughput ReadCapacityUnits=5,WriteCapacityUnits=5 \
       --sse-specification Enabled=true,SSEType=KMS,KMSMasterKeyId=alias/my-key
   ```

2. **Enable Encryption on an Existing Table:**
   If you have an existing table and you want to enable encryption, you can update the table to use server-side encryption (SSE) with a customer-managed key.

   ```sh
   aws dynamodb update-table \
       --table-name MyTable \
       --sse-specification Enabled=true,SSEType=KMS,KMSMasterKeyId=alias/my-key
   ```

3. **Verify Encryption Settings:**
   To ensure that your DynamoDB table is encrypted, you can describe the table and check the SSEDescription.

   ```sh
   aws dynamodb describe-table --table-name MyTable
   ```

   Look for the `SSEDescription` in the output to verify that encryption is enabled and using the correct key.

4. **Set Default Encryption for New Tables:**
   While DynamoDB does not have a direct setting to enforce encryption by default for all new tables, you can create an AWS Config rule to ensure that all DynamoDB tables are encrypted. This is more of a monitoring step, but it helps in maintaining compliance.

   ```sh
   aws configservice put-config-rule \
       --config-rule file://dynamodb-encryption-rule.json
   ```

   Example `dynamodb-encryption-rule.json`:
   ```json
   {
       "ConfigRuleName": "dynamodb-encryption-check",
       "Description": "Check whether DynamoDB tables are encrypted",
       "Scope": {
           "ComplianceResourceTypes": [
               "AWS::DynamoDB::Table"
           ]
       },
       "Source": {
           "Owner": "AWS",
           "SourceIdentifier": "DYNAMODB_TABLE_ENCRYPTED"
       }
   }
   ```

By following these steps, you can ensure that your DynamoDB tables are encrypted, thereby preventing misconfigurations related to unencrypted data.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console.
2. Navigate to the DynamoDB service by typing 'DynamoDB' in the search bar and selecting it from the dropdown menu.
3. In the navigation pane on the left, click on 'Tables'.
4. Select the name of the table you want to check for encryption.
5. In the 'Overview' tab, scroll down to the 'Table details' section. Here, you can see the 'Encryption' field. If it says 'Enabled', then the data in the DynamoDB table is encrypted. If it says 'Disabled', then the data is not encrypted.
</Accordion>

<Accordion title='Using CLI'>
1. **Install and Configure AWS CLI**: Before you can start using AWS CLI, you need to install it on your local machine. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your AWS Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. **List all DynamoDB Tables**: Use the AWS CLI command `aws dynamodb list-tables --region your-region-name` to list all the DynamoDB tables in your specified AWS region. Replace 'your-region-name' with the name of your AWS region.

3. **Describe DynamoDB Table**: For each table listed in the previous step, use the AWS CLI command `aws dynamodb describe-table --table-name your-table-name --region your-region-name` to get the details of each table. Replace 'your-table-name' with the name of your DynamoDB table and 'your-region-name' with the name of your AWS region.

4. **Check SSEDescription Status**: In the output of the describe-table command, look for the 'SSEDescription' field. If the 'Status' field under 'SSEDescription' is 'ENABLED', it means that the data at rest in the DynamoDB table is encrypted. If the 'Status' field is not present or is not set to 'ENABLED', it means that the data at rest in the DynamoDB table is not encrypted.
</Accordion>

<Accordion title='Using Python'>
1. Install and configure AWS SDK for Python (Boto3):
   You need to install and configure AWS SDK for Python (Boto3) to interact with AWS services. You can install it using pip:
   ```
   pip install boto3
   ```
   Then, configure your AWS credentials either by setting environment variables `AWS_ACCESS_KEY_ID`, `AWS_SECRET_ACCESS_KEY` and `AWS_SESSION_TOKEN` (optional), or by using the AWS CLI command `aws configure`.

2. Import the necessary libraries and create a DynamoDB resource object:
   You need to import Boto3 and create a DynamoDB resource object to interact with DynamoDB.
   ```python
   import boto3

   dynamodb = boto3.resource('dynamodb')
   ```

3. Get the table description:
   You can get the description of the DynamoDB table, which includes information about the encryption settings, by using the `describe_table` method.
   ```python
   table = dynamodb.Table('your_table_name')
   response = table.meta.client.describe_table(TableName='your_table_name')
   ```

4. Check the encryption status:
   The `SSEDescription` field in the response contains information about the server-side encryption status. You can check if the `Status` field is `ENABLED` and the `SSEType` field is `KMS` to ensure that the data is encrypted.
   ```python
   encryption_status = response['Table']['SSEDescription']['Status']
   encryption_type = response['Table']['SSEDescription']['SSEType']

   if encryption_status == 'ENABLED' and encryption_type == 'KMS':
       print("Data is encrypted.")
   else:
       print("Data is not encrypted.")
   ```
   This script will print "Data is encrypted." if the data in the DynamoDB table is encrypted, and "Data is not encrypted." otherwise.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of "Notebook Data Encrypted" for AWS DynamoDB using the AWS console, follow these step-by-step instructions:

1. **Login to AWS Console**: Go to the AWS Management Console (https://aws.amazon.com/console/) and log in with your credentials.

2. **Navigate to DynamoDB**: From the AWS Management Console, search for "DynamoDB" in the services search bar and click on the DynamoDB service to open it.

3. **Select the Table**: In the DynamoDB dashboard, select the table that contains the notebook data that needs to be encrypted.

4. **Enable Server-Side Encryption**: Click on the "Manage" tab in the table details page, then click on the "Advanced settings" tab.

5. **Enable Encryption**: Scroll down to the "Encryption at rest" section and click on the "Edit" button.

6. **Choose Encryption Type**: In the encryption settings, select the option for "Enable encryption at rest" and choose the encryption type you prefer (e.g., AWS managed CMK or Customer managed CMK).

7. **Save Changes**: After selecting the encryption type, click on the "Save" button to apply the encryption settings to the DynamoDB table.

8. **Monitor Encryption Status**: Once the encryption settings are saved, monitor the DynamoDB table to ensure that the encryption is successfully applied to the notebook data.

By following these steps, you can remediate the misconfiguration of "Notebook Data Encrypted" for AWS DynamoDB using the AWS console and ensure that your data is encrypted at rest for improved security.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of notebook data being encrypted in AWS DynamoDB using AWS CLI, follow these steps:

1. **Enable Encryption at Rest for DynamoDB Tables**:
   - Run the following AWS CLI command to enable encryption at rest for the DynamoDB table:
     ```
     aws dynamodb update-table \
     --table-name YOUR_TABLE_NAME \
     --sse-specification Enabled=true \
     --endpoint-url YOUR_DYNAMODB_ENDPOINT_URL
     ```
   - Replace `YOUR_TABLE_NAME` with the name of your DynamoDB table.
   - Replace `YOUR_DYNAMODB_ENDPOINT_URL` with the endpoint URL of your DynamoDB table.

2. **Verify Encryption at Rest**:
   - To verify that encryption at rest is enabled for the DynamoDB table, describe the table using the following command:
     ```
     aws dynamodb describe-table \
     --table-name YOUR_TABLE_NAME \
     --endpoint-url YOUR_DYNAMODB_ENDPOINT_URL
     ```
   - Ensure that the `SSEDescription` field shows encryption is enabled.

3. **Update IAM Policy** (Optional):
   - If needed, update the IAM policy associated with the DynamoDB table to ensure that only authorized users and services have access to the data.

By following these steps, you can remediate the misconfiguration of notebook data being encrypted in AWS DynamoDB using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of "Notebook Data Encrypted" for AWS DynamoDB using Python, you can follow these steps:

1. Enable Encryption at Rest for DynamoDB Tables:
   - Use the AWS SDK for Python (Boto3) to update the DynamoDB table to enable encryption at rest.
   - Ensure that you have the necessary permissions (e.g., `dynamodb:UpdateTable`) to make changes to the DynamoDB table.

2. Install Boto3:
   - If you haven't already installed the Boto3 library, you can install it using pip:
     ```
     pip install boto3
     ```

3. Update the DynamoDB Table Encryption Configuration:
   - Use the following Python script to update the encryption settings for the DynamoDB table. Replace `table_name` with the name of your DynamoDB table.
   
     ```python
     import boto3

     # Initialize the DynamoDB client
     dynamodb_client = boto3.client('dynamodb')

     # Specify the name of the DynamoDB table to update
     table_name = 'YOUR_TABLE_NAME'

     # Enable encryption at rest for the DynamoDB table
     response = dynamodb_client.update_table(
         TableName=table_name,
         SSESpecification={
             'Enabled': True
         }
     )

     print(f"Encryption at rest enabled for DynamoDB table: {table_name}")
     ```

4. Run the Python Script:
   - Save the above Python script in a file (e.g., `enable_dynamodb_encryption.py`) and run it using the Python interpreter.
     ```
     python enable_dynamodb_encryption.py
     ```

5. Verify Encryption Configuration:
   - After running the script, verify that encryption at rest is enabled for the specified DynamoDB table by checking the table settings in the AWS Management Console or using the AWS CLI.

By following these steps, you can remediate the misconfiguration of "Notebook Data Encrypted" for AWS DynamoDB by enabling encryption at rest for the DynamoDB table using Python and the Boto3 SDK.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/sagemaker/latest/dg/encryption-at-rest.html](https://docs.aws.amazon.com/sagemaker/latest/dg/encryption-at-rest.html) 

