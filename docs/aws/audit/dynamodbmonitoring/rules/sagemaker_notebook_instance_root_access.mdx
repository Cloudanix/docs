---
slug: sagemaker_notebook_instance_root_access
title: Sagemaker Notebook Instance Should Not Have Root Access Enabled
sidebar_label: Sagemaker Notebook Instance Should Not Have Root Access Enabled
---

### More Info:

Ensure Sagemaker notebook instance does not have root access enabled

### Risk Level

High

### Address

Security

### Compliance Standards

CBP


### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console and open the Amazon SageMaker console at https://console.aws.amazon.com/sagemaker/.

2. In the left navigation pane, choose "Notebook instances".

3. In the "Notebook instances" list, choose the name of the notebook instance that you want to check.

4. In the "Permissions and encryption" section, check the "Lifecycle configuration" associated with the notebook instance. If the "Lifecycle configuration" script contains "sudo" commands, it means the notebook instance has root access enabled. 

5. Additionally, you can check the IAM role associated with the notebook instance. In the "Permissions and encryption" section, click on the IAM role ARN. This will redirect you to the IAM console. Check the policies attached to the role. If the policies provide full access to DynamoDB or any other AWS services, it means the notebook instance potentially has root access.
</Accordion>

<Accordion title='Using CLI'>
1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Make sure you have the necessary permissions to access the Sagemaker service.

2. Once the AWS CLI is set up, you can list all the Sagemaker notebook instances using the following command:

   ```
   aws sagemaker list-notebook-instances --region your-region
   ```
   Replace 'your-region' with the region where your instances are located.

3. After listing the notebook instances, you can describe the properties of each instance using the following command:

   ```
   aws sagemaker describe-notebook-instance --notebook-instance-name your-notebook-instance-name --region your-region
   ```
   Replace 'your-notebook-instance-name' with the name of your notebook instance and 'your-region' with the region where your instances are located.

4. In the output of the above command, look for the "DirectInternetAccess" field. If the value of this field is "Enabled", it means that the notebook instance has root access enabled. If the value is "Disabled", it means that root access is not enabled.
</Accordion>

<Accordion title='Using Python'>
To detect if a SageMaker Notebook Instance has root access enabled, you can use the AWS SDK for Python (Boto3). Here are the steps:

1. **Import the necessary libraries and establish a client connection to AWS SageMaker:**

```python
import boto3

sagemaker = boto3.client('sagemaker')
```

2. **List all the SageMaker notebook instances:**

```python
notebook_instances = sagemaker.list_notebook_instances()
```

3. **Iterate over the notebook instances and check the `DirectInternetAccess` attribute:**

```python
for notebook_instance in notebook_instances['NotebookInstances']:
    if notebook_instance['DirectInternetAccess'] == 'Enabled':
        print(f"Notebook Instance {notebook_instance['NotebookInstanceName']} has root access enabled.")
```

4. **Check the Lifecycle configurations for root access:**

```python
for notebook_instance in notebook_instances['NotebookInstances']:
    lifecycle_config_name = notebook_instance.get('LifecycleConfigName')
    if lifecycle_config_name:
        lifecycle_config = sagemaker.describe_notebook_instance_lifecycle_config(
            NotebookInstanceLifecycleConfigName=lifecycle_config_name
        )
        for script in lifecycle_config['OnStart']:
            if 'sudo' in script['Content']:
                print(f"Notebook Instance {notebook_instance['NotebookInstanceName']} has root access enabled in lifecycle configuration.")
```

Please note that the above scripts only detect if the SageMaker Notebook Instances have root access enabled. It does not provide any remediation steps. Also, the scripts assume that you have the necessary permissions to list and describe the SageMaker notebook instances and their lifecycle configurations.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of Sagemaker Notebook Instance having root access enabled in AWS, follow these steps using the AWS console:

1. **Access AWS Sagemaker Console**: Log in to your AWS Management Console and navigate to the Amazon Sagemaker service.

2. **Navigate to Notebook Instances**: In the Amazon Sagemaker console, click on "Notebook instances" from the left-hand menu.

3. **Select the Sagemaker Notebook Instance**: Identify the Notebook Instance that has root access enabled and click on its name to access its details.

4. **Update the IAM Role**: Scroll down to the "Permissions and encryption" section and click on the IAM role link associated with the Notebook Instance.

5. **Edit IAM Role**: In the IAM console, click on "Attach policies" to attach a new policy to the IAM role.

6. **Attach a Policy**: Search for and attach the policy named "AmazonSageMakerFullAccess" to the IAM role. This policy provides full access to Amazon SageMaker resources without granting root access.

7. **Review and Save Changes**: Review the changes and click on "Attach policy" to save the changes.

8. **Verify Root Access**: Go back to the Notebook Instance details page and confirm that root access is no longer enabled for the instance.

By following these steps, you have successfully remediated the misconfiguration of root access being enabled for the Sagemaker Notebook Instance in AWS.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of Sagemaker Notebook Instance having Root Access enabled in AWS, you can follow these steps using AWS CLI:

1. **List the Sagemaker Notebook Instances:**
   Run the following AWS CLI command to list all the Sagemaker Notebook Instances in your AWS account:
   ```
   aws sagemaker list-notebook-instances
   ```

2. **Identify the Notebook Instance with Root Access Enabled:**
   Look for the Notebook Instance that has Root Access enabled in the output of the above command. Note down the `NotebookInstanceName` of the instance.

3. **Update the IAM Role attached to the Notebook Instance:**
   Run the following AWS CLI command to update the IAM role attached to the Notebook Instance to remove Root Access:
   ```
   aws sagemaker update-notebook-instance --notebook-instance-name <NotebookInstanceName> --iam-role-arn <UpdatedIAMRoleARN>
   ```
   Replace `<NotebookInstanceName>` with the actual name of the Notebook Instance and `<UpdatedIAMRoleARN>` with the ARN of the IAM role that does not have Root Access.

4. **Verify the Changes:**
   Run the following AWS CLI command to describe the Notebook Instance and verify that Root Access has been disabled:
   ```
   aws sagemaker describe-notebook-instance --notebook-instance-name <NotebookInstanceName>
   ```
   Ensure that the `RootAccess` parameter is set to `Disabled`.

By following these steps, you can successfully remediate the misconfiguration of Sagemaker Notebook Instance having Root Access enabled in AWS.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of having root access enabled on an AWS SageMaker Notebook Instance, you can follow these steps:

1. **Access the AWS Management Console:**
   Open your web browser and navigate to the AWS Management Console at https://console.aws.amazon.com.

2. **Navigate to SageMaker Service:**
   Click on the "Services" dropdown menu at the top of the page and select "Amazon SageMaker" under the "Machine Learning" category.

3. **Select the Notebook Instance:**
   In the Amazon SageMaker dashboard, click on "Notebook instances" from the left-hand side menu. Select the notebook instance that you want to remediate.

4. **Update the IAM Role:**
   Click on the notebook instance name to view its details. Scroll down to the "Permissions and encryption" section and locate the IAM role attached to the notebook instance.

5. **Modify the IAM Role Policy:**
   Click on the IAM role ARN to navigate to the IAM console. Locate the policy attached to the IAM role that grants root access and edit it.

6. **Revoke Root Access:**
   In the policy document, find the permissions that grant root access and remove or restrict them. Ensure that the IAM role only has the necessary permissions required for the SageMaker Notebook Instance to function properly.

7. **Review and Save Changes:**
   Review the policy changes to ensure that root access is no longer allowed. Once you are satisfied with the modifications, save the policy.

8. **Verify Changes:**
   Go back to the Amazon SageMaker console and refresh the page to ensure that the IAM role updates have been applied to the notebook instance.

By following these steps, you can remediate the misconfiguration of having root access enabled on an AWS SageMaker Notebook Instance and ensure that the instance is securely configured.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>

