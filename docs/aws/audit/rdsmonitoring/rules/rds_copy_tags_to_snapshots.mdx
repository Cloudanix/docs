---
slug: rds_copy_tags_to_snapshots
title: RDS Instances Should Make Use of Copy Tags
sidebar_label: RDS Instances Should Make Use of Copy Tags
---

### More Info:

RDS instances should make use of Copy Tags to Snapshots feature in order to allow tags set on database instances to be automatically copied to any automated or manual RDS snapshots that are created from these instances

### Risk Level

Low

### Address

Cost Optimisation

### Compliance Standards

CBP


### Triage and Remediation
<Tabs>


<Tab title='Prevention'>
### How to Prevent
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To prevent RDS instances from not using the "Copy Tags to Snapshots" feature in AWS using the AWS Management Console, follow these steps:

1. **Navigate to RDS Dashboard:**
   - Open the AWS Management Console.
   - In the Services menu, select "RDS" to go to the Amazon RDS dashboard.

2. **Modify Existing RDS Instance:**
   - In the RDS dashboard, click on "Databases" in the left-hand menu.
   - Select the RDS instance you want to modify.
   - Click on the "Modify" button at the top of the instance details page.

3. **Enable Copy Tags to Snapshots:**
   - Scroll down to the "Additional configuration" section.
   - Find the "Copy Tags to Snapshots" option.
   - Check the box next to "Copy Tags to Snapshots" to enable it.

4. **Apply Changes:**
   - Scroll to the bottom of the page and click the "Continue" button.
   - Review the changes and click the "Modify DB Instance" button to apply the changes.

By following these steps, you ensure that tags associated with your RDS instances are copied to any snapshots created from those instances, which helps in maintaining consistent tagging across your resources.
</Accordion>

<Accordion title='Using CLI'>
To ensure that RDS instances make use of the "Copy Tags to Snapshots" feature using the AWS CLI, follow these steps:

1. **Describe the RDS Instances:**
   First, identify the RDS instances that you want to configure. Use the following command to list all RDS instances:

   ```sh
   aws rds describe-db-instances
   ```

2. **Modify the RDS Instance to Enable Copy Tags to Snapshots:**
   Use the `modify-db-instance` command to enable the "Copy Tags to Snapshots" feature for a specific RDS instance. Replace `<db-instance-identifier>` with your RDS instance identifier.

   ```sh
   aws rds modify-db-instance --db-instance-identifier <db-instance-identifier> --copy-tags-to-snapshot
   ```

3. **Verify the Configuration:**
   After modifying the RDS instance, verify that the "Copy Tags to Snapshots" feature is enabled. Use the `describe-db-instances` command again and check the `CopyTagsToSnapshot` attribute.

   ```sh
   aws rds describe-db-instances --db-instance-identifier <db-instance-identifier> --query 'DBInstances[*].CopyTagsToSnapshot'
   ```

4. **Automate the Configuration for Multiple Instances (Optional):**
   If you have multiple RDS instances, you can automate the configuration using a loop in a shell script. Here is an example:

   ```sh
   for instance in $(aws rds describe-db-instances --query 'DBInstances[*].DBInstanceIdentifier' --output text); do
       aws rds modify-db-instance --db-instance-identifier $instance --copy-tags-to-snapshot
   done
   ```

By following these steps, you can ensure that your RDS instances are configured to copy tags to snapshots, helping you maintain consistent tagging across your resources.
</Accordion>

<Accordion title='Using Python'>
To prevent RDS instances from not using the "Copy Tags to Snapshots" feature in AWS using Python scripts, you can use the Boto3 library, which is the AWS SDK for Python. Here are the steps to ensure that the "Copy Tags to Snapshots" feature is enabled for your RDS instances:

1. **Install Boto3 Library**:
   Ensure you have the Boto3 library installed. If not, you can install it using pip.
   ```bash
   pip install boto3
   ```

2. **Initialize Boto3 Client**:
   Initialize the Boto3 RDS client to interact with the RDS service.
   ```python
   import boto3

   rds_client = boto3.client('rds')
   ```

3. **Describe RDS Instances**:
   Retrieve the list of RDS instances and check if the "Copy Tags to Snapshots" feature is enabled.
   ```python
   def get_rds_instances():
       response = rds_client.describe_db_instances()
       return response['DBInstances']

   rds_instances = get_rds_instances()
   ```

4. **Enable Copy Tags to Snapshots**:
   Iterate through the RDS instances and enable the "Copy Tags to Snapshots" feature if it is not already enabled.
   ```python
   def enable_copy_tags_to_snapshots(db_instance_identifier):
       rds_client.modify_db_instance(
           DBInstanceIdentifier=db_instance_identifier,
           CopyTagsToSnapshot=True
       )

   for instance in rds_instances:
       if not instance['CopyTagsToSnapshot']:
           enable_copy_tags_to_snapshots(instance['DBInstanceIdentifier'])
           print(f"Enabled Copy Tags to Snapshots for {instance['DBInstanceIdentifier']}")
   ```

Here is the complete script:

```python
import boto3

# Initialize Boto3 RDS client
rds_client = boto3.client('rds')

# Function to get all RDS instances
def get_rds_instances():
    response = rds_client.describe_db_instances()
    return response['DBInstances']

# Function to enable Copy Tags to Snapshots for a given RDS instance
def enable_copy_tags_to_snapshots(db_instance_identifier):
    rds_client.modify_db_instance(
        DBInstanceIdentifier=db_instance_identifier,
        CopyTagsToSnapshot=True
    )

# Retrieve RDS instances
rds_instances = get_rds_instances()

# Iterate through instances and enable Copy Tags to Snapshots if not already enabled
for instance in rds_instances:
    if not instance['CopyTagsToSnapshot']:
        enable_copy_tags_to_snapshots(instance['DBInstanceIdentifier'])
        print(f"Enabled Copy Tags to Snapshots for {instance['DBInstanceIdentifier']}")
```

This script will ensure that the "Copy Tags to Snapshots" feature is enabled for all your RDS instances.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console.
2. Navigate to the RDS dashboard by selecting "Services" from the top menu, then selecting "RDS" under the "Database" category.
3. In the navigation pane, click on "Databases". This will display a list of all your RDS instances.
4. For each RDS instance, click on the instance name to open its details page. Under the "Configuration" tab, look for the "Copy tags to snapshots" field. If it is set to "No", then the RDS instance is not making use of copy tags, indicating a misconfiguration.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local system. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your AWS Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all RDS instances: Use the following AWS CLI command to list all your RDS instances:

   ```
   aws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier]' --output text
   ```

   This command will return a list of all your RDS instance identifiers.

3. Check the copy tags to snapshot attribute: For each of the RDS instances, check the `CopyTagsToSnapshot` attribute. This can be done using the following command:

   ```
   aws rds describe-db-instances --db-instance-identifier <your-db-instance-identifier> --query 'DBInstances[*].[CopyTagsToSnapshot]' --output text
   ```

   Replace `<your-db-instance-identifier>` with your actual RDS instance identifier. This command will return the value of the `CopyTagsToSnapshot` attribute for the specified RDS instance.

4. Analyze the output: If the `CopyTagsToSnapshot` attribute is set to `true`, then the RDS instance is correctly configured to copy all tags from the instance to any snapshot that is created. If it is set to `false`, then the RDS instance is misconfigured.
</Accordion>

<Accordion title='Using Python'>
1. Install and configure AWS SDK for Python (Boto3) on your local system. Boto3 allows you to directly create, update, and delete AWS resources from your Python scripts.

```python
pip install boto3
```

2. Import the necessary modules and create an AWS session using your credentials.

```python
import boto3

session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    region_name='YOUR_REGION'
)
```

3. Create a client for 'rds' and retrieve all RDS instances.

```python
rds = session.client('rds')

response = rds.describe_db_instances()
```

4. Iterate over the instances and check if 'CopyTagsToSnapshot' is enabled.

```python
for instance in response['DBInstances']:
    if 'CopyTagsToSnapshot' in instance:
        if instance['CopyTagsToSnapshot'] == False:
            print(f"RDS instance {instance['DBInstanceIdentifier']} does not have CopyTagsToSnapshot enabled.")
```

This script will print out the identifiers of all RDS instances that do not have 'CopyTagsToSnapshot' enabled. This allows you to easily identify which instances are misconfigured.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of RDS instances not making use of Copy Tags in AWS, you can follow these steps using the AWS Management Console:

1. **Sign in to the AWS Management Console**: Go to https://aws.amazon.com/ and sign in to your AWS account.

2. **Navigate to the RDS Console**: Click on the "Services" dropdown menu at the top of the page, select "RDS" under the Database category. This will take you to the Amazon RDS dashboard.

3. **Select the RDS Instance**: From the list of RDS instances, select the instance that you want to enable Copy Tags for by clicking on its identifier.

4. **Enable Copy Tags**: In the RDS instance details page, scroll down to the "Details" section. Under the "Settings" tab, find the "Maintenance" section.

5. **Modify Maintenance Settings**: Click on the "Modify" button to adjust the maintenance settings for the RDS instance.

6. **Enable Copy Tags Option**: In the Modify DB Instance window, scroll down to the "Backup" section. Look for the "Copy Tags to Snapshots" option and check the box next to it to enable this feature.

7. **Save Changes**: Scroll to the bottom of the page and click on the "Continue" button. Review the changes you have made, then click on the "Modify DB Instance" button to save the changes.

8. **Monitor the Modification**: The modification process will start, and you can monitor the progress in the RDS console. Once the modification is complete, the RDS instance will now copy tags to snapshots.

By following these steps, you have successfully remediated the misconfiguration of RDS instances not making use of Copy Tags in AWS.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of RDS instances not making use of Copy Tags in AWS, you can follow these steps using the AWS CLI:

1. **List all RDS instances**:
   Run the following command to list all RDS instances in your AWS account:
   ```bash
   aws rds describe-db-instances
   ```

2. **Enable Copy Tags**:
   For each RDS instance that does not have Copy Tags enabled, you can enable it by modifying the DB instance with the `--copy-tags-to-snapshot` parameter set to `true`. Replace `your-db-instance-identifier` with the actual identifier of the RDS instance.
   ```bash
   aws rds modify-db-instance --db-instance-identifier your-db-instance-identifier --copy-tags-to-snapshot
   ```

3. **Verify Copy Tags**:
   You can verify that Copy Tags are enabled for the RDS instance by describing the DB instance and checking the `CopyTagsToSnapshot` attribute.
   ```bash
   aws rds describe-db-instances --db-instance-identifier your-db-instance-identifier
   ```

4. **Automate for all RDS instances**:
   To automate this process for all RDS instances, you can write a script that iterates through all RDS instances, checks if Copy Tags is enabled, and enables it if not. Here's a sample script:
   ```bash
   #!/bin/bash

   for instance_id in $(aws rds describe-db-instances --query "DBInstances[].DBInstanceIdentifier" --output text); do
       copy_tags=$(aws rds describe-db-instances --db-instance-identifier $instance_id --query "DBInstances[].CopyTagsToSnapshot" --output text)
       if [ "$copy_tags" != "True" ]; then
           aws rds modify-db-instance --db-instance-identifier $instance_id --copy-tags-to-snapshot
           echo "Enabled Copy Tags for RDS instance $instance_id"
       fi
   done
   ```

By following these steps and enabling Copy Tags for all RDS instances in your AWS account, you can remediate the misconfiguration and ensure that tags are copied to RDS snapshots.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of RDS instances not making use of Copy Tags in AWS using Python, you can use the AWS SDK for Python (Boto3). Follow the steps below:

1. Install Boto3:
   If you do not have Boto3 installed, you can install it using pip:
   ```
   pip install boto3
   ```

2. Write a Python script to enable the Copy Tags feature for your RDS instances. Here's an example script:

```python
import boto3

# Initialize the RDS client
rds_client = boto3.client('rds')

# Get a list of all RDS instances
response = rds_client.describe_db_instances()

# Loop through each RDS instance and modify the CopyTagsToSnapshot attribute
for db_instance in response['DBInstances']:
    db_instance_identifier = db_instance['DBInstanceIdentifier']
    
    # Enable CopyTagsToSnapshot attribute
    rds_client.modify_db_instance(
        DBInstanceIdentifier=db_instance_identifier,
        CopyTagsToSnapshot=True
    )
    
    print(f"Enabled CopyTagsToSnapshot for RDS instance: {db_instance_identifier}")
```

3. Run the Python script:
   Save the script in a file (e.g., enable_copy_tags.py) and run it using the following command:
   ```
   python enable_copy_tags.py
   ```

4. Verify the changes:
   You can verify that the Copy Tags feature has been enabled for your RDS instances by checking the AWS Management Console or by running describe-db-instances API call.

By following these steps, you can remediate the misconfiguration of RDS instances not making use of Copy Tags in AWS using Python and ensure that tags are copied to RDS snapshots.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Tagging.html](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Tagging.html) 

