---
slug: docdb_cluster_audit_logging_enabled
title: DocDB Cluster Audit Logging Should Be Enabled
sidebar_label: DocDB Cluster Audit Logging Should Be Enabled
---
### More Info:

Ensure  doc db cluster has audit logging enabled

### Risk Level

Low

### Address

Monitoring

### Compliance Standards

CBP,GDPR,HIPAA,ISO27001,SEBI

### Triage and Remediation
<Tabs>


<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console.
2. Navigate to RDS Dashboard: On the AWS Management Console, click on "Services" at the top of the page. In the drop-down menu, click on "RDS" under the "Database" section.
3. Select Databases: On the RDS Dashboard, click on "Databases" on the left-hand side menu. This will display a list of all your RDS instances.
4. Check DocDB Cluster Audit Logging: Select the DocDB Cluster you want to check. In the details section, look for the "Log exports" field. If the "Audit logs" option is not listed, then the Audit Logging is not enabled for that DocDB Cluster.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can run any AWS CLI commands, you need to install and configure the AWS CLI on your local machine. You can do this by following the instructions provided in the AWS CLI User Guide.

2. List all DocDB clusters: Use the `describe-db-clusters` command to list all of your Amazon DocumentDB clusters. The command syntax is as follows:

   ```
   aws docdb describe-db-clusters --region your-region-name
   ```

   Replace "your-region-name" with the name of the AWS region where your clusters are located. This command will return a JSON output with information about all of your clusters.

3. Check for audit logging: For each cluster, check the `EnabledCloudwatchLogsExports` field in the JSON output. If the value of this field is `audit`, then audit logging is enabled for that cluster. If the field is not present or the value is not `audit`, then audit logging is not enabled.

4. Repeat the process: Repeat steps 2 and 3 for each AWS region where you have DocDB clusters. This will ensure that you check all of your clusters for audit logging.

Remember, enabling audit logging for your DocDB clusters can help you track and analyze activity in your clusters for security and operational purposes.
</Accordion>

<Accordion title='Using Python'>
To check if DocDB Cluster Audit Logging is enabled in RDS using Python scripts, you can use the Boto3 library, which allows you to directly interact with AWS services, including RDS. Here are the steps:

1. **Import the necessary libraries and establish a session with AWS:**

    ```python
    import boto3
    session = boto3.Session(
        aws_access_key_id='YOUR_ACCESS_KEY',
        aws_secret_access_key='YOUR_SECRET_KEY',
        region_name='us-west-2'
    )
    ```

    Replace `'YOUR_ACCESS_KEY'` and `'YOUR_SECRET_KEY'` with your actual AWS access key and secret key. The `region_name` should be set to the region where your RDS instances are located.

2. **Create an RDS client:**

    ```python
    rds = session.client('rds')
    ```

3. **Retrieve a list of all DocDB clusters:**

    ```python
    clusters = rds.describe_db_clusters()['DBClusters']
    ```

4. **Check if audit logging is enabled for each cluster:**

    ```python
    for cluster in clusters:
        if 'EnabledCloudwatchLogsExports' in cluster:
            if 'audit' in cluster['EnabledCloudwatchLogsExports']:
                print(f"Audit logging is enabled for cluster {cluster['DBClusterIdentifier']}")
            else:
                print(f"Audit logging is NOT enabled for cluster {cluster['DBClusterIdentifier']}")
        else:
            print(f"Audit logging is NOT enabled for cluster {cluster['DBClusterIdentifier']}")
    ```

    This script will print out whether audit logging is enabled for each DocDB cluster. If the 'EnabledCloudwatchLogsExports' field exists for a cluster and contains 'audit', then audit logging is enabled. Otherwise, it is not.

Please note that you need to have the necessary permissions to perform these actions, and you should handle any exceptions that may occur.
</Accordion>
</AccordionGroup>
</Tab>
<Tab title='Remediation'>
### Remediation
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the DocDB Cluster Audit Logging misconfiguration for AWS RDS using the AWS console, follow these step-by-step instructions:

1. **Sign in to the AWS Management Console**: Go to https://aws.amazon.com/ and sign in to the AWS Management Console using your credentials.

2. **Navigate to Amazon RDS Console**: Once you are logged in, navigate to the Amazon RDS console by clicking on the "Services" dropdown menu at the top of the page and selecting "RDS" under the "Database" category.

3. **Select the Amazon DocumentDB Cluster**: In the Amazon RDS console, locate and select the Amazon DocumentDB cluster for which you want to enable audit logging.

4. **Enable Audit Logging**: 
   - In the cluster details page, click on the "Modify" button in the upper right corner.
   - Scroll down to the "Database options" section.
   - Under the "Audit log configuration" section, select "Enable" for the "Audit log" option.
   - Choose the desired settings for the audit log, such as the S3 bucket where the logs will be stored, the IAM role that has permission to write to the bucket, and the KMS key for encryption (if needed).
   - Click on the "Continue" button.

5. **Apply Changes**: Review the changes you have made in the "Summary of modifications" section. If everything looks correct, click on the "Modify cluster" button to apply the changes.

6. **Monitor Audit Logging Status**: Once the modifications are applied, monitor the status of the audit logging configuration in the Amazon DocumentDB cluster details page. The status should change to "applying" and then "active" once the audit logging is successfully enabled.

By following these steps, you will remediate the misconfiguration by enabling audit logging for your Amazon DocumentDB cluster in AWS RDS using the AWS console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of DocDB Cluster Audit Logging not being enabled for AWS RDS using AWS CLI, follow these steps:

1. **Enable Logging for the Amazon DocumentDB Cluster**:
   
   Run the following AWS CLI command to enable audit logging for your Amazon DocumentDB cluster. Replace `cluster-identifier` with the actual identifier of your DocumentDB cluster.
   
   ```bash
   aws docdb modify-db-cluster --db-cluster-identifier <cluster-identifier> --enable-cloudwatch-logs-exports '["audit"]'
   ```

2. **Verify the Audit Logging Configuration**:

   Run the following command to verify that the audit logging configuration has been successfully updated for your DocumentDB cluster.
   
   ```bash
   aws docdb describe-db-clusters --db-cluster-identifier <cluster-identifier> --query 'DBClusters[0].EnabledCloudwatchLogsExports'
   ```

   This command should return an array with the value `[ "audit" ]`, indicating that audit logging has been enabled.

3. **Monitor the CloudWatch Logs**:

   Once the audit logging is enabled, you can monitor the logs in CloudWatch Logs to ensure that all the database activities are being logged appropriately.

By following these steps, you can remediate the misconfiguration of DocDB Cluster Audit Logging not being enabled for AWS RDS using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of DocDB Cluster Audit Logging not being enabled for AWS RDS using Python, you can follow these steps:

1. Import the necessary Python libraries, such as `boto3`, which is the AWS SDK for Python.

```python
import boto3
```

2. Initialize the AWS RDS client using the `boto3.client` method.

```python
rds_client = boto3.client('rds')
```

3. Identify the DocDB Cluster for which you want to enable audit logging. You can do this by specifying the `DBClusterIdentifier` of the DocDB Cluster.

```python
docdb_cluster_identifier = 'your-docdb-cluster-identifier'
```

4. Enable audit logging for the DocDB Cluster by calling the `modify_db_cluster` method of the RDS client with the `EnableCloudwatchLogsExports` parameter set to include `'audit'`.

```python
response = rds_client.modify_db_cluster(
    DBClusterIdentifier=docdb_cluster_identifier,
    EnableCloudwatchLogsExports=[
        'audit'
    ]
)
```

5. Verify that the audit logging has been enabled successfully by checking the response from the `modify_db_cluster` API call.

```python
print(response)
```

By following these steps and running the Python script, you can remediate the misconfiguration of DocDB Cluster Audit Logging not being enabled for AWS RDS.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>

