---
slug: rds_iam_db_authentication
title: IAM DB authentication Should Be Enabled
sidebar_label: IAM DB authentication Should Be Enabled
---

### More Info:

IAM Database Authentication feature should be enabled in order to use AWS Identity and Access Management (IAM) service to manage database access to your Amazon RDS MySQL and PostgreSQL instances

### Risk Level

Medium

### Address

Security

### Compliance Standards

SOC2, HITRUST, NISTCSF, PCIDSS


### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console and open the Amazon RDS console at https://console.aws.amazon.com/rds/.

2. In the navigation pane, choose "Databases".

3. Choose the name of the DB instance that you want to check.

4. In the "Details" section, look for the "IAM DB Authentication" field. If the value is "Disabled", then the IAM DB authentication is not enabled for the selected Amazon RDS database. If the value is "Enabled", then the IAM DB authentication is enabled.
</Accordion>

<Accordion title='Using CLI'>
1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Make sure you have the necessary permissions to access the RDS instances.

2. Once the AWS CLI is installed and configured, you can list all the RDS instances in your account by running the following command:

   ```
   aws rds describe-db-instances
   ```

   This command will return a JSON object with all the RDS instances.

3. To check if IAM DB authentication is enabled for a specific RDS instance, you can use the following command:

   ```
   aws rds describe-db-instances --db-instance-identifier <your-db-instance-identifier>
   ```

   Replace `<your-db-instance-identifier>` with the identifier of your RDS instance. This command will return a JSON object with the details of the specified RDS instance.

4. In the returned JSON object, look for the `IAMDatabaseAuthenticationEnabled` field. If this field is set to `true`, then IAM DB authentication is enabled for the RDS instance. If it is set to `false` or if the field is not present, then IAM DB authentication is not enabled.
</Accordion>

<Accordion title='Using Python'>
To check if IAM DB authentication is enabled in RDS using Python scripts, you can use the Boto3 library, which allows you to directly interact with AWS services, including RDS. Here are the steps:

1. **Import the Boto3 library in Python:**
   Boto3 is the Amazon Web Services (AWS) Software Development Kit (SDK) for Python, which allows Python developers to write software that makes use of AWS services like Amazon S3, Amazon EC2, etc. If you haven't installed it yet, you can do so using pip:
   ```python
   pip install boto3
   ```

2. **Set up AWS Credentials and Region for Boto3:**
   You need to set up your AWS credentials and the AWS region to use. You can do this in several ways, but the simplest is to use the AWS CLI and configure it with your credentials:
   ```bash
   aws configure
   ```

3. **Create a Python script to interact with RDS:**
   Use the Boto3 library to create a client for AWS RDS. Then, use the `describe_db_instances` method to get a list of all DB instances. For each instance, check the `IAMDatabaseAuthenticationEnabled` attribute. If it's `False`, then IAM DB authentication is not enabled.

   Here is a sample Python script:
   ```python
   import boto3

   def check_iam_db_auth():
       client = boto3.client('rds')
       response = client.describe_db_instances()
       for instance in response['DBInstances']:
           if not instance['IAMDatabaseAuthenticationEnabled']:
               print(f"IAM DB Authentication is not enabled for {instance['DBInstanceIdentifier']}")

   check_iam_db_auth()
   ```
   This script will print out the identifiers of all RDS instances where IAM DB authentication is not enabled.

4. **Run the Python script:**
   Save the script and run it using your Python interpreter. The script will print out the identifiers of all RDS instances where IAM DB authentication is not enabled. If no output is produced, then IAM DB authentication is enabled for all RDS instances.

Remember to replace the AWS credentials and region with your own. Also, ensure that the AWS account has the necessary permissions to access RDS instances.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of IAM DB authentication not being enabled for AWS RDS using the AWS console, follow these steps:

1. **Login to AWS Console**: Go to the AWS Management Console and login with your credentials.

2. **Navigate to RDS Service**: From the console dashboard, navigate to the RDS service by clicking on the "Services" dropdown and selecting "RDS" under the Database category.

3. **Select the RDS Instance**: In the RDS dashboard, select the RDS instance for which you want to enable IAM DB authentication.

4. **Modify the Instance**: Click on the instance name to open the instance details. Then, click on the "Modify" button to make changes to the instance settings.

5. **Enable IAM DB Authentication**: Scroll down to the "Additional configuration" section in the Modify DB Instance page. Look for the "IAM DB authentication" option and set it to "Enable" by checking the box next to it.

6. **Apply the Changes**: Scroll to the bottom of the page and click on the "Continue" button to proceed with modifying the instance.

7. **Review and Apply Changes**: Review the changes you are about to make and click on the "Modify DB Instance" button to apply the changes.

8. **Verify IAM DB Authentication**: Once the modification is complete, go back to the RDS instance details page and verify that IAM DB authentication is now enabled for the instance.

By following these steps, you have successfully remediated the misconfiguration of IAM DB authentication not being enabled for the AWS RDS instance using the AWS console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of IAM DB authentication not being enabled for an AWS RDS instance using the AWS CLI, follow these steps:

1. **Enable IAM DB Authentication using the AWS CLI:**

```bash
aws rds modify-db-instance \
    --db-instance-identifier <your-db-instance-identifier> \
    --enable-iam-database-authentication
```

Replace `<your-db-instance-identifier>` with the identifier of your RDS instance.

2. **Check the status of IAM DB Authentication:**

```bash
aws rds describe-db-instances \
    --db-instance-identifier <your-db-instance-identifier> \
    --query 'DBInstances[0].[IAMDatabaseAuthenticationEnabled]'
```

This command will return `true` if IAM DB Authentication is successfully enabled.

3. **Verify IAM DB Authentication in AWS Management Console:**
   
   - Go to the AWS Management Console and navigate to the RDS service.
   - Select your RDS instance.
   - In the "Configuration" section, verify that IAM DB Authentication is enabled.

By following these steps, you can successfully remediate the misconfiguration of IAM DB authentication not being enabled for an AWS RDS instance using the AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To enable IAM DB authentication for an AWS RDS instance using Python, you can use the AWS SDK for Python (Boto3). Follow these steps to remediate the misconfiguration:

1. Install Boto3:
```bash
pip install boto3
```

2. Create a Python script with the following code:

```python
import boto3

# Specify the region where your RDS instance is located
region = 'us-east-1'

# Specify the identifier of your RDS instance
db_instance_identifier = 'your-db-instance-identifier'

# Create an RDS client
client = boto3.client('rds', region_name=region)

# Enable IAM DB authentication for the specified RDS instance
response = client.modify_db_instance(
    DBInstanceIdentifier=db_instance_identifier,
    EnableIAMDatabaseAuthentication=True
)

print(f"IAM DB authentication enabled for RDS instance {db_instance_identifier}")
```

3. Replace `'us-east-1'` with the appropriate region where your RDS instance is located and `'your-db-instance-identifier'` with the actual identifier of your RDS instance.

4. Run the Python script. This will enable IAM DB authentication for the specified RDS instance.

After executing the script, IAM DB authentication should be successfully enabled for your AWS RDS instance.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.Enabling.html](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.Enabling.html) 

