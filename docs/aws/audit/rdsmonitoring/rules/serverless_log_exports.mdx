---
slug: serverless_log_exports
title: Serverless Log Exports Should Be Enabled
sidebar_label: Serverless Log Exports Should Be Enabled
---

### More Info:

Aurora Serverless databases should have Log Exports feature enabled in order to publish general logs, slow query logs, audit logs and error logs to AWS CloudWatch.

### Risk Level

Low

### Address

Operational Maturity, Reliability, Security

### Compliance Standards

SOC2, NISTCSF, PCIDSS



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to the RDS dashboard by selecting "Services" from the top menu, then selecting "RDS" under the "Database" category.
3. In the navigation pane on the left, click on "Databases".
4. Select the RDS instance that you want to check.
5. In the details pane, under the "Configuration" tab, look for the "Log exports" section. If the "Log exports" section is not present or does not list the necessary logs (such as "audit" or "error"), then Serverless Log Exports are not enabled for that RDS instance.

#### Using CLI

1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Make sure you have the necessary permissions to access the RDS instances.

2. Once the AWS CLI is set up, you can list all the RDS instances in your account by running the following command:

   ```
   aws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier]' --output text
   ```
   This command will return a list of all RDS instance identifiers.

3. For each RDS instance, you can check if the log exports are enabled by running the following command:

   ```
   aws rds describe-db-instances --db-instance-identifier <DBInstanceIdentifier> --query 'DBInstances[*].[EnabledCloudwatchLogsExports]' --output text
   ```
   Replace `<DBInstanceIdentifier>` with the identifier of the RDS instance you want to check. This command will return a list of log types that are being exported to CloudWatch Logs.

4. If the output of the above command is empty, it means that no log exports are enabled for the RDS instance. If the output includes "audit" or "error", it means that the respective logs are being exported.

#### Using Python

To check if Serverless Log Exports are enabled in RDS using Python scripts, you can use the Boto3 library, which allows you to write software that makes use of services like Amazon S3, Amazon EC2, etc. Here are the steps:

1. **Import the necessary libraries**: You need to import Boto3, the AWS SDK for Python, to interact with AWS services.

    ```python
    import boto3
    ```

2. **Create a session and client for RDS**: You need to create a session using your AWS credentials and then create a client for RDS.

    ```python
    session = boto3.Session(
        aws_access_key_id='YOUR_ACCESS_KEY',
        aws_secret_access_key='YOUR_SECRET_KEY',
        region_name='us-west-2'
    )
    rds = session.client('rds')
    ```

3. **List all RDS instances**: You can list all RDS instances using the `describe_db_instances` method.

    ```python
    response = rds.describe_db_instances()
    ```

4. **Check if Serverless Log Exports are enabled**: For each RDS instance, check if the `EnabledCloudwatchLogsExports` attribute is present and contains the necessary log types (for example, 'audit', 'error', 'general', 'slowquery').

    ```python
    for instance in response['DBInstances']:
        if 'EnabledCloudwatchLogsExports' not in instance or not set(['audit', 'error', 'general', 'slowquery']).issubset(set(instance['EnabledCloudwatchLogsExports'])):
            print(f"Serverless Log Exports are not fully enabled for RDS instance: {instance['DBInstanceIdentifier']}")
    ```

This script will print out the identifiers of all RDS instances where Serverless Log Exports are not fully enabled. You can modify it according to your needs.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of enabling serverless log exports for AWS RDS using the AWS console, follow these step-by-step instructions:

1. **Login to AWS Console**: Go to the AWS Management Console (https://aws.amazon.com/console/) and login with your credentials.

2. **Navigate to RDS Service**: Click on the "Services" dropdown menu at the top of the page, and select "RDS" under the Database category.

3. **Select the RDS Instance**: From the list of RDS instances, select the instance for which you want to enable serverless log exports by clicking on its name.

4. **Modify the RDS Instance**: In the RDS instance details page, click on the "Modify" button located at the top right corner.

5. **Enable Enhanced Monitoring**: In the Modify DB Instance window, scroll down to the "Monitoring" section.

6. **Enable Log Exports**: Under the "Monitoring" section, you will find an option for "Enhanced Monitoring". Enable the "Enhanced Monitoring" option.

7. **Configure Log Exports**: Once you have enabled Enhanced Monitoring, you will see additional options for configuring log exports. Configure the settings according to your requirements, such as the log types to export and the destination for the logs.

8. **Save Changes**: After configuring the log export settings, scroll down to the bottom of the page and click on the "Continue" button.

9. **Apply Changes**: Review the changes you have made, and then click on the "Modify DB Instance" button to apply the changes to the RDS instance.

10. **Verify Configuration**: Once the modification is complete, verify that serverless log exports have been successfully enabled for the RDS instance by checking the logs in the specified destination.

By following these steps, you can successfully remediate the misconfiguration of enabling serverless log exports for an AWS RDS instance using the AWS console.

#### Using CLI

To remediate the misconfiguration of Serverless Log Exports not being enabled for an AWS RDS instance using AWS CLI, follow these steps:

1. **Identify the RDS instance**: First, you need to identify the RDS instance for which you want to enable Serverless Log Exports. You can do this by running the following AWS CLI command:
   
   ```bash
   aws rds describe-db-instances --db-instance-identifier YOUR_DB_INSTANCE_IDENTIFIER
   ```

2. **Enable Serverless Log Exports**: Once you have identified the RDS instance, you can enable Serverless Log Exports by running the following AWS CLI command:

   ```bash
   aws rds modify-db-instance --db-instance-identifier YOUR_DB_INSTANCE_IDENTIFIER --enable-log-exports --cloudwatch-logs-export-configuration '{ "EnableLogTypes": ["trace", "audit", "error", "general", "slowquery"] }'
   ```

   Replace `YOUR_DB_INSTANCE_IDENTIFIER` with the actual identifier of your RDS instance.

3. **Verify the Configuration**: You can verify that Serverless Log Exports have been enabled successfully by running the `describe-db-instances` command again and checking the `EnabledCloudwatchLogsExports` attribute in the output.

By following these steps, you can remediate the misconfiguration of Serverless Log Exports not being enabled for an AWS RDS instance using AWS CLI.

#### Using Python

To enable serverless log exports for an AWS RDS instance using Python, you can use the AWS SDK for Python (Boto3) to interact with the AWS RDS service. Below are the step-by-step instructions to remediate this misconfiguration:

1. Install Boto3:
   Make sure you have Boto3 installed. You can install it using pip:
   ```
   pip install boto3
   ```

2. Configure AWS Credentials:
   Ensure that you have your AWS credentials configured either by setting environment variables or using the AWS CLI `aws configure` command.

3. Write Python script:
   Create a Python script with the following code snippet to enable serverless log exports for the RDS instance:

   ```python
   import boto3

   # Initialize the RDS client
   rds_client = boto3.client('rds')

   # Specify the RDS instance identifier
   db_instance_identifier = 'YOUR_RDS_INSTANCE_IDENTIFIER'

   # Enable serverless log exports for the RDS instance
   response = rds_client.modify_db_instance(
       DBInstanceIdentifier=db_instance_identifier,
       EnableLogExports=[
           'error',  # You can specify other log types like 'general', 'slowquery', etc.
       ]
   )

   print('Serverless log exports enabled for RDS instance:', db_instance_identifier)
   ```

   Replace `'YOUR_RDS_INSTANCE_IDENTIFIER'` with the actual identifier of your RDS instance.

4. Run the Python script:
   Execute the Python script that you created in the previous step. This script will enable serverless log exports for the specified RDS instance.

By following these steps, you can remediate the misconfiguration of not having serverless log exports enabled for an AWS RDS instance using Python and Boto3.

### Additional Reading:

- [https://aws.amazon.com/about-aws/whats-new/2019/02/amazon-aurora-serverless-publishes-logs-to-amazon-cloudwatch/](https://aws.amazon.com/about-aws/whats-new/2019/02/amazon-aurora-serverless-publishes-logs-to-amazon-cloudwatch/) 


</Tab>
</Tabs>