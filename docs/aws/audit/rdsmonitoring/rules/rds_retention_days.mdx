---
slug: rds_retention_days
title: Backup Retention Duration Should Be Present
sidebar_label: Backup Retention Duration Should Be Present
---

### More Info:

As an organization you should have a backup policy with atleast minimum 7 days.

### Risk Level

Medium

### Address

Operational Maturity, Reliability, Security

### Compliance Standards

GDPR


### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Log in to the AWS Management Console and navigate to the RDS dashboard.
2. In the navigation pane, choose "Databases". This will display a list of all your RDS instances.
3. Select the RDS instance you want to check for backup retention duration. 
4. In the details section, look for the "Backup" section. Here, you can see the "Backup Retention Period" setting. If the value is set to 0, it means that the backup retention duration is not present.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can run any AWS CLI commands, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   Installation:
   ```
   pip install awscli
   ```
   Configuration:
   ```
   aws configure
   ```
   You will be prompted to enter your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. List all RDS instances: Use the following AWS CLI command to list all the RDS instances in your AWS account:

   ```
   aws rds describe-db-instances
   ```
   This command will return a JSON output with the details of all your RDS instances.

3. Extract the backup retention period: You can extract the backup retention period of each RDS instance from the JSON output using the 'BackupRetentionPeriod' field. You can do this using a tool like 'jq' or a scripting language like Python.

   For example, using 'jq':
   ```
   aws rds describe-db-instances | jq '.DBInstances[].BackupRetentionPeriod'
   ```
   This command will return the backup retention period of each RDS instance.

4. Check the backup retention period: Now, you can check if the backup retention period of each RDS instance is present or not. If the 'BackupRetentionPeriod' field is null or not present for any RDS instance, it means that the backup retention duration is not set for that instance.
</Accordion>

<Accordion title='Using Python'>
1. Import the necessary libraries: You will need the boto3 library, which allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, etc.

```python
import boto3
```

2. Create a session using your AWS credentials. You can also use the AWS CLI's default configuration.

```python
session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    region_name='us-west-2'
)
```

3. Create a client for 'rds' which is used for Amazon RDS.

```python
rds = session.client('rds')
```

4. Now, you can use the `describe_db_instances` method to get a list of all DB instances. Then, iterate over each instance and check the `BackupRetentionPeriod` attribute. If it's 0, then the backup retention is not enabled.

```python
def check_backup_retention():
    instances = rds.describe_db_instances()
    for instance in instances['DBInstances']:
        if instance['BackupRetentionPeriod'] == 0:
            print(f"Backup retention is not enabled for instance {instance['DBInstanceIdentifier']}")
```

This script will print out the identifiers of all instances where backup retention is not enabled. You can modify it to suit your needs, for example by raising an exception or sending an alert.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the backup retention duration misconfiguration for an AWS RDS instance using the AWS Management Console, follow these steps:

1. **Sign in to the AWS Management Console:**
   - Go to https://aws.amazon.com/ and sign in to the AWS Management Console using your credentials.

2. **Navigate to the RDS Console:**
   - In the AWS Management Console, navigate to the Amazon RDS console by clicking on "Services" at the top of the page and then selecting "RDS" under the Database section.

3. **Select the RDS Instance:**
   - From the list of RDS instances, select the instance for which you want to set the backup retention duration.

4. **Modify the Backup Retention Period:**
   - Click on the instance name to open its details page.
   - In the navigation pane on the left, click on "Modify".
   - Scroll down to the "Backup" section.
   - Locate the "Backup retention period" option and set the desired backup retention duration in days. The valid values range from 0 (for disabling automated backups) to a maximum of 35 days.
  
5. **Apply the Changes:**
   - Scroll to the bottom of the page and click on the "Continue" button.
   - Review the summary of changes and click on the "Modify DB Instance" button to apply the new backup retention duration.

6. **Monitor the Modification:**
   - Once the modification is complete, you can monitor the progress in the RDS console. The instance may undergo a brief downtime during the modification process.

By following these steps, you can remediate the backup retention duration misconfiguration for an AWS RDS instance using the AWS Management Console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the issue of missing Backup Retention Duration for an AWS RDS instance using AWS CLI, you can follow these steps:

1. **List Current Backup Retention Settings**:
   Run the following AWS CLI command to list the current backup retention settings for your RDS instance:
   ```bash
   aws rds describe-db-instances --db-instance-identifier YOUR_DB_INSTANCE_IDENTIFIER
   ```

2. **Update Backup Retention Duration**:
   Run the following AWS CLI command to modify the backup retention period for your RDS instance. Replace `YOUR_DB_INSTANCE_IDENTIFIER` with the actual identifier of your RDS instance and `NEW_RETENTION_PERIOD` with the desired retention period in days:
   ```bash
   aws rds modify-db-instance --db-instance-identifier YOUR_DB_INSTANCE_IDENTIFIER --backup-retention-period NEW_RETENTION_PERIOD
   ```

3. **Verify the Changes**:
   Run the `describe-db-instances` command again to verify that the backup retention period has been updated successfully:
   ```bash
   aws rds describe-db-instances --db-instance-identifier YOUR_DB_INSTANCE_IDENTIFIER
   ```

4. **Monitor the Backup Retention**:
   Monitor the backup retention settings periodically to ensure that the changes are applied correctly and the backups are retained for the specified duration.

By following these steps, you can remediate the issue of missing Backup Retention Duration for an AWS RDS instance using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the backup retention duration misconfiguration for AWS RDS using Python, you can use the AWS SDK for Python (Boto3). Here are the step-by-step instructions:

1. Install Boto3:
   If you haven't already installed Boto3, you can install it using pip:
   ```
   pip install boto3
   ```

2. Write a Python script to update the backup retention duration for the desired RDS instance. Here's an example script:

```python
import boto3

# Define the RDS instance identifier and the desired backup retention period
rds_instance_identifier = 'your_rds_instance_identifier'
backup_retention_period = 7  # Set the desired retention period in days

# Create an RDS client
rds_client = boto3.client('rds')

# Update the backup retention period for the specified RDS instance
response = rds_client.modify_db_instance(
    DBInstanceIdentifier=rds_instance_identifier,
    BackupRetentionPeriod=backup_retention_period
)

print(f"Backup retention period updated for RDS instance {rds_instance_identifier}")
```

3. Replace `'your_rds_instance_identifier'` with the actual identifier of your RDS instance.
   
4. Set the `backup_retention_period` variable to the desired retention period in days.

5. Run the Python script. This script will update the backup retention period for the specified RDS instance to the value you set.

By following these steps, you can remediate the backup retention duration misconfiguration for AWS RDS using Python and ensure that your RDS instances have the correct backup retention period set.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_CommonTasks.BackupRestore.html](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_CommonTasks.BackupRestore.html) 

