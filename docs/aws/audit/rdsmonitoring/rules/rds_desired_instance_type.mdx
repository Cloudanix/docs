---
slug: rds_desired_instance_type
title: RDS Instance Should Be of Desired Type
sidebar_label: RDS Instance Should Be of Desired Type
---

### More Info:

It is recommended that RDS database instances use instance types from a limited set based on the database workload deployed.

### Risk Level

Medium

### Address

Operational Maturity, Reliability, Security

### Compliance Standards

CBP


### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console and open the Amazon RDS console at https://console.aws.amazon.com/rds/.

2. In the navigation pane, choose "Databases".

3. In the list of DB instances, look at the "Instance class" column. This column shows the instance type for each DB instance.

4. Compare the instance types listed with your desired instance type. If any of the DB instances are not of the desired type, then those instances are misconfigured.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your AWS Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all RDS instances: Use the `describe-db-instances` command to list all the RDS instances in your AWS account. The command is as follows:

   ```
   aws rds describe-db-instances
   ```

   This command will return a JSON output with details of all the RDS instances.

3. Parse the output: You need to parse the output to get the details of each RDS instance. You can use the `jq` command-line JSON processor to do this. The command is as follows:

   ```
   aws rds describe-db-instances | jq '.DBInstances[] | {DBInstanceIdentifier: .DBInstanceIdentifier, DBInstanceClass: .DBInstanceClass}'
   ```

   This command will return a list of all RDS instances along with their instance identifiers and instance classes.

4. Check the instance type: Now, you can check the instance type of each RDS instance. If the instance type is not of the desired type, then it is a misconfiguration. For example, if the desired type is `db.m4.large`, you can check it as follows:

   ```
   aws rds describe-db-instances | jq '.DBInstances[] | select(.DBInstanceClass != "db.m4.large") | .DBInstanceIdentifier'
   ```

   This command will return the instance identifiers of all RDS instances that are not of the type `db.m4.large`. If no instance identifiers are returned, then all RDS instances are of the desired type.
</Accordion>

<Accordion title='Using Python'>
1. Install and configure AWS SDK for Python (Boto3): Boto3 makes it easy to integrate your Python application, library, or script with AWS services including AWS S3, AWS EC2, AWS DynamoDB, and much more. To install Boto3, you can use pip:

   ```
   pip install boto3
   ```

   You also need to configure your AWS credentials. You can do this in several ways, but the simplest is to use the AWS CLI:

   ```
   aws configure
   ```

   Then follow the prompts to input your AWS Access Key ID, Secret Access Key, default region name, and default output format.

2. Use Boto3 to connect to AWS RDS: Once Boto3 is installed and configured, you can start writing your Python scripts to interact with AWS services. To connect to AWS RDS, you can use the `client` function:

   ```python
   import boto3

   client = boto3.client('rds')
   ```

3. List all RDS instances: You can use the `describe_db_instances` function to list all RDS instances:

   ```python
   response = client.describe_db_instances()
   ```

   This function returns a dictionary that contains metadata about each DB instance.

4. Check the instance type of each RDS instance: You can iterate over the list of DB instances and check the instance type of each one. If the instance type is not the desired type, you can print a message or take other actions:

   ```python
   for instance in response['DBInstances']:
       if instance['DBInstanceClass'] != 'desired_type':
           print(f"DB instance {instance['DBInstanceIdentifier']} is not of the desired type.")
   ```

   Replace `'desired_type'` with the instance type you want to check for. For example, if you want to check for `db.t2.micro` instances, you would use `'db.t2.micro'`.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of an RDS instance being of the desired type in AWS, you can follow these steps using the AWS Management Console:

1. **Login to AWS Console**: Go to the AWS Management Console (https://aws.amazon.com/) and login using your credentials.

2. **Navigate to RDS Service**: Click on the "Services" dropdown in the top navigation bar and select "RDS" under the Database category.

3. **Identify the RDS Instance**: In the RDS dashboard, locate the RDS instance that needs to be remediated in terms of its type.

4. **Modify the Instance**: Select the RDS instance by clicking on its name. In the instance details page, click on the "Modify" button at the top.

5. **Choose Instance Type**: In the Modify DB Instance window, scroll down to the "DB Instance Class" section. Here, you can select the desired instance type from the dropdown list.

6. **Confirm and Apply Changes**: After selecting the desired instance type, scroll down to the bottom of the page and click on the "Continue" button. Review the summary of changes and click on the "Modify DB Instance" button to apply the changes.

7. **Monitor the Modification**: The modification process will start, and you can monitor the progress in the RDS dashboard. Once the modification is completed, the RDS instance will be of the desired type.

By following these steps, you can remediate the misconfiguration of an RDS instance being of the desired type in AWS using the AWS Management Console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of an RDS instance not being of the desired type in AWS using AWS CLI, follow these steps:

1. **Identify the current instance type**: 
   Run the following AWS CLI command to describe the RDS instance and note down the current instance type:
   ```
   aws rds describe-db-instances --db-instance-identifier <your-rds-instance-id>
   ```

2. **Choose the desired instance type**:
   Determine the desired instance type that you want to change the RDS instance to. You can refer to the AWS documentation for available RDS instance types.

3. **Modify the RDS instance**:
   Use the following AWS CLI command to modify the RDS instance to the desired instance type:
   ```
   aws rds modify-db-instance --db-instance-identifier <your-rds-instance-id> --db-instance-class <desired-instance-type> --apply-immediately
   ```

4. **Monitor the modification**:
   Monitor the modification progress by running the following command:
   ```
   aws rds describe-db-instances --db-instance-identifier <your-rds-instance-id>
   ```

5. **Verify the instance type**:
   Once the modification is completed, verify that the RDS instance is now of the desired type by running the describe command again:
   ```
   aws rds describe-db-instances --db-instance-identifier <your-rds-instance-id>
   ```

By following these steps, you can remediate the misconfiguration of an RDS instance not being of the desired type in AWS using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of an RDS instance not being of the desired type in AWS using Python, you can use the AWS SDK for Python (Boto3) to modify the instance type. Here are the step-by-step instructions:

1. Install Boto3:
Before you can start using Boto3 in Python, you need to install it. You can install it using pip:
```bash
pip install boto3
```

2. Configure AWS Credentials:
Make sure you have your AWS credentials configured either through environment variables, AWS CLI, or IAM roles.

3. Write Python script to modify RDS instance type:
Create a Python script with the following code to modify the RDS instance type:

```python
import boto3

# Initialize the RDS client
client = boto3.client('rds')

# Define the RDS instance identifier and the desired instance class
instance_identifier = 'your_rds_instance_identifier'
desired_instance_class = 'db.t2.large'  # Replace with the desired instance class

# Modify the RDS instance to the desired instance class
response = client.modify_db_instance(
    DBInstanceIdentifier=instance_identifier,
    DBInstanceClass=desired_instance_class,
    ApplyImmediately=True
)

print(f"RDS instance {instance_identifier} is being modified to {desired_instance_class}...")

# Wait for the modification to complete
client.get_waiter('db_instance_modified').wait(DBInstanceIdentifier=instance_identifier)

print(f"RDS instance {instance_identifier} has been successfully modified to {desired_instance_class}.")
```

4. Replace the placeholders:
Replace `your_rds_instance_identifier` with the actual RDS instance identifier and `db.t2.large` with the desired instance class.

5. Run the Python script:
Save the Python script and run it. It will modify the RDS instance to the desired instance type.

By following these steps, you can remediate the misconfiguration of an RDS instance not being of the desired type in AWS using Python and Boto3.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.html](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.html) 

