---
slug: dms_ssl_configured
title: Database Migration Service Endpoints Should Have SSL Configuration
sidebar_label: Database Migration Service Endpoints Should Have SSL Configuration
---
### More Info:

This rule checks whether AWS Database Migration Service (DMS) endpoints are configured with an SSL connection. Using SSL encryption enhances the security of data transferred through DMS endpoints. The rule is marked as non-compliant if AWS DMS does not have an SSL connection configured.

### Risk Level

Medium

### Address

Security

### Compliance Standards

CBP


### Triage and Remediation
<Tabs>


<Tab title='Prevention'>
### How to Prevent
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To prevent Database Migration Service (DMS) endpoints from lacking SSL configuration in Amazon RDS using the AWS Management Console, follow these steps:

1. **Navigate to DMS Endpoints:**
   - Open the AWS Management Console.
   - In the navigation pane, choose **Database Migration Service**.
   - Select **Endpoints** from the left-hand menu.

2. **Create or Modify Endpoint:**
   - To create a new endpoint, click on **Create endpoint**.
   - To modify an existing endpoint, select the endpoint and click on **Modify**.

3. **Configure SSL Settings:**
   - In the **Endpoint configuration** section, locate the **SSL mode** setting.
   - Choose **require** to ensure that SSL is used for the connection.

4. **Save Configuration:**
   - If creating a new endpoint, complete the remaining required fields and click **Create endpoint**.
   - If modifying an existing endpoint, after setting the SSL mode to **require**, click **Save** to apply the changes.

By following these steps, you ensure that your DMS endpoints are configured to use SSL, enhancing the security of your database migrations.
</Accordion>

<Accordion title='Using CLI'>
To prevent Database Migration Service (DMS) endpoints from lacking SSL configuration in Amazon RDS using AWS CLI, follow these steps:

1. **Create an SSL Certificate:**
   Ensure you have an SSL certificate available. If you don't have one, you can create a self-signed certificate or obtain one from a trusted Certificate Authority (CA).

2. **Modify the RDS Instance to Enable SSL:**
   Ensure that your RDS instance is configured to support SSL connections. You can modify the instance parameter group to enforce SSL connections.
   ```sh
   aws rds modify-db-instance \
       --db-instance-identifier <your-db-instance-identifier> \
       --apply-immediately \
       --ca-certificate-identifier rds-ca-2019
   ```

3. **Create a DMS Endpoint with SSL Configuration:**
   When creating a DMS endpoint, specify the SSL mode and provide the necessary SSL certificate details.
   ```sh
   aws dms create-endpoint \
       --endpoint-identifier <your-endpoint-identifier> \
       --endpoint-type source \
       --engine-name <your-engine-name> \
       --username <your-username> \
       --password <your-password> \
       --server-name <your-server-name> \
       --port <your-port> \
       --database-name <your-database-name> \
       --ssl-mode require \
       --certificate-arn <your-certificate-arn>
   ```

4. **Verify SSL Configuration:**
   After creating the endpoint, verify that the SSL configuration is correctly applied.
   ```sh
   aws dms describe-endpoints \
       --filters Name=endpoint-identifier,Values=<your-endpoint-identifier>
   ```

By following these steps, you can ensure that your DMS endpoints are configured to use SSL, thereby enhancing the security of your database migrations.
</Accordion>

<Accordion title='Using Python'>
To prevent Database Migration Service (DMS) endpoints from lacking SSL configuration in Amazon RDS using Python scripts, you can follow these steps:

1. **Install AWS SDK for Python (Boto3):**
   Ensure you have Boto3 installed in your Python environment. If not, you can install it using pip:
   ```bash
   pip install boto3
   ```

2. **Create a Boto3 Session and DMS Client:**
   Initialize a Boto3 session and create a DMS client to interact with the Database Migration Service.
   ```python
   import boto3

   # Initialize a session using Amazon DMS
   session = boto3.Session(
       aws_access_key_id='YOUR_ACCESS_KEY',
       aws_secret_access_key='YOUR_SECRET_KEY',
       region_name='YOUR_REGION'
   )

   dms_client = session.client('dms')
   ```

3. **Define a Function to Create/Modify Endpoints with SSL:**
   Create a function that ensures SSL is enabled for the DMS endpoints. This function can be used to create new endpoints or modify existing ones to enforce SSL.
   ```python
   def ensure_ssl_for_dms_endpoint(endpoint_identifier, endpoint_type, engine_name, server_name, port, username, password, database_name):
       response = dms_client.create_endpoint(
           EndpointIdentifier=endpoint_identifier,
           EndpointType=endpoint_type,
           EngineName=engine_name,
           Username=username,
           Password=password,
           ServerName=server_name,
           Port=port,
           DatabaseName=database_name,
           SslMode='require'  # Enforce SSL
       )
       return response
   ```

4. **Invoke the Function with Appropriate Parameters:**
   Call the function with the necessary parameters to create or modify the DMS endpoint with SSL configuration.
   ```python
   response = ensure_ssl_for_dms_endpoint(
       endpoint_identifier='my-endpoint',
       endpoint_type='source',  # or 'target'
       engine_name='mysql',  # or other supported engines like 'postgres', 'oracle', etc.
       server_name='my-database-server',
       port=3306,
       username='my-username',
       password='my-password',
       database_name='my-database'
   )

   print(response)
   ```

By following these steps, you can ensure that your DMS endpoints are configured to use SSL, thereby enhancing the security of your database migrations.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console.
2. Navigate to the RDS dashboard by selecting "Services" from the top menu, then selecting "RDS" under the "Database" category.
3. In the navigation pane, click on "Databases".
4. Select the database for which you want to check the SSL configuration.
5. In the details pane, under the "Connectivity & security" tab, look for the "SSL" section. If SSL is not enabled, it indicates that the Database Migration Service Endpoints do not have SSL configuration.
</Accordion>

<Accordion title='Using CLI'>
1. First, you need to install and configure AWS CLI on your local machine. You can download it from the official AWS website and configure it using the "aws configure" command. You will be prompted to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. Once the AWS CLI is set up, you can list all the DMS endpoints in your account using the following command:

   ```
   aws dms describe-endpoints --query 'Endpoints[*].[EndpointIdentifier,EndpointType,EngineName,SslMode]' --output table
   ```
   This command will return a table with the Endpoint Identifier, Endpoint Type, Engine Name, and SSL Mode for each endpoint.

3. To check if the SSL configuration is enabled for each endpoint, you need to look at the 'SslMode' column in the output table. If the value is 'none', it means that SSL is not enabled for that endpoint.

4. If you want to check the SSL configuration for a specific endpoint, you can use the following command:

   ```
   aws dms describe-endpoints --filters Name=endpoint-arn,Values=<endpoint-arn> --query 'Endpoints[*].[EndpointIdentifier,SslMode]'
   ```
   Replace `<endpoint-arn>` with the ARN of the endpoint you want to check. This command will return the Endpoint Identifier and SSL Mode for the specified endpoint. If the 'SslMode' value is 'none', it means that SSL is not enabled for that endpoint.
</Accordion>

<Accordion title='Using Python'>
1. Install the necessary Python libraries: Before you start, make sure you have the necessary Python libraries installed. You will need the boto3 library, which is the Amazon Web Services (AWS) SDK for Python. It allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, and others. You can install it using pip:

   ```python
   pip install boto3
   ```

2. Set up AWS credentials: You need to configure your AWS credentials. You can set your credentials in the AWS credentials file that the AWS CLI uses. By default, it is located at `~/.aws/credentials`. At a minimum, the credentials file should specify the access key and secret access key. To specify these for the `default` profile, you can use the following format:

   ```python
   [default]
   aws_access_key_id = YOUR_ACCESS_KEY
   aws_secret_access_key = YOUR_SECRET_KEY
   ```

3. Write a Python script to check the SSL configuration: Now you can write a Python script that uses the boto3 library to interact with AWS and check the SSL configuration of the Database Migration Service endpoints. Here is a basic example:

   ```python
   import boto3

   # Create a client
   client = boto3.client('dms')

   # Get a list of all endpoints
   response = client.describe_endpoints()

   # Iterate over the endpoints
   for endpoint in response['Endpoints']:
       # Check if the SSL mode is 'none'
       if endpoint['SslMode'] == 'none':
           print(f"Endpoint {endpoint['EndpointIdentifier']} does not have SSL configured.")
   ```

4. Run the Python script: Finally, you can run the Python script. It will print out the identifiers of all endpoints that do not have SSL configured. If no such endpoints exist, it will not print anything. This allows you to easily identify any misconfigurations.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of Database Migration Service Endpoints not having SSL configuration for AWS RDS using the AWS console, follow these step-by-step instructions:

1. **Login to AWS Management Console**: Go to the AWS Management Console at https://console.aws.amazon.com/.

2. **Navigate to RDS Service**: Click on the "Services" dropdown menu at the top left corner, then select "RDS" under the Database category.

3. **Select the RDS Instance**: From the list of RDS instances, select the instance for which you want to enable SSL configuration.

4. **Modify the RDS Instance**: Click on the instance name to open its details page. Then, click on the "Modify" button at the top.

5. **Enable SSL**: Scroll down to the "Network & Security" section, and locate the "Additional configuration" option. Here, you will find the "Enable IAM DB authentication" option. Enable this option by selecting the checkbox.

6. **Apply Changes**: Scroll down to the bottom of the page and click on the "Continue" button.

7. **Review Changes**: Review the changes you are about to make, and then click on the "Modify DB Instance" button to apply the changes.

8. **Verify SSL Configuration**: Once the modification is complete, verify that the SSL configuration is enabled for the Database Migration Service Endpoints by connecting to the RDS instance using SSL.

By following these steps, you will successfully remediate the misconfiguration of Database Migration Service Endpoints not having SSL configuration for AWS RDS using the AWS console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of Database Migration Service endpoints not having SSL configuration for AWS RDS using the AWS CLI, follow these steps:

1. **Enable SSL for the RDS instance**:
   - Run the following AWS CLI command to modify the RDS instance to enable SSL:
     ```
     aws rds modify-db-instance --db-instance-identifier YOUR_DB_INSTANCE_IDENTIFIER --apply-immediately --no-apply-immediately
     ```
   - Replace `YOUR_DB_INSTANCE_IDENTIFIER` with the identifier of your RDS instance.

2. **Verify SSL configuration**:
   - Confirm that SSL is enabled for the RDS instance by describing the instance using the following command:
     ```
     aws rds describe-db-instances --db-instance-identifier YOUR_DB_INSTANCE_IDENTIFIER --query 'DBInstances[*].{DBInstanceIdentifier:DBInstanceIdentifier, DBInstanceStatus:DBInstanceStatus, Endpoint:Endpoint}'
     ```
   - Ensure that the `Endpoint` section includes the `SSL: true` attribute.

3. **Restart the RDS instance**:
   - If the SSL configuration does not take effect immediately, you may need to restart the RDS instance. Run the following command:
     ```
     aws rds reboot-db-instance --db-instance-identifier YOUR_DB_INSTANCE_IDENTIFIER
     ```
   - This will trigger a reboot of the RDS instance to apply the SSL configuration changes.

4. **Verify SSL connection**:
   - Test the SSL connection to the RDS instance using a database client that supports SSL connections. Ensure that the connection is successful and encrypted.

By following these steps, you can remediate the misconfiguration of Database Migration Service endpoints not having SSL configuration for AWS RDS using the AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of Database Migration Service endpoints not having SSL configuration for AWS RDS using Python, you can follow these steps:

1. Install the AWS SDK for Python (Boto3) if you haven't already:
```bash
pip install boto3
```

2. Use the following Python script to enable SSL for your AWS RDS instance:

```python
import boto3

# Define the AWS region and RDS instance identifier
region = 'your_aws_region'
db_instance_identifier = 'your_rds_instance_identifier'

# Create an RDS client
rds_client = boto3.client('rds', region_name=region)

# Modify the RDS instance to enable SSL
response = rds_client.modify_db_instance(
    DBInstanceIdentifier=db_instance_identifier,
    ApplyImmediately=True,
    DBInstanceIdentifier=db_instance_identifier,
    Engine='mysql',  # Change the engine if necessary
    OptionGroupName='default:mysql-5-7',  # Change the option group if necessary
    EnableIAMDatabaseAuthentication=False,
    PubliclyAccessible=False,
    ApplyImmediately=True,
    CloudwatchLogsExportConfiguration={},
    EnablePerformanceInsights=False,
    MonitoringInterval=0,
    PerformanceInsightsKMSKeyId='',
    PerformanceInsightsRetentionPeriod=7,
    EnableEnhancedMonitoring=False,
    MonitoringRoleArn='',
    PromotionTier=0,
    OptionGroupName='default:mysql-5-7',
    DBParameterGroupName='default:mysql-5-7',
    VpcSecurityGroupIds=[
        'your_security_group_id',
    ],
    ApplyImmediately=True,
    EngineVersion='5.7.30',
    MasterUserPassword='your_master_password',
    PreferredBackupWindow='02:00-03:00',
    BackupRetentionPeriod=7,
    PreferredMaintenanceWindow='sun:04:00-sun:05:00',
    CopyTagsToSnapshot=False,
    LicenseModel='general-public-license',
    StorageType='gp2',
    StorageEncrypted=True,
    MultiAZ=False,
    AutoMinorVersionUpgrade=True,
    PubliclyAccessible=False,
    DBInstanceClass='db.t2.micro',
    AllocatedStorage=20,
    DBInstanceIdentifier=db_instance_identifier
)

print("SSL configuration enabled for RDS instance: ", response)
```

3. Replace the placeholders ('your_aws_region', 'your_rds_instance_identifier', 'your_security_group_id', 'your_master_password') with your actual AWS region, RDS instance identifier, security group ID, and master password.

4. Run the Python script to enable SSL configuration for your AWS RDS instance.

After following these steps, the SSL configuration for the Database Migration Service endpoints should be enabled for your AWS RDS instance.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>

