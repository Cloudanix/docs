

<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to RDS Dashboard: On the AWS Management Console, click on the "Services" dropdown menu, and under the "Database" category, click on "RDS". This will take you to the RDS Dashboard.
3. Access RDS Instances: On the RDS Dashboard, in the navigation pane, click on "Databases". This will display a list of all your RDS instances.
4. Check Deletion Protection: For each Neptune DB cluster, under the "Details" section, look for the "Deletion protection" attribute. If the attribute is set to "Disabled", then the Neptune DB cluster does not have deletion protection enabled.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local system. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all DB clusters: Use the `describe-db-clusters` command to list all the DB clusters in your AWS account. The command is as follows:

   ```
   aws rds describe-db-clusters --query 'DBClusters[*].[DBClusterIdentifier,DeletionProtection]' --output text
   ```

   This command will return a list of all DB clusters along with their DeletionProtection status.

3. Check DeletionProtection status: From the output of the above command, check the DeletionProtection status of the Neptune DB cluster. If the DeletionProtection status is 'false', then the Neptune DB cluster does not have deletion protection enabled.

4. Automate the process: If you want to automate this process, you can write a Python script using the boto3 library (AWS SDK for Python) to list all DB clusters and check their DeletionProtection status. The script will look something like this:

   ```python
   import boto3

   client = boto3.client('rds')

   response = client.describe_db_clusters()

   for db_cluster in response['DBClusters']:
       if not db_cluster['DeletionProtection']:
           print(f"DB cluster {db_cluster['DBClusterIdentifier']} does not have deletion protection enabled.")
   ```
   
   This script will print the identifiers of all DB clusters that do not have deletion protection enabled.

#### Using Python

1. Install the necessary Python libraries: Before you can start writing the script, you need to install the necessary Python libraries. The AWS SDK for Python (Boto3) allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, etc. You can install it using pip:

```python
pip install boto3
```

2. Import the necessary libraries and establish a session: In your Python script, you'll need to import the necessary libraries and establish a session with AWS. 

```python
import boto3

session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    region_name='us-west-2'
)
```

3. Connect to the RDS service: Once the session is established, you can connect to the RDS service and retrieve all the DB instances.

```python
rds = session.client('rds')
response = rds.describe_db_clusters()
```

4. Check the deletion protection status: Now, you can iterate over the DB instances and check the deletion protection status. If the deletion protection is not enabled, print the DB instance identifier.

```python
for db_cluster in response['DBClusters']:
    if not db_cluster['DeletionProtection']:
        print(f"DB cluster {db_cluster['DBClusterIdentifier']} does not have deletion protection enabled.")
```

This script will print the identifiers of all DB clusters that do not have deletion protection enabled.

</Tab>

<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of Neptune DB Cluster not having deletion protection enabled in AWS RDS, you can follow these step-by-step instructions using the AWS Management Console:

1. **Login to AWS Console**: Go to the AWS Management Console (https://aws.amazon.com/console/) and login with your credentials.

2. **Navigate to Amazon Neptune Service**: Click on the "Services" dropdown in the top-left corner of the console, then select "Neptune" under the Database category.

3. **Select the DB Cluster**: From the list of Neptune DB Clusters, select the DB Cluster for which you want to enable deletion protection.

4. **Modify DB Cluster**: In the DB Cluster details page, click on the "Actions" dropdown button and select "Modify".

5. **Enable Deletion Protection**: Scroll down to the "Additional configuration" section in the Modify DB Cluster page. Locate the "Deletion protection" option and check the box to enable deletion protection for the DB Cluster.

6. **Review and Apply Changes**: Review the other configuration settings to ensure they are correct. Once you have verified the changes, click on the "Modify cluster" button to apply the changes.

7. **Monitor the Modification**: The modification process may take a few minutes to complete. You can monitor the progress on the DB Cluster details page.

By following these steps, you have successfully enabled deletion protection for the Neptune DB Cluster in AWS RDS, ensuring that accidental deletion of the DB Cluster is prevented.

#### Using CLI

To remediate the misconfiguration of Neptune DB Cluster not having deletion protection enabled in AWS RDS using AWS CLI, follow these steps:

1. **Install and Configure AWS CLI:**
   - If you haven't already, install the AWS CLI by following the instructions in the AWS documentation (https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html).
   - Configure the AWS CLI with your AWS credentials by running `aws configure` and providing your Access Key ID, Secret Access Key, region, and output format.

2. **Enable Deletion Protection for Neptune DB Cluster:**
   - Run the following AWS CLI command to enable deletion protection for your Neptune DB Cluster:
     ```
     aws neptune modify-db-cluster --db-cluster-identifier <your-db-cluster-identifier> --deletion-protection
     ```
     Replace `<your-db-cluster-identifier>` with the actual identifier of your Neptune DB Cluster.

3. **Verify Deletion Protection Status:**
   - To verify that deletion protection has been successfully enabled for your Neptune DB Cluster, you can describe the cluster using the following command:
     ```
     aws neptune describe-db-clusters --db-cluster-identifier <your-db-cluster-identifier> --query 'DBClusters[*].[DBClusterIdentifier,DeletionProtection]'
     ```
     This command will return the identifier of the DB Cluster and its deletion protection status.

4. **Ensure Deletion Protection Persists:**
   - It is recommended to periodically check the deletion protection status of your Neptune DB Cluster to ensure that it persists over time. You can use the same describe command mentioned in step 3 for this purpose.

By following these steps, you can successfully remediate the misconfiguration of Neptune DB Cluster not having deletion protection enabled in AWS RDS using AWS CLI.

#### Using Python

To remediate the misconfiguration of Neptune DB Cluster not having deletion protection enabled in AWS RDS using Python, you can follow these steps:

1. Import the necessary libraries:
```python
import boto3
```

2. Initialize the AWS RDS client:
```python
client = boto3.client('rds')
```

3. Get a list of all Neptune DB Clusters:
```python
response = client.describe_db_clusters()
```

4. Iterate through each DB Cluster and enable deletion protection if it is not already enabled:
```python
for cluster in response['DBClusters']:
    cluster_identifier = cluster['DBClusterIdentifier']
    deletion_protection = cluster['DeletionProtection']

    if not deletion_protection:
        client.modify_db_cluster(
            DBClusterIdentifier=cluster_identifier,
            DeletionProtection=True
        )
        print(f"Deletion protection enabled for DB Cluster: {cluster_identifier}")
    else:
        print(f"Deletion protection is already enabled for DB Cluster: {cluster_identifier}")
```

5. Run the Python script to enable deletion protection for all Neptune DB Clusters in your AWS RDS.

Please ensure that you have the necessary IAM permissions to modify RDS DB Clusters and that your AWS credentials are properly configured for the boto3 library to work.


</Tab>
</Tabs>