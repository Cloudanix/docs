---
slug: rds_public_snapshots
title: RDS Database Snapshots Should Not Be Public
sidebar_label: RDS Database Snapshots Should Not Be Public
---

### More Info:

Your AWS Relational Database Service (RDS) database snapshots should not be publicly accessible. This is to avoid exposing your private data.

### Risk Level

Critical

### Address

Security

### Compliance Standards

HIPAA, PCIDSS, NIST, AWSWAF, GDPR

### Remediation

To remediate the issue of public RDS DB snapshots, we can use the following approach:

#### Using Console

1. **Sign in to the AWS Management Console**.
2. **Navigate to the RDS service**.
3. **Select Snapshots from the navigation pane**.
4. **Identify public snapshots**:
   - Look for snapshots listed in the console that you've identified as public.
   - These snapshots might have the attribute "restore" set to "all".
5. **Select the public snapshot**.
6. **Modify Snapshot Attributes**:
   - Click on Modify Attributes.
   - Uncheck the option to make the snapshot publicly accessible, if available.
   - Confirm the changes.
7. **Repeat for other public snapshots**:
   - Repeat the above steps for all public snapshots identified.

#### Using CLI

1. **List RDS DB Snapshots**:
```bash
aws rds describe-db-snapshots
```
2. **Identify public snapshots**:
   - Look for snapshots where the attribute "restore" is set to "all".
3. **Modify Snapshot Attributes**:
```bash
aws rds modify-db-snapshot-attribute --db-snapshot-identifier SNAPSHOT_IDENTIFIER --no-public
```
Replace `SNAPSHOT_IDENTIFIER` with the identifier of the public snapshot.
4. **Repeat for other public snapshots**:
   - Repeat the modification command for all public snapshots identified.

#### Using Python

Here's a Python script to identify and remediate public RDS DB snapshots:

```python
import boto3

class RDSSnapshotChecker:
    def __init__(self):
        self.rds_client = boto3.client('rds')

    def get_public_snapshots(self):
        failures = []
        response = self.rds_client.describe_db_snapshots()
        for snapshot in response['DBSnapshots']:
            if self.is_snapshot_public(snapshot):
                failures.append(snapshot)
        return failures

    def is_snapshot_public(self, snapshot):
        for attr in snapshot.get("Attributes", []):
            if attr.get("AttributeName", "") == "restore" and "all" in attr.get("AttributeValues", []):
                return True
        return False

    def remediate_public_snapshot(self, snapshot_id):
        self.rds_client.modify_db_snapshot_attribute(
            DBSnapshotIdentifier=snapshot_id,
            AttributeName='restore',
            NoValue=True
        )
        print(f"Snapshot {snapshot_id} has been remediated.")

# Instantiate the class
checker = RDSSnapshotChecker()

# Get public snapshots
public_snapshots = checker.get_public_snapshots()

# Remediate public snapshots
for snapshot in public_snapshots:
    checker.remediate_public_snapshot(snapshot['DBSnapshotIdentifier'])
```

This Python script identifies public RDS DB snapshots by checking if the "restore" attribute is set to "all" and then remediates them by modifying the attribute to make them non-public.

Make sure to have appropriate IAM permissions for modifying RDS snapshots if you're using AWS CLI or Python script.
### Additional Reading:

- [https://aws.amazon.com/premiumsupport/trustedadvisor/best-practices/](https://aws.amazon.com/premiumsupport/trustedadvisor/best-practices/) 

