---
slug: check_athena_workgroup_encrypted_at_rest
title: Encryption Should Be Enabled For Amazon Athena Group
sidebar_label: Encryption Should Be Enabled For Amazon Athena Group
---
### More Info:

This rule ensures that encryption of data at rest is enabled for an Amazon Athena workgroup. Enabling encryption at rest helps protect sensitive data stored in Athena workgroups from unauthorized access or tampering. It ensures that data is encrypted while stored, providing an additional layer of security.

### Risk Level

Medium

### Address

Security

### Compliance Standards

CBP,SEBI


### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console.
2. Navigate to the RDS dashboard by selecting "Services" from the top menu and then selecting "RDS" under the "Database" category.
3. In the RDS dashboard, select "Databases" from the left-hand side menu. This will display a list of all your RDS instances.
4. For each RDS instance, check the "Encryption" column. If the column displays "Disabled" or "Not Enabled", then encryption is not enabled for that Amazon Athena Group in RDS.
</Accordion>

<Accordion title='Using CLI'>
1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Make sure you have the necessary permissions to access the RDS resources.

2. Once the AWS CLI is set up, you can use the following command to list all the RDS DB instances:

   ```
   aws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier]' --output text
   ```

3. For each DB instance, you can check the encryption status using the following command:

   ```
   aws rds describe-db-instances --db-instance-identifier <DBInstanceIdentifier> --query 'DBInstances[*].[StorageEncrypted]' --output text
   ```
   Replace `<DBInstanceIdentifier>` with the ID of the DB instance you want to check. This command will return `true` if the DB instance is encrypted and `false` if it's not.

4. To automate the process, you can write a script that loops through all the DB instances and checks their encryption status. Here is a simple example in bash:

   ```bash
   #!/bin/bash
   DBInstances=$(aws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier]' --output text)
   for DBInstance in $DBInstances
   do
     EncryptionStatus=$(aws rds describe-db-instances --db-instance-identifier $DBInstance --query 'DBInstances[*].[StorageEncrypted]' --output text)
     echo "DB Instance: $DBInstance, Encryption Status: $EncryptionStatus"
   done
   ```
   This script will print the encryption status of all the DB instances.
</Accordion>

<Accordion title='Using Python'>
1. First, you need to install the necessary Python libraries. You will need the boto3 library, which is the Amazon Web Services (AWS) SDK for Python. It allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, and others. You can install it using pip:

```python
pip install boto3
```

2. Once you have boto3 installed, you can use it to create a session using your AWS credentials. You will need your access key, secret access key, and the region. Here is an example of how to create a session:

```python
import boto3

session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    region_name='us-west-2'
)
```

3. Now that you have a session, you can use it to create a client for Amazon RDS. You can then use this client to describe your DB instances and check if they have encryption enabled. Here is an example:

```python
rds = session.client('rds')

response = rds.describe_db_instances()

for instance in response['DBInstances']:
    if not instance['StorageEncrypted']:
        print(f"DB instance {instance['DBInstanceIdentifier']} is not encrypted.")
```

4. This script will print out the identifiers of all DB instances that do not have encryption enabled. If no instances are printed, then all your DB instances have encryption enabled.

Please note that this script only checks for encryption at rest. If you want to check for encryption in transit, you will need to check the parameter groups for your DB instances.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of enabling encryption for Amazon Athena Group in AWS RDS using the AWS Management Console, follow these steps:

1. **Sign in to the AWS Management Console:**
   - Go to https://aws.amazon.com/ and sign in to the AWS Management Console using your credentials.

2. **Navigate to the Amazon RDS Console:**
   - Once you are logged in, navigate to the Amazon RDS console by clicking on the "Services" dropdown menu at the top of the page and selecting "RDS" under the Database section.

3. **Select the RDS Instance:**
   - In the Amazon RDS console, select the RDS instance for which you want to enable encryption by clicking on the checkbox next to the instance.

4. **Enable Encryption:**
   - Click on the "Modify" button at the top of the page to modify the settings of the selected RDS instance.

5. **Enable Encryption at Rest:**
   - Scroll down to the "Encryption" section in the Modify DB Instance page.
   - Select the option to enable encryption at rest.
   - Choose the appropriate KMS key from the dropdown menu. If you don't have a KMS key, you can create one by clicking on the "Create New" button.
   - Click on the "Continue" button.

6. **Apply Changes:**
   - Review the changes you are about to make and ensure that encryption is enabled.
   - Click on the "Modify DB Instance" button to apply the changes to the RDS instance.

7. **Monitor Encryption Status:**
   - Once the modification is complete, monitor the status of encryption for the RDS instance in the Amazon RDS console.
   - Ensure that the encryption status is shown as "enabled" for the instance.

By following these steps, you can remediate the misconfiguration of enabling encryption for the Amazon Athena Group in AWS RDS using the AWS Management Console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of enabling encryption for Amazon Athena group in AWS RDS using the AWS CLI, follow these steps:

1. List the existing RDS DB instances to identify the RDS instance that needs to be encrypted:
```bash
aws rds describe-db-instances
```

2. Enable the encryption for the identified RDS DB instance. Replace `your-db-instance-identifier` with the actual identifier of the RDS instance:
```bash
aws rds modify-db-instance --db-instance-identifier your-db-instance-identifier --storage-encrypted
```

3. Verify that the encryption is enabled for the RDS instance by describing the instance:
```bash
aws rds describe-db-instances --db-instance-identifier your-db-instance-identifier
```

4. Once the encryption is enabled, you can confirm that the Amazon Athena group associated with this RDS instance will also have encryption enabled.

By following these steps, you can remediate the misconfiguration of enabling encryption for the Amazon Athena group in AWS RDS using the AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of enabling encryption for Amazon Athena Group in AWS RDS using Python, you can follow these steps:

1. Import the necessary Python libraries:
```python
import boto3
```

2. Initialize the AWS RDS client:
```python
client = boto3.client('rds')
```

3. Identify the Amazon Athena Group associated with the AWS RDS instance:
```python
response = client.describe_db_instances(
    DBInstanceIdentifier='YOUR_DB_INSTANCE_IDENTIFIER'
)

db_instance = response['DBInstances'][0]
```

4. Check if the encryption is already enabled for the RDS instance:
```python
if not db_instance['StorageEncrypted']:
    # Enable encryption for the RDS instance
    client.modify_db_instance(
        DBInstanceIdentifier='YOUR_DB_INSTANCE_IDENTIFIER',
        StorageEncrypted=True
    )
    print("Encryption enabled for the RDS instance.")
else:
    print("Encryption is already enabled for the RDS instance.")
```

5. Replace `'YOUR_DB_INSTANCE_IDENTIFIER'` with the actual identifier of your RDS instance.

6. Run the Python script to enable encryption for the Amazon Athena Group associated with the AWS RDS instance.

By following these steps, you can remediate the misconfiguration of enabling encryption for the Amazon Athena Group in AWS RDS using Python.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>

