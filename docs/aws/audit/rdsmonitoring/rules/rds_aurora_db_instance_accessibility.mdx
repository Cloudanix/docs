---
slug: rds_aurora_db_instance_accessibility
title: Accessibility Should Be Well-defined in Aurora Clusters
sidebar_label: Accessibility Should Be Well-defined in Aurora Clusters
---

### More Info:

All the database instances within your Amazon Aurora clusters should have the same accessibility (either public or private) in order to follow AWS best practices.

### Risk Level

Medium

### Address

Reliability, Security

### Compliance Standards

HITRUST, SOC2, NISTCSF, PCIDSS, FedRAMP



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and navigate to the RDS dashboard. 

2. In the navigation pane, choose "Databases" to access the list of your RDS instances.

3. Select the Aurora cluster that you want to examine. 

4. In the details section, check the "Public accessibility" attribute. If the attribute is set to "Yes", then the selected Amazon Aurora cluster is accessible over the internet, which is a potential misconfiguration.

#### Using CLI

1. **Install and Configure AWS CLI**: Before you can start, make sure you have AWS CLI installed and configured on your system. You can install it using pip (Python package installer). The command to install AWS CLI is `pip install awscli`. After installation, you can configure it using `aws configure` command. You will be asked to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. **List all RDS Instances**: Use the `describe-db-instances` command to list all the RDS instances. The command is as follows:
   ```
   aws rds describe-db-instances
   ```
   This command will return a JSON output with all the RDS instances.

3. **Check Public Accessibility**: In the JSON output, look for the `PubliclyAccessible` attribute for each instance. If the value of this attribute is `true`, then the RDS instance is publicly accessible. Here is a sample command to check the public accessibility of a specific RDS instance:
   ```
   aws rds describe-db-instances --db-instance-identifier mydbinstance --query 'DBInstances[*].[DBInstanceIdentifier,PubliclyAccessible]'
   ```
   Replace `mydbinstance` with the identifier of your RDS instance.

4. **Check for Aurora Clusters**: To specifically check for Aurora clusters, you can use the `describe-db-clusters` command. The command is as follows:
   ```
   aws rds describe-db-clusters
   ```
   This command will return a JSON output with all the RDS clusters. You can then check the `Engine` attribute for each cluster to see if it is `aurora`. If it is, then it is an Aurora cluster. You can also check the `PubliclyAccessible` attribute as described in step 3 to see if the Aurora cluster is publicly accessible.

#### Using Python

1. Install the necessary Python libraries: Before you can start writing Python scripts to interact with AWS services, you need to install the Boto3 library, which is the Amazon Web Services (AWS) Software Development Kit (SDK) for Python.

```python
pip install boto3
```

2. Set up AWS credentials: You can set up your AWS credentials in several ways, but the simplest is to use the AWS CLI. Run `aws configure` and then enter your access key, secret access key, and default region when prompted.

3. Write a Python script to check the accessibility of Aurora Clusters in RDS:

```python
import boto3

def check_aurora_cluster_accessibility():
    client = boto3.client('rds')
    clusters = client.describe_db_clusters()['DBClusters']
    for cluster in clusters:
        if cluster['Engine'] == 'aurora' and not cluster['PubliclyAccessible']:
            print(f"Aurora cluster {cluster['DBClusterIdentifier']} is not publicly accessible.")

check_aurora_cluster_accessibility()
```

This script will print out the identifiers of all Aurora clusters that are not publicly accessible.

4. Run the Python script: You can run the Python script using any Python interpreter. If you're using the command line, you can run the script with the command `python script_name.py`, replacing `script_name.py` with the name of your script. If any Aurora clusters are not publicly accessible, their identifiers will be printed to the console.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the accessibility misconfiguration in an Aurora cluster in AWS RDS using the AWS console, follow these steps:

1. **Navigate to the AWS RDS Console:**
   - Go to the AWS Management Console (https://console.aws.amazon.com/).
   - Open the RDS console by selecting "RDS" under the "Database" section.

2. **Select the Aurora Cluster:**
   - In the RDS dashboard, select the Aurora cluster that you want to remediate the accessibility settings for.

3. **Modify the Cluster:**
   - Click on the "Modify" button in the top right corner of the cluster details page.

4. **Update the Accessibility Settings:**
   - Scroll down to the "Network & Security" section of the modify cluster page.
   - Here, you can update the following settings:
     - **VPC Security Group:** Ensure that the appropriate VPC security group is selected to control inbound and outbound traffic to the cluster.
     - **Public Accessibility:** If the cluster needs to be publicly accessible, set the "Publicly Accessible" option to "Yes". Otherwise, set it to "No" for private accessibility.
     - **VPC:** Verify that the cluster is deployed in the correct VPC.

5. **Apply the Changes:**
   - After updating the accessibility settings, scroll to the bottom of the page and click on the "Continue" button.

6. **Review and Apply the Changes:**
   - Review the modifications you have made to the cluster's accessibility settings.
   - Once you are satisfied with the changes, click on the "Modify Cluster" button to apply the new settings.

7. **Monitor the Modification Progress:**
   - The modification process may take some time to complete. You can monitor the progress in the RDS console.

8. **Verify the Accessibility Settings:**
   - Once the modification is complete, verify that the accessibility settings for the Aurora cluster have been updated as intended.

By following these steps, you can remediate the accessibility misconfiguration in an Aurora cluster in AWS RDS using the AWS console.

#### Using CLI

To remediate the accessibility misconfiguration in an Aurora cluster in AWS RDS using AWS CLI, follow these steps:

1. **Identify the Misconfigured Aurora Cluster**:
   - Use the AWS CLI command to list all the Aurora clusters in your AWS account:
     ```
     aws rds describe-db-clusters --query "DBClusters[*].[DBClusterIdentifier,Endpoint]" --output table
     ```
   - Identify the Aurora cluster that has accessibility misconfiguration.

2. **Update the Cluster's VPC Security Group**:
   - Use the AWS CLI command to modify the Aurora cluster to specify the correct VPC security group that allows the desired accessibility:
     ```
     aws rds modify-db-cluster --db-cluster-identifier <cluster-identifier> --vpc-security-group-ids <security-group-ids>
     ```
     Replace `<cluster-identifier>` with the identifier of the Aurora cluster and `<security-group-ids>` with the IDs of the VPC security groups that should have access to the cluster.

3. **Verify the Accessibility Changes**:
   - Use the AWS CLI command to describe the Aurora cluster and verify that the VPC security group has been updated successfully:
     ```
     aws rds describe-db-clusters --db-cluster-identifier <cluster-identifier> --query "DBClusters[*].[DBClusterIdentifier,VpcSecurityGroups]" --output table
     ```
     Ensure that the correct VPC security group is now associated with the Aurora cluster.

4. **Test the Accessibility**:
   - Verify that the accessibility to the Aurora cluster is now as desired by connecting to the cluster using a client application or tool.

By following these steps, you can remediate the accessibility misconfiguration in an Aurora cluster in AWS RDS using AWS CLI.

#### Using Python

To remediate the misconfiguration of undefined accessibility in Aurora clusters in AWS RDS using Python, follow these steps:

Step 1: Import the necessary Python libraries
```python
import boto3
```

Step 2: Define the AWS region and create an RDS client
```python
region = 'your_aws_region'
rds = boto3.client('rds', region_name=region)
```

Step 3: List all the Aurora clusters in the AWS account
```python
response = rds.describe_db_clusters()
clusters = response['DBClusters']
```

Step 4: For each Aurora cluster, check if the `VpcSecurityGroups` parameter is defined
```python
for cluster in clusters:
    cluster_identifier = cluster['DBClusterIdentifier']
    vpc_security_groups = cluster['VpcSecurityGroups']
    
    if not vpc_security_groups:
        # If accessibility is not well-defined, update the cluster's security group
        new_security_group_id = 'your_security_group_id'
        rds.modify_db_cluster(
            DBClusterIdentifier=cluster_identifier,
            VpcSecurityGroupIds=[new_security_group_id]
        )
        print(f"Accessibility is now well-defined for Aurora cluster {cluster_identifier}")
    else:
        print(f"Accessibility is already well-defined for Aurora cluster {cluster_identifier}")
```

Step 5: Replace `'your_aws_region'` with your AWS region and `'your_security_group_id'` with the desired security group ID that allows access to the Aurora cluster.

Step 6: Run the Python script to remediate the misconfiguration of undefined accessibility in Aurora clusters in AWS RDS.

By following these steps, you can remediate the misconfiguration of undefined accessibility in Aurora clusters in AWS RDS using Python.

### Additional Reading:

- [https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Aurora.Modifying.html](https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Aurora.Modifying.html) 


</Tab>
</Tabs>