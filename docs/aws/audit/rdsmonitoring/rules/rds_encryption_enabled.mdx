---
slug: rds_encryption_enabled
title: RDS Instances Should Have Encryption Enabled
sidebar_label: RDS Instances Should Have Encryption Enabled
---

### More Info:

RDS database instances should be encrypted to fulfill compliance requirements for data-at-rest encryption.

### Risk Level

High

### Address

Security

### Compliance Standards

HIPAA, GDPR, CISAWS, CBP, NIST, AWSWAF, HITRUST, SOC2, NISTCSF, PCIDSS

### Remediation

#### Using Console

To remediate the misconfiguration "RDS Instances Should Have Encryption Enabled" for AWS using AWS console, you can follow the below steps:

1. Log in to the AWS Management Console.
2. Navigate to the Amazon RDS dashboard.
3. Select the RDS instance that you want to enable encryption for.
4. Click on the "Modify" button to modify the instance settings.
5. Scroll down to the "Encryption" section and select "Yes" for the "Encryption" option.
6. Select the KMS key that you want to use for encryption. You can either choose the default KMS key or create a new one.
7. Click on the "Continue" button.
8. Review the changes and click on the "Modify DB Instance" button to apply the changes.

Once you have completed these steps, encryption will be enabled for your RDS instance. It is important to note that enabling encryption may cause a brief disruption in service while the instance is being modified.

#### Using CLI

To remediate the misconfiguration "RDS Instances Should Have Encryption Enabled" for AWS using AWS CLI, follow the below steps:

1. Login to AWS CLI with appropriate credentials.
2. Identify the RDS instances that do not have encryption enabled by running the below command:

   `aws rds describe-db-instances --query "DBInstances[?StorageEncrypted=='false'].DBInstanceArn" --output text`

3. Enable encryption for the identified RDS instances by running the below command:

   `aws rds modify-db-instance --db-instance-identifier <instance-identifier> --storage-encrypted --apply-immediately`

   Replace `<instance-identifier>` with the identifier of the RDS instance that needs to be encrypted.

4. Verify the encryption status of the RDS instance by running the below command:

   `aws rds describe-db-instances --db-instance-identifier <instance-identifier> --query "DBInstances[0].StorageEncrypted"`

   Replace `<instance-identifier>` with the identifier of the RDS instance that was encrypted.

5. Repeat steps 3 and 4 for all the RDS instances that do not have encryption enabled.

By following the above steps, you can remediate the misconfiguration "RDS Instances Should Have Encryption Enabled" for AWS using AWS CLI.

#### Using Python

To remediate the misconfiguration "RDS Instances Should Have Encryption Enabled" in AWS using Python, you can follow the below steps:

1. Import the necessary AWS SDKs and libraries in your Python script.

2. Use the `boto3` client to connect to the AWS account and retrieve the list of all RDS instances.

3. For each RDS instance, check if encryption is enabled or not using the `describe_db_instances` API call.

4. If encryption is not enabled, use the `modify_db_instance` API call to enable encryption.

Here is the sample Python code to remediate the misconfiguration:

```python
import boto3

# Connect to AWS account
client = boto3.client('rds')

# Retrieve the list of all RDS instances
response = client.describe_db_instances()

# Check if encryption is enabled for each RDS instance
for db_instance in response['DBInstances']:
    if not db_instance['StorageEncrypted']:
        # Enable encryption for the RDS instance
        client.modify_db_instance(
            DBInstanceIdentifier=db_instance['DBInstanceIdentifier'],
            StorageEncrypted=True,
            ApplyImmediately=True
        )
```

This script will enable encryption for all RDS instances that do not have encryption enabled. You can run this script periodically to ensure that all RDS instances are encrypted.

### Additional Reading:

- [https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html) 

