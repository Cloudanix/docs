---
slug: rds_encryption_enabled
title: RDS Instances Should Have Encryption Enabled
sidebar_label: RDS Instances Should Have Encryption Enabled
---

### More Info:

RDS database instances should be encrypted to fulfill compliance requirements for data-at-rest encryption.

### Risk Level

High

### Address

Security

### Compliance Standards

HIPAA, GDPR, CISAWS, CBP, NIST, AWSWAF, HITRUST, SOC2, NISTCSF, PCIDSS



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to the RDS dashboard by selecting "Services" from the top menu, then selecting "RDS" under the "Database" category.
3. In the navigation pane, click on "Databases". This will display a list of all your RDS instances.
4. For each instance, look under the "Encryption" column. If the status is "Disabled" or "Not Enabled", then the RDS instance does not have encryption enabled.

#### Using CLI

1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Make sure you have the necessary permissions to access the RDS instances.

2. Once the AWS CLI is set up, you can list all the RDS instances in your account by running the following command:

   ```
   aws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier]' --output text
   ```

   This command will return a list of all RDS instance identifiers.

3. For each RDS instance, you can check if encryption is enabled by running the following command:

   ```
   aws rds describe-db-instances --db-instance-identifier <DBInstanceIdentifier> --query 'DBInstances[*].[StorageEncrypted]' --output text
   ```

   Replace `<DBInstanceIdentifier>` with the identifier of the RDS instance you want to check. This command will return `true` if encryption is enabled and `false` if it is not.

4. Repeat step 3 for each RDS instance in your account. If any instance returns `false`, it means that encryption is not enabled for that instance.

#### Using Python

1. Install and configure AWS SDK for Python (Boto3) on your local system. Boto3 allows you to directly create, update, and delete AWS services from your Python scripts.

```python
pip install boto3
```

2. Configure your AWS credentials to enable your Boto3 Python script to communicate with AWS services. You can configure it using AWS CLI:

```bash
aws configure
```

3. Write a Python script using Boto3 to list all RDS instances and check if they have encryption enabled. Here is a sample script:

```python
import boto3

def check_rds_encryption():
    client = boto3.client('rds')
    instances = client.describe_db_instances()
    for instance in instances['DBInstances']:
        if 'KmsKeyId' not in instance:
            print(f"RDS instance {instance['DBInstanceIdentifier']} does not have encryption enabled")

check_rds_encryption()
```

4. Run the Python script. If there are any RDS instances without encryption enabled, they will be printed out.

```bash
python check_rds_encryption.py
```

This script works by calling the `describe_db_instances` method from the RDS client, which returns a list of DB instances. It then iterates over each instance and checks if the 'KmsKeyId' key (which indicates that the instance is encrypted) is present in the instance's details. If it's not, it prints out the instance's identifier.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of RDS instances not having encryption enabled in AWS, you can follow these steps using the AWS Management Console:

1. **Login to AWS Console**: Go to the AWS Management Console and login with your credentials.

2. **Navigate to RDS Service**: Click on the "Services" dropdown menu at the top of the page and select "RDS" under the Database category.

3. **Select the RDS Instance**: From the list of RDS instances, select the instance for which you want to enable encryption by clicking on the instance identifier.

4. **Modify the Instance**: In the RDS instance details page, click on the "Modify" button at the top.

5. **Enable Encryption**: Scroll down to the "Encryption" section in the Modify DB Instance page. Check the box for "Enable encryption" to enable encryption for the RDS instance.

6. **Choose Encryption Key**: Select the appropriate KMS key from the dropdown menu. You can either choose the default AWS managed key or select a custom KMS key that you have created.

7. **Apply Changes**: Scroll down to the bottom of the page and click on the "Continue" button.

8. **Review and Apply Changes**: Review the changes you are about to make and click on the "Modify DB Instance" button to apply the changes.

9. **Monitor Encryption Status**: Once the modification is complete, monitor the RDS instance to ensure that encryption is enabled successfully. You can check the encryption status in the RDS instance details page.

By following these steps, you can remediate the misconfiguration of RDS instances not having encryption enabled in AWS.

#### Using CLI

To remediate the misconfiguration of RDS instances not having encryption enabled in AWS using AWS CLI, you can follow these steps:

1. **Identify the RDS Instances without Encryption Enabled:**
   Run the following AWS CLI command to list all RDS instances without encryption enabled:
   ```
   aws rds describe-db-instances --query "DBInstances[?StorageEncrypted == 'false'].DBInstanceIdentifier" --output text
   ```

2. **Enable Encryption for the RDS Instance:**
   For each RDS instance identified in the previous step, enable encryption using the following command:
   ```
   aws rds modify-db-instance --db-instance-identifier <instance-identifier> --storage-encrypted --apply-immediately
   ```

   Replace `<instance-identifier>` with the identifier of the RDS instance that needs encryption enabled.

3. **Monitor the Encryption Status:**
   You can monitor the status of the encryption modification by describing the RDS instance using the following command:
   ```
   aws rds describe-db-instances --db-instance-identifier <instance-identifier> --query "DBInstances[0].StorageEncrypted"
   ```

4. **Verify Encryption Status:**
   Once the encryption modification is complete, verify that encryption is enabled for the RDS instance by running:
   ```
   aws rds describe-db-instances --db-instance-identifier <instance-identifier> --query "DBInstances[0].StorageEncrypted"
   ```

By following these steps, you can remediate the misconfiguration of RDS instances not having encryption enabled in AWS using AWS CLI.

#### Using Python

To remediate the misconfiguration of RDS instances not having encryption enabled in AWS using Python, you can follow these steps:

1. Import the necessary Python libraries:
```python
import boto3
```

2. Initialize the AWS RDS client:
```python
client = boto3.client('rds')
```

3. Get a list of all RDS instances:
```python
response = client.describe_db_instances()
```

4. Iterate through each RDS instance and enable encryption if it is not already enabled:
```python
for db_instance in response['DBInstances']:
    db_instance_identifier = db_instance['DBInstanceIdentifier']
    db_instance_encrypted = db_instance['StorageEncrypted']
    
    if not db_instance_encrypted:
        print(f"Enabling encryption for RDS instance: {db_instance_identifier}")
        
        # Enable encryption for the RDS instance
        client.modify_db_instance(
            DBInstanceIdentifier=db_instance_identifier,
            StorageEncrypted=True,
            ApplyImmediately=True
        )
```

5. Run the Python script to enable encryption for all RDS instances without encryption.

Make sure you have the necessary IAM permissions to describe and modify RDS instances. Also, ensure that you have the AWS SDK for Python (Boto3) installed.

This script will iterate through all RDS instances in your AWS account, check if encryption is enabled, and enable it if it is not already.

### Additional Reading:

- [https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html) 

- [Encryption Limitations](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html#Overview.Encryption.Limitations)


</Tab>
</Tabs>