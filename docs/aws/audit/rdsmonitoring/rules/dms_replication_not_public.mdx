---
slug: dms_replication_not_public
title: DMS Replication Should Not Be Public
sidebar_label: DMS Replication Should Not Be Public
---
### More Info:

Ensure DMS replication instance in not public

### Risk Level

High

### Address

Observability

### Compliance Standards

HITRUST,CISEKS,SOC2,NISTCSF,PCIDSS,SEBI,RBI_MD_ITF,RBI_UCB



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console and open the Amazon RDS console at https://console.aws.amazon.com/rds/.

2. In the navigation pane, choose "Databases".

3. In the list of DB instances, choose the name of the DB instance that you want to check.

4. In the "Connectivity & security" tab, look for the "Public accessibility" field. If the value is "Yes", then the DMS Replication is public.

5. Repeat steps 3 and 4 for each DB instance in your account.

#### Using CLI

1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Make sure you have the necessary permissions to access the resources.

2. Once the AWS CLI is set up, you can list all the DMS replication instances using the following command:

   ```
   aws dms describe-replication-instances
   ```

   This command will return a JSON output with details of all the DMS replication instances.

3. To check if a DMS replication instance is publicly accessible, you need to look for the "PubliclyAccessible" attribute in the JSON output. If the value of this attribute is "true", then the DMS replication instance is publicly accessible.

4. You can use the following command to filter out the instances that are publicly accessible:

   ```
   aws dms describe-replication-instances --query 'ReplicationInstances[?PubliclyAccessible==`true`]'
   ```

   This command will return a list of DMS replication instances that are publicly accessible. If the list is empty, then there are no publicly accessible DMS replication instances.

#### Using Python

To check if DMS (Data Migration Service) Replication is not public in RDS using Python scripts, you can use the Boto3 library, which allows you to directly interact with AWS services, including RDS. Here are the steps:

1. **Import the Boto3 library in Python:**
   Boto3 is the Amazon Web Services (AWS) Software Development Kit (SDK) for Python, which allows Python developers to write software that makes use of AWS services like Amazon S3, Amazon EC2, etc. To use Boto3, you first need to import it.

   ```python
   import boto3
   ```

2. **Create an AWS session:**
   This is a high-level object representing your interaction with AWS services. The session stores configuration state and allows you to create service clients and resources.

   ```python
   session = boto3.Session(
       aws_access_key_id='YOUR_ACCESS_KEY',
       aws_secret_access_key='YOUR_SECRET_KEY',
       region_name='us-west-2'
   )
   ```

3. **Create an RDS client:**
   You can create an RDS client using the session object. This client will allow you to interact with the RDS service.

   ```python
   rds = session.client('rds')
   ```

4. **Check the Public Accessibility of DMS Replication Instances:**
   You can use the `describe_replication_instances` method to retrieve information about the DMS Replication instances. Then, check the `PubliclyAccessible` attribute of each instance. If it's set to `True`, then the DMS Replication instance is publicly accessible.

   ```python
   response = rds.describe_replication_instances()
   for instance in response['ReplicationInstances']:
       if instance['PubliclyAccessible']:
           print(f"DMS Replication instance {instance['ReplicationInstanceIdentifier']} is publicly accessible.")
   ```

This script will print out the identifiers of all DMS Replication instances that are publicly accessible. If no such instances exist, it won't print anything.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of DMS Replication being public for AWS RDS using the AWS console, follow these steps:

1. **Access AWS Management Console**: Go to the AWS Management Console at https://aws.amazon.com/ and log in to your account.

2. **Navigate to the Amazon RDS Console**: Click on the "Services" dropdown menu at the top left corner of the console, then select "RDS" under the Database category.

3. **Select the RDS Instance**: From the list of RDS instances, select the instance that is being replicated using DMS.

4. **Modify Security Group**: In the details page of the selected RDS instance, scroll down to the "Security" section and click on the security group that is associated with the instance.

5. **Edit Inbound Rules**: In the security group settings, locate the inbound rules that allow public access to the DMS replication. By default, DMS replication should not be public.

6. **Update Security Group Rules**: Remove any inbound rules that allow public access to the DMS replication endpoint. You can either modify the existing rule to restrict access to specific IP ranges or completely remove the rule if it is not required.

7. **Save Changes**: After updating the security group rules, save the changes to apply the new configuration.

8. **Verify Configuration**: Double-check the security group settings to ensure that only authorized entities have access to the DMS replication endpoint.

By following these steps, you can remediate the misconfiguration of DMS Replication being public for AWS RDS using the AWS console and ensure that your RDS instance is secure.

#### Using CLI

To remediate the DMS replication being public for AWS RDS using AWS CLI, you can follow these steps:

1. **Identify the DMS Replication Instance**: First, you need to identify the DMS replication instance that is currently public. You can use the following AWS CLI command to list all the DMS replication instances:

```bash
aws dms describe-replication-instances
```

2. **Update the Security Group**: Once you have identified the DMS replication instance, you need to update the security group associated with it to restrict access. Get the security group ID from the DMS replication instance details and then run the following AWS CLI command to update the security group:

```bash
aws ec2 revoke-security-group-ingress --group-id YOUR_SECURITY_GROUP_ID --protocol tcp --port 443 --cidr 0.0.0.0/0
```

Replace `YOUR_SECURITY_GROUP_ID` with the actual security group ID associated with the DMS replication instance.

3. **Verify the Changes**: Finally, verify that the security group rules have been updated successfully by running the following AWS CLI command:

```bash
aws ec2 describe-security-groups --group-ids YOUR_SECURITY_GROUP_ID
```

Ensure that the inbound rules for port 443 (DMS replication port) do not allow access from `0.0.0.0/0`.

By following these steps, you can remediate the DMS replication being public for AWS RDS using AWS CLI.

#### Using Python

To remediate the misconfiguration of having DMS replication public for AWS RDS using Python, you can follow these steps:

1. **Identify the Publicly Accessible DMS Replication Instance**:
   - Use the AWS SDK for Python (Boto3) to list all the DMS replication instances.
   - Check if any of the replication instances have a publicly accessible endpoint.

2. **Update the DMS Replication Instance to Not be Public**:
   - For each publicly accessible DMS replication instance, use the `modify_replication_instance` method in Boto3 to update the instance's `PubliclyAccessible` parameter to `False`.

3. **Python Script to Remediate**:
   ```python
   import boto3

   def remediate_public_dms_replication():
       client = boto3.client('dms')

       # List all DMS replication instances
       response = client.describe_replication_instances()

       for instance in response['ReplicationInstances']:
           if instance['PubliclyAccessible']:
               # Update the replication instance to not be publicly accessible
               client.modify_replication_instance(
                   ReplicationInstanceArn=instance['ReplicationInstanceArn'],
                   PubliclyAccessible=False
               )
               print(f"Updated DMS replication instance {instance['ReplicationInstanceArn']} to not be public.")

   if __name__ == '__main__':
       remediate_public_dms_replication()
   ```

4. **Run the Python Script**:
   - Save the above Python script to a file, for example, `remediate_public_dms.py`.
   - Run the script using Python, ensuring that you have the necessary IAM permissions to modify DMS replication instances.

5. **Verify the Remediation**:
   - After running the script, verify that the DMS replication instances are no longer publicly accessible by checking the `PubliclyAccessible` parameter for each instance.

By following these steps and running the provided Python script, you can successfully remediate the misconfiguration of having DMS replication public for AWS RDS.



</Tab>
</Tabs>