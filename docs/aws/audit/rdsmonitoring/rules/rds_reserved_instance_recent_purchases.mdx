---
slug: rds_reserved_instance_recent_purchases
title: RDS Reserved Instances Purchases Should Be Reviewed Every 7 Days
sidebar_label: RDS Reserved Instances Purchases Should Be Reviewed Every 7 Days
---

### More Info:

All Amazon RDS Reserved Instance (RI) purchases are reviewed every 7 days in order to confirm that no unwanted reservation purchase has been placed recently.

### Risk Level

Low

### Address

Cost Optimisation

### Compliance Standards

CBP


### Remediation

#### Using Console

To remediate the misconfiguration "RDS Reserved Instances Purchases Should Be Reviewed Every 7 Days" in AWS, please follow the below steps:

1. Open the AWS Management Console and navigate to the RDS Dashboard.
2. Click on the "Reserved Instances" tab on the left-hand side menu.
3. Review the list of all the reserved instances that are currently purchased.
4. Identify the reserved instances that have not been reviewed in the last 7 days.
5. Click on the "Modify" button next to the selected reserved instance.
6. Review the details of the reserved instance and make any necessary changes.
7. Click on the "Purchase" button to complete the purchase of the reserved instance.
8. Once the purchase is complete, review the reserved instances again to ensure that all purchases have been reviewed within the last 7 days.

By following these steps, you can remediate the misconfiguration "RDS Reserved Instances Purchases Should Be Reviewed Every 7 Days" in AWS.

#### Using CLI

To remediate the misconfiguration "RDS Reserved Instances Purchases Should Be Reviewed Every 7 Days" for AWS using AWS CLI, follow the below steps:

1. Open the AWS CLI and run the following command to list all the active RDS reserved instances:

   ```
   aws rds describe-reserved-db-instances --state active
   ```

2. Review the output and identify the RDS reserved instances that have been active for more than 7 days.

3. Once you have identified the RDS reserved instances that need to be reviewed, you can either modify or delete them based on your requirements.

   To modify a reserved instance, you can use the following command:

   ```
   aws rds modify-db-instance --reserved-db-instance-id <Reserved Instance ID> --apply-immediately
   ```

   This command will modify the specified RDS reserved instance and apply the changes immediately.

   To delete a reserved instance, you can use the following command:

   ```
   aws rds delete-db-instance --reserved-db-instance-id <Reserved Instance ID>
   ```

   This command will delete the specified RDS reserved instance.

4. After modifying or deleting the RDS reserved instances, run the first command again to ensure that all the active RDS reserved instances have been reviewed within the last 7 days.

By following these steps, you can remediate the misconfiguration "RDS Reserved Instances Purchases Should Be Reviewed Every 7 Days" for AWS using AWS CLI.

#### Using Python

To remediate the misconfiguration "RDS Reserved Instances Purchases Should Be Reviewed Every 7 Days" in AWS using Python, you can follow the below steps:

1. Import the necessary AWS SDKs and libraries in Python.
2. Use the AWS RDS client to get the list of all the Reserved Instances.
3. Check the purchase date of each Reserved Instance and compare it with the current date.
4. If the difference between the purchase date and the current date is more than 7 days, then send an email notification to the respective team to review the Reserved Instances purchases.
5. You can also automate this process by scheduling a Lambda function to run every 7 days to check the Reserved Instances purchases.

Here is a sample Python code that can help you in remediating this misconfiguration:

```
import boto3
from datetime import datetime, timedelta

# Create an RDS client
rds = boto3.client('rds')

# Get the list of all the Reserved Instances
reserved_instances = rds.describe_reserved_db_instances()

# Get the current date
current_date = datetime.now()

# Loop through each Reserved Instance
for reserved_instance in reserved_instances['ReservedDBInstances']:
    # Get the purchase date of the Reserved Instance
    purchase_date = reserved_instance['StartTime'].replace(tzinfo=None)
    
    # Calculate the difference between the purchase date and the current date
    difference = current_date - purchase_date
    
    # If the difference is more than 7 days, send an email notification to the respective team
    if difference.days > 7:
        # Code to send email notification
        print("Please review the Reserved Instance purchase for " + reserved_instance['DBInstanceClass'])
```

Note: This code is just a sample and you may need to modify it as per your specific requirements.


### Additional Reading:

- [https://aws.amazon.com/rds/reserved-instances/](https://aws.amazon.com/rds/reserved-instances/) 

