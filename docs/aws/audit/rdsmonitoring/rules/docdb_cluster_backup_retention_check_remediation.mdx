

<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to the RDS dashboard by selecting "Services" from the top menu, then selecting "RDS" under the "Database" category.
3. In the RDS dashboard, select "Databases" from the left-hand menu. This will display a list of all your RDS instances.
4. For each DocumentDB cluster, click on the cluster name to open its details page. Under the "Backup" section, check the "Backup Retention Period". If it's set to 0, it means that backups are not being retained and this is a misconfiguration.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local system. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all DocumentDB clusters: Use the `describe-db-clusters` command to list all the DocumentDB clusters. The command is as follows:

   ```
   aws docdb describe-db-clusters --query 'DBClusters[*].[DBClusterIdentifier]' --output text
   ```

   This command will return a list of all DocumentDB cluster identifiers.

3. Check backup retention period for each cluster: For each cluster identifier returned from the previous step, use the `describe-db-clusters` command again to get the backup retention period. The command is as follows:

   ```
   aws docdb describe-db-clusters --db-cluster-identifier <DBClusterIdentifier> --query 'DBClusters[*].[BackupRetentionPeriod]' --output text
   ```

   Replace `<DBClusterIdentifier>` with the actual cluster identifier. This command will return the backup retention period for the specified cluster.

4. Analyze the output: If the backup retention period is less than the desired value (for example, 7 days), then it is a misconfiguration. Repeat steps 3 and 4 for each cluster identifier.

#### Using Python

1. Install the necessary Python libraries: Before you start, make sure you have the necessary Python libraries installed. You will need the boto3 library, which is the Amazon Web Services (AWS) SDK for Python. It allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, and others. You can install it using pip:

   ```python
   pip install boto3
   ```

2. Set up AWS credentials: You need to configure your AWS credentials. You can set your credentials via the AWS CLI, or by manually creating the credentials file yourself. The default location for the file is `~/.aws/credentials`. At a minimum, the credentials file should look like this:

   ```python
   [default]
   aws_access_key_id = YOUR_ACCESS_KEY
   aws_secret_access_key = YOUR_SECRET_KEY
   ```

3. Create a Python script to check DocumentDB backup retention: Now, you can create a Python script that uses the boto3 library to interact with the AWS API and check the backup retention policy of your DocumentDB clusters. Here is a simple script that lists all DocumentDB clusters and their backup retention periods:

   ```python
   import boto3

   def check_backup_retention():
       client = boto3.client('docdb')
       response = client.describe_db_clusters()

       for db_cluster in response['DBClusters']:
           print(f"DB Cluster: {db_cluster['DBClusterIdentifier']}, Backup Retention Period: {db_cluster['BackupRetentionPeriod']} days")

   if __name__ == "__main__":
       check_backup_retention()
   ```

4. Run the script: Finally, you can run the script using your Python interpreter. The script will print the backup retention period for each DocumentDB cluster. If the backup retention period is less than your desired retention period, you have detected a misconfiguration.

   ```python
   python check_backup_retention.py
   ```

</Tab>

<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of missing backup retention settings for an AWS RDS DocumentDB cluster, you can follow these steps using the AWS Management Console:

1. **Login to AWS Console**: Go to the AWS Management Console (https://console.aws.amazon.com/) and login with your credentials.

2. **Navigate to RDS Service**: From the AWS Management Console, navigate to the RDS service by clicking on the "Services" dropdown in the top left corner and selecting "RDS" under the Database category.

3. **Select DocumentDB Cluster**: In the RDS dashboard, locate and select the DocumentDB cluster for which you want to configure backup retention settings.

4. **Modify Cluster**: Click on the cluster identifier to view the cluster details. Then, click on the "Modify" button at the top to edit the cluster settings.

5. **Configure Backup Retention**: Scroll down to the "Backup" section of the modification page. Here, you can set the backup retention period by specifying the number of days you want to retain automated backups for the cluster.

6. **Enable Automated Backups**: Ensure that the "Backup Retention Period" is set to a value greater than 0 to enable automated backups for the cluster. You can choose a retention period based on your backup and recovery requirements.

7. **Save Changes**: After setting the desired backup retention period, scroll to the bottom of the page and click on the "Continue" button. Review the summary of changes and click on the "Modify Cluster" button to apply the new backup retention settings.

8. **Verify Configuration**: Once the modification is complete, go back to the cluster details page and verify that the backup retention period is set correctly. You should see a confirmation that the backup retention settings have been updated successfully.

By following these steps, you can remediate the misconfiguration of missing backup retention settings for an AWS RDS DocumentDB cluster using the AWS Management Console.

#### Using CLI

To remediate the misconfiguration of a Document DB Cluster not having backup retention check in AWS RDS using AWS CLI, you can follow these steps:

1. **Identify the Document DB Cluster**: First, you need to identify the Document DB Cluster for which you want to enable backup retention.

2. **Enable Backup Retention**: Run the following AWS CLI command to modify the Document DB Cluster to enable backup retention with the desired retention period (in days). Replace `<cluster-identifier>` with the actual identifier of your Document DB Cluster and `<retention-period>` with the desired backup retention period.

```bash
aws rds modify-db-cluster --db-cluster-identifier <cluster-identifier> --backup-retention-period <retention-period>
```

3. **Verify Backup Retention**: To verify that the backup retention has been successfully enabled, you can describe the Document DB Cluster using the following AWS CLI command:

```bash
aws rds describe-db-clusters --db-cluster-identifier <cluster-identifier>
```

4. **Check Backup Retention Settings**: Ensure that the backup retention period is set to the desired value in the output of the above command.

By following these steps and executing the provided AWS CLI commands, you can remediate the misconfiguration of a Document DB Cluster not having backup retention check in AWS RDS.

#### Using Python

To remediate the misconfiguration of missing backup retention settings for an AWS RDS DocumentDB cluster using Python, you can use the AWS SDK for Python (Boto3) to update the backup retention period.

Here are the step-by-step instructions to remediate this issue:

1. Install Boto3:
   If you haven't already installed the Boto3 library, you can install it using pip:
   ```
   pip install boto3
   ```

2. Create a Python script to update the backup retention period:
   You can create a Python script with the following code snippet to update the backup retention period for the DocumentDB cluster:

   ```python
   import boto3

   # Define the AWS region and DocumentDB cluster identifier
   region = 'your_aws_region'
   cluster_identifier = 'your_documentdb_cluster_identifier'

   # Define the new backup retention period in days
   new_retention_period = 7

   # Create a DocumentDB client
   client = boto3.client('docdb', region_name=region)

   # Update the backup retention period for the DocumentDB cluster
   response = client.modify_db_cluster(
       DBClusterIdentifier=cluster_identifier,
       BackupRetentionPeriod=new_retention_period
   )

   print("Backup retention period updated successfully to {} days.".format(new_retention_period))
   ```

3. Configure AWS credentials:
   Ensure that your AWS credentials are properly configured on the machine where you will run this script. You can set up your AWS credentials using the AWS CLI or environment variables.

4. Run the Python script:
   Save the Python script with the above code snippet and run it. This script will update the backup retention period for the specified DocumentDB cluster to the desired value (in this case, 7 days).

By following these steps and running the Python script, you can remediate the misconfiguration of missing backup retention settings for an AWS RDS DocumentDB cluster.


</Tab>
</Tabs>