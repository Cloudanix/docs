---
slug: rds_enhanced_monitoring_enabled
title: Enhanced Monitoring Should Be Enabled For RDS Instances
sidebar_label: Enhanced Monitoring Should Be Enabled For RDS Instances
---

### More Info:

Checks if enhanced monitoring is enabled for Amazon RDS instances. This rule is NON_COMPLIANT if 'monitoringInterval' is '0' in the configuration item of the RDS instance, or if 'monitoringInterval' does not match the rule parameter value.

### Risk Level

Medium

### Addresses

Monitoring

### Compliance Standards

CBP,SEBI,RBI_MD_ITF


### Triage and Remediation
<Tabs>


<Tab title='Prevention'>
### How to Prevent
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To prevent the misconfiguration of not having Enhanced Monitoring enabled for RDS instances in AWS using the AWS Management Console, follow these steps:

1. **Navigate to RDS Dashboard:**
   - Open the AWS Management Console.
   - In the search bar, type "RDS" and select "RDS" from the dropdown to go to the RDS Dashboard.

2. **Select the RDS Instance:**
   - In the RDS Dashboard, click on "Databases" in the left-hand menu.
   - Select the RDS instance for which you want to enable Enhanced Monitoring.

3. **Modify the Instance:**
   - With the instance selected, click on the "Modify" button at the top right of the instance details page.

4. **Enable Enhanced Monitoring:**
   - Scroll down to the "Monitoring" section.
   - In the "Enhanced monitoring" dropdown, select the desired monitoring interval (e.g., 1 minute).
   - Choose an existing IAM role that has the necessary permissions for Enhanced Monitoring or create a new one if needed.
   - Scroll to the bottom of the page and click "Continue," then review the changes and click "Modify DB Instance" to apply the changes.

By following these steps, you can ensure that Enhanced Monitoring is enabled for your RDS instances, providing better insights and metrics for performance monitoring.
</Accordion>

<Accordion title='Using CLI'>
To prevent the misconfiguration of not having Enhanced Monitoring enabled for RDS instances using AWS CLI, follow these steps:

1. **Install and Configure AWS CLI:**
   Ensure that the AWS CLI is installed and configured with the necessary permissions to manage RDS instances.
   ```sh
   aws configure
   ```

2. **Enable Enhanced Monitoring for a New RDS Instance:**
   When creating a new RDS instance, you can enable Enhanced Monitoring by specifying the `--monitoring-interval` and `--monitoring-role-arn` parameters.
   ```sh
   aws rds create-db-instance \
       --db-instance-identifier mydbinstance \
       --db-instance-class db.t2.micro \
       --engine mysql \
       --allocated-storage 20 \
       --master-username admin \
       --master-user-password password \
       --monitoring-interval 60 \
       --monitoring-role-arn arn:aws:iam::123456789012:role/rds-monitoring-role
   ```

3. **Enable Enhanced Monitoring for an Existing RDS Instance:**
   To enable Enhanced Monitoring for an existing RDS instance, modify the instance with the `--monitoring-interval` and `--monitoring-role-arn` parameters.
   ```sh
   aws rds modify-db-instance \
       --db-instance-identifier mydbinstance \
       --monitoring-interval 60 \
       --monitoring-role-arn arn:aws:iam::123456789012:role/rds-monitoring-role \
       --apply-immediately
   ```

4. **Verify Enhanced Monitoring Configuration:**
   Confirm that Enhanced Monitoring is enabled by describing the RDS instance and checking the `MonitoringInterval` and `MonitoringRoleArn` fields.
   ```sh
   aws rds describe-db-instances \
       --db-instance-identifier mydbinstance \
       --query 'DBInstances[*].{DBInstanceIdentifier:DBInstanceIdentifier, MonitoringInterval:MonitoringInterval, MonitoringRoleArn:MonitoringRoleArn}'
   ```

By following these steps, you can ensure that Enhanced Monitoring is enabled for your RDS instances using the AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To prevent the misconfiguration of not having Enhanced Monitoring enabled for RDS instances in AWS, you can use the Boto3 library in Python. Here are the steps to ensure Enhanced Monitoring is enabled for your RDS instances:

1. **Install Boto3 Library**:
   Ensure you have the Boto3 library installed. If not, you can install it using pip.
   ```bash
   pip install boto3
   ```

2. **Set Up AWS Credentials**:
   Make sure your AWS credentials are configured. You can set them up using the AWS CLI or by creating a `~/.aws/credentials` file.

3. **Python Script to Enable Enhanced Monitoring**:
   Use the following Python script to enable Enhanced Monitoring for your RDS instances. This script will iterate over all RDS instances and enable Enhanced Monitoring if it is not already enabled.

   ```python
   import boto3

   # Initialize a session using Amazon RDS
   client = boto3.client('rds')

   # Function to enable Enhanced Monitoring
   def enable_enhanced_monitoring(instance_id, monitoring_interval=60):
       try:
           response = client.modify_db_instance(
               DBInstanceIdentifier=instance_id,
               MonitoringInterval=monitoring_interval,  # Monitoring interval in seconds
               ApplyImmediately=True
           )
           print(f"Enhanced Monitoring enabled for instance: {instance_id}")
       except Exception as e:
           print(f"Error enabling Enhanced Monitoring for instance {instance_id}: {e}")

   # Get all RDS instances
   def get_rds_instances():
       try:
           response = client.describe_db_instances()
           return response['DBInstances']
       except Exception as e:
           print(f"Error fetching RDS instances: {e}")
           return []

   # Main function
   def main():
       instances = get_rds_instances()
       for instance in instances:
           instance_id = instance['DBInstanceIdentifier']
           monitoring_interval = instance.get('MonitoringInterval', 0)
           if monitoring_interval == 0:
               enable_enhanced_monitoring(instance_id)
           else:
               print(f"Enhanced Monitoring already enabled for instance: {instance_id}")

   if __name__ == "__main__":
       main()
   ```

4. **Run the Script**:
   Execute the script to ensure Enhanced Monitoring is enabled for all your RDS instances.
   ```bash
   python enable_enhanced_monitoring.py
   ```

This script will check each RDS instance and enable Enhanced Monitoring if it is not already enabled. The `MonitoringInterval` parameter is set to 60 seconds by default, but you can adjust it as needed.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console.
2. Navigate to the RDS dashboard by selecting "Services" from the top menu, then selecting "RDS" under the "Database" category.
3. In the navigation pane, click on "Databases". This will display a list of all your RDS instances.
4. Select the RDS instance you want to check. In the "Details" section, look for the "Monitoring" tab. Under this tab, check the "Enhanced Monitoring" field. If it is set to "Disabled", then Enhanced Monitoring is not enabled for this RDS instance.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local system. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your AWS Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all RDS instances: Use the following AWS CLI command to list all the RDS instances in your AWS account.

   ```
   aws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier]' --output text
   ```

   This command will return a list of all RDS instance identifiers.

3. Check Enhanced Monitoring for each RDS instance: For each RDS instance, you can check if Enhanced Monitoring is enabled or not by using the following AWS CLI command:

   ```
   aws rds describe-db-instances --db-instance-identifier <DBInstanceIdentifier> --query 'DBInstances[*].[MonitoringInterval]' --output text
   ```

   Replace `<DBInstanceIdentifier>` with the identifier of the RDS instance you want to check. This command will return the monitoring interval for the specified RDS instance. If the returned value is '0', it means that Enhanced Monitoring is not enabled for this RDS instance.

4. Automate the process with a script: If you have many RDS instances, it would be more efficient to automate the process with a script. Here is a simple Python script that uses the AWS SDK (boto3) to check if Enhanced Monitoring is enabled for all RDS instances:

   ```python
   import boto3

   # Create a client for the AWS RDS service
   rds = boto3.client('rds')

   # Get a list of all RDS instances
   instances = rds.describe_db_instances()

   # For each RDS instance, check if Enhanced Monitoring is enabled
   for instance in instances['DBInstances']:
       if instance['MonitoringInterval'] == 0:
           print(f"Enhanced Monitoring is not enabled for RDS instance {instance['DBInstanceIdentifier']}")
   ```

   This script will print the identifiers of all RDS instances for which Enhanced Monitoring is not enabled.
</Accordion>

<Accordion title='Using Python'>
1. Install the necessary Python libraries: Before you can start writing the script, you need to install the necessary Python libraries. The AWS SDK for Python (Boto3) allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, etc. You can install it using pip:

   ```bash
   pip install boto3
   ```

2. Set up AWS credentials: You need to configure your AWS credentials. You can set your credentials for use by Boto3 in several ways. The quickest way to get started is to configure them in the AWS CLI:

   ```bash
   aws configure
   ```

   You'll be prompted to enter your AWS Access Key ID, Secret Access Key, default region name, and default output format.

3. Write the Python script: The following Python script uses Boto3 to check if Enhanced Monitoring is enabled for RDS instances:

   ```python
   import boto3

   def check_enhanced_monitoring():
       rds = boto3.client('rds')
       response = rds.describe_db_instances()
       for instance in response['DBInstances']:
           if instance['MonitoringInterval'] == 0:
               print(f"Enhanced Monitoring is not enabled for RDS instance: {instance['DBInstanceIdentifier']}")
           else:
               print(f"Enhanced Monitoring is enabled for RDS instance: {instance['DBInstanceIdentifier']}")

   check_enhanced_monitoring()
   ```

   This script retrieves a list of all RDS instances and checks the 'MonitoringInterval' attribute for each instance. If the 'MonitoringInterval' is 0, it means that Enhanced Monitoring is not enabled for that instance.

4. Run the Python script: You can run the Python script from your terminal:

   ```bash
   python check_enhanced_monitoring.py
   ```

   The script will print out the RDS instances for which Enhanced Monitoring is not enabled.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of not having Enhanced Monitoring enabled for RDS instances in AWS using the AWS Management Console, follow these step-by-step instructions:

1. **Login to AWS Console**: Go to the AWS Management Console (https://aws.amazon.com/console/) and login using your credentials.

2. **Navigate to RDS Service**: Click on the "Services" dropdown in the top left corner of the console, then select "RDS" under the "Database" category.

3. **Select RDS Instance**: In the Amazon RDS dashboard, select the RDS instance for which you want to enable Enhanced Monitoring.

4. **Enable Enhanced Monitoring**: Click on the RDS instance name to open the details page. In the navigation pane on the left, click on "Configuration" to expand the configuration options.

5. **Modify Instance**: Click on the "Modify" button at the top of the page to modify the instance settings.

6. **Enable Enhanced Monitoring**: Scroll down to the "Monitoring" section of the Modify DB Instance page. Look for the "Enhanced monitoring" option and select the desired monitoring level (e.g., Basic, Enhanced, or Performance Insights).

7. **Save Changes**: Scroll to the bottom of the page and click on the "Continue" button. Review the changes you are about to make, and then click on the "Modify DB Instance" button to apply the changes.

8. **Monitor Status**: Once the modification is complete, the status of the RDS instance will change to "modifying." You can monitor the progress of the modification in the RDS console.

9. **Verify Enhanced Monitoring**: After the modification is completed, go back to the RDS instance details page and check the monitoring section to ensure that Enhanced Monitoring is enabled for the instance.

By following these steps, you will successfully remediate the misconfiguration of not having Enhanced Monitoring enabled for RDS instances in AWS using the AWS Management Console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of not having Enhanced Monitoring enabled for RDS instances in AWS using AWS CLI, you can follow these steps:

Step 1: List all the RDS instances in your AWS account:
```bash
aws rds describe-db-instances
```

Step 2: Identify the RDS instance for which you want to enable Enhanced Monitoring.

Step 3: Enable Enhanced Monitoring for the identified RDS instance:
```bash
aws rds modify-db-instance --db-instance-identifier YOUR_DB_INSTANCE_IDENTIFIER --monitoring-interval 1
```
Replace `YOUR_DB_INSTANCE_IDENTIFIER` with the actual identifier of your RDS instance.

Step 4: Verify that Enhanced Monitoring is enabled for the RDS instance:
```bash
aws rds describe-db-instances --db-instance-identifier YOUR_DB_INSTANCE_IDENTIFIER
```

After following these steps, Enhanced Monitoring should be successfully enabled for the specified RDS instance in AWS using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of not having Enhanced Monitoring enabled for AWS RDS instances using Python, you can use the AWS SDK for Python (Boto3) to enable Enhanced Monitoring. Here are the step-by-step instructions to remediate this issue:

1. Install Boto3:
   If you haven't already installed the Boto3 library, you can do so using pip:
   ```
   pip install boto3
   ```

2. Configure AWS Credentials:
   Ensure that you have configured your AWS credentials either by setting environment variables or using the AWS CLI `aws configure` command.

3. Write a Python script:
   Create a Python script with the following code to enable Enhanced Monitoring for your RDS instance:

   ```python
   import boto3

   # Initialize the RDS client
   rds_client = boto3.client('rds')

   # Specify the RDS instance identifier for which you want to enable Enhanced Monitoring
   instance_identifier = 'your_rds_instance_identifier'

   # Enable Enhanced Monitoring for the specified RDS instance
   try:
       response = rds_client.modify_db_instance(
           DBInstanceIdentifier=instance_identifier,
           MonitoringInterval=60,  # Monitoring interval in seconds (1 minute)
           MonitoringRoleArn='arn:aws:iam::123456789012:role/monitoringRole',  # Replace with your IAM role ARN
           EnableEnhancedMonitoring=True
       )
       print(f"Enhanced Monitoring enabled for RDS instance {instance_identifier}")
   except Exception as e:
       print(f"Error enabling Enhanced Monitoring: {str(e)}")
   ```

4. Replace the placeholders:
   - Replace `'your_rds_instance_identifier'` with the actual RDS instance identifier for which you want to enable Enhanced Monitoring.
   - Replace `'arn:aws:iam::123456789012:role/monitoringRole'` with the ARN of the IAM role that has permissions to publish monitoring data to CloudWatch.

5. Run the Python script:
   Execute the Python script in your terminal or IDE to enable Enhanced Monitoring for the specified RDS instance. Make sure to review the output for any errors.

By following these steps and running the Python script, you can remediate the misconfiguration of not having Enhanced Monitoring enabled for AWS RDS instances.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>

