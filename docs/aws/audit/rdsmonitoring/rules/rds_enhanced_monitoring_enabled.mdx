---
slug: rds_enhanced_monitoring_enabled
title: Enhanced Monitoring Should Be Enabled For RDS Instances
sidebar_label: Enhanced Monitoring Should Be Enabled For RDS Instances
---

### More Info:

Checks if enhanced monitoring is enabled for Amazon RDS instances. This rule is NON_COMPLIANT if 'monitoringInterval' is '0' in the configuration item of the RDS instance, or if 'monitoringInterval' does not match the rule parameter value.

### Risk Level

Medium

### Addresses

Monitoring

### Compliance Standards

CBP,SEBI,RBI_MD_ITF



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to the RDS dashboard by selecting "Services" from the top menu and then selecting "RDS" under the "Database" category.
3. In the navigation pane, click on "Databases". This will display a list of all your RDS instances.
4. Select the RDS instance you want to check. In the "Details" section, look for the "Monitoring" tab. Under this tab, check the "Enhanced Monitoring" field. If it is set to "Disabled", then Enhanced Monitoring is not enabled for this RDS instance.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local system. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your AWS Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all RDS instances: Use the following AWS CLI command to list all the RDS instances in your AWS account.

   ```
   aws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier]' --output text
   ```

3. Check Enhanced Monitoring for each RDS instance: For each RDS instance, you need to check if Enhanced Monitoring is enabled or not. You can do this by running the following AWS CLI command for each RDS instance.

   ```
   aws rds describe-db-instances --db-instance-identifier <DBInstanceIdentifier> --query 'DBInstances[*].[MonitoringInterval]' --output text
   ```

   Replace `<DBInstanceIdentifier>` with the identifier of your RDS instance. If the output is '0', then Enhanced Monitoring is not enabled for that RDS instance.

4. Automate the process with a script: If you have many RDS instances, it would be more efficient to automate the process with a script. Here is a simple Python script that uses the AWS SDK (boto3) to check if Enhanced Monitoring is enabled for all RDS instances.

   ```python
   import boto3

   # Create a client for the AWS RDS service
   rds = boto3.client('rds')

   # List all RDS instances
   response = rds.describe_db_instances()

   # Check Enhanced Monitoring for each RDS instance
   for instance in response['DBInstances']:
       if instance['MonitoringInterval'] == 0:
           print(f"Enhanced Monitoring is not enabled for RDS instance: {instance['DBInstanceIdentifier']}")
   ```

   This script will print the identifiers of all RDS instances for which Enhanced Monitoring is not enabled.

#### Using Python

1. Install and configure AWS SDK for Python (Boto3): Before you can start writing Python scripts to check the RDS instances, you need to install and configure Boto3. You can install it using pip:

   ```
   pip install boto3
   ```
   Then, configure your AWS credentials either by setting up environment variables or by using the AWS CLI.

2. Import the necessary modules and create a session: In your Python script, you need to import Boto3 and create a session using your AWS credentials.

   ```python
   import boto3

   session = boto3.Session(
       aws_access_key_id='YOUR_ACCESS_KEY',
       aws_secret_access_key='YOUR_SECRET_KEY',
       region_name='us-west-2'
   )
   ```

3. Connect to the RDS service and retrieve all RDS instances: Using the session you created, you can connect to the RDS service and retrieve all RDS instances.

   ```python
   rds = session.client('rds')

   response = rds.describe_db_instances()
   ```

4. Check if Enhanced Monitoring is enabled for each RDS instance: You can iterate over the list of RDS instances and check the 'MonitoringInterval' attribute. If the value is greater than 0, then Enhanced Monitoring is enabled.

   ```python
   for instance in response['DBInstances']:
       if instance['MonitoringInterval'] > 0:
           print(f"Enhanced Monitoring is enabled for RDS instance: {instance['DBInstanceIdentifier']}")
       else:
           print(f"Enhanced Monitoring is not enabled for RDS instance: {instance['DBInstanceIdentifier']}")
   ```
This script will print out whether Enhanced Monitoring is enabled for each RDS instance in your AWS account.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of not having Enhanced Monitoring enabled for RDS instances in AWS using the AWS Management Console, follow these step-by-step instructions:

1. **Login to AWS Console**: Go to the AWS Management Console (https://aws.amazon.com/console/) and login using your credentials.

2. **Navigate to RDS Service**: Click on the "Services" dropdown in the top left corner of the console, then select "RDS" under the "Database" category.

3. **Select RDS Instance**: In the Amazon RDS dashboard, select the RDS instance for which you want to enable Enhanced Monitoring.

4. **Enable Enhanced Monitoring**: Click on the RDS instance name to open the details page. In the navigation pane on the left, click on "Configuration" to expand the configuration options.

5. **Modify Instance**: Click on the "Modify" button at the top of the page to modify the instance settings.

6. **Enable Enhanced Monitoring**: Scroll down to the "Monitoring" section of the Modify DB Instance page. Look for the "Enhanced monitoring" option and select the desired monitoring level (e.g., Basic, Enhanced, or Performance Insights).

7. **Save Changes**: Scroll to the bottom of the page and click on the "Continue" button. Review the changes you are about to make, and then click on the "Modify DB Instance" button to apply the changes.

8. **Monitor Status**: Once the modification is complete, the status of the RDS instance will change to "modifying." You can monitor the progress of the modification in the RDS console.

9. **Verify Enhanced Monitoring**: After the modification is completed, go back to the RDS instance details page and check the monitoring section to ensure that Enhanced Monitoring is enabled for the instance.

By following these steps, you will successfully remediate the misconfiguration of not having Enhanced Monitoring enabled for RDS instances in AWS using the AWS Management Console.

#### Using CLI

To remediate the misconfiguration of not having Enhanced Monitoring enabled for RDS instances in AWS using AWS CLI, you can follow these steps:

Step 1: List all the RDS instances in your AWS account:
```bash
aws rds describe-db-instances
```

Step 2: Identify the RDS instance for which you want to enable Enhanced Monitoring.

Step 3: Enable Enhanced Monitoring for the identified RDS instance:
```bash
aws rds modify-db-instance --db-instance-identifier YOUR_DB_INSTANCE_IDENTIFIER --monitoring-interval 1
```
Replace `YOUR_DB_INSTANCE_IDENTIFIER` with the actual identifier of your RDS instance.

Step 4: Verify that Enhanced Monitoring is enabled for the RDS instance:
```bash
aws rds describe-db-instances --db-instance-identifier YOUR_DB_INSTANCE_IDENTIFIER
```

After following these steps, Enhanced Monitoring should be successfully enabled for the specified RDS instance in AWS using AWS CLI.

#### Using Python

To remediate the misconfiguration of not having Enhanced Monitoring enabled for AWS RDS instances using Python, you can use the AWS SDK for Python (Boto3) to enable Enhanced Monitoring. Here are the step-by-step instructions to remediate this issue:

1. Install Boto3:
   If you haven't already installed the Boto3 library, you can do so using pip:
   ```
   pip install boto3
   ```

2. Configure AWS Credentials:
   Ensure that you have configured your AWS credentials either by setting environment variables or using the AWS CLI `aws configure` command.

3. Write a Python script:
   Create a Python script with the following code to enable Enhanced Monitoring for your RDS instance:

   ```python
   import boto3

   # Initialize the RDS client
   rds_client = boto3.client('rds')

   # Specify the RDS instance identifier for which you want to enable Enhanced Monitoring
   instance_identifier = 'your_rds_instance_identifier'

   # Enable Enhanced Monitoring for the specified RDS instance
   try:
       response = rds_client.modify_db_instance(
           DBInstanceIdentifier=instance_identifier,
           MonitoringInterval=60,  # Monitoring interval in seconds (1 minute)
           MonitoringRoleArn='arn:aws:iam::123456789012:role/monitoringRole',  # Replace with your IAM role ARN
           EnableEnhancedMonitoring=True
       )
       print(f"Enhanced Monitoring enabled for RDS instance {instance_identifier}")
   except Exception as e:
       print(f"Error enabling Enhanced Monitoring: {str(e)}")
   ```

4. Replace the placeholders:
   - Replace `'your_rds_instance_identifier'` with the actual RDS instance identifier for which you want to enable Enhanced Monitoring.
   - Replace `'arn:aws:iam::123456789012:role/monitoringRole'` with the ARN of the IAM role that has permissions to publish monitoring data to CloudWatch.

5. Run the Python script:
   Execute the Python script in your terminal or IDE to enable Enhanced Monitoring for the specified RDS instance. Make sure to review the output for any errors.

By following these steps and running the Python script, you can remediate the misconfiguration of not having Enhanced Monitoring enabled for AWS RDS instances.





</Tab>
</Tabs>