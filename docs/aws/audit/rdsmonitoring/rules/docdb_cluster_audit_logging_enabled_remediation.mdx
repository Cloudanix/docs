

<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to RDS dashboard at https://console.aws.amazon.com/rds/.
3. In the navigation pane, choose "Databases", and then choose the DocDB cluster that you want to examine.
4. In the "Summary" section, look for the "Cluster Details" section.
5. Under "Cluster Details", check the "Cloudwatch Logs Export" configuration. If the "Audit" option is not listed, then the Audit Logging is not enabled for the selected Amazon DocumentDB cluster.

#### Using CLI

1. First, you need to install and configure AWS CLI on your local machine. Make sure you have the necessary permissions to access the RDS resources.

2. Once the AWS CLI is set up, you can list all the DocDB clusters using the following command:

   ```
   aws docdb describe-db-clusters --query 'DBClusters[*].[DBClusterIdentifier]' --output text
   ```

   This command will return a list of all DocDB cluster identifiers.

3. For each DocDB cluster, you can check if the audit logging is enabled or not using the following command:

   ```
   aws docdb describe-db-clusters --db-cluster-identifier <your_db_cluster_identifier> --query 'DBClusters[*].[DBClusterIdentifier,EnabledCloudwatchLogsExports]' --output text
   ```

   Replace `<your_db_cluster_identifier>` with your actual DocDB cluster identifier. This command will return the cluster identifier and the status of the CloudWatch Logs export.

4. If the output of the above command does not include "audit", it means that the audit logging is not enabled for that particular DocDB cluster. You need to repeat this process for each DocDB cluster to check the audit logging status.

#### Using Python

To check if DocDB Cluster Audit Logging is enabled in RDS using Python scripts, you can use the Boto3 library, which allows you to write software that makes use of services like Amazon S3, Amazon EC2, etc. Here are the steps:

1. **Import the necessary libraries:**
   You need to import Boto3, the AWS SDK for Python, to interact with AWS services.

   ```python
   import boto3
   ```

2. **Create a session and client for RDS:**
   You need to create a session using your AWS credentials, and then create a client for RDS.

   ```python
   session = boto3.Session(
       aws_access_key_id='YOUR_ACCESS_KEY',
       aws_secret_access_key='YOUR_SECRET_KEY',
       region_name='us-west-2'
   )
   rds = session.client('rds')
   ```

3. **List all DocDB clusters and check their configurations:**
   You can use the `describe_db_clusters` method to get a list of all DocDB clusters, and then check the `EnabledCloudwatchLogsExports` field of each cluster to see if audit logging is enabled.

   ```python
   clusters = rds.describe_db_clusters()
   for cluster in clusters['DBClusters']:
       if 'EnabledCloudwatchLogsExports' in cluster:
           if 'audit' in cluster['EnabledCloudwatchLogsExports']:
               print(f"Audit logging is enabled for cluster {cluster['DBClusterIdentifier']}")
           else:
               print(f"Audit logging is NOT enabled for cluster {cluster['DBClusterIdentifier']}")
       else:
           print(f"Audit logging is NOT enabled for cluster {cluster['DBClusterIdentifier']}")
   ```

4. **Handle exceptions:**
   It's a good practice to handle exceptions in your script. For example, you can catch the `NoCredentialsError` exception, which is thrown when the Boto3 library can't find your AWS credentials.

   ```python
   try:
       # Your code here...
   except boto3.exceptions.NoCredentialsError:
       print("No AWS credentials found.")
   ```

Please replace `'YOUR_ACCESS_KEY'` and `'YOUR_SECRET_KEY'` with your actual AWS access key and secret key. Also, replace `'us-west-2'` with the AWS region that you're using.

</Tab>

<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the DocDB Cluster Audit Logging misconfiguration for AWS RDS using the AWS console, follow these step-by-step instructions:

1. **Sign in to the AWS Management Console**: Go to https://aws.amazon.com/ and sign in to the AWS Management Console using your credentials.

2. **Navigate to Amazon RDS Console**: Once you are logged in, navigate to the Amazon RDS console by clicking on the "Services" dropdown menu at the top of the page and selecting "RDS" under the "Database" category.

3. **Select the Amazon DocumentDB Cluster**: In the Amazon RDS console, locate and select the Amazon DocumentDB cluster for which you want to enable audit logging.

4. **Enable Audit Logging**: 
   - In the cluster details page, click on the "Modify" button in the upper right corner.
   - Scroll down to the "Database options" section.
   - Under the "Audit log configuration" section, select "Enable" for the "Audit log" option.
   - Choose the desired settings for the audit log, such as the S3 bucket where the logs will be stored, the IAM role that has permission to write to the bucket, and the KMS key for encryption (if needed).
   - Click on the "Continue" button.

5. **Apply Changes**: Review the changes you have made in the "Summary of modifications" section. If everything looks correct, click on the "Modify cluster" button to apply the changes.

6. **Monitor Audit Logging Status**: Once the modifications are applied, monitor the status of the audit logging configuration in the Amazon DocumentDB cluster details page. The status should change to "applying" and then "active" once the audit logging is successfully enabled.

By following these steps, you will remediate the misconfiguration by enabling audit logging for your Amazon DocumentDB cluster in AWS RDS using the AWS console.

#### Using CLI

To remediate the misconfiguration of DocDB Cluster Audit Logging not being enabled for AWS RDS using AWS CLI, follow these steps:

1. **Enable Logging for the Amazon DocumentDB Cluster**:
   
   Run the following AWS CLI command to enable audit logging for your Amazon DocumentDB cluster. Replace `cluster-identifier` with the actual identifier of your DocumentDB cluster.
   
   ```bash
   aws docdb modify-db-cluster --db-cluster-identifier <cluster-identifier> --enable-cloudwatch-logs-exports '["audit"]'
   ```

2. **Verify the Audit Logging Configuration**:

   Run the following command to verify that the audit logging configuration has been successfully updated for your DocumentDB cluster.
   
   ```bash
   aws docdb describe-db-clusters --db-cluster-identifier <cluster-identifier> --query 'DBClusters[0].EnabledCloudwatchLogsExports'
   ```

   This command should return an array with the value `[ "audit" ]`, indicating that audit logging has been enabled.

3. **Monitor the CloudWatch Logs**:

   Once the audit logging is enabled, you can monitor the logs in CloudWatch Logs to ensure that all the database activities are being logged appropriately.

By following these steps, you can remediate the misconfiguration of DocDB Cluster Audit Logging not being enabled for AWS RDS using AWS CLI.

#### Using Python

To remediate the misconfiguration of DocDB Cluster Audit Logging not being enabled for AWS RDS using Python, you can follow these steps:

1. Import the necessary Python libraries, such as `boto3`, which is the AWS SDK for Python.

```python
import boto3
```

2. Initialize the AWS RDS client using the `boto3.client` method.

```python
rds_client = boto3.client('rds')
```

3. Identify the DocDB Cluster for which you want to enable audit logging. You can do this by specifying the `DBClusterIdentifier` of the DocDB Cluster.

```python
docdb_cluster_identifier = 'your-docdb-cluster-identifier'
```

4. Enable audit logging for the DocDB Cluster by calling the `modify_db_cluster` method of the RDS client with the `EnableCloudwatchLogsExports` parameter set to include `'audit'`.

```python
response = rds_client.modify_db_cluster(
    DBClusterIdentifier=docdb_cluster_identifier,
    EnableCloudwatchLogsExports=[
        'audit'
    ]
)
```

5. Verify that the audit logging has been enabled successfully by checking the response from the `modify_db_cluster` API call.

```python
print(response)
```

By following these steps and running the Python script, you can remediate the misconfiguration of DocDB Cluster Audit Logging not being enabled for AWS RDS.

</Tab>
</Tabs>