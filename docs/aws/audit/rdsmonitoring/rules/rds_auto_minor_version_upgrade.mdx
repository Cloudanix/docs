---
slug: rds_auto_minor_version_upgrade
title: Auto Minor Version Upgrade flag Should Be Enabled
sidebar_label: Auto Minor Version Upgrade flag Should Be Enabled
---

### More Info:

Your RDS database instances should have the Auto Minor Version Upgrade flag enabled in order to receive automatically minor engine upgrades during the specified maintenance window

### Risk Level

Low

### Address

Security

### Compliance Standards

AWSWAF, SOC2, NISTCSF


### Triage and Remediation
<Tabs>


<Tab title='Prevention'>
### How to Prevent
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To prevent the misconfiguration where the "Auto Minor Version Upgrade" flag should be enabled in Amazon RDS using the AWS Management Console, follow these steps:

1. **Navigate to RDS Dashboard:**
   - Sign in to the AWS Management Console.
   - In the top search bar, type "RDS" and select "RDS" from the dropdown to go to the RDS Dashboard.

2. **Select the DB Instance:**
   - In the RDS Dashboard, click on "Databases" in the left-hand menu.
   - From the list of DB instances, select the DB instance for which you want to enable the Auto Minor Version Upgrade.

3. **Modify the DB Instance:**
   - With the DB instance selected, click on the "Modify" button at the top right of the instance details page.

4. **Enable Auto Minor Version Upgrade:**
   - In the "Modify DB Instance" page, scroll down to the "DB Engine Version" section.
   - Check the box for "Auto minor version upgrade."
   - Scroll to the bottom of the page and click on the "Continue" button.
   - Review the changes and click on the "Modify DB Instance" button to apply the changes.

By following these steps, you ensure that the Auto Minor Version Upgrade flag is enabled, which helps in keeping your RDS instance up-to-date with the latest minor version releases.
</Accordion>

<Accordion title='Using CLI'>
To prevent the misconfiguration where the "Auto Minor Version Upgrade" flag should be enabled in Amazon RDS using AWS CLI, follow these steps:

1. **Describe the Current RDS Instances:**
   First, identify the RDS instances that do not have the "Auto Minor Version Upgrade" flag enabled.
   ```sh
   aws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier,AutoMinorVersionUpgrade]'
   ```

2. **Modify the RDS Instance:**
   For each RDS instance that does not have the "Auto Minor Version Upgrade" flag enabled, modify the instance to enable it.
   ```sh
   aws rds modify-db-instance --db-instance-identifier <your-db-instance-identifier> --auto-minor-version-upgrade
   ```

3. **Apply Changes Immediately:**
   If you want the changes to take effect immediately, you can add the `--apply-immediately` flag.
   ```sh
   aws rds modify-db-instance --db-instance-identifier <your-db-instance-identifier> --auto-minor-version-upgrade --apply-immediately
   ```

4. **Verify the Changes:**
   After modifying the RDS instances, verify that the "Auto Minor Version Upgrade" flag is now enabled.
   ```sh
   aws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier,AutoMinorVersionUpgrade]'
   ```

By following these steps, you can ensure that the "Auto Minor Version Upgrade" flag is enabled for your RDS instances using the AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To prevent the misconfiguration where the "Auto Minor Version Upgrade" flag should be enabled in Amazon RDS using Python scripts, you can use the Boto3 library, which is the AWS SDK for Python. Below are the steps to ensure this configuration is set correctly:

1. **Install Boto3 Library**:
   Ensure you have the Boto3 library installed. If not, you can install it using pip.
   ```bash
   pip install boto3
   ```

2. **Set Up AWS Credentials**:
   Make sure your AWS credentials are configured. You can set them up using the AWS CLI or by directly configuring the `~/.aws/credentials` file.

3. **Python Script to Enable Auto Minor Version Upgrade**:
   Use the following Python script to enable the "Auto Minor Version Upgrade" flag for your RDS instances.

   ```python
   import boto3

   # Initialize a session using Amazon RDS
   client = boto3.client('rds')

   # Function to enable Auto Minor Version Upgrade
   def enable_auto_minor_version_upgrade(db_instance_identifier):
       try:
           response = client.modify_db_instance(
               DBInstanceIdentifier=db_instance_identifier,
               AutoMinorVersionUpgrade=True,
               ApplyImmediately=True
           )
           print(f"Auto Minor Version Upgrade enabled for {db_instance_identifier}")
       except Exception as e:
           print(f"Error enabling Auto Minor Version Upgrade for {db_instance_identifier}: {e}")

   # List of RDS instances to update
   db_instances = ['your-db-instance-identifier-1', 'your-db-instance-identifier-2']

   # Enable Auto Minor Version Upgrade for each instance
   for db_instance in db_instances:
       enable_auto_minor_version_upgrade(db_instance)
   ```

4. **Run the Script**:
   Execute the script to apply the changes. Ensure you have the necessary permissions to modify RDS instances.

   ```bash
   python enable_auto_minor_version_upgrade.py
   ```

This script will iterate over the list of RDS instances you provide and enable the "Auto Minor Version Upgrade" flag for each one. Make sure to replace `'your-db-instance-identifier-1'` and `'your-db-instance-identifier-2'` with your actual RDS instance identifiers.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Log in to the AWS Management Console and open the Amazon RDS console at https://console.aws.amazon.com/rds/.

2. In the navigation pane, choose "Databases".

3. Choose the name of the DB instance that you want to check.

4. In the "Details" section, look for the "Maintenance & backups" section. 

5. Check the "Auto minor version upgrade" field. If it is set to "No", then the Auto Minor Version Upgrade flag is not enabled.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local system. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all RDS instances: Use the following command to list all the RDS instances in your AWS account.

   ```
   aws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier]' --output text
   ```

3. Check Auto Minor Version Upgrade flag: For each RDS instance, you can check the Auto Minor Version Upgrade flag by using the following command. Replace `db-instance-identifier` with the actual ID of your RDS instance.

   ```
   aws rds describe-db-instances --db-instance-identifier db-instance-identifier --query 'DBInstances[*].[AutoMinorVersionUpgrade]' --output text
   ```

4. Analyze the output: If the output of the above command is 'true', then the Auto Minor Version Upgrade flag is enabled for that RDS instance. If the output is 'false', then it is not enabled. Repeat this process for each RDS instance in your AWS account.
</Accordion>

<Accordion title='Using Python'>
To check if the Auto Minor Version Upgrade flag is enabled in RDS using Python scripts, you can use the Boto3 library, which allows you to directly interact with AWS services, including RDS. Here are the steps:

1. **Import the Boto3 library in Python:**
   Boto3 is the Amazon Web Services (AWS) Software Development Kit (SDK) for Python, which allows Python developers to write software that makes use of AWS services like Amazon S3, Amazon EC2, etc. If you haven't installed it yet, you can do so using pip:
   ```python
   pip install boto3
   ```
   Then, import it in your script:
   ```python
   import boto3
   ```

2. **Create an RDS client:**
   You need to create an RDS client to interact with the RDS instances. You can do this using the `boto3.client()` function. You'll need to provide your AWS credentials (access key and secret access key) and the region in which your RDS instances are located.
   ```python
   rds = boto3.client('rds', aws_access_key_id='YOUR_ACCESS_KEY',
                      aws_secret_access_key='YOUR_SECRET_KEY', region_name='YOUR_REGION_NAME')
   ```

3. **List all RDS instances:**
   Use the `describe_db_instances()` function to get a list of all RDS instances.
   ```python
   instances = rds.describe_db_instances()
   ```

4. **Check the Auto Minor Version Upgrade flag:**
   Iterate over the instances and check the `AutoMinorVersionUpgrade` attribute. If it's set to False, then the Auto Minor Version Upgrade flag is not enabled.
   ```python
   for instance in instances['DBInstances']:
       if not instance['AutoMinorVersionUpgrade']:
           print(f"Auto Minor Version Upgrade flag is not enabled for instance {instance['DBInstanceIdentifier']}")
   ```
This script will print out the identifiers of all RDS instances for which the Auto Minor Version Upgrade flag is not enabled.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of the "Auto Minor Version Upgrade" flag not being enabled for an AWS RDS instance using the AWS Management Console, follow these steps:

1. **Sign in to the AWS Management Console**: Go to https://aws.amazon.com/ and sign in to the AWS Management Console using your credentials.

2. **Navigate to the RDS Dashboard**: Click on the "Services" dropdown menu at the top of the page, select "RDS" under the Database category.

3. **Select the RDS Instance**: From the list of RDS instances, select the instance for which you want to enable the "Auto Minor Version Upgrade" flag by clicking on its identifier.

4. **Modify the Instance**: In the RDS dashboard for the selected instance, click on the "Modify" button located in the top right corner of the page.

5. **Enable Auto Minor Version Upgrade**: Scroll down to the "Backup" section of the Modify DB Instance page. Here, you will find the "Auto minor version upgrade" option. Check the box next to this option to enable automatic minor version upgrades for your RDS instance.

6. **Save Changes**: Scroll to the bottom of the page and click on the "Continue" button.

7. **Apply Changes**: Review the changes you are about to make and click on the "Modify DB Instance" button to apply the changes.

8. **Monitor the Status**: Once the modification is complete, monitor the status of the RDS instance to ensure that the "Auto Minor Version Upgrade" flag is now enabled.

By following these steps, you have remediated the misconfiguration of the "Auto Minor Version Upgrade" flag not being enabled for your AWS RDS instance using the AWS Management Console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of the "Auto Minor Version Upgrade" flag not being enabled for an AWS RDS instance using AWS CLI, follow these steps:

1. **Identify the RDS Instance**: First, you need to identify the AWS RDS instance for which you want to enable the Auto Minor Version Upgrade flag. You can do this by listing all the RDS instances in your AWS account using the following AWS CLI command:
   ```
   aws rds describe-db-instances
   ```

2. **Enable Auto Minor Version Upgrade**: Once you have identified the RDS instance, you can enable the Auto Minor Version Upgrade flag by running the following AWS CLI command:
   ```
   aws rds modify-db-instance --db-instance-identifier <your-rds-instance-name> --auto-minor-version-upgrade --apply-immediately
   ```
   Replace `<your-rds-instance-name>` with the actual name of your RDS instance.

3. **Verify the Configuration**: After running the above command, the Auto Minor Version Upgrade flag should be enabled for your RDS instance. You can verify this by describing the RDS instance again using the AWS CLI command:
   ```
   aws rds describe-db-instances --db-instance-identifier <your-rds-instance-name>
   ```
   Ensure that the `AutoMinorVersionUpgrade` parameter is set to `true` in the output.

By following these steps, you can remediate the misconfiguration of the Auto Minor Version Upgrade flag not being enabled for an AWS RDS instance using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of the "Auto Minor Version Upgrade" flag not being enabled for an AWS RDS instance using Python, you can use the AWS SDK for Python (Boto3) to update the RDS instance's configuration. Here are the step-by-step instructions:

1. Install Boto3: Ensure that you have the Boto3 library installed. You can install it using pip:
   ```
   pip install boto3
   ```

2. Configure AWS Credentials: Make sure you have your AWS credentials configured either through environment variables, AWS CLI configuration, or IAM role assigned to the instance running the script.

3. Write Python script: Create a Python script with the following code to enable the "Auto Minor Version Upgrade" flag for the RDS instance:

   ```python
   import boto3

   # Initialize the RDS client
   rds_client = boto3.client('rds', region_name='your-aws-region')

   # Specify the RDS instance identifier
   db_instance_identifier = 'your-rds-instance-id'

   # Enable Auto Minor Version Upgrade for the specified RDS instance
   response = rds_client.modify_db_instance(
       DBInstanceIdentifier=db_instance_identifier,
       AutoMinorVersionUpgrade=True
   )

   print(f"Auto Minor Version Upgrade enabled for RDS instance {db_instance_identifier}")
   ```

   Make sure to replace `'your-aws-region'` with the AWS region where your RDS instance is located and `'your-rds-instance-id'` with the actual identifier of your RDS instance.

4. Run the script: Execute the Python script you created in step 3. This will enable the "Auto Minor Version Upgrade" flag for the specified RDS instance.

5. Verify: You can verify that the configuration has been updated by checking the RDS instance details in the AWS Management Console or by running describe_db_instances API call using Boto3.

By following these steps, you can remediate the misconfiguration of the "Auto Minor Version Upgrade" flag not being enabled for an AWS RDS instance using Python and Boto3.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_UpgradeDBInstance.Upgrading.html](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_UpgradeDBInstance.Upgrading.html) 

