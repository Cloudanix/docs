---
slug: rds_db_instance_generation
title: RDS Instances Should Use Latest Generation of Instance Classes
sidebar_label: RDS Instances Should Use Latest Generation of Instance Classes
---

### More Info:

All RDS databases instances provisioned within your AWS account should be using the latest generation of instance classes in order to get the best performance with lower costs.

### Risk Level

Medium

### Address

Reliability, Security

### Compliance Standards

CBP


### Triage and Remediation
<Tabs>


<Tab title='Prevention'>
### How to Prevent
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To prevent RDS instances from using outdated generation instance classes in AWS using the AWS Management Console, follow these steps:

1. **Navigate to RDS Dashboard:**
   - Sign in to the AWS Management Console.
   - Open the Amazon RDS console at [https://console.aws.amazon.com/rds/](https://console.aws.amazon.com/rds/).

2. **Modify Existing Instances:**
   - In the navigation pane, choose "Databases" to view your RDS instances.
   - Select the RDS instance you want to update.
   - Choose the "Modify" button.

3. **Select Latest Generation Instance Class:**
   - In the "DB instance class" section, choose the latest generation instance class from the dropdown menu. AWS typically labels the latest generation with a higher number (e.g., `db.m6g.large` instead of `db.m5.large`).

4. **Apply Changes:**
   - Scroll down and choose whether to apply the changes immediately or during the next maintenance window.
   - Review the changes and choose "Modify DB Instance" to save your settings.

By following these steps, you ensure that your RDS instances are using the latest generation of instance classes, which can provide better performance and cost-efficiency.
</Accordion>

<Accordion title='Using CLI'>
To ensure that your RDS instances use the latest generation of instance classes in AWS using the AWS CLI, you can follow these steps:

1. **List Available DB Instance Classes:**
   First, you need to list the available DB instance classes to identify the latest generation instance classes.
   ```sh
   aws rds describe-orderable-db-instance-options --engine mysql --query 'OrderableDBInstanceOptions[*].DBInstanceClass' --output text
   ```

2. **Modify Existing RDS Instances:**
   Modify your existing RDS instances to use the latest generation instance class. Replace `db-instance-identifier` with your actual RDS instance identifier and `db.m5.large` with the latest generation instance class you want to use.
   ```sh
   aws rds modify-db-instance --db-instance-identifier mydbinstance --db-instance-class db.m5.large --apply-immediately
   ```

3. **Create New RDS Instances with Latest Generation:**
   When creating new RDS instances, specify the latest generation instance class. Replace `db.m5.large` with the desired instance class.
   ```sh
   aws rds create-db-instance --db-instance-identifier mynewdbinstance --db-instance-class db.m5.large --engine mysql --allocated-storage 20 --master-username admin --master-user-password password
   ```

4. **Automate Instance Class Selection:**
   To automate the selection of the latest generation instance class, you can use a script or a configuration management tool to dynamically fetch and apply the latest instance class. Here is an example of a simple script to fetch the latest instance class and modify an existing RDS instance:
   ```sh
   latest_instance_class=$(aws rds describe-orderable-db-instance-options --engine mysql --query 'OrderableDBInstanceOptions[?contains(DBInstanceClass, `db.m5`) == `true`].DBInstanceClass' --output text | sort | tail -n 1)
   aws rds modify-db-instance --db-instance-identifier mydbinstance --db-instance-class $latest_instance_class --apply-immediately
   ```

By following these steps, you can ensure that your RDS instances are using the latest generation of instance classes, thereby optimizing performance and cost-efficiency.
</Accordion>

<Accordion title='Using Python'>
To prevent RDS instances from using outdated instance classes and ensure they use the latest generation of instance classes, you can use Python scripts to automate the process. Below are the steps to achieve this:

### 1. Install Required Libraries
First, ensure you have the necessary libraries installed. You will need `boto3` for AWS interactions.

```bash
pip install boto3
```

### 2. Initialize Boto3 Client
Set up the Boto3 client to interact with AWS RDS.

```python
import boto3

# Initialize a session using Amazon RDS
session = boto3.Session(
    aws_access_key_id='YOUR_AWS_ACCESS_KEY',
    aws_secret_access_key='YOUR_AWS_SECRET_KEY',
    region_name='YOUR_AWS_REGION'
)

rds_client = session.client('rds')
```

### 3. List All RDS Instances
Fetch the list of all RDS instances to check their instance classes.

```python
def list_rds_instances():
    response = rds_client.describe_db_instances()
    return response['DBInstances']

rds_instances = list_rds_instances()
```

### 4. Check and Update Instance Classes
Compare the instance classes of the RDS instances with the latest generation and update them if necessary.

```python
# Define the latest generation instance classes
latest_instance_classes = {
    'db.m5.large': 'db.m6g.large',
    'db.m5.xlarge': 'db.m6g.xlarge',
    # Add other mappings as needed
}

def update_instance_class(instance_id, current_class):
    if current_class in latest_instance_classes:
        new_class = latest_instance_classes[current_class]
        print(f"Updating {instance_id} from {current_class} to {new_class}")
        rds_client.modify_db_instance(
            DBInstanceIdentifier=instance_id,
            DBInstanceClass=new_class,
            ApplyImmediately=True
        )
    else:
        print(f"No update needed for {instance_id} with class {current_class}")

for instance in rds_instances:
    instance_id = instance['DBInstanceIdentifier']
    instance_class = instance['DBInstanceClass']
    update_instance_class(instance_id, instance_class)
```

### Summary
1. **Install Required Libraries**: Ensure `boto3` is installed.
2. **Initialize Boto3 Client**: Set up the Boto3 client with your AWS credentials and region.
3. **List All RDS Instances**: Fetch the list of all RDS instances.
4. **Check and Update Instance Classes**: Compare and update the instance classes to the latest generation if necessary.

This script will help you automate the process of ensuring that your RDS instances are using the latest generation of instance classes.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console.
2. Navigate to the RDS dashboard by selecting "Services" from the top menu, then selecting "RDS" under the "Database" category.
3. In the RDS dashboard, select "Databases" from the left-hand menu. This will display a list of all your RDS instances.
4. For each instance, check the "Instance class" column. If the instance class is not the latest generation (for example, db.m5 instead of db.m4), then it is a misconfiguration.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local system. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your AWS Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all RDS instances: Use the following AWS CLI command to list all the RDS instances in your account:

   ```
   aws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier,Engine,DBInstanceClass]'
   ```

   This command will return a list of all RDS instances along with their identifiers, engine types, and instance classes.

3. Check the instance class of each RDS instance: The instance class of each RDS instance is listed in the output of the previous command. The latest generation of instance classes for RDS start with 'db.' followed by the instance type (e.g., 'db.t3.micro'). If any of your RDS instances are not using the latest generation of instance classes, they will have a different prefix (e.g., 'db.m1.small').

4. Filter out older generation instances: You can modify the previous command to only return instances that are not using the latest generation of instance classes. Here's an example:

   ```
   aws rds describe-db-instances --query 'DBInstances[?starts_with(DBInstanceClass, `db.m1`) == `true`].[DBInstanceIdentifier,Engine,DBInstanceClass]'
   ```

   This command will return a list of all RDS instances that are using the 'db.m1' instance class, which is not the latest generation. You can replace 'db.m1' with any other instance class prefix to check for other older generations.
</Accordion>

<Accordion title='Using Python'>
1. Import the necessary libraries: You will need the boto3 library, which allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, etc.

```python
import boto3
```

2. Create a session using your AWS credentials. You can also use the AWS CLI's default configuration.

```python
session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    region_name='us-west-2'
)
```

3. Create a client for RDS and get all DB instances:

```python
rds = session.client('rds')
response = rds.describe_db_instances()
```

4. Check the instance class of each DB instance. If the instance class is not the latest generation, print a message:

```python
for instance in response['DBInstances']:
    instance_class = instance['DBInstanceClass']
    if not instance_class.startswith('db.m5') and not instance_class.startswith('db.r5'):
        print(f"DB instance {instance['DBInstanceIdentifier']} is not using the latest generation of instance classes.")
```

This script checks if the RDS instances are using the latest generation of instance classes (m5 and r5). If not, it prints a message with the instance identifier. Please replace 'YOUR_ACCESS_KEY' and 'YOUR_SECRET_KEY' with your actual AWS access key and secret key.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of RDS instances not using the latest generation of instance classes in AWS, you can follow these steps using the AWS Management Console:

1. **Log in to the AWS Management Console**: Go to https://aws.amazon.com/ and log in to your AWS account using your credentials.

2. **Navigate to RDS Service**: Click on the "Services" dropdown menu at the top of the page and select "RDS" under the Database category.

3. **Select the RDS Instance**: In the RDS dashboard, select the RDS instance that you want to update to the latest generation of instance classes.

4. **Modify the Instance**: Click on the instance ID of the RDS instance to go to its details page. Then, click on the "Modify" button at the top of the page.

5. **Choose Instance Class**: In the Modify RDS Instance page, scroll down to the "DB Instance Class" section. Click on the dropdown menu and select the latest generation of instance class that you want to use for your RDS instance.

6. **Apply Changes**: Review the other configuration settings if needed, and then scroll down to the bottom of the page and click on the "Continue" button.

7. **Apply Immediately or Schedule**: Choose whether you want to apply the changes immediately or schedule the modification for a later time. Select the appropriate option and click on the "Modify DB Instance" button.

8. **Monitor the Modification**: The modification process will start, and you can monitor the progress on the RDS dashboard. Once the modification is complete, the RDS instance will be using the latest generation of instance classes.

By following these steps, you can remediate the misconfiguration of RDS instances not using the latest generation of instance classes in AWS.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of RDS instances not using the latest generation of instance classes in AWS, you can follow these steps using the AWS CLI:

1. List all the existing RDS instances to identify the instances that are not using the latest generation of instance classes:
```bash
aws rds describe-db-instances
```

2. Identify the instances that are not using the latest generation of instance classes based on the `DBInstanceClass` attribute.

3. Modify the RDS instance to use the latest generation of instance classes. You can do this by modifying the instance with the `modify-db-instance` command. Replace `your-db-instance-identifier` with the identifier of the RDS instance you want to modify and `db.t3.medium` with the desired latest generation instance class:
```bash
aws rds modify-db-instance --db-instance-identifier your-db-instance-identifier --db-instance-class db.t3.medium
```

4. Monitor the modification progress by describing the RDS instance and checking the `DBInstanceClass` attribute:
```bash
aws rds describe-db-instances --db-instance-identifier your-db-instance-identifier
```

5. Verify that the RDS instance is now using the latest generation of instance class.

By following these steps, you can remediate the misconfiguration of RDS instances not using the latest generation of instance classes in AWS using the AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of RDS instances not using the latest generation of instance classes in AWS, you can use the AWS SDK for Python (Boto3) to update the instance classes. Below are the step-by-step instructions on how to remediate this issue using Python:

1. Install Boto3:
   If you haven't installed Boto3, you can do so using pip:
   ```bash
   pip install boto3
   ```

2. Configure AWS Credentials:
   Make sure you have configured your AWS credentials with the necessary permissions to modify RDS instances. You can set up your credentials using AWS CLI or by setting environment variables.

3. Write Python script to update RDS instance classes:
   Use the following Python script to update the RDS instances to use the latest generation of instance classes:

   ```python
   import boto3

   # Initialize the RDS client
   rds_client = boto3.client('rds')

   # Get a list of all RDS instances
   response = rds_client.describe_db_instances()

   # Iterate over each RDS instance and update the instance class
   for db_instance in response['DBInstances']:
       db_instance_identifier = db_instance['DBInstanceIdentifier']
       current_instance_class = db_instance['DBInstanceClass']
       latest_instance_class = 'db.m5.large'  # Replace with the latest instance class

       if current_instance_class != latest_instance_class:
           print(f"Updating instance {db_instance_identifier} from {current_instance_class} to {latest_instance_class}")
           rds_client.modify_db_instance(DBInstanceIdentifier=db_instance_identifier, DBInstanceClass=latest_instance_class)
   ```

   Make sure to replace `'db.m5.large'` with the latest generation instance class that you want to update the RDS instances to.

4. Run the Python script:
   Save the script in a file (e.g., `update_rds_instance_classes.py`) and run it using Python:
   ```bash
   python update_rds_instance_classes.py
   ```

5. Verify the changes:
   After running the script, check the AWS Management Console or use Boto3 to confirm that the RDS instances have been updated to use the latest generation of instance classes.

By following these steps, you can remediate the misconfiguration of RDS instances not using the latest generation of instance classes in AWS using Python and Boto3.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://aws.amazon.com/rds/instance-types/](https://aws.amazon.com/rds/instance-types/) 

