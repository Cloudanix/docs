---
slug: vpc_changes_alarm
title: VPC Changes Alarm
sidebar_label: VPC Changes Alarm
---

### More Info:

AWS VPCs configuration changes should be monitored using CloudWatch alarms.

### Risk Level

Medium

### Address

Security

### Compliance Standards

CISAWS, CBP, SOC2, NIST, HIPAA, ISO27001, AWSWAF, HITRUST, NISTCSF



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and open the CloudWatch console at https://console.aws.amazon.com/cloudwatch/.

2. In the navigation pane, click on "Alarms".

3. In the "Alarms" dashboard, you can see all the alarms that have been set up. Look for the VPC Changes Alarm. If it's in the "ALARM" state, it means that the changes in the VPC have crossed the threshold set for the alarm.

4. For more details, click on the alarm name. You can see the metrics and conditions that are associated with the alarm. This will give you an idea of what changes in the VPC have triggered the alarm.

#### Using CLI

1. **Install and Configure AWS CLI**: Before you can start using AWS CLI, you need to install it on your local machine. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. **List Existing CloudWatch Alarms**: To check if there is an existing VPC Changes Alarm, you can use the `describe-alarms` command. This command will list all the alarms that are currently set up in your AWS account. The command is as follows: 
```
aws cloudwatch describe-alarms
```
This will return a list of all the alarms, including their names, states, and other details.

3. **Filter Alarms for VPC Changes**: Since the output from the previous command can be quite large, you might want to filter it to only show alarms related to VPC changes. You can do this by piping the output to a `grep` command like this:
```
aws cloudwatch describe-alarms | grep "VPC Changes"
```
This will only show alarms that have "VPC Changes" in their name or description.

4. **Check Alarm Details**: If you find an alarm related to VPC changes, you can check its details using the `describe-alarms` command again, but this time with the `--alarm-names` option followed by the name of the alarm. The command is as follows:
```
aws cloudwatch describe-alarms --alarm-names "Your VPC Changes Alarm Name"
```
This will return detailed information about the alarm, including its state, associated actions, and metric.


#### Using Python

1. **Setup AWS SDK (Boto3) in Python Environment:**
   First, you need to set up the AWS SDK (Boto3) in your Python environment. You can install it using pip:
   ```
   pip install boto3
   ```
   After installing boto3, configure your AWS credentials either by setting up environment variables or by using the AWS CLI.

2. **Create a Python Script to Fetch CloudWatch Alarms:**
   You can use the `describe_alarms` method provided by the CloudWatch client in boto3 to fetch all the alarms. Here is a sample script:

   ```python
   import boto3

   def get_cloudwatch_alarms():
       cloudwatch = boto3.client('cloudwatch')
       alarms = cloudwatch.describe_alarms()
       return alarms['MetricAlarms']

   alarms = get_cloudwatch_alarms()
   for alarm in alarms:
       print(alarm['AlarmName'])
   ```
   This script will print the names of all the alarms in CloudWatch.

3. **Filter Alarms for VPC Changes:**
   Now, you need to filter out the alarms related to VPC changes. You can do this by checking the `MetricName` and `Namespace` of each alarm. Here is how you can modify the above script to do this:

   ```python
   import boto3

   def get_cloudwatch_alarms():
       cloudwatch = boto3.client('cloudwatch')
       alarms = cloudwatch.describe_alarms()
       return alarms['MetricAlarms']

   alarms = get_cloudwatch_alarms()
   for alarm in alarms:
       if alarm['Namespace'] == 'AWS/EC2' and 'VPC' in alarm['MetricName']:
           print(alarm['AlarmName'])
   ```
   This script will print the names of all the alarms related to VPC changes.

4. **Check Alarm State:**
   Finally, you can check the state of each alarm to see if it is in the `ALARM` state. Here is how you can modify the above script to do this:

   ```python
   import boto3

   def get_cloudwatch_alarms():
       cloudwatch = boto3.client('cloudwatch')
       alarms = cloudwatch.describe_alarms()
       return alarms['MetricAlarms']

   alarms = get_cloudwatch_alarms()
   for alarm in alarms:
       if alarm['Namespace'] == 'AWS/EC2' and 'VPC' in alarm['MetricName']:
           if alarm['StateValue'] == 'ALARM':
               print(f"Alarm {alarm['AlarmName']} is in ALARM state.")
   ```
   This script will print the names of all the alarms related to VPC changes that are currently in the `ALARM` state.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

The VPC Changes Alarm is triggered when any changes are made to your VPC configuration. This alarm is important as it can help you detect any unauthorized changes made to your VPC. To remediate this issue, you can follow the below steps:

1. Login to your AWS console and navigate to the CloudWatch service.

2. From the left-hand side menu, select "Alarms" and then select the "VPC Changes Alarm" that you want to remediate.

3. Click on the "Actions" drop-down menu and select "Disable Alarm" to temporarily disable the alarm.

4. Next, navigate to the VPC dashboard and review the recent changes made to the VPC configuration.

5. If you identify any unauthorized changes, undo them immediately.

6. Once you have reviewed and corrected the VPC configuration, go back to the CloudWatch Alarms page and re-enable the VPC Changes Alarm by selecting "Enable Alarm" from the "Actions" drop-down menu.

7. Finally, monitor the VPC Changes Alarm regularly to ensure that any future changes made to the VPC configuration are authorized and expected.

By following these steps, you can remediate the VPC Changes Alarm issue in AWS and ensure that your VPC configuration is secure.

#### Using CLI

The "VPC Changes Alarm" is an AWS CloudWatch alarm that is triggered when there are changes made to the Virtual Private Cloud (VPC) configuration. To remediate this issue, you can follow these steps using AWS CLI:

1. Log in to your AWS account and open the AWS Command Line Interface (CLI).
2. Run the following command to list all the CloudWatch alarms in your account:
```
aws cloudwatch describe-alarms
```
3. Identify the "VPC Changes Alarm" from the list of alarms.
4. Run the following command to disable the alarm:
```
aws cloudwatch disable-alarm-actions --alarm-names VPC-Changes-Alarm
```
5. Verify that the alarm has been disabled by running the following command:
```
aws cloudwatch describe-alarms --alarm-names VPC-Changes-Alarm
```
6. If the alarm is still enabled, you can delete it by running the following command:
```
aws cloudwatch delete-alarms --alarm-names VPC-Changes-Alarm
```
7. Verify that the alarm has been deleted by running the following command:
```
aws cloudwatch describe-alarms
```

Note: Before disabling or deleting the "VPC Changes Alarm", make sure that it is not critical for your organization's security and compliance requirements. It is recommended to keep this alarm enabled and configure it to send notifications to the appropriate stakeholders.

#### Using Python

The VPC Changes Alarm is triggered when there are any changes made to the VPC configuration. To remediate this misconfiguration, you can create a CloudWatch alarm that will send an email notification to the specified email address when changes are made to the VPC configuration.

Here are the step-by-step instructions to remediate this misconfiguration in AWS using Python:

1. Import the necessary AWS SDK libraries in Python:

```
import boto3
from botocore.exceptions import ClientError
```

2. Create a CloudWatch alarm:

```
def create_cloudwatch_alarm():
    cloudwatch = boto3.client('cloudwatch')
    sns = boto3.client('sns')
    alarm_name = 'VPC Changes Alarm'
    alarm_description = 'Alarm triggered when changes are made to the VPC configuration'
    alarm_actions = ['arn:aws:sns:us-west-2:123456789012:my-email-topic']
    metric_name = 'VpcConfigurationChanged'
    namespace = 'AWS/EC2'
    statistic = 'Sum'
    dimensions = [{'Name': 'InstanceId', 'Value': 'i-1234567890abcdef0'}]
    period = 60
    evaluation_periods = 1
    threshold = 1
    comparison_operator = 'GreaterThanThreshold'
    try:
        cloudwatch.put_metric_alarm(
            AlarmName=alarm_name,
            AlarmDescription=alarm_description,
            ActionsEnabled=True,
            AlarmActions=alarm_actions,
            MetricName=metric_name,
            Namespace=namespace,
            Statistic=statistic,
            Dimensions=dimensions,
            Period=period,
            EvaluationPeriods=evaluation_periods,
            Threshold=threshold,
            ComparisonOperator=comparison_operator
        )
        print('CloudWatch alarm created successfully')
    except ClientError as e:
        print('Error creating CloudWatch alarm: ', e)
        return False
    return True
```

3. Replace the email topic ARN with your own email topic ARN.

4. Call the `create_cloudwatch_alarm()` function to create the CloudWatch alarm.

```
if __name__ == '__main__':
    create_cloudwatch_alarm()
```

These steps will create a CloudWatch alarm that will send an email notification to the specified email address when changes are made to the VPC configuration.

### Additional Reading:

- [https://docs.aws.amazon.com/cli/latest/reference/cloudwatch/put-metric-alarm.html](https://docs.aws.amazon.com/cli/latest/reference/cloudwatch/put-metric-alarm.html) 


</Tab>
</Tabs>