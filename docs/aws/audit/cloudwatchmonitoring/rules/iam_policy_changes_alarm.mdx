---
slug: iam_policy_changes_alarm
title: IAM Policy Changes Alarm
sidebar_label: IAM Policy Changes Alarm
---

### More Info:

AWS IAM policy configuration changes should be monitored using CloudWatch alarms.

### Risk Level

High

### Address

Security

### Compliance Standards

SOC2, HIPAA, ISO27001, AWSWAF, HITRUST, CISAWS, CBP, NISTCSF, PCIDSS

### Remediation

#### Using Console

1. **Sign in to the AWS Management Console**: Go to the AWS Management Console at https://console.aws.amazon.com/.

2. **Open CloudWatch Console**: Navigate to the CloudWatch service by either searching for it in the AWS services search bar or finding it under "Management & Governance."

3. **Navigate to Metrics**: In the CloudWatch console, click on "Metrics" in the left-hand navigation pane.

4. **Select the Appropriate Namespace**: Find and select the namespace under which the metric `IAMPolicyChangesEventCount` should be located. This could be "AWS/CloudTrail" or a custom namespace if the metric is custom.

5. **Check for Metric**: Look for the metric named `IAMPolicyChangesEventCount`. If it exists, you'll see data points plotted on the graph.

#### Using CLI

To set a CloudWatch metric using the AWS CLI, you typically don't "set" metrics directly like you would with CloudWatch Alarms or Dashboards. Instead, you typically publish custom metrics to CloudWatch. Here's how you can publish a custom metric using the AWS CLI:

1. **Install and Configure AWS CLI**: Make sure you have the AWS CLI installed and configured with the necessary permissions to publish custom metrics to CloudWatch.

2. **Prepare Metric Data**: Prepare the data you want to publish as a custom metric. The data should include the metric name, value, timestamp, and any other relevant dimensions or metadata.

3. **Publish Metric Data**: Use the `put-metric-data` command to publish the metric data to CloudWatch.

Here's a general example of how you can use the AWS CLI to publish custom metric data:

```bash
aws cloudwatch put-metric-data --namespace "MyNamespace" --metric-name "MyMetric" --value 1 --timestamp "$(date -u +'%Y-%m-%dT%H:%M:%S')" --region "us-east-1"
```

In this example:
- `MyNamespace` is the namespace for the metric.
- `MyMetric` is the name of the metric.
- `1` is the value of the metric.
- `$(date -u +'%Y-%m-%dT%H:%M:%S')` is the timestamp in ISO 8601 format.
- `us-east-1` is the AWS region.

Replace these values with your actual metric data. Also, ensure that the AWS CLI is configured with the correct AWS region where your CloudWatch metrics are located.

Remember that you can't directly create metrics in CloudWatch through the AWS CLI. You can only publish data points to existing custom metrics or predefined AWS service metrics. If you're working with custom metrics, make sure you have set up the metric namespace and dimensions beforehand.

#### Using Python

Here's how you can check for the existence of the metric `IAMPolicyChangesEventCount` using Python with the boto3 library:

```python
import boto3

cloudwatch = boto3.client('cloudwatch')

# List metrics
response = cloudwatch.list_metrics(
    Namespace='AWS/CloudTrail'
)

# Check if IAMPolicyChangesEventCount exists
found = False
for metric in response['Metrics']:
    if metric['MetricName'] == 'IAMPolicyChangesEventCount':
        found = True
        break

if found:
    print("IAMPolicyChangesEventCount metric exists.")
else:
    print("IAMPolicyChangesEventCount metric does not exist.")
```

This script will check if the metric `IAMPolicyChangesEventCount` exists under the `AWS/CloudTrail` namespace in CloudWatch. Adjust the namespace accordingly if the metric is located in a different namespace.

### Additional Reading:

- [https://aws.amazon.com/blogs/security/how-to-receive-alerts-when-your-iam-configuration-changes/](https://aws.amazon.com/blogs/security/how-to-receive-alerts-when-your-iam-configuration-changes/) 

