---
slug: waf_logging_enabled
title: WAF Logging Should Be Enabled
sidebar_label: WAF Logging Should Be Enabled
---

### More Info:

WAF logging should be enabled

### Risk Level

Medium

### Address

Security, Reliability, Operational Maturity

### Compliance Standards

CBP,GDPR,HIPAA,ISO27001,SEBI,RBI_MD_ITF,RBI_UCB



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and navigate to the AWS WAF & Shield service.

2. In the AWS WAF & Shield dashboard, select the "WebACLs" option from the left-hand side menu.

3. In the WebACLs page, select the WebACL that you want to check. This will open the details page for the selected WebACL.

4. In the details page, check the "Logging" section. If the "Logging" status is "ON", then WAF Logging is enabled in Cloud Watch for the selected WebACL. If the "Logging" status is "OFF", then WAF Logging is not enabled.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   Installation:
   ```
   pip install awscli
   ```
   Configuration:
   ```
   aws configure
   ```
   You will be prompted to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. List all the WebACLs: Use the following command to list all the WebACLs in your AWS account:

   ```
   aws wafv2 list-web-acls --scope REGIONAL
   ```
   This command will return a list of WebACLs along with their Ids and ARNs.

3. Get WebACL details: For each WebACL, use the following command to get its details:

   ```
   aws wafv2 get-web-acl --scope REGIONAL --id <WebACLId> --name <WebACLName> --region <Region>
   ```
   Replace `<WebACLId>`, `<WebACLName>`, and `<Region>` with the actual Id, Name, and Region of the WebACL. This command will return the details of the WebACL including its rules and actions.

4. Check for logging configuration: In the output of the previous command, look for the `LoggingConfiguration` field. If this field is missing or if the `LogDestinationConfigs` field within it is empty, then WAF logging is not enabled for that WebACL.

#### Using Python

To check if WAF Logging is enabled in CloudWatch using Python scripts, you can use the AWS SDK for Python (Boto3). Here are the steps:

1. **Set up AWS SDK for Python (Boto3):**
   First, you need to set up Boto3. You can install it using pip:

   ```bash
   pip install boto3
   ```

   Then, configure your AWS credentials. You can do this by setting the following environment variables:

   ```bash
   export AWS_ACCESS_KEY_ID='your_access_key'
   export AWS_SECRET_ACCESS_KEY='your_secret_key'
   ```

2. **Create a Python script to list all WAFv2 web ACLs:**
   Use the `list_web_acls` method to get all the web ACLs. Here is a sample script:

   ```python
   import boto3

   client = boto3.client('wafv2')

   response = client.list_web_acls(
       Scope='REGIONAL'
   )

   for web_acl in response['WebACLs']:
       print(web_acl['Name'])
   ```

3. **Check if logging is enabled for each web ACL:**
   For each web ACL, use the `get_logging_configuration` method to check if logging is enabled. Here is a sample script:

   ```python
   import boto3

   client = boto3.client('wafv2')

   response = client.list_web_acls(
       Scope='REGIONAL'
   )

   for web_acl in response['WebACLs']:
       try:
           logging_config = client.get_logging_configuration(
               ResourceArn=web_acl['ARN']
           )
           print(f"Logging is enabled for {web_acl['Name']}")
       except client.exceptions.WAFNonexistentItemException:
           print(f"Logging is not enabled for {web_acl['Name']}")
   ```

4. **Interpret the results:**
   If logging is enabled for a web ACL, the script will print "Logging is enabled for [web ACL name]". If logging is not enabled, it will print "Logging is not enabled for [web ACL name]". If you see the latter message for any of your web ACLs, it means that WAF Logging is not enabled in CloudWatch for those ACLs.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of WAF Logging not being enabled in AWS CloudWatch using the AWS Management Console, follow these steps:

1. **Sign in to the AWS Management Console**: Go to https://aws.amazon.com/ and sign in to your AWS account.

2. **Navigate to AWS WAF Console**: Click on the "Services" dropdown menu at the top of the page, search for "WAF & Shield" under the Security, Identity, & Compliance category, and click on it.

3. **Select the Web ACL**: In the left-hand navigation pane, click on "Web ACLs".

4. **Choose the Web ACL**: Select the Web ACL for which you want to enable logging by clicking on its name.

5. **Enable Logging**: In the Web ACL details page, click on the "Logging" tab.

6. **Enable Logging**: Click on the "Edit" button to modify the logging configuration.

7. **Enable Logging**: Toggle the "Enable Logging" option to enable logging for the Web ACL.

8. **Choose Logging Destination**: Select the CloudWatch log group where you want to store the logs. If you don't have an existing log group, you can create a new one by clicking on the "Create a new CloudWatch log group" button.

9. **Save Changes**: Click on the "Update" button to save the changes and enable logging for the Web ACL.

10. **Verify Logging**: To verify that logging is enabled, you can check the CloudWatch logs in the specified log group to ensure that the WAF logs are being generated and stored correctly.

By following these steps, you will successfully remediate the misconfiguration of WAF Logging not being enabled in AWS CloudWatch using the AWS Management Console.

#### Using CLI

To remediate the misconfiguration of WAF logging not being enabled in AWS CloudWatch using AWS CLI, follow these steps:

1. Enable logging for your Web Application Firewall (WAF) in the AWS Management Console:
   - Navigate to the AWS WAF console.
   - Select the WebACL for which you want to enable logging.
   - Click on the "Logging and Metrics" tab.
   - Click on "Edit Logging Configuration" and enable logging.
   - Choose the Amazon Kinesis Data Firehose delivery stream or Amazon S3 bucket where you want to store the logs.

2. Use AWS CLI to enable logging for your WAF:
   - Open your terminal or command prompt.
   - Run the following AWS CLI command to associate a logging configuration with your WebACL:
     ```
     aws waf-regional update-web-acl --web-acl-id <web-acl-id> --updates Action=INSERT,ActivatedRule={Priority=1,RuleId=AWSManagedRulesCommonRuleSetRuleID},LoggingConfiguration={LogDestinationConfigs=[<log-destination-arn>],RedactedFields=[{Type=URI,Data=FULL},{Type=QUERY_STRING,Data=ALL},{Type=HEADER,Data=ALL},{Type=SINGLE_QUERY_ARG,Data=ALL},{Type=ALL_QUERY_ARGS,Data=ALL}]}
     ```
     Replace `<web-acl-id>` with the ID of your WebACL and `<log-destination-arn>` with the ARN of the Amazon Kinesis Data Firehose delivery stream or Amazon S3 bucket where you want to store the logs.

3. Verify that logging is enabled:
   - Run the following AWS CLI command to describe the logging configuration for your WebACL:
     ```
     aws waf-regional get-web-acl --web-acl-id <web-acl-id>
     ```
   - Check the output to ensure that the logging configuration is correctly set up and enabled.

By following these steps, you can remediate the misconfiguration of WAF logging not being enabled in AWS CloudWatch using AWS CLI.

#### Using Python

To enable WAF logging in AWS CloudWatch using Python, you can use the AWS SDK for Python (Boto3). Follow these steps to remediate the misconfiguration:

1. Install Boto3:
```bash
pip install boto3
```

2. Create a Python script with the following code:
```python
import boto3

# Initialize the AWS service clients
waf_client = boto3.client('waf')
cloudwatch_client = boto3.client('cloudwatch')

# Get the WebACL Id
web_acl_id = 'YOUR_WEB_ACL_ID'

# Enable logging for the WebACL
response = waf_client.update_web_acl(
    WebACLId=web_acl_id,
    LoggingConfiguration={
        'ResourceArn': 'arn:aws:logs:REGION:ACCOUNT_ID:log-group:LOG_GROUP_NAME',
        'LogDestinationConfigs': [
            'arn:aws:firehose:REGION:ACCOUNT_ID:deliverystream/FIREHOSE_NAME'
        ],
        'RedactedFields': []
    }
)

# Create a CloudWatch log group for the WAF logs
response = cloudwatch_client.create_log_group(
    logGroupName='LOG_GROUP_NAME'
)

print("WAF logging has been enabled successfully.")
```

3. Replace the following placeholders in the script:
- `YOUR_WEB_ACL_ID`: Replace this with the ID of the WebACL for which you want to enable logging.
- `REGION`: Replace this with the AWS region where the logs will be stored.
- `ACCOUNT_ID`: Replace this with your AWS account ID.
- `LOG_GROUP_NAME`: Replace this with the name of the CloudWatch log group where WAF logs will be stored.
- `FIREHOSE_NAME`: Replace this with the name of the Kinesis Data Firehose delivery stream where logs will be delivered.

4. Run the Python script to enable WAF logging in AWS CloudWatch:
```bash
python enable_waf_logging.py
```

After running this script, WAF logging will be enabled for the specified WebACL, and the logs will be stored in the CloudWatch log group you specified.




</Tab>
</Tabs>