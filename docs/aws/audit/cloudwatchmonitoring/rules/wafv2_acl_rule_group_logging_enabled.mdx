---
slug: wafv2_acl_rule_group_logging_enabled
title: WAFv2 WebACL Rule Group Logging Should Be Enabled
sidebar_label: WAFv2 WebACL Rule Group Logging Should Be Enabled
---

### More Info:

Web ACL rule group logging should be enabled

### Risk Level

Medium

### Address

Security, Reliability, Operational Maturity

### Compliance Standards

GDPR,HITRUST,SOC2,NISTCSF,PCIDSS,SEBI



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and navigate to the WAF & Shield service. 

2. In the navigation pane, select "WebACLs". This will display a list of all the WebACLs that are currently configured in your AWS account.

3. Select the WebACL that you want to check for logging configuration. This will open the details page for the selected WebACL.

4. In the details page, look for the "Logging" section. If logging is enabled, you will see the name of the CloudWatch Logs group where the logs are being sent. If this section is not present or it says "Logging: OFF", then logging is not enabled for this WebACL Rule Group.

#### Using CLI

1. First, you need to list all the available WebACLs in your AWS account. You can do this by using the following AWS CLI command:

   ```
   aws wafv2 list-web-acls --scope REGIONAL
   ```
   This command will return a list of WebACLs in your account. Note down the ARN of the WebACL you want to check.

2. Next, you need to get the details of the specific WebACL. Use the following command:

   ```
   aws wafv2 get-web-acl --scope REGIONAL --arn "arn:aws:wafv2:region:account-id:regional/webacl/WebACLName/ID"
   ```
   Replace "arn:aws:wafv2:region:account-id:regional/webacl/WebACLName/ID" with the ARN of the WebACL you noted down in the previous step. This command will return the details of the WebACL.

3. In the output of the previous command, look for the "LoggingConfiguration" field. If this field is not present or if the "LogDestinationConfigs" field within it is empty, then logging is not enabled for the WebACL.

4. To confirm, you can also check the CloudWatch Logs group where the logs should be sent. Use the following command:

   ```
   aws logs describe-log-groups --log-group-name-prefix "aws-waf-logs"
   ```
   This command will return a list of log groups with names starting with "aws-waf-logs". If the log group for your WebACL is not in this list, then logging is not enabled for the WebACL.

#### Using Python

To check if WAFv2 WebACL Rule Group Logging is enabled in Cloud Watch using Python scripts, you can use the AWS SDK for Python (Boto3). Here are the steps:

1. **Set up AWS SDK for Python (Boto3):**
   First, you need to set up Boto3. Install it using pip:
   ```
   pip install boto3
   ```
   Then, configure your AWS credentials. You can do this by setting the following environment variables:
   ```
   AWS_ACCESS_KEY_ID = 'your_access_key'
   AWS_SECRET_ACCESS_KEY = 'your_secret_key'
   ```

2. **Create a Python script to list all WebACLs:**
   Use the `list_web_acls` method to get all the WebACLs. Here is a sample script:
   ```python
   import boto3

   client = boto3.client('wafv2')

   response = client.list_web_acls(
       Scope='REGIONAL',
   )

   for webacl in response['WebACLs']:
       print(webacl['Name'])
   ```
   This script will print the names of all your WebACLs.

3. **Create a Python script to get the logging configuration of each WebACL:**
   Use the `get_logging_configuration` method to get the logging configuration of each WebACL. Here is a sample script:
   ```python
   import boto3

   client = boto3.client('wafv2')

   response = client.list_web_acls(
       Scope='REGIONAL',
   )

   for webacl in response['WebACLs']:
       try:
           logging_config = client.get_logging_configuration(
               ResourceArn=webacl['ARN']
           )
           print(f"Logging configuration for {webacl['Name']}: {logging_config}")
       except client.exceptions.WAFNonexistentItemException:
           print(f"No logging configuration for {webacl['Name']}")
   ```
   This script will print the logging configuration for each WebACL, or a message indicating that no logging configuration exists.

4. **Analyze the output:**
   If the logging configuration for a WebACL is not present or not enabled, then WAFv2 WebACL Rule Group Logging is not enabled for that WebACL. If all WebACLs have a logging configuration and it is enabled, then WAFv2 WebACL Rule Group Logging is enabled in Cloud Watch.

Please note that you need to replace `'REGIONAL'` with `'CLOUDFRONT'` if you want to check the WebACLs associated with CloudFront distributions. Also, replace `'your_access_key'` and `'your_secret_key'` with your actual AWS access key and secret key.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of WAFv2 WebACL Rule Group Logging not being enabled in AWS CloudWatch using the AWS Management Console, follow these steps:

1. **Sign in to the AWS Management Console**: Go to https://aws.amazon.com/ and sign in to your AWS account.

2. **Navigate to AWS WAF & Shield console**: Click on the 'Services' dropdown menu at the top left corner of the console, then select 'WAF & Shield' under the Security, Identity, & Compliance section.

3. **Select the desired WebACL**: In the AWS WAF & Shield console, click on 'Web ACLs' from the left-hand menu, then select the WebACL that you want to enable logging for.

4. **Edit the WebACL**: Click on the WebACL that you have selected, then click on the 'Edit' button to make changes to the WebACL configuration.

5. **Enable Logging for the Rule Group**: In the WebACL configuration page, scroll down to the 'Logging configuration' section. Ensure that 'Log' is enabled for the desired rule group(s) that you want to log.

6. **Save Changes**: Once you have enabled logging for the rule group(s), click on the 'Save' button to save the changes to the WebACL configuration.

7. **Verify Logging Configuration**: After saving the changes, you can verify that logging is enabled for the rule group(s) by checking the 'Logging configuration' section in the WebACL configuration page.

By following these steps, you have successfully remediated the misconfiguration of WAFv2 WebACL Rule Group Logging not being enabled in AWS CloudWatch using the AWS Management Console.

#### Using CLI

To remediate the misconfiguration for WAFv2 WebACL Rule Group Logging in AWS CloudWatch using AWS CLI, follow these steps:

1. List all the WAFv2 WebACLs in your AWS account to identify the WebACL Rule Group for which logging needs to be enabled:
```
aws wafv2 list-web-acls
```

2. Get the details of the specific WebACL Rule Group that needs logging enabled:
```
aws wafv2 get-web-acl --name <WebACL-Name>
```

3. Enable logging for the identified WebACL Rule Group by updating its configuration:
```
aws wafv2 update-web-acl --name <WebACL-Name> --scope REGIONAL --default-action ALLOW --visibility-config SampledRequestsEnabled=true,CloudWatchMetricsEnabled=true,ManagedByFirewallManager=false --rules 'Action=ALLOW,Priority=1,RuleLabels=[{Name=SampleRuleLabel}],Statement={ByteMatchStatement={FieldToMatch={UriPath={}},PositionalConstraint=EXACTLY,SearchString="example.com"},VisibilityConfig={SampledRequestsEnabled=true,CloudWatchMetricsEnabled=true,ManagedByFirewallManager=false}'
```

4. Verify that the logging is enabled for the WebACL Rule Group:
```
aws wafv2 get-web-acl --name <WebACL-Name>
```

By following these steps, you can successfully remediate the misconfiguration and enable logging for the WAFv2 WebACL Rule Group in AWS CloudWatch using AWS CLI.

#### Using Python

To remediate the misconfiguration of WAFv2 WebACL Rule Group Logging not being enabled in AWS CloudWatch using Python, you can use the AWS SDK for Python (Boto3) to programmatically enable logging for the WebACL Rule Group. Below are the step-by-step instructions to remediate this issue:

1. Install Boto3: Make sure you have the Boto3 library installed. You can install it using pip:

```bash
pip install boto3
```

2. Configure AWS Credentials: Ensure that you have configured your AWS credentials either by setting environment variables or using AWS CLI `aws configure` command.

3. Write a Python script: Create a Python script with the following code to enable logging for the WAFv2 WebACL Rule Group:

```python
import boto3

# Initialize the WAFv2 client
wafv2_client = boto3.client('wafv2')

# Specify the WebACL ARN for which you want to enable logging
web_acl_arn = 'YOUR_WEB_ACL_ARN'

# Enable logging for the specified WebACL
response = wafv2_client.put_logging_configuration(
    LoggingConfiguration={
        'ResourceArn': web_acl_arn,
        'LogDestinationConfigs': [
            'arn:aws:logs:REGION:ACCOUNT_ID:log-group:LOG_GROUP_NAME'
        ],
        'RedactedFields': []
    }
)

print("Logging enabled for WebACL Rule Group with ARN:", web_acl_arn)
```

4. Replace the placeholders:
   - Replace `YOUR_WEB_ACL_ARN` with the ARN of the WebACL Rule Group for which you want to enable logging.
   - Replace `REGION`, `ACCOUNT_ID`, and `LOG_GROUP_NAME` in the `LogDestinationConfigs` with your AWS region, account ID, and the name of the CloudWatch Logs log group where you want to store the logs.

5. Run the Python script: Execute the Python script to enable logging for the specified WebACL Rule Group. Make sure the script runs successfully without any errors.

By following these steps and running the Python script, you can remediate the misconfiguration of WAFv2 WebACL Rule Group Logging not being enabled in AWS CloudWatch.

</Tab>
</Tabs>