---
slug: cloudwatch_log_groups_not_encrypted
title: CloudWatch Log Groups Should Be Encrypted
sidebar_label: CloudWatch Log Groups Should Be Encrypted
---

### More Info:

Cloudwatch loggroups should be encrypted

### Risk Level

High

### Address

Security

### Compliance Standards

HIPAA,PCIDSS,GDPR,CISAWS,CBP,NIST,SOC2,AWSWAF,SEBI,RBI_UCB

### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console.
2. Navigate to CloudWatch service. In the navigation pane, choose 'Logs'.
3. In the 'Log groups' section, you will see a list of all your log groups.
4. For each log group, check the 'Encryption' column. If the column is blank or the encryption is not enabled, then the log group is not encrypted.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   Installation:
   ```
   pip install awscli
   ```
   Configuration:
   ```
   aws configure
   ```
   You will be prompted to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. List all CloudWatch Log Groups: Use the following AWS CLI command to list all the CloudWatch Log Groups in your AWS account:

   ```
   aws logs describe-log-groups
   ```
   This command will return a JSON output with the details of all the CloudWatch Log Groups.

3. Check encryption configuration: In the JSON output, look for the "kmsKeyId" field for each Log Group. If this field is not present or is null, it means that the Log Group is not encrypted.

4. Automate the process with a script: You can automate the process of checking the encryption configuration of all CloudWatch Log Groups with a Python script. Use the AWS SDK for Python (Boto3) to interact with AWS services. Here is a simple script that does this:

   ```python
   import boto3

   # Create a CloudWatch client
   client = boto3.client('logs')

   # List all log groups
   response = client.describe_log_groups()

   # Check encryption for each log group
   for log_group in response['logGroups']:
       if 'kmsKeyId' not in log_group or not log_group['kmsKeyId']:
           print(f"Log Group {log_group['logGroupName']} is not encrypted.")
   ```
   This script will print the names of all the CloudWatch Log Groups that are not encrypted.
</Accordion>

<Accordion title='Using Python'>
1. Install and configure AWS SDK for Python (Boto3) on your local system. This will allow you to interact with AWS services using Python.

```python
pip install boto3
aws configure
```

2. Import the necessary modules and create a session using your AWS credentials.

```python
import boto3

session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    region_name='YOUR_REGION'
)
```

3. Use the `describe_log_groups` method from the CloudWatchLogs client to retrieve a list of all log groups.

```python
client = session.client('logs')
response = client.describe_log_groups()
```

4. Iterate over the log groups and check the `kmsKeyId` attribute. If it's `None`, the log group is not encrypted.

```python
for log_group in response['logGroups']:
    if 'kmsKeyId' not in log_group or log_group['kmsKeyId'] is None:
        print(f"Log Group {log_group['logGroupName']} is not encrypted.")
```

This script will print out the names of all unencrypted log groups. If no names are printed, all log groups are encrypted.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
Cloudwatch Log groups are by default encrypted with AWS KMS Keys
</Accordion>
<Accordion title='Using CLI' defaultOpen='true'>
Cloudwatch Log groups are by default encrypted with AWS KMS Keys
</Accordion>
<Accordion title='Using Python' defaultOpen='true'>
Cloudwatch Log groups are by default encrypted with AWS KMS Keys
</Accordion>
</AccordionGroup>
</Tab>
</Tabs>
[Reference Link](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html)

