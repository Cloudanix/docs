---
slug: global_endpoint_event_replication_enabled
title: EventBridge Global Endpoints Replication Should Be Enabled
sidebar_label: EventBridge Global Endpoints Replication Should Be Enabled
---

### More Info:

This rule checks if event replication is enabled for Amazon EventBridge global endpoints. The rule is NON_COMPLIANT if event replication is not enabled.

### Risk Level

Medium

### Address

Configuration

### Compliance Standards

CBP



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and navigate to the CloudWatch service. 

2. In the navigation pane, select "Rules" under the "Events" section. This will display a list of all the EventBridge rules in your account.

3. For each rule, check the "Targets" section. If the "Event bus in another AWS account or AWS Region" option is selected, it means that the rule is set to replicate events to other regions or accounts.

4. If the "Event bus in another AWS account or AWS Region" option is not selected for a rule, it means that the EventBridge Global Endpoints Replication is not enabled for that rule. Repeat this process for all the rules in your account to identify any misconfigurations.

#### Using CLI

1. Install and configure AWS CLI: Before you can start, make sure you have AWS CLI installed and configured with the necessary permissions. You can install it using pip (Python package installer). 

   ```
   pip install awscli
   ```
   Then configure it using the following command and provide your AWS credentials (Access Key ID and Secret Access Key), default region name, and default output format when prompted.

   ```
   aws configure
   ```

2. List all the EventBridge rules: Use the following AWS CLI command to list all your Amazon EventBridge rules.

   ```
   aws events list-rules
   ```
   This command will return a list of all your EventBridge rules in the JSON format.

3. Check the EventBridge rule targets: For each rule returned from the previous step, check its targets using the following command.

   ```
   aws events list-targets-by-rule --rule <RULE_NAME>
   ```
   Replace `<RULE_NAME>` with the name of your rule. This command will return a list of all the targets for the specified rule.

4. Check the EventBridge rule target's configuration: In the output from the previous step, check the `Arn` field of each target. If the ARN is not global (i.e., it does not contain `events.amazonaws.com`), then the EventBridge Global Endpoints Replication is not enabled for that target.

Please note that AWS CLI commands may vary based on the region and the configuration of your AWS environment.

#### Using Python

To check if EventBridge Global Endpoints Replication is enabled in CloudWatch using Python scripts, you can use the AWS SDK for Python (Boto3). Here are the steps:

1. **Set up AWS SDK for Python (Boto3):**
   First, you need to set up Boto3. Install it using pip:
   ```
   pip install boto3
   ```
   Then, configure your AWS credentials. You can do this by setting the following environment variables:
   ```
   AWS_ACCESS_KEY_ID = 'your_access_key'
   AWS_SECRET_ACCESS_KEY = 'your_secret_key'
   ```

2. **Create a Python script to list all the EventBridge rules:**
   Use the `list_rules` method provided by the EventBridge client in Boto3. This method returns all your EventBridge rules.
   ```python
   import boto3

   def list_eventbridge_rules():
       client = boto3.client('events')
       response = client.list_rules()
       return response['Rules']
   ```

3. **Check if the EventBridge rules are being replicated globally:**
   For each rule returned by the `list_rules` method, check the `State` attribute. If the `State` attribute is `ENABLED`, then the rule is being replicated globally.
   ```python
   def check_eventbridge_replication():
       rules = list_eventbridge_rules()
       for rule in rules:
           if rule['State'] == 'ENABLED':
               print(f"Rule {rule['Name']} is being replicated globally.")
           else:
               print(f"Rule {rule['Name']} is not being replicated globally.")
   ```

4. **Run the Python script:**
   Finally, run the Python script. It will print out the names of all your EventBridge rules and whether they are being replicated globally or not.

Please note that this script assumes that you have the necessary permissions to list and describe your EventBridge rules. If you don't, you may need to adjust your IAM policies accordingly.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of EventBridge Global Endpoints Replication not being enabled for AWS CloudWatch in the AWS console, follow these step-by-step instructions:

1. **Login to AWS Console**: Go to the AWS Management Console (https://aws.amazon.com/) and log in using your credentials.

2. **Navigate to CloudWatch**: Click on the "Services" dropdown menu at the top of the page and select "CloudWatch" under the Management & Governance section.

3. **Go to EventBridge**: In the CloudWatch dashboard, navigate to the left-hand side menu and click on "EventBridge" under the Events section.

4. **Select Global Endpoints**: In the EventBridge dashboard, click on the "Global Endpoints" tab on the left-hand side menu.

5. **Enable Replication**: Locate the option for "Replication" and ensure that it is enabled. If it is not enabled, click on the "Edit" button or the toggle switch to enable replication for global endpoints.

6. **Save Changes**: After enabling replication, make sure to save the changes by clicking on the "Save" or "Update" button, typically located at the bottom or top of the page.

7. **Verify Configuration**: Double-check that the replication for global endpoints is now enabled by reviewing the settings and ensuring that the changes have been successfully saved.

By following these steps, you should be able to remediate the misconfiguration of EventBridge Global Endpoints Replication not being enabled for AWS CloudWatch in the AWS console.

#### Using CLI

To remediate the misconfiguration of EventBridge Global Endpoints Replication not being enabled for AWS CloudWatch using AWS CLI, follow these steps:

1. Open your terminal or command prompt.

2. Run the following AWS CLI command to enable EventBridge Global Endpoints Replication for AWS CloudWatch:
   
```bash
aws events put-replication-configuration --region <region-name> --destination <destination-arn> --event-bus-name <event-bus-name>
```

Replace the placeholders:
- `<region-name>`: The AWS region where the EventBridge event bus is located.
- `<destination-arn>`: The Amazon Resource Name (ARN) of the destination where the events will be replicated.
- `<event-bus-name>`: The name of the EventBridge event bus for AWS CloudWatch.

3. Verify the replication configuration by running the following AWS CLI command:
   
```bash
aws events describe-replication-configuration --region <region-name> --event-bus-name <event-bus-name>
```

Replace the placeholders:
- `<region-name>`: The AWS region where the EventBridge event bus is located.
- `<event-bus-name>`: The name of the EventBridge event bus for AWS CloudWatch.

4. Ensure that the output of the `describe-replication-configuration` command shows that the replication configuration is successfully enabled for the specified event bus.

By following these steps, you can remediate the misconfiguration of EventBridge Global Endpoints Replication not being enabled for AWS CloudWatch using AWS CLI.

#### Using Python

To remediate the misconfiguration of EventBridge global endpoints replication not being enabled in AWS CloudWatch using Python, follow these steps:

1. Import the Boto3 library to interact with AWS services.

```python
import boto3
```

2. Initialize the CloudWatch client using Boto3.

```python
cloudwatch_client = boto3.client('cloudwatch')
```

3. Enable EventBridge global endpoints replication for CloudWatch using the following API call:

```python
response = cloudwatch_client.enable_insight_rules()
```

4. Verify the response to ensure that the global endpoints replication has been successfully enabled.

```python
if response['ResponseMetadata']['HTTPStatusCode'] == 200:
    print("EventBridge global endpoints replication has been successfully enabled for CloudWatch.")
else:
    print("Failed to enable EventBridge global endpoints replication for CloudWatch.")
```

5. Run the Python script to execute the remediation steps.

By following these steps, you can remediate the misconfiguration of EventBridge global endpoints replication not being enabled in AWS CloudWatch using Python.



</Tab>
</Tabs>