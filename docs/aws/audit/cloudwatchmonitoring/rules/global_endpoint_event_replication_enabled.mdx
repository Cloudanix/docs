---
slug: global_endpoint_event_replication_enabled
title: EventBridge Global Endpoints Replication Should Be Enabled
sidebar_label: EventBridge Global Endpoints Replication Should Be Enabled
---

### More Info:

This rule checks if event replication is enabled for Amazon EventBridge global endpoints. The rule is NON_COMPLIANT if event replication is not enabled.

### Risk Level

Medium

### Address

Configuration

### Compliance Standards

CBP


### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Log in to the AWS Management Console and navigate to the CloudWatch service.
2. In the left navigation pane, select "Rules" under the "Events" section.
3. In the "Rules" page, you will see a list of all the EventBridge rules. Click on the rule you want to inspect.
4. In the rule details page, check the "Targets" section. If the "Event bus in another AWS account or AWS Region" is not listed as a target, it means the EventBridge Global Endpoints Replication is not enabled.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local system and configure it with your AWS account credentials. You can do this by running the following commands:

   Installation:
   ```
   pip install awscli
   ```
   Configuration:
   ```
   aws configure
   ```
   You will be prompted to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. List all the EventBridge rules: Once your AWS CLI is set up, you can list all the EventBridge rules in your account by running the following command:
   ```
   aws events list-rules
   ```
   This command will return a list of all the EventBridge rules in your account.

3. Check the EventBridge rule targets: For each rule, you need to check the targets to see if they are configured to use global endpoints. You can do this by running the following command for each rule:
   ```
   aws events list-targets-by-rule --rule <RULE_NAME>
   ```
   Replace `<RULE_NAME>` with the name of the rule you want to check. This command will return a list of all the targets for the specified rule.

4. Check the replication status: For each target, check if the `Arn` field contains a global endpoint. If it does, then the rule is configured to use global endpoints. If it doesn't, then the rule is not configured to use global endpoints and you have detected a misconfiguration.
</Accordion>

<Accordion title='Using Python'>
To check if EventBridge Global Endpoints Replication is enabled in CloudWatch using Python scripts, you can use the AWS SDK for Python (Boto3). Here are the steps:

1. **Set up AWS SDK for Python (Boto3):**
   First, you need to install and configure Boto3. You can install it using pip:

   ```
   pip install boto3
   ```

   Then, configure your AWS credentials. You can do this by setting the following environment variables:

   ```
   AWS_ACCESS_KEY_ID = 'your_access_key'
   AWS_SECRET_ACCESS_KEY = 'your_secret_key'
   ```

2. **Create a Python script to list all EventBridge rules:**
   You can use the `list_rules` method of the `events` client in Boto3 to list all EventBridge rules. Here is a sample script:

   ```python
   import boto3

   def list_rules():
       client = boto3.client('events')
       response = client.list_rules()
       return response['Rules']

   print(list_rules())
   ```

3. **Check if each rule has a target in another region:**
   For each rule, you can use the `list_targets_by_rule` method to list its targets. Then, check if any of the targets is in another region. Here is a sample script:

   ```python
   import boto3

   def check_rule_targets(rule_name):
       client = boto3.client('events')
       response = client.list_targets_by_rule(Rule=rule_name)
       for target in response['Targets']:
           if target['Arn'].split(':')[3] != client.meta.region_name:
               return True
       return False

   print(check_rule_targets('my-rule'))
   ```

4. **Check if EventBridge Global Endpoints Replication is enabled:**
   If a rule has a target in another region, it means that EventBridge Global Endpoints Replication is enabled. If none of the rules have a target in another region, it means that EventBridge Global Endpoints Replication is not enabled. You can modify the `list_rules` function to check this:

   ```python
   import boto3

   def list_rules():
       client = boto3.client('events')
       response = client.list_rules()
       for rule in response['Rules']:
           if check_rule_targets(rule['Name']):
               print(f"EventBridge Global Endpoints Replication is enabled for rule {rule['Name']}")
           else:
               print(f"EventBridge Global Endpoints Replication is not enabled for rule {rule['Name']}")

   print(list_rules())
   ```

Please note that this script assumes that you have the necessary permissions to list and inspect EventBridge rules. If you don't, you may need to modify the script to handle permission errors.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of EventBridge Global Endpoints Replication not being enabled for AWS CloudWatch in the AWS console, follow these step-by-step instructions:

1. **Login to AWS Console**: Go to the AWS Management Console (https://aws.amazon.com/) and log in using your credentials.

2. **Navigate to CloudWatch**: Click on the "Services" dropdown menu at the top of the page and select "CloudWatch" under the Management & Governance section.

3. **Go to EventBridge**: In the CloudWatch dashboard, navigate to the left-hand side menu and click on "EventBridge" under the Events section.

4. **Select Global Endpoints**: In the EventBridge dashboard, click on the "Global Endpoints" tab on the left-hand side menu.

5. **Enable Replication**: Locate the option for "Replication" and ensure that it is enabled. If it is not enabled, click on the "Edit" button or the toggle switch to enable replication for global endpoints.

6. **Save Changes**: After enabling replication, make sure to save the changes by clicking on the "Save" or "Update" button, typically located at the bottom or top of the page.

7. **Verify Configuration**: Double-check that the replication for global endpoints is now enabled by reviewing the settings and ensuring that the changes have been successfully saved.

By following these steps, you should be able to remediate the misconfiguration of EventBridge Global Endpoints Replication not being enabled for AWS CloudWatch in the AWS console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of EventBridge Global Endpoints Replication not being enabled for AWS CloudWatch using AWS CLI, follow these steps:

1. Open your terminal or command prompt.

2. Run the following AWS CLI command to enable EventBridge Global Endpoints Replication for AWS CloudWatch:
   
```bash
aws events put-replication-configuration --region <region-name> --destination <destination-arn> --event-bus-name <event-bus-name>
```

Replace the placeholders:
- `<region-name>`: The AWS region where the EventBridge event bus is located.
- `<destination-arn>`: The Amazon Resource Name (ARN) of the destination where the events will be replicated.
- `<event-bus-name>`: The name of the EventBridge event bus for AWS CloudWatch.

3. Verify the replication configuration by running the following AWS CLI command:
   
```bash
aws events describe-replication-configuration --region <region-name> --event-bus-name <event-bus-name>
```

Replace the placeholders:
- `<region-name>`: The AWS region where the EventBridge event bus is located.
- `<event-bus-name>`: The name of the EventBridge event bus for AWS CloudWatch.

4. Ensure that the output of the `describe-replication-configuration` command shows that the replication configuration is successfully enabled for the specified event bus.

By following these steps, you can remediate the misconfiguration of EventBridge Global Endpoints Replication not being enabled for AWS CloudWatch using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of EventBridge global endpoints replication not being enabled in AWS CloudWatch using Python, follow these steps:

1. Import the Boto3 library to interact with AWS services.

```python
import boto3
```

2. Initialize the CloudWatch client using Boto3.

```python
cloudwatch_client = boto3.client('cloudwatch')
```

3. Enable EventBridge global endpoints replication for CloudWatch using the following API call:

```python
response = cloudwatch_client.enable_insight_rules()
```

4. Verify the response to ensure that the global endpoints replication has been successfully enabled.

```python
if response['ResponseMetadata']['HTTPStatusCode'] == 200:
    print("EventBridge global endpoints replication has been successfully enabled for CloudWatch.")
else:
    print("Failed to enable EventBridge global endpoints replication for CloudWatch.")
```

5. Run the Python script to execute the remediation steps.

By following these steps, you can remediate the misconfiguration of EventBridge global endpoints replication not being enabled in AWS CloudWatch using Python.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>

