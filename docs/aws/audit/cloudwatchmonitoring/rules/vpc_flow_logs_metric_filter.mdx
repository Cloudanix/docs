---
title: CloudWatch Alarm for VPC Flow Logs Metric Filter
---

### More Info:

A CloudWatch alarm should be created for the VPC Flow Logs metric filter and an alarm action should be configured.

### Risk Level

High

### Address

Security

### Compliance Standards

CBP

### Remediation

How to create and configure the required CloudWatch alarm for the VPC Flow Logs metric filter?

#### Using AWS Console

1. Open the AWS Management Console and navigate to the CloudWatch service.
2. Click on "Alarms" in the navigation panel on the left side.
    (In the Cloudanix Console, navigate to "Misconfig" page and look for Affected Assets for "CloudWatch Alarm for VPC Flow Logs Metric Filter" Policy.)
3. Click on the "Create alarm" button.
4. In the "Create Alarm" wizard, under "Select metric," click on the "Select metric" button.
5. In the "All metrics" tab, scroll down and expand the "VPC Flow Logs" section.
6. Select the specific VPC Flow Logs log group and metric filter that you want to create an alarm for. 
   Note: You must have already set up VPC Flow Logs and configured the desired metric filter before creating the alarm.
7. Click on the checkbox next to the desired metric filter to select it.
8. Click on the "Select metric" button to confirm your selection.
9. Configure the conditions for the alarm:
   a. In the "Conditions" section, specify the threshold for triggering the alarm. You can set thresholds based on the metric values, such as when the value is greater than a specific number, or when the value breaches a percentage.
   b. Set the evaluation period, which defines the time window over which the metric is evaluated to determine if the alarm should trigger.
   c. Choose the "Statistic" option, such as "SampleCount," "Average," "Sum," or "Maximum," depending on the metric and your specific monitoring requirements.
10. In the "Actions" section, select the actions you want to take when the alarm state is triggered. You can choose options like sending a notification, executing an AWS Lambda function, or stopping or terminating instances.
11. Under the "Alarm state trigger" section, provide a name and description for the alarm.
12. Configure the notification settings if desired. You can select an existing SNS topic or create a new one to receive notifications when the alarm state is triggered.
13. Click on the "Create alarm" button to create the CloudWatch alarm.
14. You will be redirected to the alarm list, where you can see the newly created alarm.

### Additional Reading:

- [https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/MonitoringLogData.html](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/MonitoringLogData.html)
