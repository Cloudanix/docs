### Remediation

#### Using Console

To remediate the misconfiguration of not having FMS Shield Resource Policy enabled for AWS CloudWatch using the AWS Management Console, follow these steps:

1. **Sign in to the AWS Management Console**: Go to https://aws.amazon.com/ and sign in to your AWS account.

2. **Navigate to AWS CloudWatch**: Click on the "Services" dropdown at the top of the page, then select "CloudWatch" under the Management & Governance section.

3. **Enable FMS Shield Resource Policy**:
   - In the CloudWatch console, click on "Alarms" in the left-hand navigation pane.
   - Click on the alarm that you want to enable FMS Shield Resource Policy for.
   - In the alarm details page, click on the "Actions" dropdown and select "Edit".
   - Scroll down to the "FMS Shield Resource Policy" section.
   - Click on the toggle button to enable the FMS Shield Resource Policy.
   - Click on the "Save" button to apply the changes.

4. **Verify the FMS Shield Resource Policy is enabled**:
   - Once you have enabled the FMS Shield Resource Policy for the alarm, you can verify that it is enabled by checking the alarm details and ensuring that the FMS Shield Resource Policy toggle is set to enabled.

By following these steps, you should be able to remediate the misconfiguration of not having FMS Shield Resource Policy enabled for AWS CloudWatch using the AWS Management Console.

#### Using CLI

To enable FMS Shield Resource Policy for AWS CloudWatch using AWS CLI, follow these steps:

1. Open your terminal and ensure that you have the AWS CLI installed and configured with the necessary permissions to make changes to AWS resources.

2. Run the following AWS CLI command to enable FMS Shield Resource Policy for AWS CloudWatch:

```
aws fms put-policy --policy-id AWSManagedRulesCommonFWRuleSet --resource-type RESOURCE_TYPE --resource-id RESOURCE_ID
```

Replace `RESOURCE_TYPE` with the type of AWS resource you want to protect (e.g., `AWS::CloudWatch::Alarm`) and `RESOURCE_ID` with the specific resource ID you want to apply the policy to.

3. Verify that the FMS Shield Resource Policy has been successfully enabled for AWS CloudWatch by running the following command:

```
aws fms list-policies
```

You should see the newly created policy in the list of policies returned by this command.

By following these steps, you should be able to remediate the misconfiguration and enable FMS Shield Resource Policy for AWS CloudWatch using AWS CLI.

#### Using Python

To remediate the misconfiguration of FMS Shield Resource Policy not being enabled for AWS CloudWatch using Python, you can use the AWS SDK for Python (Boto3) to update the resource policy. Here are the step-by-step instructions:

1. Install Boto3:
   If you haven't already installed Boto3, you can install it using pip:
   ```
   pip install boto3
   ```

2. Create a Python script with the following code to enable the FMS Shield Resource Policy for CloudWatch:

```python
import boto3

def enable_fms_shield_policy():
    # Create a CloudWatch client
    cloudwatch_client = boto3.client('cloudwatch')

    # Enable the FMS Shield Resource Policy for CloudWatch
    response = cloudwatch_client.put_metric_policy(
        PolicyName='FMS-Shield-Policy',
        PolicyDocument='{"Version": "2012-10-17","Statement": [{"Effect": "Allow","Principal": {"Service": "shield.amazonaws.com"},"Action": "cloudwatch:PutMetricData","Resource": "*"}]}'
    )

    print('FMS Shield Resource Policy has been enabled for CloudWatch.')

if __name__ == '__main__':
    enable_fms_shield_policy()
```

3. Run the Python script:
   Save the Python script with a `.py` extension and run it using the Python interpreter. Make sure your AWS credentials are properly configured on your system.

   ```
   python enable_fms_shield_policy.py
   ```

4. Verify the policy:
   After running the script, verify that the FMS Shield Resource Policy has been successfully enabled for CloudWatch by checking the CloudWatch console or by listing the CloudWatch resource policies using the AWS CLI:

   ```
   aws cloudwatch list-metric-policies
   ```

By following these steps, you can remediate the misconfiguration of the FMS Shield Resource Policy not being enabled for AWS CloudWatch using Python and Boto3.

