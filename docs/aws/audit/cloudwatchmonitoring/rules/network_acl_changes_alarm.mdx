---
slug: network_acl_changes_alarm
title: Network ACL Changes Alarm
sidebar_label: Network ACL Changes Alarm
---

### More Info:

AWS Network ACLs configuration changes should be monitored using CloudWatch alarms.

### Risk Level

Medium

### Address

Security

### Compliance Standards

SOC2, AWSWAF, HITRUST, CISAWS, CBP, NISTCSF



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and open the CloudWatch console at https://console.aws.amazon.com/cloudwatch/.

2. In the navigation pane, click on "Alarms".

3. In the "Alarms" dashboard, you can see all the alarms that have been set up. Look for the Network ACL Changes Alarm. If it's in the "ALARM" state, it means that the changes in Network ACL have crossed the threshold set for the alarm.

4. For more details, click on the alarm name. In the details pane, you can see the metric name, the threshold set, the period over which the metric is evaluated, and other details. You can also see the history of the alarm, which shows when the alarm state changed and why.

#### Using CLI

1. First, you need to install and configure AWS CLI on your local machine. You can do this by using the following commands:

   - To install AWS CLI, use the command: `pip install awscli`
   - To configure AWS CLI, use the command: `aws configure` and then enter your AWS Access Key ID, AWS Secret Access Key, Default region name, and Default output format when prompted.

2. Once AWS CLI is installed and configured, you can use the `describe-alarms` command to list all the alarms in your AWS account. The command is as follows:

   `aws cloudwatch describe-alarms`

   This command will return a list of all the alarms in your AWS account, including the Network ACL Changes Alarm if it exists.

3. To specifically check for the Network ACL Changes Alarm, you can filter the results of the `describe-alarms` command using the `--alarm-names` option. The command is as follows:

   `aws cloudwatch describe-alarms --alarm-names "Network ACL Changes Alarm"`

   This command will return the details of the Network ACL Changes Alarm if it exists.

4. If the Network ACL Changes Alarm does not exist or if it is not configured correctly, you will need to create or reconfigure it. You can do this using the `put-metric-alarm` command. The command is as follows:

   `aws cloudwatch put-metric-alarm --alarm-name "Network ACL Changes Alarm" --metric-name "NetworkAclChanges" --namespace "AWS/EC2" --statistic "SampleCount" --period 300 --threshold 1 --comparison-operator "GreaterThanOrEqualToThreshold" --evaluation-periods 1 --alarm-actions "arn:aws:sns:us-east-1:123456789012:MyTopic" --unit "Count"`

   This command will create a new Network ACL Changes Alarm or update the existing one to trigger an alarm when the number of Network ACL changes is greater than or equal to 1 within a 5-minute period. The alarm will send a notification to the specified SNS topic when it is triggered.

#### Using Python

1. **Set up AWS SDK and Python Boto3:** First, you need to set up AWS SDK and Python Boto3 on your local system. Boto3 is the Amazon Web Services (AWS) Software Development Kit (SDK) for Python, which allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, etc. You can install it using pip:

   ```python
   pip install boto3
   ```

2. **Configure AWS Credentials:** You need to configure your AWS credentials. You can configure credentials by using the AWS CLI or by placing them directly in your script. It's recommended to use AWS CLI for security purposes. Run `aws configure` and enter your Access Key, Secret Key, and region when prompted.

3. **Create a Python Script to Check Network ACL Changes:** Now, you can create a Python script using Boto3 to check for Network ACL changes. The script will use the `describe_network_acls()` function to get the details of all Network ACLs and then check the `NetworkAcl` object for changes.

   ```python
   import boto3

   def check_network_acl_changes():
       client = boto3.client('ec2')
       response = client.describe_network_acls()

       for acl in response['NetworkAcls']:
           # Check for changes in the ACL
           # This is a simplified example, you may need to check specific fields depending on your needs
           if acl['IsDefault'] == False:
               print(f"Non-default Network ACL detected: {acl['NetworkAclId']}")

   check_network_acl_changes()
   ```

4. **Set up CloudWatch Alarm for Network ACL Changes:** The above script will only check for changes at the time it's run. If you want to continuously monitor for changes, you can set up a CloudWatch Alarm that triggers the script whenever a change is detected. This involves creating a CloudWatch Events rule that matches the `ModifyNetworkAcl` and `CreateNetworkAcl` API calls and then targets your script. This is more complex and involves additional AWS services, but it allows for real-time monitoring of changes.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

The "Network ACL Changes Alarm" indicates that changes have been made to the Network Access Control List (NACL) in your AWS account. To remediate this issue, you can follow the steps below:

1. Open the AWS Management Console and navigate to the VPC service.

2. Select the VPC where the NACL changes were made.

3. Click on the "Network ACLs" option in the left-hand menu.

4. Identify the NACL that has been modified and click on its name.

5. Review the "Inbound Rules" and "Outbound Rules" tabs to identify any unauthorized changes.

6. If unauthorized changes are identified, click the "Edit" button for the relevant rule and modify it as necessary.

7. Click the "Save" button to apply the changes.

8. Once all unauthorized changes have been remediated, update the alarm configuration to ensure that you are alerted if any further unauthorized changes are made to the NACL.

9. To update the alarm configuration, navigate to the CloudWatch service, select the relevant alarm, and click the "Actions" button.

10. Select "Edit" and update the alarm configuration as necessary.

11. Click the "Save" button to apply the changes.

By following these steps, you can remediate the "Network ACL Changes Alarm" issue in your AWS account.

#### Using CLI

The Network ACL Changes Alarm is triggered when there is a change to the network access control list (ACL) in your AWS account. This could potentially allow unauthorized access to your network resources. To remediate this issue, you can follow these steps:

1. Login to your AWS account and open the AWS CLI.

2. Verify that the Network ACL Changes Alarm is triggered by running the following command:
```
aws cloudwatch describe-alarms --alarm-names Network_ACL_Changes_Alarm
```

3. Identify the network ACL that has been modified by running the following command:
```
aws ec2 describe-network-acls --query "NetworkAcls[?Associations[?SubnetId=='<subnet_id>']]"
```
Replace `<subnet_id>` with the ID of the subnet associated with the modified network ACL.

4. Review the changes made to the network ACL by running the following command:
```
aws ec2 describe-network-acls --network-acl-id <network_acl_id> --query "NetworkAcls[0].Entries"
```
Replace `<network_acl_id>` with the ID of the modified network ACL.

5. If the changes made to the network ACL are unauthorized, you can revert the changes by running the following command:
```
aws ec2 replace-network-acl-entry --network-acl-id <network_acl_id> --rule-number <rule_number> --protocol <protocol> --rule-action <rule_action> --cidr-block <cidr_block> --egress --region <region>
```
Replace `<network_acl_id>` with the ID of the modified network ACL, `<rule_number>` with the number of the rule that was modified, `<protocol>` with the protocol type, `<rule_action>` with the action taken, `<cidr_block>` with the CIDR block affected, and `<region>` with the AWS region where the network ACL is located.

6. Finally, verify that the changes have been reverted by running the following command:
```
aws ec2 describe-network-acls --network-acl-id <network_acl_id> --query "NetworkAcls[0].Entries"
```
Replace `<network_acl_id>` with the ID of the modified network ACL. The output should show the original rules before the unauthorized changes were made.

By following these steps, you can remediate the Network ACL Changes Alarm in AWS using the AWS CLI.

#### Using Python

The Network ACL Changes Alarm is triggered when there are changes made to the Network Access Control Lists (NACLs) in your AWS environment. To remediate this issue using Python, you can follow these steps:

1. Identify the source of the change: You can use the AWS CloudTrail service to identify the source of the change. CloudTrail logs all API calls made to your AWS account, and you can use it to see who made the change and when it was made.

2. Review the change: Once you have identified the source of the change, you should review the change to ensure that it was made in accordance with your organization's security policies and best practices.

3. Roll back the change: If the change was made in error or is not in compliance with your organization's security policies, you should roll back the change. You can use the AWS CLI or the AWS Management Console to roll back the change.

4. Update NACLs: If the change was made in compliance with your organization's security policies, you should update your NACLs to reflect the change. You can use the AWS CLI or the AWS Management Console to update your NACLs.

5. Monitor for future changes: To prevent future misconfigurations, you should monitor your NACLs for changes and set up alerts to notify you of any unauthorized changes.

Here is some sample Python code to get you started with monitoring NACL changes using AWS CloudWatch:

```
import boto3

client = boto3.client('cloudwatch')

response = client.put_metric_alarm(
    AlarmName='Network ACL Changes',
    AlarmDescription='Alarm triggered when there are changes made to the Network Access Control Lists (NACLs)',
    MetricName='NetworkAclChanges',
    Namespace='AWS/EC2',
    Statistic='Sum',
    Period=300,
    EvaluationPeriods=1,
    Threshold=1,
    ComparisonOperator='GreaterThanOrEqualToThreshold',
    Dimensions=[
        {
            'Name': 'InstanceId',
            'Value': 'i-0123456789abcdef0'
        },
    ],
    AlarmActions=[
        'arn:aws:sns:us-west-2:123456789012:MyTopic'
    ],
    OKActions=[
        'arn:aws:sns:us-west-2:123456789012:MyTopic'
    ],
    InsufficientDataActions=[
        'arn:aws:sns:us-west-2:123456789012:MyTopic'
    ],
    Unit='Count'
)
```

This code sets up a CloudWatch alarm to monitor for changes to NACLs in your AWS environment. When a change is detected, the alarm will trigger an SNS notification to a specified topic. You can customize this code to meet your specific needs and requirements.

### Additional Reading:

- [https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html) 


</Tab>
</Tabs>