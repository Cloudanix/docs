---
slug: cw_loggroup_retention_period_check
title: Cloudwatch Loggroup Retention Period Should Be Reviewed
sidebar_label: Cloudwatch Loggroup Retention Period Should Be Reviewed
---

### More Info:

This rule checks if an Amazon CloudWatch LogGroup retention period is set to greater than 365 days or else a specified retention period. The rule is NON_COMPLIANT if the retention period is less than MinRetentionTime, if specified, or else 365 days.

### Risk Level

Medium

### Address

Configuration

### Compliance Standards

SOC2,HIPAA,GDPR,NISTCSF,PCIDSS,RBI_MD_ITF,RBI_UCB



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and open the CloudWatch console at https://console.aws.amazon.com/cloudwatch/.

2. In the navigation pane, click on 'Logs'.

3. In the 'Log groups' section, you will see a list of all your log groups. 

4. For each log group, check the 'Expire Events After' column. This column shows the retention period for each log group. If the retention period is set to 'Never Expire', it means that the log data is kept indefinitely and this could be a potential misconfiguration.

#### Using CLI

1. Install and configure AWS CLI: Before you can run any AWS CLI commands, you need to install and configure the AWS CLI on your local machine. You can do this by following the instructions provided in the AWS CLI User Guide.

2. List all CloudWatch Log Groups: Use the following AWS CLI command to list all the CloudWatch Log Groups in your AWS account:

   ```
   aws logs describe-log-groups
   ```

   This command will return a JSON object that contains information about all the CloudWatch Log Groups in your AWS account.

3. Check the retention period: In the returned JSON object, look for the "retentionInDays" field. This field indicates the retention period for each CloudWatch Log Group. If the "retentionInDays" field is not present or is set to "Never Expire", then the retention period for that Log Group has not been set and should be reviewed.

4. Use a script to automate the process: If you have a large number of CloudWatch Log Groups, it might be more efficient to use a Python script to automate the process of checking the retention period. You can use the Boto3 library, which is the Amazon Web Services (AWS) Software Development Kit (SDK) for Python, to interact with AWS services. Here is a simple script that lists all CloudWatch Log Groups and their retention periods:

   ```python
   import boto3

   # Create a CloudWatch client
   cw = boto3.client('logs')

   # List all log groups
   response = cw.describe_log_groups()

   for log_group in response['logGroups']:
       print('Log Group Name:', log_group['logGroupName'])
       if 'retentionInDays' in log_group:
           print('Retention Period:', log_group['retentionInDays'], 'days')
       else:
           print('Retention Period: Never Expire')
   ```
   
   This script will print the name and retention period of each CloudWatch Log Group in your AWS account. If the retention period is not set, it will print "Never Expire".

#### Using Python

1. Install the necessary AWS SDK for Python (Boto3) if you haven't done so already. You can install it using pip:

```python
pip install boto3
```

2. Import the necessary modules and create a session using your AWS credentials:

```python
import boto3

session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    region_name='YOUR_REGION'
)
```

3. Use the CloudWatch client from boto3 to list all the log groups:

```python
client = session.client('logs')
response = client.describe_log_groups()
```

4. Iterate over the log groups and check the retention period. If the retention period is not set or is set to a value that is not acceptable based on your organization's policies, print a message:

```python
for log_group in response['logGroups']:
    if 'retentionInDays' not in log_group or log_group['retentionInDays'] < YOUR_MIN_RETENTION:
        print(f"Log group {log_group['logGroupName']} has a misconfigured retention period.")
```

Replace `YOUR_MIN_RETENTION` with the minimum acceptable retention period for your organization.

Please note that this script only checks the log groups in one region. If you have resources in multiple regions, you need to create a session for each region and repeat the process. Also, remember to replace `'YOUR_ACCESS_KEY'`, `'YOUR_SECRET_KEY'`, and `'YOUR_REGION'` with your actual AWS access key, secret key, and region.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of CloudWatch Log Group retention period in AWS, follow these steps using the AWS Management Console:

1. **Login to AWS Console**: Go to the AWS Management Console (https://aws.amazon.com/) and login to your account.

2. **Navigate to CloudWatch**: Click on the "Services" dropdown at the top of the page, search for "CloudWatch" in the search bar, and click on the CloudWatch service.

3. **Select Log Groups**: In the CloudWatch dashboard, click on "Log groups" in the left-hand menu to view all the log groups in your account.

4. **Find the Log Group**: Locate the log group for which you want to review or update the retention period. You can use the search bar to find the log group quickly.

5. **Update Retention Period**:
   - Click on the log group name to open the log group details.
   - In the log group details page, click on the "Edit" button next to the "Retention settings" section.
   - Update the retention period as per your requirements. You can choose a value between 1 day to 10 years or select "Never Expire" if you want to retain logs indefinitely.
   - Click on the "Save changes" button to apply the new retention period.

6. **Verify the Changes**: Once you have updated the retention period, you can verify the changes by checking the "Retention settings" section in the log group details.

By following these steps, you can remediate the misconfiguration of the CloudWatch Log Group retention period in AWS using the AWS Management Console.

#### Using CLI

To remediate the CloudWatch Loggroup retention period misconfiguration in AWS using the AWS CLI, follow these steps:

1. List all the CloudWatch log groups to identify the ones with retention periods that need to be reviewed:
```bash
aws logs describe-log-groups
```

2. Identify the log group for which you want to update the retention period.

3. Update the retention period for the identified log group using the following command:
```bash
aws logs put-retention-policy --log-group-name YOUR_LOG_GROUP_NAME --retention-in-days YOUR_RETENTION_PERIOD
```
Replace `YOUR_LOG_GROUP_NAME` with the name of the log group you want to update and `YOUR_RETENTION_PERIOD` with the desired retention period in days.

For example, to set the retention period of a log group named "my-log-group" to 30 days, you would run:
```bash
aws logs put-retention-policy --log-group-name my-log-group --retention-in-days 30
```

4. Verify that the retention period has been updated successfully by describing the log group again:
```bash
aws logs describe-log-groups --log-group-name YOUR_LOG_GROUP_NAME
```

By following these steps, you can remediate the CloudWatch Loggroup retention period misconfiguration in AWS using the AWS CLI.

#### Using Python

To remediate the CloudWatch Loggroup retention period misconfiguration in AWS using Python, follow these steps:

1. Install the AWS SDK for Python (Boto3) if you haven't already:
```
pip install boto3
```

2. Use the following Python script to update the retention period for the CloudWatch Loggroup:

```python
import boto3

# Initialize the CloudWatch Logs client
client = boto3.client('logs')

# Specify the Log Group name and the desired retention period in days
log_group_name = 'YOUR_LOG_GROUP_NAME'
retention_days = YOUR_DESIRED_RETENTION_DAYS

# Update the retention policy for the Log Group
response = client.put_retention_policy(
    logGroupName=log_group_name,
    retentionInDays=retention_days
)

print(f"Retention period for Log Group {log_group_name} updated to {retention_days} days.")
```

3. Replace `'YOUR_LOG_GROUP_NAME'` with the name of the CloudWatch Log Group you want to update and `YOUR_DESIRED_RETENTION_DAYS` with the desired retention period in days.

4. Run the Python script to update the retention period for the specified CloudWatch Log Group.

After following these steps, the retention period for the specified CloudWatch Log Group will be updated to the desired value, remediating the misconfiguration.



</Tab>
</Tabs>