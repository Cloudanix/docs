---
title: Ports Should Not Be Open for Internal Traffic
---

### More Info:

Security groups should not have all ports or protocols open to the internal traffic. Security groups should be created on a per-service basis and avoid allowing all ports or protocols even for internal access.

### Risk Level

Medium

### Address

Security

### Compliance Standards

CBP, NIST, MAS, APRA

### Remediation

How to remediate if EC2 security groups all ports are open to internal traffic

#### Using AWS Console

1. Identify the affected security groups:
   - Navigate to the EC2 service in the AWS Management Console.
   - Go to the "Security Groups" section.
   - Identify the security groups that have all ports open to internal traffic.
     (In the Cloudanix Console, navigate to "Misconfig" page and look for Affected Assets for "Ports Should Not Be Open for Internal Traffic" Policy.)
2. Update the security group rules:
   - Select the security group you want to modify.
   - Review the inbound and outbound rules associated with the security group.
   - Remove any rules that allow unrestricted access to all ports from the internal CIDR range (e.g., 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16).
   - Add specific rules for the required ports and protocols that should be allowed for internal traffic.
3. Verify the changes:
   - Confirm that the security group rules have been updated to restrict access to the desired ports for internal traffic.
   - Test the connectivity between instances within the same security group to ensure that internal communication is functioning as expected.
4. Repeat for other affected security groups:
   - If you have multiple security groups with the same issue, repeat the steps above to update the rules for each affected security group.

### Additional Reading:

- [http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/authorizing-access-to-an-instance.html](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/authorizing-access-to-an-instance.html)
