---
slug: ec2_instances_exist_with_default_groups
title: Default Security Groups Should Block All Traffic
sidebar_label: Default Security Groups Should Block All Traffic
---

### More Info:

Default security groups should block all traffic by default. EC2 instances should not be associated with default security groups.

### Risk Level

Medium

### Address

Security

### Compliance Standards

NIST

### Remediation

How to ensure EC2 instances do not use Default Security Group

#### Using AWS Console

1. Identify EC2 instances using the Default Security Group:
   - Navigate to the EC2 service in the AWS Management Console.
   - Go to the "Instances" view and identify the EC2 instances using the Default Security Group.
     (In the Cloudanix Console, navigate to "Misconfig" page and look for Affected Assets for "Default Security Groups Should Block All Traffic" Policy.)
2. Create a new security group:
   - Click on the "Create Security Group" button to create a new security group.
   - Provide a meaningful name and description for the security group.
   - Configure the desired inbound and outbound rules based on your requirements.
3. Assign the new security group to the EC2 instances:
   - Select an EC2 instance using the Default Security Group.
   - Click on the "Actions" dropdown menu and choose "Networking" -> "Change Security Groups".
   - In the "Change Security Groups" dialog, select the new security group you created in Step 2.
   - Click "Assign Security Groups" to apply the changes.
4. Repeat Step 3 for all EC2 instances using the Default Security Group:
   - Repeat the process of selecting an EC2 instance and assigning the new security group to it.
   - Continue until all EC2 instances previously using the Default Security Group are updated.
5. Verify the changes:
   - Double-check that all EC2 instances are now using the new security group instead of the Default Security Group.
   - Validate that the desired inbound and outbound rules are correctly configured for the new security group.
6. Remove the Default Security Group:
   - Once all EC2 instances are using the new security group and the changes are verified, you can remove the Default Security Group.
   - Select the Default Security Group from the list of security groups.
   - Click on the "Actions" dropdown menu and choose "Delete Security Group".
   - Confirm the deletion when prompted.

### Additional Reading:

- [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security-groups.html#default-security-group](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security-groups.html#default-security-group) 

