---
slug: rds_public_instance_exists
title: RDS Instances Should Not Be Publicly Accessible
sidebar_label: RDS Instances Should Not Be Publicly Accessible
---

### More Info:

RDS instances should not be launched into the public cloud. Unless there is a specific business requirement, RDS instances should not have a public endpoint and should be accessed from within a VPC only.

### Risk Level

High

### Address

Security

### Compliance Standards

NIST



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console and open the Amazon RDS console at https://console.aws.amazon.com/rds/.

2. In the navigation pane, choose "Databases".

3. Select the RDS instance that you want to check.

4. In the "Connectivity & security" tab, under "Security" section, look for "Public accessibility". If it is set to "Yes", then the RDS instance is publicly accessible.

5. Additionally, you can check the associated security groups. Under the "Security group rules" section, if there are inbound rules that allow all traffic (0.0.0.0/0) from all ports, it indicates that the RDS instance is publicly accessible.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your AWS Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all RDS instances: Use the following command to list all the RDS instances in your AWS account.

   ```
   aws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier,PubliclyAccessible]'
   ```

   This command will return a list of all RDS instances along with their identifiers and whether they are publicly accessible or not.

3. Filter the results: The above command will return a list of all RDS instances. You need to filter out the instances that are publicly accessible. You can do this by adding a `--query` parameter to the command like this:

   ```
   aws rds describe-db-instances --query 'DBInstances[?PubliclyAccessible==`true`].[DBInstanceIdentifier]'
   ```

   This command will return a list of identifiers of all RDS instances that are publicly accessible.

4. Review the results: Review the results returned by the command. If any RDS instances are publicly accessible, you need to take action to secure them. If no instances are returned by the command, then all your RDS instances are secure.

#### Using Python

1. Install the necessary Python libraries: Before you can start writing the script, you need to install the necessary Python libraries. The Boto3 library is the Amazon Web Services (AWS) Software Development Kit (SDK) for Python, which allows Python developers to write software that makes use of AWS services like Amazon S3, Amazon EC2, etc. You can install it using pip:

   ```bash
   pip install boto3
   ```

2. Configure AWS Credentials: Boto3 needs your AWS credentials (access key and secret access key) to call AWS services on your behalf. These can be configured in several ways, but the simplest is to use the AWS CLI's configure command:

   ```bash
   aws configure
   ```

3. Write the Python script: The following Python script uses Boto3 to list all RDS instances and checks if they are publicly accessible:

   ```python
   import boto3

   def check_rds_public_accessibility():
       client = boto3.client('rds')
       response = client.describe_db_instances()
       for instance in response['DBInstances']:
           if instance['PubliclyAccessible']:
               print(f"RDS instance {instance['DBInstanceIdentifier']} is publicly accessible")

   if __name__ == "__main__":
       check_rds_public_accessibility()
   ```

4. Run the Python script: You can run the Python script from your terminal using the following command:

   ```bash
   python check_rds_public_accessibility.py
   ```

This script will print out the identifiers of all RDS instances that are publicly accessible. If no instances are publicly accessible, it will not print anything.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of RDS instances being publicly accessible in AWS, you can follow these steps using the AWS Management Console:

1. **Log in to the AWS Management Console**: Go to https://aws.amazon.com/ and log in to your AWS account.

2. **Navigate to the RDS Dashboard**: Click on the "Services" dropdown menu at the top of the page, select "RDS" under the Database section.

3. **Select the RDS Instance**: From the list of RDS instances, select the instance that you want to modify the security group for by clicking on its identifier.

4. **Modify the Security Group**: In the RDS instance details page, scroll down to the "Security group rules" section. Click on the security group name listed there.

5. **Edit Inbound Rules**: In the security group's "Inbound rules" tab, you will see the current rules allowing inbound traffic to the RDS instance. To make the RDS instance not publicly accessible, you need to remove the rule that allows inbound traffic from any source (0.0.0.0/0).

6. **Delete the Public Access Rule**: Find the rule that allows inbound traffic from 0.0.0.0/0 (or any IP address range), select it, and click on the "Delete" or "Remove" button to remove this rule.

7. **Add Specific IP Addresses (Optional)**: If you still need to access the RDS instance from specific IP addresses or ranges, you can add new inbound rules to allow traffic only from those specific sources.

8. **Save Changes**: After removing the public access rule and adding specific IP addresses if necessary, click on the "Save rules" or "Apply changes" button to apply the new security group rules.

By following these steps, you have successfully remediated the misconfiguration of making RDS instances publicly accessible in AWS by updating the security group rules to restrict access to specific IP addresses or ranges.

#### Using CLI

To remediate the issue of RDS instances being publicly accessible in AWS using AWS CLI, follow these steps:

1. Identify the security group associated with the RDS instance:
   Run the following AWS CLI command to get the details of the security group associated with the RDS instance:
   ```
   aws rds describe-db-instances --db-instance-identifier <your-db-instance-id>
   ```
   Note down the Security Group ID associated with the RDS instance.

2. Update the inbound rules of the security group to restrict access:
   Run the following AWS CLI command to revoke the ingress rule that allows public access to the RDS instance. Replace `<your-security-group-id>` and `<your-ip-cidr>` with the actual values.
   ```
   aws ec2 revoke-security-group-ingress --group-id <your-security-group-id> --protocol tcp --port 3306 --cidr <your-ip-cidr>
   ```
   This command will remove the ingress rule that allows access to port 3306 (MySQL) from the specified IP CIDR range.

3. Verify the changes:
   Run the following AWS CLI command to describe the inbound rules of the security group and confirm that the public access rule has been revoked:
   ```
   aws ec2 describe-security-groups --group-ids <your-security-group-id>
   ```

By following these steps, you can remediate the misconfiguration of RDS instances being publicly accessible in AWS by updating the security group's inbound rules using AWS CLI.

#### Using Python

To remediate the misconfiguration of RDS instances being publicly accessible in AWS using Python, you can follow these steps:

1. Import the necessary libraries:
```python
import boto3
```

2. Initialize the AWS client for RDS:
```python
rds_client = boto3.client('rds')
```

3. Get a list of all RDS instances:
```python
response = rds_client.describe_db_instances()
```

4. Iterate through each RDS instance and check if it is publicly accessible. If it is, modify the security group to remove public access:
```python
for db_instance in response['DBInstances']:
    db_instance_identifier = db_instance['DBInstanceIdentifier']
    db_instance_publicly_accessible = db_instance['PubliclyAccessible']
    
    if db_instance_publicly_accessible:
        response_sg = rds_client.describe_db_security_groups(DBInstanceIdentifier=db_instance_identifier)
        security_group_id = response_sg['DBSecurityGroups'][0]['DBSecurityGroupId']
        
        # Revoke the ingress rule that allows public access
        rds_client.revoke_db_security_group_ingress(
            DBSecurityGroupName=security_group_id,
            CIDRIP='0.0.0.0/0'
        )
        
        print(f"Public access revoked for RDS instance: {db_instance_identifier}")
```

5. Run the script to remediate the misconfiguration.

Please ensure that you have the necessary permissions to modify RDS instances and security groups in your AWS account before running this script.

### Additional Reading:

- [https://docs.aws.amazon.com/redshift/latest/mgmt/getting-started-cluster-in-vpc.html](https://docs.aws.amazon.com/redshift/latest/mgmt/getting-started-cluster-in-vpc.html) 


</Tab>
</Tabs>