---
slug: ses_malware_scanning_enabled
title: SES Malware Scanning Should Be Enabled
sidebar_label: SES Malware Scanning Should Be Enabled
---

### More Info:

Ensure SES malware scanning is enabled

### Risk Level

Low

### Addresses

Security

### Compliance Standards

CBP

### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Log in to the AWS Management Console and navigate to the Simple Email Service (SES) dashboard.
2. In the left navigation pane, select "Email Receiving" under "Email Receiving Settings".
3. In the "Rule Sets" section, you will see a list of all the rule sets. Click on the rule set that you want to check.
4. In the "Rules" section, look for the "Enabled" column. If the "Enabled" column for the "Malware Scanning" rule is set to "Yes", then malware scanning is enabled. If it is set to "No", then malware scanning is not enabled.
</Accordion>

<Accordion title='Using CLI'>
1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Make sure you have the necessary permissions to access the SES resources.

2. Once the AWS CLI is installed and configured, you can use the following command to list all the receipt rules in a given receipt rule set:

   ```
   aws ses list-receipt-rules --rule-set-name <Your-Rule-Set-Name>
   ```

   Replace `<Your-Rule-Set-Name>` with the name of your rule set. This command will return a list of all the receipt rules in the specified rule set.

3. For each receipt rule, check if it has an enabled action of type `Lambda` with an invocation type of `Event`. This action is used to trigger a Lambda function for each email received. The Lambda function should be configured to scan the email for malware. You can do this by inspecting the `Actions` field of the receipt rule. Here is an example of how to do this in Python:

   ```python
   import json

   # Assume `rule` is a dictionary representing a receipt rule
   actions = rule['Actions']
   for action in actions:
       if action['Type'] == 'Lambda' and action['InvocationType'] == 'Event':
           # This is a Lambda action. Check if it is configured to scan for malware
           function_arn = action['FunctionArn']
           print(f'Lambda function {function_arn} is used to scan emails for malware')
   ```

4. If none of the receipt rules in the rule set have an enabled Lambda action configured to scan for malware, then SES malware scanning is not enabled.
</Accordion>

<Accordion title='Using Python'>
To check if Malware Scanning is enabled in Amazon Simple Email Service (SES), you can use the AWS SDK for Python (Boto3). Here are the steps:

1. **Set up AWS SDK for Python (Boto3):**
   First, you need to install and configure Boto3. You can install it using pip:

   ```
   pip install boto3
   ```

   Then, configure your AWS credentials. You can do this by setting the following environment variables:

   ```
   AWS_ACCESS_KEY_ID = 'your_access_key'
   AWS_SECRET_ACCESS_KEY = 'your_secret_key'
   ```

2. **Create a SES client:**
   You can create a SES client using Boto3 as follows:

   ```python
   import boto3

   ses = boto3.client('ses')
   ```

3. **Get the SES receipt rules:**
   You can get the receipt rules using the `list_receipt_rules` method. This method returns a dictionary that contains information about the receipt rules.

   ```python
   response = ses.list_receipt_rules(RuleSetName='your_rule_set_name')
   ```

4. **Check if Malware Scanning is enabled:**
   You can check if Malware Scanning is enabled by iterating over the receipt rules and checking the `ScanEnabled` attribute.

   ```python
   for rule in response['Rules']:
       if 'ScanEnabled' in rule['Actions']:
           print(f"Malware Scanning is enabled for rule {rule['Name']}")
       else:
           print(f"Malware Scanning is not enabled for rule {rule['Name']}")
   ```

Please note that you need to replace `'your_rule_set_name'` with the name of your rule set. Also, this script assumes that you have the necessary permissions to list and describe the SES receipt rules.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of enabling malware scanning for AWS SES using the AWS console, follow these step-by-step instructions:

1. **Sign in to the AWS Management Console:**
   - Go to https://aws.amazon.com/ and sign in to the AWS Management Console using your credentials.

2. **Navigate to the Amazon SES Console:**
   - In the AWS Management Console, search for "SES" in the search bar or navigate to the "Services" dropdown menu and select "Simple Email Service" under the "Messaging" category.

3. **Enable Malware Scanning:**
   - In the Amazon SES console, click on the "Configuration Sets" option in the left-hand menu.
   - Select the configuration set that you want to enable malware scanning for, or create a new configuration set if needed.
   - Click on the "Edit" button next to the configuration set.

4. **Configure Malware Scanning:**
   - In the configuration set settings, scroll down to the "Email Sending" section.
   - Look for the "Enable virus scanning" option and make sure it is toggled on.
   - You can also configure other settings related to malware scanning such as the action to take when malware is detected.

5. **Save Changes:**
   - Once you have enabled malware scanning and configured the settings, click on the "Save" or "Update" button to apply the changes to the configuration set.

6. **Test the Configuration:**
   - To ensure that malware scanning is working correctly, send a test email that contains a known malware attachment or content.
   - Check the SES logs or notifications to verify that the malware scanning feature is detecting and handling the malware appropriately.

By following these steps, you can remediate the misconfiguration of enabling malware scanning for AWS SES using the AWS Management Console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of enabling malware scanning for AWS SES using AWS CLI, follow these step-by-step instructions:

1. Open your terminal or command prompt.

2. Run the following AWS CLI command to enable malware scanning for AWS SES:
```
aws ses put-configuration-set-reputation-options --configuration-set-name YOUR_CONFIGURATION_SET_NAME --enabled true --scan-enabled true
```
Replace `YOUR_CONFIGURATION_SET_NAME` with the name of your SES configuration set.

3. Verify that the malware scanning has been enabled successfully by running the following command:
```
aws ses get-configuration-set-reputation-options --configuration-set-name YOUR_CONFIGURATION_SET_NAME
```
Ensure that the `Enabled` and `ScanEnabled` parameters are set to `true`.

By following these steps, you have successfully enabled malware scanning for AWS SES using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of not having SES Malware Scanning enabled in AWS using Python, you can follow these steps:

1. Import the AWS SDK for Python (Boto3) by running the following command:
   ```bash
   pip install boto3
   ```

2. Use the following Python script to enable Malware Scanning for AWS SES:

```python
import boto3

def enable_malware_scan():
    ses_client = boto3.client('ses', region_name='us-east-1')  # Replace 'us-east-1' with your preferred region

    response = ses_client.set_maintenance_window(
        Enabled=True,
        StartDay=1,
        StartHour=0,
        StartMinute=0,
        EndDay=7,
        EndHour=23,
        EndMinute=59
    )

    response = ses_client.set_malware_scanning(
        Enabled=True
    )

    print("SES Malware Scanning has been enabled successfully.")

if __name__ == '__main__':
    enable_malware_scan()
```

3. Run the Python script to enable Malware Scanning for AWS SES. Make sure you have the necessary IAM permissions to perform this action.

After running the script, the Malware Scanning feature for SES should be enabled successfully. You can verify the configuration in the AWS Management Console for SES.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>

