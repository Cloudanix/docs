---
slug: default_master_username
title: Redshift Cluster Should Not Use Default Master Username
sidebar_label: Redshift Cluster Should Not Use Default Master Username
---

### More Info:

AWS Redshift database clusters should not be using "awsuser" (default master user name) for database access.

### Risk Level

Informational

### Address

Operational Maturity, Security

### Compliance Standards

PCIDSS




<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to the Redshift dashboard by selecting "Services" from the top menu, then selecting "Redshift" under the "Database" category.
3. In the Redshift dashboard, select "Clusters" from the left-hand menu. This will display a list of all your Redshift clusters.
4. For each cluster, check the "Master username" field. If the master username is "awsuser", this indicates that the default master username is being used, which is a misconfiguration.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   Installation:
   ```
   pip install awscli
   ```
   Configuration:
   ```
   aws configure
   ```
   You will be prompted to provide your AWS Access Key ID, Secret Access Key, default region name, and default output format.

2. List all Redshift clusters: Use the `describe-clusters` command to list all the Redshift clusters in your account. This command returns a JSON output that contains information about all your clusters.

   ```
   aws redshift describe-clusters
   ```

3. Parse the output: The output from the previous command includes a `Clusters` array that contains information about each cluster. You need to parse this output to find the `MasterUsername` for each cluster. You can do this using a tool like `jq`:

   ```
   aws redshift describe-clusters | jq -r '.Clusters[].MasterUsername'
   ```

4. Check for default username: The default master username for Redshift clusters is `awsuser`. If any of your clusters are using this username, it means they are using the default master username. You can check this by comparing the output from the previous step with `awsuser`. If any of the usernames match `awsuser`, it means that cluster is using the default master username.

#### Using Python

1. Import the necessary libraries: You will need the boto3 library, which allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, etc.

```python
import boto3
```

2. Create a Redshift client: This will allow you to interact with the Redshift service. You will need to provide your AWS credentials (access key and secret key) and the region in which your Redshift cluster is located.

```python
redshift = boto3.client('redshift', region_name='your_region', aws_access_key_id='your_access_key', aws_secret_access_key='your_secret_key')
```

3. Get the list of all Redshift clusters: You can do this using the `describe_clusters` method. This will return a list of all your Redshift clusters.

```python
clusters = redshift.describe_clusters()
```

4. Check the master username of each cluster: You can do this by iterating over the list of clusters and checking the `MasterUsername` attribute. If it is 'awsuser', which is the default, then the cluster is misconfigured.

```python
for cluster in clusters['Clusters']:
    if cluster['MasterUsername'] == 'awsuser':
        print(f"Cluster {cluster['ClusterIdentifier']} is using the default master username.")
```

This script will print out the identifiers of all clusters that are using the default master username. If no such clusters exist, it will not print anything.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of an AWS Redshift cluster using the default master username, follow these steps using the AWS Management Console:

1. **Login to AWS Console**: Go to the AWS Management Console (https://aws.amazon.com/console/) and log in to your AWS account.

2. **Navigate to Amazon Redshift**: In the AWS Management Console, search for "Redshift" in the services search bar and click on "Amazon Redshift" to open the Redshift dashboard.

3. **Select the Redshift Cluster**: From the list of Redshift clusters, select the cluster for which you want to remediate the misconfiguration.

4. **Modify the Cluster**: Click on the cluster identifier to open the cluster details page. In the cluster details page, click on the "Modify" button at the top.

5. **Change Master Username**: In the "Cluster Database Properties" section of the modify cluster page, locate the "Master user name" field. Change the default master username (usually "masteruser") to a custom username that follows your organization's security best practices.

6. **Save Changes**: After updating the master username, scroll down to the bottom of the modify cluster page and click on the "Modify cluster" button to save the changes.

7. **Monitor the Modification**: AWS Redshift will start applying the changes to the cluster. You can monitor the modification progress in the cluster details page.

8. **Verify the Changes**: Once the modification is completed, verify that the master username has been successfully changed to the custom username you specified.

By following these steps, you have successfully remediated the misconfiguration of using the default master username for an AWS Redshift cluster.

#### Using CLI

To remediate the misconfiguration of AWS Redshift cluster using the default master username, you can follow these steps using AWS CLI:

Step 1: List the existing Redshift clusters to identify the cluster that is using the default master username.
```
aws redshift describe-clusters
```

Step 2: Identify the Redshift cluster for which you want to change the master username.

Step 3: Modify the master username for the identified Redshift cluster using the following command:
```
aws redshift modify-cluster --cluster-identifier YOUR_CLUSTER_IDENTIFIER --master-username NEW_MASTER_USERNAME
```
Replace `YOUR_CLUSTER_IDENTIFIER` with the actual identifier of your Redshift cluster and `NEW_MASTER_USERNAME` with the desired non-default master username.

Step 4: You will be prompted to provide the master user password for confirmation. Enter the master user password when prompted.

Step 5: Verify that the master username has been successfully changed by describing the cluster again:
```
aws redshift describe-clusters --cluster-identifier YOUR_CLUSTER_IDENTIFIER
```

By following these steps, you can remediate the misconfiguration of using the default master username for an AWS Redshift cluster using the AWS CLI.

#### Using Python

To remediate the misconfiguration of an AWS Redshift cluster using the default master username, you can follow these steps using Python and AWS SDK (boto3):

1. Install boto3 library if you haven't already:
```bash
pip install boto3
```

2. Use the following Python script to update the master username of the Redshift cluster:

```python
import boto3

# Define the AWS region and the Redshift cluster identifier
region = 'your_aws_region'
cluster_identifier = 'your_redshift_cluster_identifier'

# Define the new master username
new_master_username = 'new_master_username'

# Create a Redshift client using boto3
redshift_client = boto3.client('redshift', region_name=region)

# Modify the Redshift cluster to update the master username
response = redshift_client.modify_cluster(
    ClusterIdentifier=cluster_identifier,
    MasterUserPassword=new_master_username,
    ApplyImmediately=True
)

# Print the response
print(response)
```

3. Replace the placeholders `your_aws_region`, `your_redshift_cluster_identifier`, and `new_master_username` with your actual AWS region, Redshift cluster identifier, and the desired new master username.

4. Run the Python script to update the master username of the Redshift cluster. This will trigger an immediate update, and the Redshift cluster will no longer use the default master username.

By following these steps and running the Python script, you can remediate the misconfiguration of an AWS Redshift cluster using the default master username.

### Additional Reading:

- [https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-clusters.html](https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-clusters.html) 


</Tab>
</Tabs>