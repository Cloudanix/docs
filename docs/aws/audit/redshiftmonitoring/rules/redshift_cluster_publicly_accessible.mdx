---
slug: redshift_cluster_publicly_accessible
title: Redshift Cluster Should Not Be Publicly Accessible
sidebar_label: Redshift Cluster Should Not Be Publicly Accessible
---

### More Info:

Amazon Redshift clusters should not be publicly accessible in order to minimise security risks.

### Risk Level

High

### Address

Security

### Compliance Standards

HIPAA, NIST, PCIDSS, HITRUST, SOC2, GDPR, NISTCSF, FedRAMP


### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console and open the Amazon Redshift console at https://console.aws.amazon.com/redshift/.

2. In the navigation pane, choose "Clusters". This will display a list of all your Redshift clusters.

3. Click on the name of the cluster that you want to check. This will open the cluster details page.

4. In the cluster details page, look for the "Publicly accessible" field under the "Network and security" section. If the value of this field is "Yes", then the Redshift cluster is publicly accessible.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local system. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all Redshift clusters: Use the following AWS CLI command to list all the Redshift clusters in your account:

   ```
   aws redshift describe-clusters
   ```

   This command will return a JSON output with details of all the Redshift clusters.

3. Check the PubliclyAccessible attribute: In the JSON output, look for the "PubliclyAccessible" attribute for each cluster. If the value of this attribute is "true", then the Redshift cluster is publicly accessible. 

   ```
   aws redshift describe-clusters --query 'Clusters[*].[ClusterIdentifier,PubliclyAccessible]'
   ```

   This command will return a list of all clusters along with their PubliclyAccessible status.

4. Automate the process: If you have a large number of clusters, you can automate this process by writing a Python script that uses the AWS SDK (Boto3) to list all clusters and check their PubliclyAccessible attribute. The script would essentially do the same thing as the above CLI commands, but in an automated manner.
</Accordion>

<Accordion title='Using Python'>
1. Install and configure AWS SDK for Python (Boto3) on your local system. This will allow you to interact with AWS services including Redshift.

```python
pip install boto3
```

2. Import the necessary modules and create a Redshift client using your AWS credentials.

```python
import boto3

aws_access_key_id = 'YOUR_ACCESS_KEY'
aws_secret_access_key = 'YOUR_SECRET_KEY'
region_name = 'us-west-2'

redshift = boto3.client('redshift', aws_access_key_id=aws_access_key_id, aws_secret_access_key=aws_secret_access_key, region_name=region_name)
```

3. Use the `describe_clusters` method to retrieve information about all Redshift clusters in your account.

```python
clusters = redshift.describe_clusters()
```

4. Iterate over the clusters and check the `PubliclyAccessible` attribute. If it's set to `True`, the cluster is publicly accessible and this is a misconfiguration.

```python
for cluster in clusters['Clusters']:
    if cluster['PubliclyAccessible']:
        print(f"Cluster {cluster['ClusterIdentifier']} is publicly accessible.")
```

This script will print out the identifiers of all publicly accessible Redshift clusters. If no such clusters exist, it will not output anything.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the issue of an AWS Redshift cluster being publicly accessible, follow these steps using the AWS Management Console:

1. **Login to AWS Console**: Go to the AWS Management Console (https://aws.amazon.com/) and login with your credentials.

2. **Navigate to Amazon Redshift**: From the AWS Management Console, navigate to the Amazon Redshift service.

3. **Select the Redshift Cluster**: In the Amazon Redshift dashboard, select the Redshift cluster that is publicly accessible.

4. **Modify Cluster**: Click on the cluster that you want to modify to access its details.

5. **Modify Cluster Settings**: In the cluster details page, click on the "Modify" button to change the cluster settings.

6. **Update Cluster Security Group**: Scroll down to the Network and Security section and locate the "VPC security groups" setting.

7. **Edit Security Groups**: Click on the "Edit" button next to the security group associated with the Redshift cluster.

8. **Remove Public Ingress Rules**: In the security group settings, remove any inbound rules that allow traffic from sources outside of your VPC or trusted networks.

9. **Save Changes**: Once you have removed the public ingress rules, click on the "Save" button to apply the changes.

10. **Verify Changes**: After saving the changes, verify that the Redshift cluster is no longer publicly accessible by checking the cluster's endpoint and ensuring it is not accessible from outside networks.

By following these steps, you will remediate the misconfiguration of having an AWS Redshift cluster publicly accessible.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the issue of an AWS Redshift cluster being publicly accessible, follow these steps using the AWS CLI:

Step 1: List all the Redshift clusters in your AWS account to identify the cluster that is publicly accessible.
```bash
aws redshift describe-clusters
```

Step 2: Identify the Redshift cluster that is publicly accessible by checking the value of the `PubliclyAccessible` parameter in the cluster description.

Step 3: Modify the Redshift cluster to make the cluster not publicly accessible by updating the cluster's security group. Replace `your-security-group-id` with the appropriate security group ID of your Redshift cluster.
```bash
aws redshift modify-cluster --cluster-identifier your-cluster-Cluster --no-publicly-accessible --vpc-security-group-ids your-security-group-id
```

After running these commands, your AWS Redshift cluster should no longer be publicly accessible. Make sure to replace `your-cluster-identifier` and `your-security-group-id` with the actual values for your Redshift cluster.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of an AWS Redshift cluster being publicly accessible, you can follow these steps using Python and the AWS SDK (boto3):

Step 1: Install the AWS SDK (boto3) if you haven't already:
```bash
pip install boto3
```

Step 2: Use the following Python script to modify the Redshift cluster parameter group to disable public accessibility:

```python
import boto3

# Initialize the Redshift client
client = boto3.client('redshift')

# Specify the Redshift cluster identifier
cluster_identifier = 'your-redshift-cluster-identifier'

# Describe the cluster to get the current parameter group
response = client.describe_clusters(ClusterIdentifier=cluster_identifier)
parameter_group_name = response['Clusters'][0]['ClusterParameterGroups'][0]['ParameterGroupName']

# Modify the cluster parameter group to disable public accessibility
response = client.modify_cluster_parameter_group(
    ParameterGroupName=parameter_group_name,
    Parameters=[
        {
            'ParameterName': 'publicly_accessible',
            'ParameterValue': 'false',
            'ApplyType': 'dynamic'
        },
    ]
)

# Apply the changes to the Redshift cluster
response = client.modify_cluster(
    ClusterIdentifier=cluster_identifier,
    ClusterParameterGroupName=parameter_group_name
)

print("Redshift cluster is no longer publicly accessible.")
```

Make sure to replace `'your-redshift-cluster-identifier'` with the actual identifier of your Redshift cluster.

Step 3: Run the Python script to remediate the misconfiguration and make the Redshift cluster not publicly accessible.

By following these steps, you can remediate the misconfiguration of an AWS Redshift cluster being publicly accessible using Python and the AWS SDK (boto3).
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-vpc.html](https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-vpc.html) 

