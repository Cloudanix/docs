---
slug: has_tags
title: Lambda Functions Should Have Tags
sidebar_label: Lambda Functions Should Have Tags
---

### More Info:

You can tag Lambda functions to organize them by owner, project or department. Tags are freeform key-value pairs that are supported across AWS services for use in filtering resources and adding detail to billing reports.

### Risk Level

Informational

### Address

Cost, Operational Maturity

### Compliance Standards

CBP




<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to the AWS Lambda console. You can do this by typing 'Lambda' into the search bar and selecting 'Lambda' from the dropdown menu.
3. In the AWS Lambda console, you will see a list of all your Lambda functions. Click on the name of the function you want to check.
4. In the function's detail page, scroll down to the 'Tags' section. If there are no tags listed, then the function is misconfigured.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   Installation:
   ```
   pip install awscli
   ```
   Configuration:
   ```
   aws configure
   ```
   You will be prompted to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. List all Lambda functions: Use the AWS CLI command `list-functions` to retrieve a list of all Lambda functions in your AWS account. The command is as follows:
   ```
   aws lambda list-functions
   ```
   This command will return a JSON output with details of all the Lambda functions.

3. Extract function names: From the JSON output, extract the names of all the Lambda functions. You can do this using a tool like `jq` or a scripting language like Python. Here's an example using `jq`:
   ```
   aws lambda list-functions | jq -r '.Functions[].FunctionName'
   ```

4. Check for tags: For each function name retrieved in the previous step, use the `list-tags` AWS CLI command to check if the function has any tags. The command is as follows:
   ```
   aws lambda list-tags --resource <FunctionARN>
   ```
   Replace `<FunctionARN>` with the ARN of the Lambda function. If the function has tags, this command will return a JSON output with the tags. If the function does not have tags, the command will return an empty JSON object.

#### Using Python

1. First, you need to install the AWS SDK for Python (Boto3) in your environment. You can do this by running the command `pip install boto3` in your terminal.

2. Import the necessary libraries and initialize the AWS Lambda client. Here is a sample script:

```python
import boto3

# Create a low-level service client by the SDK for Python (Boto3)
lambda_client = boto3.client('lambda')
```

3. Now, you can use the `list_functions` method to retrieve all the Lambda functions in your AWS account. Then, for each function, use the `list_tags` method to get the tags. If a function doesn't have any tags, it's a misconfiguration. Here is a sample script:

```python
# Get the list of all functions
response = lambda_client.list_functions()

# For each function, check if it has tags
for function in response['Functions']:
    function_name = function['FunctionName']
    tags = lambda_client.list_tags(Resource=function_name)
    if not tags['Tags']:
        print(f"Function {function_name} doesn't have any tags.")
```

4. Run the script. If there are any functions without tags, they will be printed out. This way, you can easily detect if there are any Lambda functions in your AWS account that don't have tags.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

Sure, here are the step by step instructions to remediate the "Lambda Functions Should Have Tags" misconfiguration in AWS using AWS console:

1. Login to your AWS console.
2. Navigate to the AWS Lambda service.
3. Click on the checkbox next to the Lambda function that you want to remediate.
4. Click on the "Add/Edit Tags" button at the top of the page.
5. In the "Key" field, enter a tag key (e.g. "Environment") that describes the function's purpose or environment.
6. In the "Value" field, enter a tag value (e.g. "Production") that provides additional information about the function.
7. Click on the "Add" button to add the tag to the function.
8. Repeat steps 5-7 for any additional tags that you want to add.
9. Once you have added all necessary tags, click on the "Save" button to save the changes.

That's it! You have successfully remediated the "Lambda Functions Should Have Tags" misconfiguration in AWS using AWS console.

#### Using CLI

To remediate the misconfiguration "Lambda Functions Should Have Tags" for AWS using AWS CLI, follow these steps:

1. Open the AWS CLI on your local machine.

2. Use the following command to list all the Lambda functions in your AWS account:

   ```
   aws lambda list-functions
   ```

3. Identify the Lambda functions that do not have tags associated with them.

4. Use the following command to add tags to a Lambda function:

   ```
   aws lambda tag-resource --resource-arn arn:aws:lambda:<region>:<account-id>:function:<function-name> --tags Key=<tag-key>,Value=<tag-value>
   ```

   Replace `<region>` with the AWS region where the Lambda function is located, `<account-id>` with your AWS account ID, `<function-name>` with the name of the Lambda function that needs to be tagged, `<tag-key>` with the name of the tag you want to add, and `<tag-value>` with the value of the tag you want to add.

   For example:

   ```
   aws lambda tag-resource --resource-arn arn:aws:lambda:us-east-1:123456789012:function:my-function --tags Key=Environment,Value=Production
   ```

   This command will add a tag to the Lambda function named "my-function" with the key "Environment" and the value "Production".

5. Repeat step 4 for all the Lambda functions that do not have tags associated with them.

6. Verify that all the Lambda functions have tags associated with them by using the following command:

   ```
   aws lambda list-tags --resource arn:aws:lambda:<region>:<account-id>:function:<function-name>
   ```

   Replace `<region>`, `<account-id>`, and `<function-name>` with the appropriate values.

   This command will list all the tags associated with the Lambda function. If the Lambda function has tags associated with it, the output will show the tags. If the Lambda function does not have tags associated with it, the output will be empty.

7. Once you have verified that all the Lambda functions have tags associated with them, the remediation is complete.

#### Using Python

To remediate the misconfiguration "Lambda Functions Should Have Tags" in AWS using Python, you can follow these steps:

1. First, import the necessary AWS SDK for Python (Boto3) library:
```python
import boto3
```

2. Then, create a Boto3 client for AWS Lambda:
```python
lambda_client = boto3.client('lambda')
```

3. Next, use the `list_functions()` method to get a list of all Lambda functions in your account:
```python
response = lambda_client.list_functions()
functions = response['Functions']
```

4. Loop through each Lambda function and check if it has any tags. If not, add a tag with a key-value pair of your choice (e.g. "Environment": "Production"):
```python
for function in functions:
    function_arn = function['FunctionArn']
    tags = lambda_client.list_tags(Resource=function_arn)['Tags']
    if not tags:
        lambda_client.tag_resource(Resource=function_arn, Tags={'Environment': 'Production'})
```

5. Finally, run the Python script and verify that all Lambda functions now have tags:
```python
python lambda_tagging.py
```

Note: You will need to have appropriate AWS credentials configured for Boto3 to be able to access your AWS account.


### Additional Reading:

- [https://docs.aws.amazon.com/lambda/latest/dg/configuration-tags.html](https://docs.aws.amazon.com/lambda/latest/dg/configuration-tags.html) 


</Tab>
</Tabs>