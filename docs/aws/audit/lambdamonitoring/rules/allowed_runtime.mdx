---
slug: allowed_runtime
title: Lambda Functions Should Have Latest Runtime Version
sidebar_label: Lambda Functions Should Have Latest Runtime Version
---

### More Info:

You should always use the latest version of the execution environment for your Amazon Lambda functions in order to adhere to AWS best practices and receive the newest software features, get the latest security patches and bug fixes, and benefit from better performance and reliability.

### Risk Level

Low

### Address

Security, Reliability

### Compliance Standards

CBP



### Triage and Remediation
<Tabs>


<Tab title='Prevention'>
### How to Prevent
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To prevent Lambda functions from using outdated runtime versions in AWS using the AWS Management Console, follow these steps:

1. **Navigate to the Lambda Console:**
   - Open the AWS Management Console.
   - In the search bar, type "Lambda" and select "Lambda" from the dropdown.

2. **Select the Lambda Function:**
   - In the Lambda dashboard, you will see a list of your Lambda functions.
   - Click on the name of the Lambda function you want to update.

3. **Check and Update the Runtime:**
   - In the function's configuration page, scroll down to the "Runtime settings" section.
   - Check the current runtime version. If it is not the latest, click the "Edit" button.
   - From the "Runtime" dropdown menu, select the latest available runtime version.
   - Click "Save" to apply the changes.

4. **Enable Notifications for Runtime Updates:**
   - Go to the "CloudWatch" service from the AWS Management Console.
   - Set up an alarm or notification to alert you when AWS announces new runtime versions.
   - This can be done by creating a CloudWatch Event Rule that triggers on AWS Lambda runtime updates and sends notifications via SNS (Simple Notification Service).

By following these steps, you can ensure that your Lambda functions are always using the latest runtime versions, thereby preventing potential security vulnerabilities and taking advantage of the latest features and performance improvements.
</Accordion>

<Accordion title='Using CLI'>
To ensure that your AWS Lambda functions are using the latest runtime version, you can follow these steps using the AWS CLI:

1. **List All Lambda Functions:**
   First, you need to list all the Lambda functions in your account to identify which ones need to be updated.
   ```sh
   aws lambda list-functions --query 'Functions[*].{FunctionName:FunctionName, Runtime:Runtime}'
   ```

2. **Check Available Runtime Versions:**
   Identify the latest runtime versions available for your Lambda functions. You can refer to the AWS Lambda documentation for the latest runtime versions or use the AWS CLI to describe a specific runtime.
   ```sh
   aws lambda get-function --function-name <FunctionName> --query 'Configuration.Runtime'
   ```

3. **Update Lambda Function Runtime:**
   For each Lambda function that is not using the latest runtime, update the runtime to the latest version. Replace `<FunctionName>` with the name of your Lambda function and `<NewRuntime>` with the latest runtime version.
   ```sh
   aws lambda update-function-configuration --function-name <FunctionName> --runtime <NewRuntime>
   ```

4. **Verify the Update:**
   After updating the runtime, verify that the Lambda function is now using the latest runtime version.
   ```sh
   aws lambda get-function-configuration --function-name <FunctionName> --query 'Runtime'
   ```

By following these steps, you can ensure that your AWS Lambda functions are using the latest runtime versions, which helps in maintaining security and performance.
</Accordion>

<Accordion title='Using Python'>
To ensure that AWS Lambda functions are always using the latest runtime version, you can implement a Python script that checks the runtime version of your Lambda functions and updates them if they are not using the latest version. Below are the steps to achieve this:

### Step 1: Install AWS SDK for Python (Boto3)
First, ensure you have Boto3 installed. You can install it using pip if you haven't already:

```bash
pip install boto3
```

### Step 2: List All Lambda Functions
Use Boto3 to list all the Lambda functions in your AWS account.

```python
import boto3

def list_lambda_functions():
    client = boto3.client('lambda')
    response = client.list_functions()
    return response['Functions']

lambda_functions = list_lambda_functions()
```

### Step 3: Check Runtime Versions
Create a function to check if the runtime version of each Lambda function is the latest. You can maintain a dictionary of the latest runtime versions for comparison.

```python
LATEST_RUNTIMES = {
    'python3.6': 'python3.6',
    'python3.7': 'python3.7',
    'python3.8': 'python3.8',
    'nodejs12.x': 'nodejs14.x',
    'nodejs10.x': 'nodejs14.x',
    # Add other runtimes as needed
}

def is_latest_runtime(runtime):
    return runtime in LATEST_RUNTIMES and runtime == LATEST_RUNTIMES[runtime]

def check_lambda_runtimes(lambda_functions):
    outdated_functions = []
    for function in lambda_functions:
        runtime = function['Runtime']
        if not is_latest_runtime(runtime):
            outdated_functions.append(function['FunctionName'])
    return outdated_functions

outdated_functions = check_lambda_runtimes(lambda_functions)
```

### Step 4: Update Outdated Lambda Functions
Create a function to update the runtime of outdated Lambda functions to the latest version.

```python
def update_lambda_runtime(function_name, new_runtime):
    client = boto3.client('lambda')
    response = client.update_function_configuration(
        FunctionName=function_name,
        Runtime=new_runtime
    )
    return response

def update_outdated_functions(outdated_functions):
    for function_name in outdated_functions:
        current_runtime = [f['Runtime'] for f in lambda_functions if f['FunctionName'] == function_name][0]
        new_runtime = LATEST_RUNTIMES[current_runtime]
        update_lambda_runtime(function_name, new_runtime)
        print(f"Updated {function_name} to runtime {new_runtime}")

update_outdated_functions(outdated_functions)
```

### Summary
1. **Install Boto3**: Ensure you have the AWS SDK for Python installed.
2. **List Lambda Functions**: Use Boto3 to list all Lambda functions.
3. **Check Runtime Versions**: Compare the current runtime versions with the latest versions.
4. **Update Outdated Functions**: Update the runtime of outdated Lambda functions to the latest version.

By following these steps, you can automate the process of ensuring that your AWS Lambda functions are always using the latest runtime versions.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Log in to the AWS Management Console and navigate to the AWS Lambda service.
2. In the AWS Lambda dashboard, select the Functions from the left-hand side menu. This will display a list of all the Lambda functions that are currently deployed within the selected AWS region.
3. Select a function from the list to view its configuration details. Under the Configuration tab, look for the Runtime field. This field indicates the runtime version that the selected Lambda function is currently using.
4. Compare the runtime version with the latest available runtime versions listed in the AWS Lambda Developer Guide. If the function's runtime version is not the latest, it indicates a misconfiguration. Repeat this process for all the Lambda functions deployed within your AWS environment.
</Accordion>

<Accordion title='Using CLI'>
1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Make sure you have the necessary permissions to access the Lambda functions.

2. Once the AWS CLI is set up, you can list all the Lambda functions in your account by running the following command:

   ```
   aws lambda list-functions --region your-region-name
   ```
   Replace 'your-region-name' with the name of your AWS region.

3. This command will return a JSON object with details about all your Lambda functions. To check the runtime version of each function, you can look at the 'Runtime' field in the returned JSON. 

4. To automate this process, you can use a Python script to parse the JSON and check if any functions are using an outdated runtime. Here's a simple example:

   ```python
   import json
   import subprocess

   def check_lambda_runtimes():
       result = subprocess.run(['aws', 'lambda', 'list-functions', '--region', 'your-region-name'], stdout=subprocess.PIPE)
       functions = json.loads(result.stdout)['Functions']
       for function in functions:
           if function['Runtime'] != 'python3.8':  # replace with the latest runtime version
               print(f"Function {function['FunctionName']} is using an outdated runtime: {function['Runtime']}")

   if __name__ == '__main__':
       check_lambda_runtimes()
   ```
   Replace 'your-region-name' with the name of your AWS region and 'python3.8' with the latest runtime version. This script will print the names of all functions that are using an outdated runtime.
</Accordion>

<Accordion title='Using Python'>
1. First, you need to install the AWS SDK for Python (Boto3) in your environment. You can do this by running the command `pip install boto3` in your terminal.

2. Once Boto3 is installed, you can use it to interact with AWS services. To check the runtime version of Lambda functions, you need to use the `get_function_configuration` method of the `lambda` client. Here is a sample script:

```python
import boto3

# Create a low-level service client
client = boto3.client('lambda')

# Get the list of all functions
response = client.list_functions()

# Iterate over each function
for function in response['Functions']:
    # Get the function configuration
    config = client.get_function_configuration(FunctionName=function['FunctionName'])
    # Print the function name and runtime
    print(f"Function: {function['FunctionName']}, Runtime: {config['Runtime']}")
```

3. This script will print the name and runtime of each Lambda function in your AWS account. To check if they are using the latest runtime version, you need to compare the `Runtime` value with the latest versions listed in the AWS documentation.

4. To automate this process, you can modify the script to include a list of the latest runtime versions and check if the `Runtime` value is in this list. If it's not, the script can print a warning message. Here is an example:

```python
import boto3

# Create a low-level service client
client = boto3.client('lambda')

# Get the list of all functions
response = client.list_functions()

# List of latest runtime versions
latest_runtimes = ['nodejs14.x', 'python3.9', 'java11', 'go1.16', 'dotnetcore3.1']

# Iterate over each function
for function in response['Functions']:
    # Get the function configuration
    config = client.get_function_configuration(FunctionName=function['FunctionName'])
    # Check if the runtime is the latest version
    if config['Runtime'] not in latest_runtimes:
        print(f"WARNING: Function {function['FunctionName']} is not using the latest runtime version. Current: {config['Runtime']}")
```

This script will print a warning for each function that is not using the latest runtime version.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate this misconfiguration in AWS, you can follow the below steps:

1. Open the AWS Management Console and navigate to the AWS Lambda service.
2. Select the Lambda function that you want to update.
3. Click on the "Configuration" tab.
4. Under the "General configuration" section, you will see the "Runtime" option. Click on the "Edit" button next to it.
5. Select the latest version of the runtime from the drop-down list.
6. Click on the "Save" button to apply the changes.

After following these steps, your Lambda function will be updated with the latest runtime version. It is recommended to regularly check for updates and keep your Lambda functions up-to-date to ensure optimal performance and security.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration "Lambda Functions Should Have Latest Runtime Version" for AWS using AWS CLI, follow these steps:

1. Open the AWS CLI on your local machine.

2. Run the following command to list all the Lambda functions in your AWS account:
```
aws lambda list-functions
```

3. Identify the Lambda function that is not using the latest runtime version.

4. Run the following command to update the runtime version of the Lambda function:
```
aws lambda update-function-configuration --function-name <function-name> --runtime <runtime-version>
```
Replace `<function-name>` with the name of your Lambda function and `<runtime-version>` with the latest runtime version available for your function's programming language.

5. Once the command is executed successfully, the runtime version of the Lambda function will be updated to the latest version. 

6. Verify the updated runtime version by running the following command:
```
aws lambda get-function-configuration --function-name <function-name> | grep Runtime
```
Replace `<function-name>` with the name of your Lambda function.

7. Repeat the above steps for all the Lambda functions that are not using the latest runtime version.

By following these steps, you can remediate the misconfiguration "Lambda Functions Should Have Latest Runtime Version" for AWS using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
Sure, I can help you with that. Here are the step-by-step instructions to remediate the misconfiguration "Lambda Functions Should Have Latest Runtime Version" in AWS using Python:

1. Open the AWS Management Console and go to the AWS Lambda service.

2. Select the Lambda function for which you want to update the runtime version.

3. Click on the "Configuration" tab.

4. Scroll down to the "Runtime settings" section and check the current runtime version of the function.

5. If the runtime version is not the latest one, then we need to update it.

6. Create a new Python script and import the Boto3 library to interact with AWS services.

7. Use the following code to update the runtime version of the Lambda function:

```python
import boto3

client = boto3.client('lambda')

response = client.update_function_configuration(
    FunctionName='your-function-name',
    Runtime='python3.8'
)

print(response)
```

Note: Replace 'your-function-name' with the actual name of your Lambda function and 'python3.8' with the latest runtime version you want to update to.

8. Save the Python script and run it.

9. Verify that the runtime version of the Lambda function has been updated to the latest one by checking the "Runtime settings" section in the AWS Lambda Management Console.

That's it! You have successfully remediated the misconfiguration "Lambda Functions Should Have Latest Runtime Version" in AWS using Python.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html](https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html) 

