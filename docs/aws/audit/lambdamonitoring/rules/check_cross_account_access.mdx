---
slug: check_cross_account_access
title: Lambda Functions Should Not Allow Cross Account Access
sidebar_label: Lambda Functions Should Not Allow Cross Account Access
---

### More Info:

Your Amazon Lambda functions should be configured to allow access only to trusted AWS accounts in order to protect against unauthorized cross account access.

### Risk Level

Medium

### Address

Security

### Compliance Standards

HITRUST, SOC2, NISTCSF, PCIDSS

### Remediation

How to prohibit Cross account access in lambda functions?

#### Using AWS Console

1. Open the AWS Management Console and navigate to the AWS Lambda service.
2. Select the Lambda function for which you want to prohibit cross-account access.
    (In the Cloudanix Console, navigate to "Misconfig" page and look for Affected Assets for "Lambda Functions Should Not Allow Cross Account Access" Policy.)
3. In the function details page, scroll down to the "Configuration" tab.
4. Under the "Permissions" section, review the IAM roles and permissions associated with the Lambda function.
5. Check if there are any IAM roles or policies that allow cross-account access to the Lambda function. Look for statements that include the `aws:SourceAccount` condition key and specify the allowed account IDs.
6. To prohibit cross-account access, modify the relevant IAM roles or policies to remove the statements that allow access from specific accounts. This ensures that only the accounts specified in the IAM roles or policies can invoke the Lambda function.
7. Alternatively, you can create a new IAM policy specifically for the Lambda function and specify the allowed account IDs in the `aws:SourceAccount` condition key. This policy can then be attached to the Lambda function's IAM role, effectively prohibiting cross-account access.
8. Test the Lambda function to verify that cross-account access is prohibited. Attempt to invoke the function from an unauthorized account and ensure that the request is denied.

### Additional Reading:

- [https://docs.aws.amazon.com/lambda/latest/dg/access-control-identity-based.html](https://docs.aws.amazon.com/lambda/latest/dg/access-control-identity-based.html) 

