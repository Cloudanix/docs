---
slug: deprecated_runtime
title: Lambda Functions Should Not Use Deprecated Versions
sidebar_label: Lambda Functions Should Not Use Deprecated Versions
---

### More Info:

You should not use the deprecated versions of the execution environment for your Amazon Lambda functions in order to adhere to AWS best practices.

### Risk Level

Low

### Address

Security, Reliability

### Compliance Standards

AWSWAF




<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to the AWS Lambda service by typing 'Lambda' into the search bar and selecting 'Lambda' from the dropdown menu.
3. In the AWS Lambda dashboard, you will see a list of all your Lambda functions. Click on the name of the function you want to check.
4. In the function overview page, under the 'Runtime' section, you can see the version of the runtime that the function is using. If the version is marked as deprecated in the AWS Lambda Developer Guide, then the function is using a deprecated version.

#### Using CLI

1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Make sure you have the necessary permissions to access the Lambda functions.

2. Once the AWS CLI is set up, you can list all the Lambda functions in your account by running the following command:

   ```
   aws lambda list-functions --region your-region-name
   ```
   Replace 'your-region-name' with the name of your AWS region.

3. The output of the above command will be a JSON object that contains information about all the Lambda functions in your account. You can parse this JSON object to get the names and runtime versions of all the Lambda functions.

4. To check if any of the Lambda functions are using deprecated versions, you can compare the runtime versions of the Lambda functions with the list of deprecated versions provided by AWS. If any of the Lambda functions are using a deprecated version, it means that there is a misconfiguration. 

   Here is a sample command to check if a specific Lambda function is using a deprecated version:

   ```
   aws lambda get-function-configuration --function-name your-function-name --query 'Runtime' --output text
   ```
   Replace 'your-function-name' with the name of your Lambda function. This command will return the runtime version of the specified Lambda function. If the returned version is in the list of deprecated versions, it means that the function is using a deprecated version.

#### Using Python

1. Install the necessary Python libraries: Before you start, you need to install the AWS SDK for Python (Boto3) in your environment. This can be done using pip:

   ```bash
   pip install boto3
   ```

2. Import the necessary libraries and establish a session with AWS: In your Python script, you need to import the boto3 library and establish a session with AWS using your access keys.

   ```python
   import boto3

   session = boto3.Session(
       aws_access_key_id='YOUR_ACCESS_KEY',
       aws_secret_access_key='YOUR_SECRET_KEY',
       region_name='YOUR_REGION'
   )
   ```

3. List all Lambda functions and their versions: Use the `list_functions` method to get a list of all Lambda functions in your account. Then, for each function, use the `list_versions_by_function` method to get a list of all versions of that function.

   ```python
   lambda_client = session.client('lambda')

   functions = lambda_client.list_functions()['Functions']

   for function in functions:
       versions = lambda_client.list_versions_by_function(FunctionName=function['FunctionArn'])['Versions']
   ```

4. Check for deprecated versions: For each version of each function, check if the version is deprecated. If it is, print a warning message.

   ```python
   for function in functions:
       versions = lambda_client.list_versions_by_function(FunctionName=function['FunctionArn'])['Versions']
       for version in versions:
           if version['Version'] == '$LATEST':
               continue
           if version['Runtime'] in ['nodejs', 'nodejs4.3', 'nodejs6.10', 'nodejs8.10']:
               print(f"Warning: Function {function['FunctionName']} uses deprecated Node.js runtime {version['Runtime']}")
           elif version['Runtime'] in ['dotnetcore1.0', 'dotnetcore2.0']:
               print(f"Warning: Function {function['FunctionName']} uses deprecated .NET Core runtime {version['Runtime']}")
           elif version['Runtime'] in ['go1.x']:
               print(f"Warning: Function {function['FunctionName']} uses deprecated Go runtime {version['Runtime']}")
           elif version['Runtime'] in ['python2.7']:
               print(f"Warning: Function {function['FunctionName']} uses deprecated Python runtime {version['Runtime']}")
           elif version['Runtime'] in ['ruby2.5']:
               print(f"Warning: Function {function['FunctionName']} uses deprecated Ruby runtime {version['Runtime']}")
           elif version['Runtime'] in ['java8']:
               print(f"Warning: Function {function['FunctionName']} uses deprecated Java runtime {version['Runtime']}")
   ```

This script will print a warning for each Lambda function that uses a deprecated runtime.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of Lambda Functions using deprecated versions in AWS, follow these steps:

1. Login to the AWS Management Console.
2. Go to the AWS Lambda service.
3. Select the Lambda function that is using a deprecated version.
4. Click on the "Configuration" tab.
5. In the "Runtime settings" section, select the latest version of the runtime that is available. For example, if the function is using Node.js 8.10, select Node.js 14.x.
6. Click on the "Save" button to save the changes.
7. Test the function to ensure that it is working properly with the updated runtime version.

By following these steps, you have successfully remediated the misconfiguration of Lambda Functions using deprecated versions in AWS.

#### Using CLI

To remediate the Lambda Functions Should Not Use Deprecated Versions misconfiguration in AWS using AWS CLI, follow these steps:

1. Open your terminal and make sure you have the AWS CLI installed.

2. Run the following command to list all the Lambda functions in your AWS account:

```
aws lambda list-functions
```

3. Identify the Lambda functions that are using deprecated versions.

4. Run the following command to update the runtime of the Lambda function to a non-deprecated version:

```
aws lambda update-function-configuration --function-name <function-name> --runtime <runtime>
```

Replace `<function-name>` with the name of the Lambda function that you want to update, and `<runtime>` with the non-deprecated runtime version that you want to use.

5. Repeat steps 4 and 5 for all the Lambda functions that are using deprecated versions.

6. Verify that all the Lambda functions are now using non-deprecated versions by running the following command:

```
aws lambda list-functions --query 'Functions[*].Runtime'
```

This command will return a list of all the Lambda functions and their respective runtimes. Make sure that all the runtimes are non-deprecated versions.

By following these steps, you can remediate the Lambda Functions Should Not Use Deprecated Versions misconfiguration in AWS using AWS CLI.

#### Using Python

To remediate the misconfiguration "Lambda Functions Should Not Use Deprecated Versions" in AWS using Python, follow the below steps:

1. Login to the AWS Management Console and navigate to the Lambda service.

2. Select the Lambda function that is using a deprecated version.

3. Click on the "Configuration" tab and scroll down to the "Runtime settings" section.

4. Verify the runtime version of the function. If it is using a deprecated version, then it needs to be updated.

5. Update the runtime version of the Lambda function to the latest version supported by AWS. You can refer to the AWS documentation to find the latest supported version.

6. Once the update is complete, click on the "Save" button to save the changes.

7. Test the updated Lambda function to ensure that it is functioning as expected.

8. Finally, it is recommended to regularly monitor the runtime versions of your Lambda functions and update them as needed to ensure that they are not using any deprecated versions.

In Python, you can use the AWS SDK boto3 to programmatically update the runtime version of your Lambda function. Here's an example code snippet:

```
import boto3

# Replace <function_name> and <new_runtime> with your function name and the new runtime version respectively
function_name = "<function_name>"
new_runtime = "<new_runtime>"

# Create a Lambda client object
lambda_client = boto3.client('lambda')

# Update the runtime version of the function
response = lambda_client.update_function_configuration(
    FunctionName=function_name,
    Runtime=new_runtime
)

# Print the response
print(response)
```


### Additional Reading:

- [https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html](https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html) 


</Tab>
</Tabs>