---
slug: default_timeout_used
title: Lambda Functions Should Have Default Timeout Set
sidebar_label: Lambda Functions Should Have Default Timeout Set
---

### More Info:

Your AWS Lambda Functions should have default timeout set in order to achieve greater relaibility and availability.

### Risk Level

Low

### Address

Reliability, Security

### Compliance Standards

CBP



### Triage and Remediation
<Tabs>


<Tab title='Prevention'>
### How to Prevent
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To prevent Lambda functions from having an indefinite timeout in AWS using the AWS Management Console, follow these steps:

1. **Navigate to the Lambda Console:**
   - Open the AWS Management Console.
   - In the search bar, type "Lambda" and select the Lambda service from the dropdown.

2. **Select the Lambda Function:**
   - In the Lambda dashboard, you will see a list of your Lambda functions.
   - Click on the name of the Lambda function you want to configure.

3. **Edit the Function Configuration:**
   - In the function's configuration page, click on the "Configuration" tab.
   - In the left-hand menu, select "General configuration."

4. **Set the Timeout:**
   - In the "General configuration" section, you will see a "Timeout" setting.
   - Set the timeout to a value that is appropriate for your function's execution time (e.g., 30 seconds, 1 minute).
   - Click the "Save" button to apply the changes.

By following these steps, you ensure that your Lambda functions have a default timeout set, preventing them from running indefinitely.
</Accordion>

<Accordion title='Using CLI'>
To prevent the misconfiguration of Lambda functions not having a default timeout set using AWS CLI, follow these steps:

1. **Set a Default Timeout When Creating a Lambda Function:**
   When you create a new Lambda function, specify the `--timeout` parameter to set a default timeout. For example, to set a timeout of 30 seconds:
   ```sh
   aws lambda create-function --function-name MyFunction \
   --runtime python3.8 --role arn:aws:iam::123456789012:role/execution_role \
   --handler lambda_function.lambda_handler --timeout 30 \
   --zip-file fileb://function.zip
   ```

2. **Update Existing Lambda Function to Set Timeout:**
   If you have an existing Lambda function, you can update its configuration to set a default timeout using the `update-function-configuration` command:
   ```sh
   aws lambda update-function-configuration --function-name MyFunction --timeout 30
   ```

3. **Automate Timeout Configuration with a Script:**
   Create a script to ensure all Lambda functions have a default timeout set. This script can iterate over all Lambda functions and set a timeout if not already set. Here is a simple example in Bash:
   ```sh
   for function in $(aws lambda list-functions --query 'Functions[*].FunctionName' --output text); do
       aws lambda update-function-configuration --function-name $function --timeout 30
   done
   ```

4. **Enforce Timeout Policy Using AWS Config Rules:**
   Use AWS Config to enforce a policy that ensures all Lambda functions have a timeout set. You can create a custom AWS Config rule or use a managed rule like `lambda-function-settings-check` to monitor and enforce this configuration. This step involves setting up AWS Config, which can be done via the AWS CLI:
   ```sh
   aws configservice put-config-rule --config-rule file://lambda-timeout-rule.json
   ```
   Here, `lambda-timeout-rule.json` should define the rule to check for Lambda function timeout settings.

By following these steps, you can ensure that all your AWS Lambda functions have a default timeout set, thereby preventing the misconfiguration.
</Accordion>

<Accordion title='Using Python'>
To prevent the misconfiguration of Lambda functions not having a default timeout set in AWS, you can use a Python script to ensure that all Lambda functions have a timeout value specified. Below are the steps to achieve this:

1. **Install AWS SDK for Python (Boto3):**
   Ensure you have Boto3 installed. If not, you can install it using pip:
   ```bash
   pip install boto3
   ```

2. **Set Up AWS Credentials:**
   Make sure your AWS credentials are configured. You can set them up using the AWS CLI:
   ```bash
   aws configure
   ```

3. **Python Script to Check and Set Timeout:**
   Write a Python script to iterate through all Lambda functions and set a default timeout if it is not already set.

   ```python
   import boto3

   # Initialize a session using Amazon Lambda
   session = boto3.Session()
   lambda_client = session.client('lambda')

   # Define the default timeout (in seconds)
   DEFAULT_TIMEOUT = 60  # Example: 60 seconds

   def set_default_timeout(function_name):
       try:
           # Get the current configuration of the Lambda function
           response = lambda_client.get_function_configuration(FunctionName=function_name)
           current_timeout = response.get('Timeout', None)

           # Check if the timeout is not set or is set to 0
           if current_timeout is None or current_timeout == 0:
               print(f"Setting default timeout for function: {function_name}")
               # Update the function configuration to set the default timeout
               lambda_client.update_function_configuration(
                   FunctionName=function_name,
                   Timeout=DEFAULT_TIMEOUT
               )
           else:
               print(f"Function {function_name} already has a timeout set: {current_timeout} seconds")
       except Exception as e:
           print(f"Error updating function {function_name}: {e}")

   def main():
       try:
           # List all Lambda functions
           paginator = lambda_client.get_paginator('list_functions')
           for page in paginator.paginate():
               for function in page['Functions']:
                   function_name = function['FunctionName']
                   set_default_timeout(function_name)
       except Exception as e:
           print(f"Error listing functions: {e}")

   if __name__ == "__main__":
       main()
   ```

4. **Run the Script:**
   Execute the script to ensure all Lambda functions have a default timeout set.
   ```bash
   python set_lambda_timeout.py
   ```

This script will iterate through all your Lambda functions and set a default timeout if it is not already set. Adjust the `DEFAULT_TIMEOUT` variable as needed for your specific requirements.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console.
2. Navigate to the AWS Lambda service by typing 'Lambda' into the search bar and selecting 'Lambda' from the dropdown menu.
3. Once you are in the Lambda service, you will see a list of all your Lambda functions. Click on the name of the function you want to check.
4. In the function's configuration page, look for the 'Basic settings' section. Here, you will see the 'Timeout' setting. If the timeout is not set or is set to a value higher than your organization's standard, then it is a misconfiguration.
</Accordion>

<Accordion title='Using CLI'>
1. First, you need to list all the Lambda functions in your AWS account. You can do this by using the AWS CLI command `aws lambda list-functions`. This command will return a JSON object with all your Lambda functions.

    ```
    aws lambda list-functions --region your-region
    ```

2. Once you have the list of all Lambda functions, you can iterate over each function to get its configuration details. You can use the `aws lambda get-function-configuration` command to get the configuration details of a specific Lambda function.

    ```
    aws lambda get-function-configuration --function-name your-function-name --region your-region
    ```

3. In the returned JSON object, look for the `Timeout` attribute. This attribute specifies the amount of time that Lambda allows a function to run before stopping it. If the `Timeout` attribute is not set or is set to a value greater than the recommended maximum, then the function is considered to have a misconfiguration.

4. You can automate the above steps using a Python script. Use the `boto3` library to interact with AWS services. The script will list all Lambda functions, get their configuration details, and check the `Timeout` attribute for each function. If the `Timeout` attribute is not set or is set to a value greater than the recommended maximum, the script will print the function name and its timeout value.
</Accordion>

<Accordion title='Using Python'>
1. Install the necessary Python libraries: Before you start, you need to install the AWS SDK for Python (Boto3) in your environment. This can be done using pip:

   ```python
   pip install boto3
   ```

2. Establish a session with AWS: You need to establish a session with AWS using your access key, secret access key, and the region. Replace 'your_access_key', 'your_secret_access_key', and 'your_region' with your actual AWS credentials.

   ```python
   import boto3

   session = boto3.Session(
       aws_access_key_id='your_access_key',
       aws_secret_access_key='your_secret_access_key',
       region_name='your_region'
   )
   ```

3. Get a list of all Lambda functions: Use the `list_functions` method to get a list of all Lambda functions in your account.

   ```python
   lambda_client = session.client('lambda')
   functions = lambda_client.list_functions()
   ```

4. Check the timeout for each function: For each function in the list, check the 'Timeout' attribute. If it's not set, the function doesn't have a default timeout set.

   ```python
   for function in functions['Functions']:
       if 'Timeout' not in function:
           print(f"Lambda function {function['FunctionName']} does not have a default timeout set.")
   ```

This script will print the names of all Lambda functions that do not have a default timeout set.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
Sure, here are the step-by-step instructions to remediate the misconfiguration of Lambda Functions not having a default timeout set in AWS:

1. Open the AWS Management Console and navigate to the Lambda service.
2. Click on the name of the Lambda function that needs to be remediated.
3. Scroll down to the Basic settings section and click on the Edit button next to the Timeout value.
4. Set an appropriate timeout value for the function, keeping in mind the function's execution time and any dependencies it may have.
5. Click on the Save button to apply the changes.

That's it! The Lambda function now has a default timeout set, which helps ensure that it doesn't run indefinitely and incur unnecessary costs.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration "Lambda Functions Should Have Default Timeout Set" for AWS using AWS CLI, follow these steps:

1. Open the AWS CLI on your computer.

2. Run the following command to get a list of all the Lambda functions in your AWS account:

```
aws lambda list-functions
```

3. Identify the Lambda function that does not have a default timeout set.

4. Run the following command to set a default timeout for the identified Lambda function:

```
aws lambda update-function-configuration --function-name <function-name> --timeout <timeout-value>
```

Replace `<function-name>` with the name of the identified Lambda function and `<timeout-value>` with the timeout value you want to set in seconds. For example, if you want to set the timeout to 5 minutes, you can set the `<timeout-value>` to 300.

5. Verify that the default timeout has been set for the Lambda function by running the following command:

```
aws lambda get-function-configuration --function-name <function-name>
```

Replace `<function-name>` with the name of the identified Lambda function. The output should include the timeout value you set in the previous step.

6. Repeat steps 3-5 for any other Lambda functions that do not have a default timeout set.

By following these steps, you have successfully remediated the misconfiguration "Lambda Functions Should Have Default Timeout Set" for AWS using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
Sure, here are the step-by-step instructions to remediate the misconfiguration "Lambda Functions Should Have Default Timeout Set" for AWS using Python:

1. Open the AWS Management Console and navigate to the AWS Lambda service page.
2. Select the Lambda function for which you want to set the default timeout.
3. Click on the "Configuration" tab.
4. Scroll down to the "General configuration" section.
5. Under "Basic settings", click on the "Edit" button.
6. Set the "Timeout" value to a default value of your choice. For example, you can set it to 30 seconds.
7. Click on the "Save" button to save the changes.

Here is the Python code to set the default timeout for an AWS Lambda function:

```python
import boto3

# Replace 'function_name' with the name of the Lambda function for which you want to set the default timeout
function_name = '<function_name>'

# Replace 'timeout' with the default timeout value in seconds
timeout = 30

# Create a Lambda client
lambda_client = boto3.client('lambda')

# Update the function configuration
response = lambda_client.update_function_configuration(
    FunctionName=function_name,
    Timeout=timeout
)

# Print the response
print(response)
```

Make sure you have the AWS SDK for Python (Boto3) installed before running this code. You can install it using the following command:

```
pip install boto3
```

That's it! This code will set the default timeout for the specified Lambda function.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/lambda/latest/dg/configuration-console.html](https://docs.aws.amazon.com/lambda/latest/dg/configuration-console.html) 

