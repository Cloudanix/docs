---
slug: cloudfront_fieldlevel_encryption
title: CloudFront Distributions Should Have Field-Level Encryption Enabled
sidebar_label: CloudFront Distributions Should Have Field-Level Encryption Enabled
---

### More Info:

Field-level encryption should be enabled for your Amazon CloudFront web distributions in order to help protect sensitive data like credit card numbers or social security numbers, and to help protect your data across application services.

### Risk Level

Medium

### Address

Security

### Compliance Standards

SOC2, GDPR, ISO27001, HIPAA, HITRUST, NISTCSF, PCIDSS



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console and open the CloudFront console at https://console.aws.amazon.com/cloudfront/.

2. In the navigation pane, click on "Distributions".

3. In the list of distributions, click on the ID of the distribution that you want to check.

4. In the distribution settings, click on the "Behaviors" tab.

5. In the list of behaviors, check the "Field-Level Encryption" column. If it is set to "None", then field-level encryption is not enabled for that distribution.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all CloudFront distributions: Use the following AWS CLI command to list all the CloudFront distributions in your AWS account:

   ```
   aws cloudfront list-distributions --query 'DistributionList.Items[*].Id' --output text
   ```

   This command will return a list of IDs for all the CloudFront distributions.

3. Check field-level encryption for each distribution: For each distribution ID returned by the previous command, run the following command to get the details of the distribution:

   ```
   aws cloudfront get-distribution-config --id <distribution-id>
   ```

   Replace `<distribution-id>` with the actual ID of the distribution. This command will return the configuration details of the distribution in JSON format.

4. Check the `FieldLevelEncryptionId` field in the output: In the output of the previous command, look for the `FieldLevelEncryptionId` field. If this field is empty or not present, it means that field-level encryption is not enabled for the distribution. If the field is present and contains a value, it means that field-level encryption is enabled.

#### Using Python

1. Install and configure AWS SDK for Python (Boto3):
   You need to install and configure Boto3 to interact with AWS services. You can install it using pip:
   ```
   pip install boto3
   ```
   Then, configure your AWS credentials to allow Boto3 to interact with AWS services on your behalf. You can do this by setting the following environment variables:
   ```
   AWS_ACCESS_KEY_ID='your_access_key'
   AWS_SECRET_ACCESS_KEY='your_secret_key'
   ```

2. Import the necessary modules and create a CloudFront client:
   You need to import Boto3 and create a CloudFront client to interact with the CloudFront service.
   ```python
   import boto3

   # Create CloudFront client
   cloudfront = boto3.client('cloudfront')
   ```

3. List all CloudFront distributions and check for field-level encryption:
   You can list all CloudFront distributions using the `list_distributions` method and then check if field-level encryption is enabled for each distribution.
   ```python
   # List all distributions
   distributions = cloudfront.list_distributions()

   # Check for field-level encryption
   for distribution in distributions['DistributionList']['Items']:
       if 'FieldLevelEncryptionId' not in distribution['DefaultCacheBehavior']:
           print(f"CloudFront distribution {distribution['Id']} does not have field-level encryption enabled.")
   ```

4. Run the script:
   Finally, you can run the script to check if field-level encryption is enabled for all CloudFront distributions. If a distribution does not have field-level encryption enabled, the script will print a message with the ID of the distribution.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration "CloudFront Distributions Should Have Field-Level Encryption Enabled" in AWS using AWS console, follow the below steps:

1. Login to AWS Management Console.
2. Go to the CloudFront service.
3. Select the CloudFront distribution for which you want to enable field-level encryption.
4. Click on the "Edit" button in the top menu.
5. Scroll down to the "Security and Privacy" section.
6. In the "Field-level Encryption Config" section, click on the "Create Field-level Encryption Config" button.
7. In the "Create Field-level Encryption Config" dialog box, enter a name for the configuration and click on the "Create" button.
8. In the "Field-level Encryption Config" section, select the newly created configuration from the dropdown list.
9. Click on the "Yes, Edit" button to save the changes.
10. Finally, click on the "Save Changes" button to complete the remediation.

By following these steps, you have successfully enabled Field-level Encryption for the selected CloudFront distribution in AWS.

#### Using CLI

To remediate the misconfiguration of CloudFront distributions not having field-level encryption enabled in AWS using AWS CLI, follow these steps:

1. Open the AWS CLI on your local machine and run the following command to enable field-level encryption for your CloudFront distribution:

```
aws cloudfront update-distribution --id DISTRIBUTION_ID --field-level-encryption-config Id=FIELD_LEVEL_ENCRYPTION_ID,ForwardWhenContentTypeIsUnknown=true
```

Replace `DISTRIBUTION_ID` with the ID of your CloudFront distribution and `FIELD_LEVEL_ENCRYPTION_ID` with the ID of the field-level encryption configuration that you want to use.

2. Verify that field-level encryption is enabled for your CloudFront distribution by running the following command:

```
aws cloudfront get-distribution-config --id DISTRIBUTION_ID
```

This command will return the current configuration for your CloudFront distribution. Verify that the `FieldLevelEncryptionId` parameter is set to the ID of the field-level encryption configuration that you specified in step 1.

3. Test your CloudFront distribution to ensure that field-level encryption is working as expected.

Congratulations! You have now successfully remediated the misconfiguration of CloudFront distributions not having field-level encryption enabled in AWS using AWS CLI.

#### Using Python

To remediate the misconfiguration "CloudFront Distributions Should Have Field-Level Encryption Enabled" in AWS using Python, you can follow the below steps:

1. Import the Boto3 library: 

```
import boto3
```

2. Create a CloudFront client object: 

```
client = boto3.client('cloudfront')
```

3. Get the list of CloudFront distributions: 

```
response = client.list_distributions()
```

4. Loop through each distribution and check if field-level encryption is enabled: 

```
for distribution in response['DistributionList']['Items']:
    distribution_id = distribution['Id']
    response = client.get_distribution_config(Id=distribution_id)
    if 'FieldLevelEncryption' not in response['DistributionConfig']:
        # Field-level encryption is not enabled, remediate it
```

5. If field-level encryption is not enabled, enable it by adding a field-level encryption configuration: 

```
field_level_encryption_config = {
    'CallerReference': 'unique_reference_string',
    'FieldLevelEncryptionConfig': {
        'FieldLevelEncryptionProfileConfig': {
            'Name': 'profile_name',
            'CallerReference': 'unique_reference_string',
            'EncryptionEntities': {
                'Quantity': 1,
                'Items': [
                    {
                        'PublicKeyId': 'public_key_id',
                        'ProviderId': 'provider_id'
                    }
                ]
            }
        },
        'ContentTypeProfileConfig': {
            'ForwardWhenContentTypeIsUnknown': False,
            'ContentTypeProfiles': {
                'Quantity': 1,
                'Items': [
                    {
                        'Format': 'URLEncoded',
                        'ProfileId': 'profile_id',
                        'ContentType': 'content_type'
                    }
                ]
            }
        }
    }
}
response = client.update_distribution(
    DistributionConfig={
        'CallerReference': 'unique_reference_string',
        'Aliases': {
            'Quantity': 1,
            'Items': [
                'example.com'
            ]
        },
        'DefaultRootObject': 'index.html',
        'Origins': {
            'Quantity': 1,
            'Items': [
                {
                    'Id': 'unique_id',
                    'DomainName': 'example.com',
                    'OriginPath': '',
                    'CustomHeaders': {
                        'Quantity': 0
                    },
                    'S3OriginConfig': {
                        'OriginAccessIdentity': ''
                    },
                    'CustomOriginConfig': {
                        'HTTPPort': 80,
                        'HTTPSPort': 443,
                        'OriginProtocolPolicy': 'https-only',
                        'OriginSslProtocols': {
                            'Quantity': 3,
                            'Items': [
                                'TLSv1',
                                'TLSv1.1',
                                'TLSv1.2'
                            ]
                        }
                    }
                }
            ]
        },
        'DefaultCacheBehavior': {
            'TargetOriginId': 'unique_id',
            'ForwardedValues': {
                'QueryString': False,
                'Cookies': {
                    'Forward': 'none'
                },
                'Headers': {
                    'Quantity': 0
                },
                'QueryStringCacheKeys': {
                    'Quantity': 0
                }
            },
            'TrustedSigners': {
                'Enabled': False,
                'Quantity': 0
            },
            'ViewerProtocolPolicy': 'redirect-to-https',
            'MinTTL': 0,
            'AllowedMethods': {
                'Quantity': 2,
                'Items': [
                    'GET',
                    'HEAD'
                ],
                'CachedMethods': {
                    'Quantity': 2,
                    'Items': [
                        'GET',
                        'HEAD'
                    ]
                }
            },
            'SmoothStreaming': False,
            'DefaultTTL': 86400,
            'MaxTTL': 31536000,
            'Compress': False,
            'LambdaFunctionAssociations': {
                'Quantity': 0
            }
        },
        'CacheBehaviors': {
            'Quantity': 0
        },
        'CustomErrorResponses': {
            'Quantity': 0
        },
        'Comment': '',
        'Logging': {
            'Enabled': False,
            'IncludeCookies': False,
            'Bucket': '',
            'Prefix': ''
        },
        'PriceClass': 'PriceClass_All',
        'Enabled': True,
        'ViewerCertificate': {
            'CloudFrontDefaultCertificate': True,
            'MinimumProtocolVersion': 'TLSv1',
            'CertificateSource': 'cloudfront'
        },
        'Restrictions': {
            'GeoRestriction': {
                'RestrictionType': 'none',
                'Quantity': 0
            }
        },
        'WebACLId': '',
        'HttpVersion': 'http2',
        'IsIPV6Enabled': True,
        'FieldLevelEncryption': field_level_encryption_config
    },
    Id=distribution_id,
    IfMatch=response['ETag']
)
```

6. Replace the `unique_reference_string`, `profile_name`, `public_key_id`, `provider_id`, `profile_id`, `content_type`, `example.com`, `unique_id`, and `bucket_name` with the appropriate values for your CloudFront distribution.

7. Save the Python script and execute it to remediate the "CloudFront Distributions Should Have Field-Level Encryption Enabled" misconfiguration in AWS.

### Additional Reading:

- [https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/field-level-encryption.html](https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/field-level-encryption.html) 


</Tab>
</Tabs>