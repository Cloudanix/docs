---
slug: cloudfront_custom_ssl_certificate
title: Custom SSL Certificate Should Be Set For Amazon CloudFront Distributions
sidebar_label: Custom SSL Certificate Should Be Set For Amazon CloudFront Distributions
---

### More Info:

This rule checks whether the certificate associated with an Amazon CloudFront distribution is the default SSL certificate. Using custom SSL certificates enhances security and trust for users accessing content through CloudFront distributions. The rule is marked as non-compliant if a CloudFront distribution uses the default SSL certificate.

### Risk Level

Medium

### Address

Security

### Compliance Standards

CBP



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to the CloudFront service by typing 'CloudFront' into the search bar and selecting it from the dropdown menu.
3. In the CloudFront console, you will see a list of your distributions. Click on the ID of the distribution you want to check.
4. In the distribution settings, click on the 'General' tab. Under the 'Distribution Details' section, look for the 'SSL Certificate' field. If it is set to 'Default CloudFront Certificate', then a custom SSL certificate is not set for this distribution.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   ```
   pip install awscli
   aws configure
   ```
   You will be prompted to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. List all CloudFront distributions: Use the following AWS CLI command to list all the CloudFront distributions in your AWS account:

   ```
   aws cloudfront list-distributions --query 'DistributionList.Items[*].Id' --output text
   ```
   This command will return a list of IDs for all the CloudFront distributions.

3. Get the details of each CloudFront distribution: For each ID returned by the previous command, run the following command to get the details of the distribution:

   ```
   aws cloudfront get-distribution --id <distribution-id>
   ```
   Replace `<distribution-id>` with the ID of the distribution you want to check. This command will return a JSON object containing the details of the distribution.

4. Check the SSL certificate: In the JSON object returned by the previous command, look for the `ViewerCertificate` field. If the `ACMCertificateArn` field is present and has a value, then a custom SSL certificate is set for the distribution. If the `ACMCertificateArn` field is not present or does not have a value, then a custom SSL certificate is not set for the distribution.

#### Using Python

1. Install the necessary Python libraries: Before you start, make sure you have the necessary Python libraries installed. You will need the `boto3` library, which is the Amazon Web Services (AWS) SDK for Python. It allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, and others. You can install it using pip:

   ```bash
   pip install boto3
   ```

2. Set up AWS credentials: You need to configure your AWS credentials. You can set your credentials for use by `boto3` in several ways, but the simplest is to use the AWS CLI tool. Run `aws configure` and then enter your access key, secret access key, and default region when prompted.

3. Write a Python script to list all CloudFront distributions and check their SSL certificates:

   ```python
   import boto3

   # Create a CloudFront client
   cf = boto3.client('cloudfront')

   # List all distributions
   distributions = cf.list_distributions()

   for distribution in distributions['DistributionList']['Items']:
       # Check if a custom SSL certificate is set
       if 'ViewerCertificate' in distribution and 'ACMCertificateArn' in distribution['ViewerCertificate']:
           print(f"Distribution {distribution['Id']} has a custom SSL certificate.")
       else:
           print(f"Distribution {distribution['Id']} does not have a custom SSL certificate.")
   ```

4. Run the script: Save the script to a file, for example `check_ssl.py`, and then run it using Python:

   ```bash
   python check_ssl.py
   ```

This script will print out the IDs of all your CloudFront distributions and whether or not they have a custom SSL certificate set.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of not having a custom SSL certificate set for an Amazon CloudFront distribution in AWS, you can follow these steps using the AWS Management Console:

1. **Sign in to the AWS Management Console:**
   - Go to https://aws.amazon.com/ and sign in to the AWS Management Console using your credentials.

2. **Navigate to Amazon CloudFront service:**
   - In the AWS Management Console, search for "CloudFront" in the search bar or go to the "Networking & Content Delivery" section and click on "CloudFront".

3. **Select the CloudFront distribution:**
   - From the list of CloudFront distributions, select the distribution for which you want to set a custom SSL certificate.

4. **Edit the distribution settings:**
   - Click on the distribution ID or domain name to open the distribution settings.

5. **Go to the "General" tab:**
   - In the distribution settings, navigate to the "General" tab where you can view the basic information about the distribution.

6. **Edit the SSL certificate settings:**
   - Scroll down to the "SSL Certificate" section and click on the "Edit" button next to the "Alternate Domain Names (CNAMEs)" field.

7. **Choose a custom SSL certificate:**
   - In the "Custom SSL Certificate" section, select "Custom SSL Certificate" from the drop-down menu.

8. **Select or import a custom SSL certificate:**
   - If you have already uploaded your SSL certificate to AWS Certificate Manager (ACM), select the appropriate certificate from the list.
   - If you haven't uploaded the certificate to ACM, you can click on the "Request or Import a Certificate with ACM" link to upload a new SSL certificate.

9. **Save the changes:**
   - After selecting the custom SSL certificate, click on the "Yes, Edit" button to save the changes.

10. **Wait for the distribution to deploy the changes:**
    - It may take some time for the CloudFront distribution to deploy the changes and propagate them across the edge locations.

By following these steps, you can successfully remediate the misconfiguration of not having a custom SSL certificate set for an Amazon CloudFront distribution in AWS.

#### Using CLI

To remediate the misconfiguration of not having a custom SSL certificate set for an Amazon CloudFront distribution using AWS CLI, you can follow these step-by-step instructions:

1. **Generate or Import an SSL Certificate**:
   - First, you need to have an SSL certificate ready. You can either import a certificate into AWS Certificate Manager (ACM) or use a certificate from a third-party Certificate Authority (CA).

2. **Get the ARN of the SSL Certificate**:
   - Use the AWS CLI command to list the SSL certificates in ACM:
     ```
     aws acm list-certificates
     ```
   - Note down the ARN of the SSL certificate you want to use for CloudFront.

3. **Update the CloudFront Distribution**:
   - Use the AWS CLI command to update the CloudFront distribution with the custom SSL certificate:
     ```
     aws cloudfront update-distribution --id YOUR_DISTRIBUTION_ID --default-cache-behavior ViewerProtocolPolicy=https-only,SSLSupportMethod=sni-only,MinimumProtocolVersion=TLSv1.2_2021,ACMCertificateArn=YOUR_SSL_CERTIFICATE_ARN
     ```
     - Replace `YOUR_DISTRIBUTION_ID` with the ID of your CloudFront distribution.
     - Replace `YOUR_SSL_CERTIFICATE_ARN` with the ARN of the SSL certificate you noted down earlier.

4. **Wait for the Distribution to Deploy**:
   - After updating the distribution, it may take some time for the changes to propagate. You can check the status of the distribution deployment using the following command:
     ```
     aws cloudfront get-distribution --id YOUR_DISTRIBUTION_ID --query 'Distribution.DistributionConfig.Enabled'
     ```
   - Wait until the status changes to `true`.

5. **Verify the SSL Certificate**:
   - Once the distribution is deployed, you can verify that the custom SSL certificate is set by accessing your CloudFront distribution using HTTPS and checking the SSL certificate details in the browser.

By following these steps, you can remediate the misconfiguration of not having a custom SSL certificate set for an Amazon CloudFront distribution using AWS CLI.

#### Using Python

To remediate the misconfiguration of not having a custom SSL certificate set for an Amazon CloudFront distribution using Python, you can follow these steps:

1. **Import necessary libraries**: Make sure you have the AWS SDK for Python (Boto3) installed. You can install it using pip:
   ```
   pip install boto3
   ```

2. **Configure AWS credentials**: Ensure that your AWS credentials are properly configured on your system. You can set them up using the AWS CLI or by setting environment variables.

3. **Write Python script**:
   Here is a sample Python script to update the CloudFront distribution with a custom SSL certificate:
   ```python
   import boto3

   # Initialize the CloudFront client
   client = boto3.client('cloudfront')

   # Specify the CloudFront distribution ID
   distribution_id = 'YOUR_DISTRIBUTION_ID'

   # Specify the ARN of the custom SSL certificate
   certificate_arn = 'YOUR_CERTIFICATE_ARN'

   # Update the CloudFront distribution with the custom SSL certificate
   response = client.update_distribution(
       DistributionConfig={
           'CallerReference': 'YOUR_CALLER_REFERENCE',
           'Aliases': {
               'Quantity': 1,
               'Items': ['YOUR_DOMAIN_NAME']
           },
           'DefaultCacheBehavior': {
               'ViewerProtocolPolicy': 'redirect-to-https',
               'MinTTL': 0,
               'TargetOriginId': 'YOUR_ORIGIN_ID'
           },
           'ViewerCertificate': {
               'CloudFrontDefaultCertificate': False,
               'ACMCertificateArn': certificate_arn,
               'SSLSupportMethod': 'sni-only'
           },
           'Comment': 'YOUR_COMMENT',
           'Enabled': True,
           'DefaultRootObject': 'index.html',
           'Origins': {
               'Quantity': 1,
               'Items': [
                   {
                       'Id': 'YOUR_ORIGIN_ID',
                       'DomainName': 'YOUR_ORIGIN_DOMAIN_NAME',
                       'CustomOriginConfig': {
                           'HTTPPort': 80,
                           'HTTPSPort': 443,
                           'OriginProtocolPolicy': 'https-only'
                       }
                   }
               ]
           },
           'PriceClass': 'PriceClass_All',
           'DefaultRootObject': 'index.html'
       },
       Id=distribution_id,
       IfMatch='YOUR_DISTRIBUTION_ETAG'
   )

   print(response)
   ```

4. **Replace placeholders**:
   - Replace `YOUR_DISTRIBUTION_ID` with the actual CloudFront distribution ID.
   - Replace `YOUR_CERTIFICATE_ARN` with the ARN of your custom SSL certificate.
   - Replace other placeholders like `YOUR_DOMAIN_NAME`, `YOUR_ORIGIN_ID`, `YOUR_ORIGIN_DOMAIN_NAME`, `YOUR_CALLER_REFERENCE`, `YOUR_COMMENT`, and `YOUR_DISTRIBUTION_ETAG` with actual values.

5. **Run the script**: Save the script to a file (e.g., `update_cloudfront_ssl.py`) and run it using Python:
   ```
   python update_cloudfront_ssl.py
   ```

By following these steps, you can remediate the misconfiguration of not having a custom SSL certificate set for an Amazon CloudFront distribution using Python.



</Tab>
</Tabs>