---
slug: cloudfront_in_use
title: AWS Account Should Use CloudFront CDN Service
sidebar_label: AWS Account Should Use CloudFront CDN Service
---

### More Info:

AWS CloudFront Content Delivery Network (CDN) service should be used within your AWS account to secure and accelerate the delivery of your websites, media files or static resources.

### Risk Level

Medium

### Address

Security

### Compliance Standards

AWSWAF


### Triage and Remediation
<Tabs>


<Tab title='Prevention'>
### How to Prevent
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To ensure your AWS account uses the CloudFront CDN service via the AWS Management Console, follow these steps:

1. **Navigate to CloudFront:**
   - Sign in to the AWS Management Console.
   - In the search bar at the top, type "CloudFront" and select "CloudFront" from the dropdown list.

2. **Create a Distribution:**
   - On the CloudFront dashboard, click on the "Create Distribution" button.
   - Choose the "Web" option for a web distribution and click "Get Started."

3. **Configure Distribution Settings:**
   - In the "Origin Settings" section, specify the origin domain name (e.g., your S3 bucket or web server).
   - Configure other settings as needed, such as enabling SSL, setting up cache behaviors, and specifying default root objects.

4. **Review and Create:**
   - Review all the settings you have configured.
   - Click the "Create Distribution" button at the bottom of the page to create the CloudFront distribution.

By following these steps, you ensure that your AWS account is utilizing the CloudFront CDN service, which can help improve the performance and security of your web applications.
</Accordion>

<Accordion title='Using CLI'>
To ensure that your AWS account uses the CloudFront CDN service, you can follow these steps using the AWS CLI:

1. **Create a CloudFront Distribution:**
   Use the `create-distribution` command to create a new CloudFront distribution. This will set up a CDN for your content.

   ```sh
   aws cloudfront create-distribution --origin-domain-name <your-origin-domain-name>
   ```

2. **List CloudFront Distributions:**
   Verify that the CloudFront distribution has been created by listing all distributions.

   ```sh
   aws cloudfront list-distributions
   ```

3. **Update CloudFront Distribution:**
   If you need to update an existing CloudFront distribution, use the `update-distribution` command. This can be useful for modifying settings or adding new origins.

   ```sh
   aws cloudfront update-distribution --id <distribution-id> --distribution-config file://distribution-config.json
   ```

4. **Enable CloudFront Logging:**
   Enable logging for your CloudFront distribution to monitor and ensure it is being used correctly.

   ```sh
   aws cloudfront update-distribution --id <distribution-id> --distribution-config file://distribution-config.json --default-cache-behavior "{\"Logging\":{\"Bucket\":\"<your-logging-bucket>.s3.amazonaws.com\",\"Prefix\":\"<your-prefix>\"}}"
   ```

Replace placeholders like `<your-origin-domain-name>`, `<distribution-id>`, `<your-logging-bucket>`, and `<your-prefix>` with your actual values. These steps will help ensure that your AWS account is using the CloudFront CDN service effectively.
</Accordion>

<Accordion title='Using Python'>
To prevent the misconfiguration of not using AWS CloudFront CDN service in your AWS account using Python scripts, you can follow these steps:

### 1. **Install Boto3 Library**
First, ensure you have the Boto3 library installed, which is the AWS SDK for Python.

```bash
pip install boto3
```

### 2. **Create a CloudFront Distribution**
You need to create a CloudFront distribution if one does not already exist. Below is a Python script to create a CloudFront distribution.

```python
import boto3

client = boto3.client('cloudfront')

response = client.create_distribution(
    DistributionConfig={
        'CallerReference': 'unique-string',
        'Origins': {
            'Quantity': 1,
            'Items': [
                {
                    'Id': '1',
                    'DomainName': 'example.com',
                    'OriginPath': '',
                    'CustomHeaders': {
                        'Quantity': 0
                    },
                    'S3OriginConfig': {
                        'OriginAccessIdentity': ''
                    },
                    'ConnectionAttempts': 3,
                    'ConnectionTimeout': 10,
                    'OriginShield': {
                        'Enabled': False
                    }
                },
            ]
        },
        'DefaultCacheBehavior': {
            'TargetOriginId': '1',
            'ViewerProtocolPolicy': 'redirect-to-https',
            'AllowedMethods': {
                'Quantity': 2,
                'Items': ['GET', 'HEAD'],
                'CachedMethods': {
                    'Quantity': 2,
                    'Items': ['GET', 'HEAD']
                }
            },
            'Compress': True,
            'ForwardedValues': {
                'QueryString': False,
                'Cookies': {
                    'Forward': 'none'
                },
                'Headers': {
                    'Quantity': 0
                },
                'QueryStringCacheKeys': {
                    'Quantity': 0
                }
            },
            'MinTTL': 0,
            'DefaultTTL': 86400,
            'MaxTTL': 31536000
        },
        'Comment': 'My CloudFront Distribution',
        'Enabled': True
    }
)

print("CloudFront Distribution Created: ", response['Distribution']['Id'])
```

### 3. **Verify CloudFront Distribution**
To ensure that the CloudFront distribution is active, you can list all distributions and check their statuses.

```python
response = client.list_distributions()

for distribution in response['DistributionList']['Items']:
    print(f"ID: {distribution['Id']}, Status: {distribution['Status']}")
```

### 4. **Automate the Check and Creation**
You can automate the check and creation process to ensure that a CloudFront distribution is always present.

```python
def ensure_cloudfront_distribution():
    response = client.list_distributions()
    if response['DistributionList']['Quantity'] == 0:
        print("No CloudFront distributions found. Creating one...")
        create_cloudfront_distribution()
    else:
        print("CloudFront distribution already exists.")

def create_cloudfront_distribution():
    response = client.create_distribution(
        DistributionConfig={
            'CallerReference': 'unique-string',
            'Origins': {
                'Quantity': 1,
                'Items': [
                    {
                        'Id': '1',
                        'DomainName': 'example.com',
                        'OriginPath': '',
                        'CustomHeaders': {
                            'Quantity': 0
                        },
                        'S3OriginConfig': {
                            'OriginAccessIdentity': ''
                        },
                        'ConnectionAttempts': 3,
                        'ConnectionTimeout': 10,
                        'OriginShield': {
                            'Enabled': False
                        }
                    },
                ]
            },
            'DefaultCacheBehavior': {
                'TargetOriginId': '1',
                'ViewerProtocolPolicy': 'redirect-to-https',
                'AllowedMethods': {
                    'Quantity': 2,
                    'Items': ['GET', 'HEAD'],
                    'CachedMethods': {
                        'Quantity': 2,
                        'Items': ['GET', 'HEAD']
                    }
                },
                'Compress': True,
                'ForwardedValues': {
                    'QueryString': False,
                    'Cookies': {
                        'Forward': 'none'
                    },
                    'Headers': {
                        'Quantity': 0
                    },
                    'QueryStringCacheKeys': {
                        'Quantity': 0
                    }
                },
                'MinTTL': 0,
                'DefaultTTL': 86400,
                'MaxTTL': 31536000
            },
            'Comment': 'My CloudFront Distribution',
            'Enabled': True
        }
    )
    print("CloudFront Distribution Created: ", response['Distribution']['Id'])

ensure_cloudfront_distribution()
```

By following these steps, you can ensure that your AWS account is always using the CloudFront CDN service, thereby preventing the misconfiguration.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console.
2. Navigate to the CloudFront service by typing "CloudFront" into the search bar and selecting it from the dropdown menu.
3. Once in the CloudFront dashboard, check if there are any existing distributions. If there are no distributions, it means that the CloudFront CDN service is not being used.
4. For a more detailed check, select each distribution and review its settings. Check the "Origin Domain Name" and ensure it matches with your AWS resources (like S3 bucket, EC2 instance, Elastic Load Balancer, etc.). If there are no matches, it indicates a misconfiguration.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your AWS Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List CloudFront distributions: To check if your AWS account is using CloudFront CDN service, you need to list all the CloudFront distributions in your account. You can do this by running the following command in your terminal:

   ```
   aws cloudfront list-distributions --query 'DistributionList.Items[].Id' --output text
   ```

   This command will return a list of IDs of all the CloudFront distributions in your AWS account. If the list is empty, it means your AWS account is not using CloudFront CDN service.

3. Get details of a specific CloudFront distribution: If you want to get more details about a specific CloudFront distribution, you can use the following command:

   ```
   aws cloudfront get-distribution --id <distribution-id>
   ```

   Replace `<distribution-id>` with the ID of the CloudFront distribution you are interested in. This command will return a JSON object containing all the details of the specified CloudFront distribution.

4. Analyze the output: After running the above commands, you need to analyze the output to determine if your AWS account is using CloudFront CDN service. If the list of CloudFront distributions is not empty and the details of the distributions indicate that they are active and properly configured, it means your AWS account is using CloudFront CDN service. If not, it means there is a misconfiguration.
</Accordion>

<Accordion title='Using Python'>
1. Install and configure AWS SDK for Python (Boto3): Before you can begin writing Python scripts to detect misconfigurations, you need to install and configure Boto3. You can install it using pip:

   ```
   pip install boto3
   ```
   Then, configure your AWS credentials to enable Boto3 to communicate with AWS services:

   ```
   aws configure
   ```
   You'll be prompted to provide your AWS Access Key ID and Secret Access Key, which you can find in your AWS Management Console.

2. Import necessary libraries and create a CloudFront client: In your Python script, you'll need to import Boto3 and create a CloudFront client. This client will allow you to interact with the CloudFront service.

   ```python
   import boto3

   # Create CloudFront client
   cf = boto3.client('cloudfront')
   ```

3. List all CloudFront distributions: You can use the `list_distributions()` method to retrieve a list of all CloudFront distributions for your AWS account.

   ```python
   # List distributions
   distributions = cf.list_distributions()

   if not distributions['DistributionList']['Items']:
       print("No CloudFront distributions found.")
   else:
       for distribution in distributions['DistributionList']['Items']:
           print(f"Distribution ID: {distribution['Id']}")
   ```

4. Check for the use of CloudFront CDN service: If there are no distributions found, it means that the AWS account is not using the CloudFront CDN service. If there are distributions, it means that the service is being used. 

   Note: This is a basic check. Depending on your specific requirements, you might need to perform additional checks, such as checking the status of each distribution, checking the configuration of each distribution, etc.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate this misconfiguration, you can follow the steps below:

1. Log in to your AWS console and navigate to the CloudFront service.

2. Click the "Create Distribution" button.

3. Choose the type of distribution you want to create. For example, if you want to use CloudFront to deliver your website content, select "Web".

4. Configure the settings for your distribution. This includes setting the origin, which is the location of your content, and configuring caching settings.

5. Once you have configured your settings, click "Create Distribution" to create your CloudFront distribution.

6. After your CloudFront distribution is created, you will need to update your DNS settings to point to your CloudFront distribution. This involves creating a CNAME record in your DNS that points to your CloudFront distribution.

7. Finally, test your CloudFront distribution to ensure that your content is being delivered correctly.

By following these steps, you can remediate the misconfiguration and begin using CloudFront to deliver your content.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration in AWS that the account should use CloudFront CDN service, you can follow the below steps using AWS CLI:

1. Open the AWS CLI on your local machine.

2. Run the following command to create a new CloudFront distribution:

```
aws cloudfront create-distribution --distribution-config file://distribution-config.json
```

Note: Replace `distribution-config.json` with the path to your CloudFront distribution configuration file.

3. Update the DNS records for your domain to point to the CloudFront distribution.

4. Wait for the DNS changes to propagate.

5. Verify that your website is now being served through CloudFront by visiting your website and checking the response headers for the `X-Cache` header. If the header is present, it means that your website is being served through CloudFront.

By following these steps, you can remediate the misconfiguration that your AWS account should use CloudFront CDN service.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration in AWS where the account should use CloudFront CDN service, you can use the following steps in Python:

1. Import the necessary AWS SDK for Python (Boto3) library.

```
import boto3
```

2. Create a CloudFront client object using the `boto3.client()` method.

```
cloudfront = boto3.client('cloudfront')
```

3. Create a new CloudFront distribution using the `create_distribution()` method.

```
response = cloudfront.create_distribution(
    DistributionConfig={
        'CallerReference': 'unique-id', # Specify a unique identifier for the distribution
        'DefaultRootObject': 'index.html', # Specify the default root object
        'Origins': {
            'Quantity': 1,
            'Items': [
                {
                    'Id': 'my-bucket-origin', # Specify a unique identifier for the origin
                    'DomainName': 'my-bucket.s3.amazonaws.com', # Specify the S3 bucket domain name
                    'S3OriginConfig': {
                        'OriginAccessIdentity': '' # Specify the origin access identity
                    }
                }
            ]
        },
        'DefaultCacheBehavior': {
            'TargetOriginId': 'my-bucket-origin', # Specify the origin identifier
            'ForwardedValues': {
                'QueryString': False, # Specify whether to forward query strings
                'Cookies': {
                    'Forward': 'none' # Specify whether to forward cookies
                }
            },
            'ViewerProtocolPolicy': 'redirect-to-https', # Specify the viewer protocol policy
            'MinTTL': 0 # Specify the minimum TTL
        },
        'Comment': 'My CloudFront distribution', # Specify a comment for the distribution
        'Enabled': True # Specify whether the distribution is enabled
    }
)
```

4. Wait for the distribution to be deployed using the `wait_until()` method.

```
cloudfront.get_waiter('distribution_deployed').wait(
    Id=response['Distribution']['Id'],
    WaiterConfig={
        'Delay': 30,
        'MaxAttempts': 50
    }
)
```

5. Update the DNS records to point to the CloudFront distribution using Route 53 or other DNS service.

```
# Example using Route 53
route53 = boto3.client('route53')

response = route53.change_resource_record_sets(
    HostedZoneId='Z1234567890123', # Specify the hosted zone ID
    ChangeBatch={
        'Changes': [
            {
                'Action': 'UPSERT',
                'ResourceRecordSet': {
                    'Name': 'example.com', # Specify the domain name
                    'Type': 'A',
                    'AliasTarget': {
                        'HostedZoneId': 'Z2FDTNDATAQYW2', # Specify the CloudFront hosted zone ID
                        'DNSName': 'd1234567890123.cloudfront.net', # Specify the CloudFront DNS name
                        'EvaluateTargetHealth': False
                    }
                }
            }
        ]
    }
)
```

By following these steps, you can remediate the misconfiguration in AWS where the account should use CloudFront CDN service using Python.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/](https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/) 

