### Remediation

How to create and configure the required Cloudfront web distribution?

#### Using AWS Console

- Step 1: Sign in to your Cloud Conformity console, access Use Cloudfront Content Distribution Network conformity rule settings and copy the domain name configured for your web application (e.g. \<domain_name\>).

- Step 2: Sign in to the AWS Management Console. and Navigate to Cloudfront dashboard at https://console.aws.amazon.com/cloudfront/.

- Step 3: In the left navigation panel, click Distributions. On Cloudfront distributions page, click Create Distribution.

- Step 4: On Select a delivery method for your content page, under Web section, click Get Started to initiate the web distribution setup process.

- Step 5: On Create distribution page, perform the following actions:
  A: For the Origin Settings configuration category, provide the following information:
  a. In the Origin Domain Name box, paste the domain name for your web application origin, copied at step no. 1 (e.g. \<domain_name\>).

  b. (Optional) To request your web content from a directory available at your origin, enter the directory path (e.g. /media/images) in the Origin Path box. Cloudfront service will append the provided directory path to the value entered in the Origin Domain Name box, for example: \<domain_name\>/media/images and fill out the Origin ID box to create the web distribution unique ID.

  c. In the Origin SSL Protocols section, select which SSL protocols Cloudfront is allowed to use for the HTTPS connection between the distribution edge servers and your origin. Cloud Conformity strongly recommends using TLSv1 protocols. If your application origin supports all TLSv1 protocols, use just the TLSv1.2 protocol.

  d. In the Origin Protocol Policy section, select HTTPS only in order to connect the web distribution to your origin over HTTPS (your web application must match the same protocol at origin).

  e. (Optional) If required, within the HTTPS Port box, enter the custom HTTPS port that your origin listens on. The default port used is 443 (recommended).

  f. In the Origin Custom Headers section, specify the custom headers that will be attached to every HTTPS request sent to your web application origin. In the Header Name box type the custom header name (e.g. Cache-Control) and in the Value box enter the value for the header (e.g. no-cache). If required, click the + button to define additional custom headers for the distribution.

  B: For the Default Cache Behavior Settings configuration category, perform the following:
  a. In the Viewer Protocol Policy section, select HTTPS only to enforce web content access using the HTTPS protocol for a secure connection between viewers (end users) and the web distribution edge locations.
  b. In the Allowed HTTP Methods section, choose the list of HTTP(S) methods to process and forward to your origin by the Cloudfront distribution.
  c. (Optional) If required, use Field-level Encryption Config dropdown list to select the field-level encryption configuration for private content.

  d. For Cached HTTP Methods setting, specify whether you want AWS Cloudfront to cache responses from your application origin when users send OPTIONS requests. GET and HEAD responses are always cached (default).

  e. From Cache Based on Selected Request Headers dropdown list, select None (Improve Caching) to forward the default headers to your origin without caching the objects (files) based on their headers value.

  f. In the Object Caching section, select one of the following options based on your application requirements:
  a. Select Use Origin Cache Headers to preserve the Cache-Control header value attached to your objects by your web application origin.

  b. Select Customize to define the expiration time in seconds for the objects in the Cloudfront cache regardless of Cache-Control headers value set by the origin. Use Minimum TTL (the default is 0 seconds), Maximum TTL and Default TTL fields to specify the minimum, maximum or the default time to keep your objects in the distribution cache.

  g. From Forward Cookies dropdown list, select None (Improve Caching) to remove the Cookie header from requests forwarded to your origin and to remove the Set-Cookie header from responses returned to your web application users in order to improve caching.

  h. From Query String Forwarding and Caching dropdown list, select whether you want the new Cloudfront distribution to include query strings in the request URLs forwarded to your origin.

  i. For Smooth Streaming choose No.

  j. For Restrict Viewer Access (Use Signed URLs or Signed Cookies) option, choose No.

  k. For Compress Objects Automatically choose No.
  l. (Optional) For Lambda Function Associations, specify the ARN of the Lambda function to be associated with a specific event type. Event types available are Viewer Request, Viewer Response, Origin Request and Origin Response. You can set only one ARN for a given event type.

  C: For the Distribution Settings configuration category, provide the following information:
  a. From the Price Class dropdown menu, select Use All Edge Locations (Best Performance) to use all edge servers made available by the AWS Cloudfront global network for minimal latency. This price class provides worldwide coverage at higher cost.

  b. (Optional) To integrate the web distribution with AWS WAF in order to allow or block requests based on your web application requirements, select an existing web ACL (Access Control List) from the AWS WAF Web ACL dropdown list.

  c. In the Alternate Domain Names (CNAMEs) box, enter your custom CNAME record (for example, media.) to use your own domain name instead of the AWS Cloudfront web distribution domain name (requires configuring a CNAME record within your domain DNS setting).

  d. In the SSL Certificate section, choose Custom SSL Certificate to use your own domain name for the objects URL structure (e.g., https://media.&LT;domain_name>/media/images/logo.png). Choose the applicable SSL certificate from the section dropdown list or use the Request an ACM certificate button to request a new SSL certificate through AWS Certificate Manager (ACM) service.

  e. (Optional) For Supported HTTP Versions, choose the versions of the HTTP protocol that you want CloudFront to accept. Select HTTP/2, HTTP/1.1, HTTP/1.0 for faster delivery. Amazon CloudFront always forwards requests to the application origin using HTTP/1.1

  f. (Optional) In the Default Root Object box, specify a default root object (e.g., index.html) available in your origin root directory to avoid exposing the contents of your distribution.

  g. For Logging, select whether you want to log all user requests made for the objects available in the distribution. To log the requests, provide the S3 bucket name that will store the access logs, a unique prefix for the log files (optional) and whether you want Cloudfront to include cookies in these logs.

  h. (Optional) Check Enable IPv6 checkbox to enable IPv6 version of the IP protocol if you have users on IPv6 networks who want to access your web content.

  i. (Optional) In the Comment box, enter a small description for the web distribution.

  j. Set Distribution State to Enabled.

- Step 6: Click Create Distribution button to create your AWS Cloudfront web distribution. The distribution status should change from In Progress to Deployed once deployed worldwide.
