

<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and navigate to the CloudFront service.

2. In the CloudFront dashboard, select the ID of the distribution that you want to examine.

3. In the distribution settings, click on the "Behaviors" tab.

4. In the Behaviors settings, look for the "SSL Protocol" field. If the SSL Protocol is set to anything other than TLSv1.1 or TLSv1.2, it means that the CloudFront distribution is using insecure SSL protocols.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   Installation:
   ```
   pip install awscli
   ```
   Configuration:
   ```
   aws configure
   ```
   You will be prompted to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. List CloudFront Distributions: Use the AWS CLI command "list-distributions" to get a list of all your CloudFront distributions. The command is as follows:
   ```
   aws cloudfront list-distributions
   ```
   This command will return a JSON object that contains information about all your CloudFront distributions.

3. Check SSL Protocols: For each CloudFront distribution, check the "ViewerCertificate" section in the returned JSON object. This section contains information about the SSL/TLS protocol that the distribution is using. The command to check the SSL protocols is as follows:
   ```
   aws cloudfront get-distribution-config --id <distribution-id>
   ```
   Replace `<distribution-id>` with the ID of your CloudFront distribution. This command will return a JSON object that contains the configuration of the specified CloudFront distribution.

4. Analyze the Output: Look for the "MinimumProtocolVersion" field in the "ViewerCertificate" section of the returned JSON object. If the value of this field is "SSLv3" or "TLSv1", then the CloudFront distribution is using an insecure SSL protocol.

#### Using Python

1. Install the necessary Python libraries: Before you can start writing the script, you need to install the necessary Python libraries. The AWS SDK for Python (Boto3) allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, etc. You can install it using pip:

   ```bash
   pip install boto3
   ```

2. Set up AWS credentials: You need to configure your AWS credentials. You can do this by creating the credentials file yourself. By default, its location is at `~/.aws/credentials`. At a minimum, the credentials file should look like this:

   ```bash
   [default]
   aws_access_key_id = YOUR_ACCESS_KEY
   aws_secret_access_key = YOUR_SECRET_KEY
   ```

3. Write the Python script: Now you can write a Python script that uses Boto3 to interact with your AWS resources. Here's a simple script that checks for CloudFront distributions that are using insecure SSL protocols:

   ```python
   import boto3

   client = boto3.client('cloudfront')

   response = client.list_distributions()

   for distribution in response['DistributionList']['Items']:
       viewer_protocol_policy = distribution['DefaultCacheBehavior']['ViewerProtocolPolicy']
       if viewer_protocol_policy in ['allow-all', 'redirect-to-https']:
           print(f"Distribution {distribution['Id']} is using insecure SSL protocols.")
   ```

4. Run the script: Finally, you can run the script using Python. The script will print out the IDs of any CloudFront distributions that are using insecure SSL protocols.

   ```bash
   python check_ssl_protocols.py
   ```

This script only checks the default cache behavior of each distribution. If you have multiple cache behaviors with different viewer protocol policies, you would need to modify the script to check all of them.

</Tab>

<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration "CloudFront Distributions Should Not Use Insecure SSL Protocols" in AWS using AWS console, follow the below steps:

1. Login to your AWS console.
2. Go to the CloudFront service.
3. Select the distribution which is using insecure SSL protocols.
4. Click on the "Edit" button.
5. Scroll down to the "SSL Certificate" section.
6. In the "Minimum SSL Protocol Version" dropdown, select "TLSv1.2_2018".
7. Click on the "Yes, Edit" button to save the changes.

By doing this, you have successfully remediated the misconfiguration "CloudFront Distributions Should Not Use Insecure SSL Protocols" in AWS using AWS console.

#### Using CLI

To remediate the CloudFront Distributions Should Not Use Insecure SSL Protocols misconfiguration in AWS using AWS CLI, you can follow the below steps:

1. Open your terminal and install AWS CLI if it is not installed already.

2. Run the following command to update the CloudFront distribution to use only secure SSL protocols:

```
aws cloudfront update-distribution --id <distribution-id> --viewer-protocol-policy https-only
```

Note: Replace `<distribution-id>` with the ID of the CloudFront distribution that you want to update.

3. After running the above command, the CloudFront distribution will be updated to use only secure SSL protocols. 

4. Verify the changes by checking the SSL protocols used by the CloudFront distribution using the following command:

```
aws cloudfront get-distribution-config --id <distribution-id> --query "DistributionConfig.ViewerCertificate.MinimumProtocolVersion"
```

Note: Replace `<distribution-id>` with the ID of the CloudFront distribution that you updated.

5. The output of the above command should show that the minimum SSL protocol version is TLSv1.1 or higher. 

By following these steps, you can remediate the CloudFront Distributions Should Not Use Insecure SSL Protocols misconfiguration in AWS using AWS CLI.

#### Using Python

To remediate the misconfiguration of CloudFront distributions using insecure SSL protocols in AWS using Python, you can follow the below steps:

1. Import the required AWS modules and libraries in your Python script:

```
import boto3
from botocore.exceptions import ClientError
```

2. Create an AWS client for CloudFront using the boto3 library:

```
cloudfront_client = boto3.client('cloudfront')
```

3. Get a list of all the CloudFront distributions using the `list_distributions` method:

```
response = cloudfront_client.list_distributions()
```

4. Loop through the list of CloudFront distributions and check if they are using insecure SSL protocols. You can do this by checking the value of the `MinimumProtocolVersion` parameter. If it is set to `SSLv3` or `TLSv1`, then it is using an insecure SSL protocol.

```
for distribution in response['DistributionList']['Items']:
    if distribution['ViewerCertificate']['MinimumProtocolVersion'] in ['SSLv3', 'TLSv1']:
        # Remediation steps go here
```

5. To remediate the misconfiguration, you need to update the CloudFront distribution with a secure SSL protocol. You can do this by updating the `ViewerCertificate` parameter with a new value for `MinimumProtocolVersion`. For example, to set it to `TLSv1.2_2018`, you can use the `update_distribution` method:

```
distribution_id = distribution['Id']
etag = distribution['ETag']
viewer_certificate = {
    'CloudFrontDefaultCertificate': False,
    'MinimumProtocolVersion': 'TLSv1.2_2018'
}
try:
    cloudfront_client.update_distribution(
        DistributionConfig={
            'ViewerCertificate': viewer_certificate
        },
        Id=distribution_id,
        IfMatch=etag
    )
    print(f"Successfully updated CloudFront distribution {distribution_id}")
except ClientError as e:
    print(f"Error updating CloudFront distribution {distribution_id}: {e}")
```

6. Finally, run the Python script to remediate the misconfiguration for all the CloudFront distributions using insecure SSL protocols.


</Tab>
</Tabs>