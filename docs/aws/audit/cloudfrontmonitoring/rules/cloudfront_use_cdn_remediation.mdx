

<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and open the CloudFront console at https://console.aws.amazon.com/cloudfront/.

2. In the CloudFront console, you will see a list of all your CloudFront distributions. 

3. Click on the ID of the distribution you want to check. This will open the distribution settings.

4. In the distribution settings, check the "Origins and Origin Groups" tab. If your web application is not using a CDN, there will be no origin specified here. If there is an origin specified, check if it's a CDN by looking at the domain name. CDNs typically have a domain name that includes "cloudfront.net". If the domain name does not include "cloudfront.net", your web application is not using a CDN.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   ```
   pip install awscli
   aws configure
   ```
   You will be prompted to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. List all CloudFront distributions: To check if your web applications are using CDNs in CloudFront, you need to list all the CloudFront distributions in your AWS account. You can do this by running the following command:

   ```
   aws cloudfront list-distributions
   ```
   This command will return a list of all CloudFront distributions along with their details.

3. Check the Origins: For each CloudFront distribution, check the 'Origins' field. This field should contain the domain name of your web application. If your web application is not listed in the 'Origins' field of any CloudFront distribution, it means that it is not using a CDN.

4. Check the Status: For each CloudFront distribution, also check the 'Status' field. If the status is 'Deployed', it means that the CDN is active. If the status is 'InProgress', it means that the CDN is being set up or updated. If the status is 'Disabled', it means that the CDN is not active.

Please note that these steps only check if your web applications are using CDNs in CloudFront. They do not check if the CDNs are properly configured or if they are effectively improving the performance of your web applications.

#### Using Python

1. **Import necessary libraries and establish a session**: To start with, you need to import the necessary libraries in your Python script. Boto3 is the Amazon Web Services (AWS) Software Development Kit (SDK) for Python, which allows Python developers to write software that makes use of AWS services like Amazon S3, Amazon EC2, etc. 

```python
import boto3
session = boto3.Session(profile_name='your_profile_name')
client = session.client('cloudfront')
```

2. **List all distributions**: The next step is to list all the CloudFront distributions in your AWS account. You can do this using the `list_distributions()` function.

```python
distributions = client.list_distributions()
```

3. **Check for associated CDN**: For each distribution, check if it is associated with a CDN. If the `Origin` of the distribution is an S3 bucket, then it is using a CDN. If not, then it is not using a CDN.

```python
for distribution in distributions['DistributionList']['Items']:
    for origin in distribution['Origins']['Items']:
        if 'S3' in origin['DomainName']:
            print(f"Distribution {distribution['Id']} is using a CDN.")
        else:
            print(f"Distribution {distribution['Id']} is not using a CDN.")
```

4. **Logging the results**: Finally, you can log the results to a file or print them to the console. This will give you a list of all the distributions that are not using a CDN.

```python
with open('cdn_check_results.txt', 'w') as file:
    for distribution in distributions['DistributionList']['Items']:
        for origin in distribution['Origins']['Items']:
            if 'S3' in origin['DomainName']:
                file.write(f"Distribution {distribution['Id']} is using a CDN.\n")
            else:
                file.write(f"Distribution {distribution['Id']} is not using a CDN.\n")
```

This script will help you identify the distributions that are not using a CDN. However, it is important to note that using a CDN is not always necessary and depends on the specific requirements of your web application.

</Tab>

<Tab title='Remediation'>
### Remediation

#### Using Console

The misconfiguration is that the web application is not using a Content Delivery Network (CDN) which can lead to slower load times and higher latency for users. Here are the step-by-step instructions to remediate this issue for AWS using the AWS console:

1. Log in to the AWS Management Console.
2. Navigate to the Amazon CloudFront service.
3. Click on the "Create Distribution" button.
4. Select the "Web" option for the type of distribution.
5. In the "Origin Domain Name" field, enter the domain name of your web application.
6. In the "Origin Protocol Policy" field, select "HTTPS Only" to ensure that all traffic to your web application is encrypted.
7. In the "Viewer Protocol Policy" field, select "Redirect HTTP to HTTPS" to ensure that all traffic is encrypted.
8. In the "Allowed HTTP Methods" field, select "GET, HEAD, OPTIONS, PUT, POST, PATCH, DELETE" to allow all necessary HTTP methods.
9. In the "Price Class" field, select the appropriate price class for your needs.
10. In the "Alternate Domain Names (CNAMEs)" field, enter any alternate domain names that you want to use for your web application.
11. In the "Default Root Object" field, enter the name of the default file that should be served when a user accesses your web application.
12. Click on the "Create Distribution" button to create your CDN distribution.

Once you have completed these steps, your web application will be using a CDN which will improve load times and reduce latency for your users.

#### Using CLI

To remediate the misconfiguration "Web Applications Should Use CDNs" for AWS using AWS CLI, follow these steps:

1. Login to AWS CLI using your AWS account credentials.

2. Identify the web application that needs to be configured with CDN.

3. Create an S3 bucket that will store the static content of the web application. Use the following AWS CLI command to create an S3 bucket:

```
aws s3api create-bucket --bucket <bucket-name> --region <region>
```

Replace `<bucket-name>` with a unique name for your S3 bucket and `<region>` with the region where you want to create the bucket.

4. Upload the static content of the web application to the S3 bucket. Use the following AWS CLI command to upload the files:

```
aws s3 sync <local-path> s3://<bucket-name> --acl public-read
```

Replace `<local-path>` with the local path of the static files and `<bucket-name>` with the name of the S3 bucket you created in step 3.

5. Create a CloudFront distribution for the S3 bucket. Use the following AWS CLI command to create a CloudFront distribution:

```
aws cloudfront create-distribution --origin-domain-name <bucket-name>.s3.amazonaws.com --default-root-object index.html
```

Replace `<bucket-name>` with the name of the S3 bucket you created in step 3.

6. Update the DNS settings of the web application to point to the CloudFront distribution. Use the following AWS CLI command to get the CloudFront distribution domain name:

```
aws cloudfront get-distribution --id <distribution-id> --query "Distribution.DomainName" --output text
```

Replace `<distribution-id>` with the ID of the CloudFront distribution you created in step 5.

7. Update the DNS settings of the web application to point to the CloudFront distribution domain name obtained in step 6.

By following these steps, you have configured the web application with CDN on AWS.

#### Using Python

To remediate the misconfiguration "Web Applications Should Use CDNs" for AWS using Python, you can follow these steps:

1. Create an AWS CloudFront distribution: 

```python
import boto3

cloudfront = boto3.client('cloudfront')

response = cloudfront.create_distribution(
    DistributionConfig={
        'CallerReference': 'unique-id', # unique identifier for the distribution
        'Aliases': {
            'Quantity': 1, # number of CNAMEs (aliases) for the distribution
            'Items': ['example.com'] # list of CNAMEs for the distribution
        },
        'DefaultRootObject': 'index.html', # default object to serve when no path is specified
        'Origins': {
            'Quantity': 1, # number of origins for the distribution
            'Items': [
                {
                    'Id': 'my-s3-bucket', # unique identifier for the origin
                    'DomainName': 'my-s3-bucket.s3.amazonaws.com', # domain name of the S3 bucket
                    'S3OriginConfig': {
                        'OriginAccessIdentity': '' # optional, use if you want to restrict access to the S3 bucket
                    }
                }
            ]
        },
        'DefaultCacheBehavior': {
            'TargetOriginId': 'my-s3-bucket', # unique identifier for the origin
            'ForwardedValues': {
                'QueryString': False, # whether to forward query strings to the origin
                'Cookies': {
                    'Forward': 'none' # whether to forward cookies to the origin
                }
            },
            'TrustedSigners': {
                'Enabled': False, # whether to require signed URLs or cookies
                'Quantity': 0 # number of trusted signers
            },
            'ViewerProtocolPolicy': 'redirect-to-https', # whether to redirect HTTP requests to HTTPS
            'MinTTL': 0 # minimum time-to-live for objects in the cache
        },
        'Comment': 'My CloudFront distribution', # optional comment for the distribution
        'Enabled': True # whether the distribution is enabled
    }
)

distribution_id = response['Distribution']['Id']
```

2. Update DNS records:

Once the CloudFront distribution is created, you need to update your DNS records to point to the CloudFront domain name. You can do this by creating a CNAME record in your DNS provider's control panel that points to the CloudFront domain name.

3. Test the distribution:

Once the DNS records have propagated, you can test the CloudFront distribution by accessing your web application using the CloudFront domain name. If everything is working correctly, your web application should be served from the CloudFront edge locations, which will improve performance and reduce latency for your users.

Note: Remember to update your web application code to use the CloudFront domain name instead of the S3 bucket URL.


</Tab>
</Tabs>