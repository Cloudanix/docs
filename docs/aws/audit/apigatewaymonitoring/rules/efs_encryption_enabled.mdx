---
slug: efs_encryption_enabled
title: EFS Encryption Enabled
sidebar_label: EFS Encryption Enabled
---

### More Info:

Ensure that your Amazon EFS file systems are encrypted in order to meet security and compliance requirements. Your data is transparently encrypted while being written and transparently decrypted while being read from your file system, therefore the encryption process does not require any additional action from you or your application. Encryption keys are managed by AWS KMS service, eliminating the need to build and maintain a secure key management infrastructure.

### Risk Level

High

### Address

Security

### Compliance Standards

HIPAA, GDPR, CISAWS, CBP, NIST

### Remediation

#### Using Console

Sure, here are the steps to remediate the EFS Encryption Enabled misconfiguration in AWS console:

1. Go to the AWS Management Console and navigate to the Amazon Elastic File System (EFS) service.

2. Select the EFS file system that you want to remediate.

3. Click on the "Properties" tab in the bottom pane.

4. Scroll down to the "Encryption" section and click on "Edit".

5. Select the "Enable encryption" checkbox.

6. Choose the KMS key that you want to use for encryption. If you don't have a KMS key, you can create one by clicking on "Create a new KMS key".

7. Click on "Save" to enable encryption for the EFS file system.

8. Verify that the encryption is enabled by checking the "Encryption" section on the "Properties" tab.

Congratulations! You have successfully remediated the EFS Encryption Enabled misconfiguration in AWS console.

#### Using CLI

To remediate the misconfiguration of EFS Encryption Enabled in AWS CLI, please follow the below steps:

1. Open the AWS CLI on your local machine or EC2 instance.

2. Run the following command to disable encryption on the EFS file system:

   ```
   aws efs update-file-system --file-system-id <file-system-id> --encrypted false
   ```

   Replace `<file-system-id>` with the ID of the EFS file system that needs to be remediated.

3. Verify that the encryption has been disabled by running the following command:

   ```
   aws efs describe-file-systems --file-system-id <file-system-id> --query "FileSystems[].Encrypted"
   ```

   If the output is `false`, then the encryption has been successfully disabled.

4. If the EFS file system needs to be encrypted again, run the following command:

   ```
   aws efs update-file-system --file-system-id <file-system-id> --encrypted true
   ```

   Replace `<file-system-id>` with the ID of the EFS file system that needs to be encrypted.

5. Verify that the encryption has been enabled by running the following command:

   ```
   aws efs describe-file-systems --file-system-id <file-system-id> --query "FileSystems[].Encrypted"
   ```

   If the output is `true`, then the encryption has been successfully enabled.

Note: Make sure that you have the necessary permissions to update the EFS file system.

#### Using Python

To remediate the misconfiguration of EFS Encryption Enabled in AWS using Python, follow the steps below:

1. Install the AWS SDK for Python (Boto3) using the following command:

   ```
   pip install boto3
   ```

2. Create an AWS session using the following code:

   ```
   import boto3

   session = boto3.Session(
       aws_access_key_id='ACCESS_KEY',
       aws_secret_access_key='SECRET_KEY',
       region_name='REGION'
   )
   ```

   Replace the ACCESS_KEY, SECRET_KEY, and REGION with your AWS credentials.

3. Create an EFS client using the following code:

   ```
   efs = session.client('efs')
   ```

4. Get a list of all the EFS file systems using the following code:

   ```
   response = efs.describe_file_systems()
   file_systems = response['FileSystems']
   ```

5. For each file system, check if encryption is enabled using the following code:

   ```
   for file_system in file_systems:
       file_system_id = file_system['FileSystemId']
       response = efs.describe_file_system_policy(FileSystemId=file_system_id)
       policy = response['Policy']
       if 'KmsKeyId' not in policy:
           # Encryption is not enabled, enable it
           efs.put_file_system_policy(
               FileSystemId=file_system_id,
               Policy='{"KmsKeyId": "YOUR_KMS_KEY_ID"}'
           )
   ```

   Replace YOUR_KMS_KEY_ID with the ID of the KMS key you want to use for encryption.

6. Run the script and verify that encryption is enabled for all EFS file systems.

Note: This script assumes that you have already created a KMS key and have the ID available. If you haven't created a KMS key, you can do so using the AWS Management Console or the AWS CLI.

### Additional Reading:

- [https://docs.aws.amazon.com/efs/latest/ug/encryption.html](https://docs.aws.amazon.com/efs/latest/ug/encryption.html) 

