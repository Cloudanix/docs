### Remediation

How to ensure apigateway is integrated with WAF?

#### Using AWS Console

1. Create and Configure AWS WAF WebACL:
   - Access the AWS Management Console and navigate to the AWS WAF service.
     (In the Cloudanix Console, navigate to "Misconfig" page and look for Affected Assets for "API Gateway Should Be Integrated With WAF" Policy.)
   - Go to the "Web ACLs" section and click on "Create web ACL."
   - Provide a name for the WebACL and optionally add a description.
   - Choose the region where your API Gateway is deployed.
   - Configure the desired rules and conditions to protect your API from common web vulnerabilities.
   - Save the configuration and note down the ARN (Amazon Resource Name) of the created WebACL.
2. Configure API Gateway Integration:
   - Access the AWS Management Console and navigate to the API Gateway service.
   - Select the API for which you want to enable integration with WAF.
   - Click on the "Stages" tab and select the desired stage (e.g., "Prod").
   - In the stage settings, click on "Edit."
   - Under the "Access logging" section, select the option to enable access logging if desired.
   - Scroll down to the "CloudWatch Settings" section and expand it.
   - Enable "Enable AWS WAF" and paste the WebACL ARN that you noted down in step 1.
   - Save the changes.
3. Deploy the API Changes:
   - After configuring the WAF integration, navigate to the "Resources" tab in the API Gateway console.
   - Select the root resource and click on "Actions" > "Deploy API."
   - Select the desired deployment stage (e.g., "Prod") and click on "Deploy."
4. Monitor and Manage WAF Logs:
   - Access the AWS Management Console and navigate to the AWS WAF service.
   - Go to the "Logging & monitoring" section and enable logging to CloudWatch or Amazon S3, as per your requirements.
   - Configure appropriate logging and monitoring settings to track and analyze WAF-related logs.

