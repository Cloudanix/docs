---
slug: api_gateway_xray_enabled
title: API Gateway X-Ray Should Be Enabled
sidebar_label: API Gateway X-Ray Should Be Enabled
---

### More Info:

Ensure XRAY is enabled for API Gateway

### Risk Level

Low

### Address

Reliability, Operational Maturity, Security

### Compliance Standards

CBP


### Triage and Remediation
<Tabs>
<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of API Gateway X-Ray not being enabled in AWS, follow these steps using the AWS Management Console:

1. **Sign in to the AWS Management Console**: Go to https://aws.amazon.com/ and sign in to your AWS account.

2. **Navigate to API Gateway**: Click on the "Services" dropdown at the top of the page, search for "API Gateway" in the search bar, and click on it to open the API Gateway console.

3. **Select Your API**: In the API Gateway console, select the API for which you want to enable X-Ray tracing.

4. **Enable X-Ray Tracing**:
   - In the API Gateway console, click on the "Stages" option in the left-hand navigation pane.
   - Select the desired stage (e.g., "Prod") for which you want to enable X-Ray tracing.
   - Under the selected stage, click on the "Logs/Tracing" tab.
   - Toggle the "Enable X-Ray Tracing" option to enable X-Ray tracing for the selected stage.

5. **Save Changes**: Click on the "Save Changes" button to apply the configuration changes.

6. **Verify X-Ray Tracing**: To verify that X-Ray tracing is enabled for your API Gateway, you can make a test request to your API and check the X-Ray console to see if traces are being recorded.

By following these steps, you will successfully remediate the misconfiguration of API Gateway X-Ray not being enabled in AWS.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of API Gateway X-Ray not being enabled in AWS using AWS CLI, follow these steps:

1. Install and configure the AWS CLI: Ensure that you have the AWS CLI installed and configured with the necessary permissions to make changes to the API Gateway settings.

2. Enable X-Ray tracing for API Gateway: Run the following AWS CLI command to enable X-Ray tracing for API Gateway:

```
aws apigateway update-stage --rest-api-id <REST_API_ID> --stage-name <STAGE_NAME> --patch-operations op="replace",path="/tracingEnabled",value="True"
```

Replace `<REST_API_ID>` with the ID of your API Gateway REST API and `<STAGE_NAME>` with the name of the stage for which you want to enable X-Ray tracing.

3. Verify X-Ray tracing is enabled: To verify that X-Ray tracing has been successfully enabled for API Gateway, you can use the AWS Management Console or run the following AWS CLI command:

```
aws apigateway get-stage --rest-api-id <REST_API_ID> --stage-name <STAGE_NAME> | grep tracingEnabled
```

This command will return the tracingEnabled attribute with a value of "True" if X-Ray tracing is enabled for the specified stage of API Gateway.

By following these steps, you can successfully remediate the misconfiguration of API Gateway X-Ray not being enabled in AWS using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of API Gateway X-Ray not being enabled in AWS using Python, you can use the AWS SDK for Python (Boto3) to update the API Gateway stage settings. Here are the step-by-step instructions to remediate this issue:

1. Install Boto3:
   If you haven't already installed Boto3, you can do so using pip:
   ```
   pip install boto3
   ```

2. Configure AWS Credentials:
   Make sure you have configured your AWS credentials either by setting environment variables or using the AWS CLI `aws configure` command.

3. Write a Python script to enable X-Ray tracing for your API Gateway stage:
   You can use the following Python script as a starting point:

   ```python
   import boto3

   # Initialize the API Gateway client
   client = boto3.client('apigateway')

   # Specify the API Gateway details
   rest_api_id = 'YOUR_API_ID'
   stage_name = 'YOUR_STAGE_NAME'

   # Enable X-Ray tracing for the specified API Gateway stage
   client.update_stage(
       restApiId=rest_api_id,
       stageName=stage_name,
       patchOperations=[
           {
               'op': 'replace',
               'path': '/tracingEnabled',
               'value': 'True'
           }
       ]
   )

   print(f'X-Ray tracing has been enabled for the {stage_name} stage of API Gateway {rest_api_id}.')
   ```

4. Replace `YOUR_API_ID` and `YOUR_STAGE_NAME` with your actual API Gateway ID and stage name in the script.

5. Run the Python script:
   Save the script to a file (e.g., `enable_xray_tracing.py`) and run it using Python:
   ```
   python enable_xray_tracing.py
   ```

6. Verify the X-Ray tracing is enabled:
   You can verify that X-Ray tracing is enabled for the specified API Gateway stage by checking the API Gateway console or using the AWS CLI.

By following these steps, you can remediate the misconfiguration of API Gateway X-Ray not being enabled in AWS using Python and ensure that X-Ray tracing is enabled for your API Gateway stage.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>

