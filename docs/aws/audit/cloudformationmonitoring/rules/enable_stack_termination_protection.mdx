---
slug: enable_stack_termination_protection
title: AWS CloudFormation Stacks Should Have Termination Protection Enabled
sidebar_label: AWS CloudFormation Stacks Should Have Termination Protection Enabled
---

### More Info:

Amazon CloudFormation stacks should have Termination Protection feature enabled in order to protect them from being accidentally deleted.

### Risk Level

Low

### Address

Reliability, Security

### Compliance Standards

CBP



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to the CloudFormation service. You can do this by typing "CloudFormation" into the search bar and selecting it from the dropdown menu.
3. In the CloudFormation console, you will see a list of your stacks. Select the stack you want to check.
4. In the stack details pane, look for the "Termination Protection" field. If it is set to "Enabled", then termination protection is on. If it is set to "Disabled", then termination protection is not enabled.

#### Using CLI

1. First, you need to install and configure AWS CLI on your local machine. You can do this by following the instructions provided by AWS. Make sure you have the necessary permissions to access the CloudFormation Stacks.

2. Once the AWS CLI is installed and configured, you can list all the CloudFormation stacks in your account using the following command:

   ```
   aws cloudformation list-stacks --stack-status-filter CREATE_COMPLETE ROLLBACK_COMPLETE UPDATE_COMPLETE UPDATE_ROLLBACK_COMPLETE --query 'StackSummaries[].StackName' --output text
   ```
   This command will list all the CloudFormation stacks that are in a completed state.

3. To check if termination protection is enabled for each stack, you can use the following command:

   ```
   aws cloudformation describe-stacks --stack-name <StackName> --query 'Stacks[].EnableTerminationProtection'
   ```
   Replace `<StackName>` with the name of the stack you want to check. This command will return `true` if termination protection is enabled, and `false` if it is not.

4. Repeat step 3 for each stack listed in step 2. If any stack returns `false`, it means that termination protection is not enabled for that stack.

#### Using Python

1. Install and configure AWS SDK for Python (Boto3) on your local system. This will allow you to interact with AWS services using Python.

```python
pip install boto3
aws configure
```

2. Import the necessary modules and create a session using your AWS credentials.

```python
import boto3

session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    region_name='YOUR_REGION'
)
```

3. Use the `describe_stacks()` function from the CloudFormation client to get a list of all the stacks in your AWS account.

```python
cf = session.client('cloudformation')
response = cf.describe_stacks()
```

4. Iterate over the list of stacks and check the `EnableTerminationProtection` attribute for each stack. If it's set to `False`, then the stack does not have termination protection enabled.

```python
for stack in response['Stacks']:
    if not stack['EnableTerminationProtection']:
        print(f"Stack {stack['StackName']} does not have termination protection enabled.")
```

This script will print out the names of all the stacks that do not have termination protection enabled. You can modify it to suit your needs, for example by sending an alert or taking some remediation action when a misconfigured stack is detected.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

Sure, here are the step-by-step instructions to remediate the issue of "AWS CloudFormation Stacks Should Have Termination Protection Enabled" for AWS using the AWS console:

1. Log in to your AWS Management Console.
2. Navigate to the AWS CloudFormation console.
3. In the left navigation pane, select "Stacks".
4. Select the stack for which you want to enable termination protection.
5. Click on the "Actions" button and select "Enable termination protection".
6. A pop-up window will appear, asking you to confirm the action. Click on "Yes, Enable" to confirm.
7. Once you have enabled termination protection, you will see a lock icon next to the stack name indicating that it is now protected from accidental deletion.

That's it! You have successfully remediated the issue of "AWS CloudFormation Stacks Should Have Termination Protection Enabled" for the selected stack.

#### Using CLI

To remediate the misconfiguration "AWS CloudFormation Stacks Should Have Termination Protection Enabled" in AWS using AWS CLI, you can follow the below steps:

1. Open the AWS CLI on your local machine or EC2 instance.

2. Check the status of termination protection for all the CloudFormation stacks in the AWS account by running the following command:

```
aws cloudformation list-stacks --stack-status-filter CREATE_COMPLETE UPDATE_COMPLETE UPDATE_ROLLBACK_COMPLETE --query "StackSummaries[?EnableTerminationProtection=='False'].StackName" --output text
```

This command will list all the CloudFormation stacks in the AWS account that have termination protection disabled.

3. Enable termination protection for each of the CloudFormation stacks listed in step 2 by running the following command:

```
aws cloudformation update-termination-protection --stack-name <stack-name> --enable-termination-protection
```

Replace `<stack-name>` with the name of the CloudFormation stack for which you want to enable termination protection.

4. Repeat step 3 for each of the CloudFormation stacks listed in step 2.

5. Verify the termination protection status for all the CloudFormation stacks in the AWS account by running the following command:

```
aws cloudformation list-stacks --stack-status-filter CREATE_COMPLETE UPDATE_COMPLETE UPDATE_ROLLBACK_COMPLETE --query "StackSummaries[?EnableTerminationProtection=='True'].StackName" --output text
```

This command will list all the CloudFormation stacks in the AWS account that have termination protection enabled.

By following these steps, you can remediate the misconfiguration "AWS CloudFormation Stacks Should Have Termination Protection Enabled" in AWS using AWS CLI.

#### Using Python

To remediate the misconfiguration of AWS CloudFormation stacks not having termination protection enabled, you can use the following steps in Python:

1. Import the necessary AWS SDKs and modules:

```python
import boto3
from botocore.exceptions import ClientError
```

2. Create a boto3 session and CloudFormation client:

```python
session = boto3.Session(region_name='your_aws_region')
cfn = session.client('cloudformation')
```

3. Get a list of all CloudFormation stacks:

```python
stacks = cfn.list_stacks(
    StackStatusFilter=[
        'CREATE_COMPLETE',
        'UPDATE_COMPLETE',
        'ROLLBACK_COMPLETE'
    ]
)['StackSummaries']
```

4. Loop through the list of stacks and check if termination protection is enabled:

```python
for stack in stacks:
    stack_name = stack['StackName']
    try:
        response = cfn.describe_termination_protection(
            StackName=stack_name
        )
        if not response['TerminationProtected']:
            print(f"{stack_name} does not have termination protection enabled.")
            # Enable termination protection
            cfn.update_termination_protection(
                StackName=stack_name,
                EnableTerminationProtection=True
            )
            print(f"{stack_name} now has termination protection enabled.")
    except ClientError as e:
        if e.response['Error']['Message'] == 'Stack with id {0} does not exist'.format(stack_name):
            print(f"{stack_name} does not exist.")
        else:
            print(f"Error checking termination protection for {stack_name}: {e}")
```

5. Run the script and verify that termination protection is now enabled for all CloudFormation stacks.

Note: Make sure to replace "your_aws_region" with the region where your AWS resources are located.




</Tab>
</Tabs>