### Remediation

How to relaunch and configure your Elasticsearch cluster(s) within an AWS VPC?

#### Using AWS Console

- Step 1: Click on the ES domain that you want to relaunch (see Audit section part I to identify the right resource).

- Step 2: On the selected ES domain description page, click the Configure cluster button from the dashboard top menu to open the cluster configuration page.

- Step 3: On the Configure cluster page, copy the selected cluster configuration information such as Instance count, Instance type, Dedicated master instance type, Dedicated master instance count, Storage Type, EBS volume size, etc.

- Step 4: On the Set up access policy page, copy the access policy available in the Add or edit the access policy textbox. Go back to the AWS ES service dashboard and click the Create new domain button from the dashboard top menu to launch a new Elasticsearch domain.

- Step 5: On the Define domain page, perform the following actions:
  A: Provide a unique name for the new ES domain in the Elasticsearch domain name box.
  B: Select the right version of the Elasticsearch engine from the Elasticsearch version dropdown list.
  C: Click Next to continue the setup process

- Step 6: On the Configure cluster page, set the new domain parameters using the configuration details copied at step no. 5 then click Next.

- Step 7: On the Set up access page of the new domain, perform the following actions:
  A: Inside Network configuration section, choose VPC access option to launch the domain within a VPC, then select the VPC identifier from the VPC dropdown list, an available subnet from the Subnet list and one or multiple security groups from Security Groups dropdown list.
  B: Within Access policy section, paste the access policy copied at step no. 6 (if required) into the Add or edit the access policy box or simply select a pre-configured policy from the Set the domain access policy to dropdown list and edit it to meet the needs of your ES domain. Then click Next.

- Step 8: On the Review page, verify the domain configuration and its access policy then click Confirm and create to launch the new AWS Elasticsearch domain within the specified VPC.

- Step 9: Once the new AWS ES domain is created, upload the data from the source cluster (domain) to the new ES cluster.

- Step 10: Now itâ€™s safe to remove the source (publicly accessible) Elasticsearch domain in order to stop incurring charges for it. To delete the source domain, perform the following:
  A: Click on the name of the domain that you want to remove (see Audit section part I to identify the right resource).
  B: On the selected domain description page, click Delete Elasticsearch domain to expand the section panel then click Delete domain button to start the removal process.
  C: Within Delete domain dialog box, check Delete the domain <domain_name> then click the Delete button to confirm the action.
