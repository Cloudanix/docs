---
title: Elasticsearch Domains Should Not Allow Cross Account Access
---

### More Info:

All your Elasticsearch Service (ES) clusters should be configured to allow access only to trusted AWS users and accounts in order to protect against unauthorized cross account access

### Risk Level

High

### Address

Security

### Compliance Standards

PCIDSS, APRA, MAS, NIST

### Remediation

How to update Amazon ElasticSearch clusters permissions to allow cross-account access from trusted entities?

#### Using AWS Console

1. Log in to the AWS Management Console using your AWS account credentials.
2. Navigate to the Amazon Elasticsearch Service by selecting "Elasticsearch Service" from the services menu.
    (In the Cloudanix Console, navigate to "Misconfig" page and look for Affected Assets for "Elasticsearch Domains Should Not Allow Cross Account Access" Policy.)
3. In the Amazon Elasticsearch Service dashboard, select the Elasticsearch domain for which you want to configure cross-account access.
4. In the domain details page, click on the "Actions" button and select "Modify access policy."
5. In the access policy editor, update the policy to allow access from trusted AWS accounts or entities. Here's an example of an access policy that allows access from a trusted AWS account:
```
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::123456789012:root"
      },
      "Action": "es:*",
      "Resource": "arn:aws:es:us-west-2:123456789012:domain/example-domain/*"
    }
  ]
}
```
Replace the `123456789012` with the AWS account ID of the trusted account or entity that you want to grant access to. You can add multiple `AWS` principals for each trusted account or entity.
6. Review the modified access policy to ensure that it accurately reflects the desired cross-account access configuration.
7. Click on "Submit" to apply the updated access policy to the Elasticsearch domain.
8. AWS will apply the access policy changes to the Elasticsearch domain, which may take a few minutes to complete.
9. Once the changes are successfully applied, the Elasticsearch domain will allow access from the trusted AWS accounts or entities specified in the access policy.

### Additional Reading:

- [https://aws.amazon.com/blogs/security/how-to-control-access-to-your-amazon-elasticsearch-service-domain/](https://aws.amazon.com/blogs/security/how-to-control-access-to-your-amazon-elasticsearch-service-domain/)
