### Remediation

How to encrypt an existing AWS ElasticSearch domain with your own KMS Customer Master Key?

#### Using AWS Console

1. Log in to the AWS Management Console using your AWS account credentials.
2. Navigate to the Amazon Elasticsearch Service by selecting "Elasticsearch Service" from the services menu.
    (In the Cloudanix Console, navigate to "Misconfig" page and look for Affected Assets for "Elasticsearch Domain Should Be Encrypted with KMS CMKs" Policy.)
3. In the Amazon Elasticsearch Service dashboard, select the Elasticsearch domain that you want to encrypt.
4. In the domain details page, click on the "Actions" button and select "Modify domain."
5. In the "Encryption" section, choose the "Enable encryption" option.
6. Select the CMK that you want to use for encryption from the dropdown list. If you haven't created a CMK, you can create one by following the AWS Key Management Service (KMS) documentation.
7. Specify the KMS key policy that defines who can use the CMK for encrypting and decrypting data. You can use the default key policy or customize it according to your requirements.
8. Click on "Save changes" to apply the encryption configuration to the Elasticsearch domain.
9. AWS will start applying the encryption settings to the Elasticsearch domain. This process may take a few minutes to complete.
10. Once the encryption configuration is successfully applied, the Elasticsearch domain will be encrypted using the specified CMK.
