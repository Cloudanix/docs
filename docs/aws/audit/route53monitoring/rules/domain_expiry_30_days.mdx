---
slug: domain_expiry_30_days
title: Route 53 Domain Expiry In 30 Days
sidebar_label: Route 53 Domain Expiry In 30 Days
---

### More Info:

All the domain names registered with AWS Route 53 or transferred to AWS Route 53 should be renewed 30 days before their validity period ends.

### Risk Level

Medium

### Address

Reliability, Security

### Compliance Standards

CBP


### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Log in to your AWS Management Console.
2. Navigate to the Route 53 dashboard. You can do this by typing "Route 53" into the search bar at the top of the console and selecting it from the dropdown menu.
3. Once you're in the Route 53 dashboard, click on "Registered domains" in the left-hand menu. This will bring up a list of all the domains you have registered with Route 53.
4. Check the "Expiration date" column for each domain. If a domain is set to expire in the next 30 days, it will be listed here.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can run any AWS CLI commands, you need to install and configure the AWS CLI on your local machine. You can do this by following the instructions provided in the AWS CLI User Guide.

2. List hosted zones: Use the following command to list all the hosted zones in your AWS account:

   ```
   aws route53 list-hosted-zones
   ```
   This command will return a list of all the hosted zones in your AWS account, including their ID, name, and other information.

3. List resource record sets: For each hosted zone, use the following command to list all the resource record sets:

   ```
   aws route53 list-resource-record-sets --hosted-zone-id <hosted-zone-id>
   ```
   Replace `<hosted-zone-id>` with the ID of the hosted zone you want to check. This command will return a list of all the resource record sets in the specified hosted zone, including their name, type, and other information.

4. Check domain expiry: For each resource record set of type `SOA` (Start of Authority), check the `RDATA` field for the expiry value. If the expiry value is less than or equal to 30 days, then the domain is set to expire in 30 days or less. Note that the expiry value is specified in seconds, so you need to convert it to days by dividing by 86400 (the number of seconds in a day).

   Unfortunately, AWS CLI does not provide a direct way to check the expiry date of a domain. You may need to use other tools or services, or check the domain expiry manually through the AWS Management Console.
</Accordion>

<Accordion title='Using Python'>
1. Install the necessary AWS SDK for Python (Boto3) if you haven't done so already. You can install it using pip:
```python
pip install boto3
```

2. Import the necessary libraries and initialize the Route53 client. You will need to provide your AWS credentials (access key and secret key) which you can get from your AWS console.
```python
import boto3
from datetime import datetime, timedelta

# Initialize the Route53 client
route53 = boto3.client('route53', aws_access_key_id='YOUR_ACCESS_KEY', aws_secret_access_key='YOUR_SECRET_KEY')
```

3. Fetch the list of domain names and their expiry dates. The 'list_domains' function of the Route53 client can be used to get the list of domain names. For each domain name, you can get the expiry date using the 'get_domain_detail' function.
```python
# Get the list of domain names
domains = route53.list_domains()

for domain in domains['Domains']:
    # Get the domain details
    domain_details = route53.get_domain_detail(DomainName=domain['DomainName'])
    
    # Get the expiry date
    expiry_date = domain_details['Expiry']
```

4. Check if the domain is expiring in the next 30 days. You can do this by comparing the expiry date with the current date plus 30 days. If the expiry date is earlier, then the domain is expiring in the next 30 days.
```python
# Get the current date plus 30 days
current_date_plus_30 = datetime.now() + timedelta(days=30)

# Check if the domain is expiring in the next 30 days
if expiry_date <= current_date_plus_30:
    print(f"The domain {domain['DomainName']} is expiring in the next 30 days.")
```
This script will print out all the domain names that are expiring in the next 30 days.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the Route 53 Domain Expiry in 30 days issue in AWS using the AWS console, follow these steps:

1. Log in to your AWS Management Console.
2. Navigate to the Route 53 dashboard.
3. In the left-hand navigation panel, click on the "Registered domains" option.
4. Locate the domain that is expiring in 30 days and click on it.
5. Click on the "Renew registration" button.
6. Follow the prompts to renew the domain registration.
7. Once the domain registration is renewed, verify that the domain expiry date has been updated to a future date.

By following these steps, you will have successfully remediated the Route 53 Domain Expiry in 30 Days issue in AWS.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the Route 53 Domain Expiry in 30 Days misconfiguration for AWS using AWS CLI, follow these steps:

1. Install AWS CLI on your local machine if you haven't already done so.

2. Open a terminal or command prompt and run the following command to list all hosted zones in your AWS account:

```
aws route53 list-hosted-zones
```

3. Identify the hosted zone that is expiring in 30 days or less. Note the value of the "Id" field for this hosted zone.

4. Run the following command to get the details of the hosted zone:

```
aws route53 get-hosted-zone --id <hosted-zone-id>
```

Replace `<hosted-zone-id>` with the actual ID of the hosted zone you identified in step 3.

5. Check the value of the "Expiration" field in the output of the previous command. If the value is less than 30 days from the current date, the hosted zone is expiring soon and needs to be renewed.

6. To renew the hosted zone, run the following command:

```
aws route53 update-hosted-zone --id <hosted-zone-id> --auto-renew
```

Replace `<hosted-zone-id>` with the actual ID of the hosted zone you identified in step 3.

7. Verify that the hosted zone has been renewed by running the following command:

```
aws route53 get-hosted-zone --id <hosted-zone-id>
```

Check the value of the "Expiration" field in the output of the previous command to ensure that it has been extended.

By following these steps, you can remediate the Route 53 Domain Expiry in 30 Days misconfiguration for AWS using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the Route 53 Domain Expiry in 30 days issue using Python, you can use the AWS SDK for Python (Boto3) to automate the process. Here are the steps:

1. Install Boto3: Install the Boto3 library using pip by running the following command in your terminal:

```
pip install boto3
```

2. Create an AWS IAM user: Create an IAM user with the necessary permissions to access Route 53 domains. The user should have the following permissions:

- route53domains:ListDomains
- route53domains:GetDomainDetail

3. Configure AWS credentials: Configure your AWS credentials by setting the AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY environment variables or by using the AWS CLI.

4. Write Python code: Use the following Python code to remediate the Route 53 Domain Expiry in 30 days issue:

```
import boto3
import datetime

# Set the number of days before expiry
expiry_days = 30

# Create a Route 53 client
client = boto3.client('route53domains')

# Get a list of all domains
response = client.list_domains()

# Loop through each domain and check if it will expire in the next 30 days
for domain in response['Domains']:
    domain_name = domain['DomainName']
    expiration_date = domain['Expiry']
    days_left = (expiration_date - datetime.datetime.now()).days
    if days_left <= expiry_days:
        # Renew the domain
        client.renew_domain(
            DomainName=domain_name,
            DurationInYears=1
        )
```

This code will get a list of all Route 53 domains and check if they will expire in the next 30 days. If a domain is going to expire, it will be renewed for another year. You can schedule this Python script to run periodically to ensure that your domains are always up-to-date.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-restore-expired.html](https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-restore-expired.html) 

