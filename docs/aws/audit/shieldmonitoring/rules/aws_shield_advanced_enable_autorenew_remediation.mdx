
### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Log in to the AWS Management Console and open the AWS Shield console at https://console.aws.amazon.com/shield/.
   
2. In the navigation pane, choose "Protected resources". 

3. In the Protected resources section, select the resource that you want to check.

4. In the details pane, under AWS Shield Advanced, check the status of the Auto Renew setting. If it is not set to Auto Renew, then the Shield Advanced setting is misconfigured.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your AWS Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all the subscriptions: Use the following AWS CLI command to list all the AWS Shield Advanced subscriptions in your account:

   ```
   aws shield list-subscriptions
   ```
   This command will return a list of all the AWS Shield Advanced subscriptions in your account.

3. Describe the subscription: For each subscription in the list, use the following AWS CLI command to get detailed information about the subscription:

   ```
   aws shield describe-subscription --subscription-arn <subscription-arn>
   ```
   Replace `<subscription-arn>` with the ARN of the subscription you want to check. This command will return detailed information about the subscription, including the auto-renew setting.

4. Check the auto-renew setting: In the output of the `describe-subscription` command, look for the `AutoRenew` field. If the value of this field is `ENABLED`, then the Shield Advanced subscription is set to auto-renew. If the value is `DISABLED`, then it is not set to auto-renew.
</Accordion>

<Accordion title='Using Python'>
1. Install AWS SDK for Python (Boto3): Boto3 is the Amazon Web Services (AWS) Software Development Kit (SDK) for Python, which allows Python developers to write software that makes use of services like Amazon S3, Amazon EC2, etc. You can install it using pip:

   ```bash
   pip install boto3
   ```

2. Configure AWS Credentials: Before you can begin using Boto3, you should set up authentication credentials. You can do this by creating a new IAM user in your AWS console, then set your credentials in the AWS credentials file, which is located by default at `~/.aws/credentials`. At a minimum, the credentials file should specify the access key and secret access key. To specify these for the `default` profile, you can use the following format:

   ```bash
   [default]
   aws_access_key_id = YOUR_ACCESS_KEY
   aws_secret_access_key = YOUR_SECRET_KEY
   ```

3. Create a Python script to check Shield Advanced Setting:

   ```python
   import boto3

   # Create a Shield client
   client = boto3.client('shield')

   # Get the Shield Advanced subscription details
   response = client.describe_subscription()

   # Check if AutoRenew is set to 'ENABLED'
   if response['Subscription']['AutoRenew'] != 'ENABLED':
       print("Shield Advanced Setting is not set to Auto Renew")
   else:
       print("Shield Advanced Setting is set to Auto Renew")
   ```

4. Run the Python script: You can run the Python script using any Python environment. If the output is "Shield Advanced Setting is not set to Auto Renew", then there is a misconfiguration. If the output is "Shield Advanced Setting is set to Auto Renew", then there is no misconfiguration.
</Accordion>

</AccordionGroup>
</Tab>
<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of AWS Shield Advanced setting not being set to auto-renew, follow these steps using the AWS Management Console:

1. **Login to AWS Console**: Go to the AWS Management Console (https://aws.amazon.com/) and log in to your AWS account.

2. **Navigate to AWS Shield Console**: In the AWS Management Console, search for "Shield" in the services search bar and click on "AWS Shield" under the Security, Identity, & Compliance category.

3. **Select the Shield Advanced Service**: In the AWS Shield console, click on the "Shield Advanced" service.

4. **Navigate to Advanced Settings**: In the Shield Advanced dashboard, locate the "Advanced settings" section and click on it to view the current settings.

5. **Enable Auto-Renewal**: Look for the setting related to auto-renewal of the AWS Shield Advanced subscription. If it is not already set to auto-renew, you will see an option to enable auto-renewal. Click on the option to enable auto-renewal for the subscription.

6. **Review and Confirm**: Review the changes you have made to ensure that the auto-renewal setting is now enabled for your AWS Shield Advanced subscription.

7. **Save Changes**: Once you have confirmed that the auto-renewal setting is enabled, click on the "Save" or "Update" button to save the changes.

By following these steps, you have successfully remediated the misconfiguration of AWS Shield Advanced setting not being set to auto-renew. This ensures that your AWS Shield Advanced subscription will automatically renew at the end of its term, providing continuous protection for your AWS resources against DDoS attacks.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of the Shield Advanced setting not being set to auto-renew in AWS using the AWS CLI, follow these steps:

1. Open a terminal or command prompt window.

2. Use the AWS CLI command to enable auto-renewal for Shield Advanced. Run the following command:

```bash
aws shield update-subscription --auto-renew
```

3. Verify that the setting has been updated successfully by running the following command to describe the Shield subscription:

```bash
aws shield describe-subscription
```

4. Check the output to confirm that the `AutoRenew` field is set to `True`, indicating that auto-renewal is now enabled for Shield Advanced.

By following these steps, you have successfully remediated the misconfiguration by setting the Shield Advanced subscription to auto-renew using the AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of AWS Shield Advanced setting not being set to auto renew, you can use the AWS SDK for Python (Boto3) to update the Shield Advanced configuration. Here are the step-by-step instructions to remediate this issue:

1. Install Boto3:
   Make sure you have Boto3 installed. You can install it using pip:
   ```
   pip install boto3
   ```

2. Configure AWS Credentials:
   Ensure that you have AWS credentials configured on the machine where you will be running the Python script. You can set up your AWS credentials using AWS CLI by running:
   ```
   aws configure
   ```

3. Write a Python script to update the Shield Advanced configuration:
   Create a Python script with the following code snippet to update the Shield Advanced configuration to enable auto-renewal:

   ```python
   import boto3

   def update_shield_advanced_auto_renew():
       shield = boto3.client('shield')

       response = shield.update_subscription(
           AutoRenew=True
       )

       print("Auto Renewal for Shield Advanced has been enabled successfully.")

   if __name__ == '__main__':
       update_shield_advanced_auto_renew()
   ```

4. Run the Python script:
   Save the Python script with a meaningful name (e.g., `update_shield_auto_renew.py`) and run it using the following command:
   ```
   python update_shield_auto_renew.py
   ```

5. Verify the Shield Advanced configuration:
   After running the script, verify that the Shield Advanced setting has been updated to auto-renew by checking the AWS Management Console or by running describe_shield_subscription API call.

By following these steps, you can remediate the misconfiguration of AWS Shield Advanced setting not being set to auto renew using Python and Boto3.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
