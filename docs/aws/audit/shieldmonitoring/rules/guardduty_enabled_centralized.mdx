---
slug: guardduty_enabled_centralized
title: GuardDuty Centralized Enablement.
sidebar_label: GuardDuty Centralized Enablement.
---

### More Info:

This rule checks if Amazon GuardDuty is enabled in your AWS account and AWS Region. If you provide an AWS account for centralization, the rule evaluates the GuardDuty results in the centralized account. The rule is COMPLIANT when GuardDuty is enabled.

### Risk Level

Low

### Addresses

Security

### Compliance Standards

CBP,RBI_MD_ITF


### Triage and Remediation
<Tabs>
<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the misconfiguration of GuardDuty Centralized Enablement for AWS Shield using the AWS console, follow these step-by-step instructions:

1. **Sign in to the AWS Management Console**: Go to https://aws.amazon.com/ and sign in to the AWS Management Console using your credentials.

2. **Navigate to the GuardDuty Service**: In the AWS Management Console, search for "GuardDuty" in the search bar at the top of the page and select the GuardDuty service from the search results.

3. **Enable GuardDuty**: If GuardDuty is not already enabled, click on the "Enable GuardDuty" button to enable the service in your AWS account.

4. **Configure GuardDuty**: Follow the on-screen instructions to configure GuardDuty for your account. Make sure to select the appropriate settings based on your requirements.

5. **Enable Centralized Management**: In the GuardDuty console, navigate to the "Settings" tab on the left-hand side menu.

6. **Enable Centralized Management**: In the Settings page, locate the "Enable Centralized Management" option and click on the "Edit" button next to it.

7. **Enable Centralized Management**: In the Edit Centralized Management Settings page, select the option to enable centralized management for GuardDuty.

8. **Save Changes**: Click on the "Save" button to save the changes and enable centralized management for GuardDuty.

9. **Verify Centralized Management**: Once the changes are saved, verify that centralized management is enabled by checking the status in the GuardDuty console.

By following these steps, you will be able to remediate the misconfiguration of GuardDuty Centralized Enablement for AWS Shield using the AWS console.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the misconfiguration of GuardDuty Centralized Enablement for AWS Shield using AWS CLI, follow these steps:

1. **List all regions where GuardDuty is not enabled:**
```bash
aws guardduty list-detectors --region <region-name>
```

2. **Enable GuardDuty in the desired region:**
```bash
aws guardduty create-detector --enable --region <region-name>
```

3. **Enable Centralized GuardDuty Management:**
    - Open the AWS Management Console.
    - Go to the GuardDuty service.
    - Click on the "Settings" tab.
    - Enable the "Enable GuardDuty Centralized Management" option.

4. **Enable AWS Shield Advanced:**
    - Open the AWS Management Console.
    - Go to the AWS Shield service.
    - Click on "Activate AWS Shield Advanced".
    - Follow the on-screen instructions to complete the activation.

5. **Verify GuardDuty and AWS Shield configuration:**
    - Use the following command to verify that GuardDuty is enabled in all regions:
    ```bash
    aws guardduty list-detectors
    ```
    - Use the following command to verify that AWS Shield Advanced is enabled:
    ```bash
    aws shield describe-attack
    ```

By following these steps, you can remediate the misconfiguration of GuardDuty Centralized Enablement for AWS Shield using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the "GuardDuty Centralized Enablement" misconfiguration for AWS Shield using Python, you can follow these steps:

1. Import the necessary Python libraries:
```python
import boto3
```

2. Connect to AWS using the Boto3 library:
```python
client = boto3.client('shield')
```

3. Disable GuardDuty Centralized Enablement:
```python
response = client.update_subscription(
    AutoRenew=True,
    Enabled=False
)
```

4. Verify that GuardDuty Centralized Enablement has been successfully disabled:
```python
if response['ResponseMetadata']['HTTPStatusCode'] == 200:
    print("GuardDuty Centralized Enablement has been successfully disabled.")
else:
    print("Failed to disable GuardDuty Centralized Enablement.")
```

By following these steps, you can remediate the "GuardDuty Centralized Enablement" misconfiguration for AWS Shield using Python.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>

