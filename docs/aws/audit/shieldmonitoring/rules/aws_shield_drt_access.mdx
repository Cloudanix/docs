---
slug: aws_shield_drt_access
title: Shield Response Team (SRT) Should Have Access To AWS Account
sidebar_label: Shield Response Team (SRT) Should Have Access To AWS Account
---

### More Info:

This rule checks whether the Shield Response Team (SRT) can access your AWS account. If AWS Shield Advanced is enabled but the role for SRT access is not configured, the rule is marked as non-compliant. Granting access to the SRT helps AWS respond to and mitigate DDoS attacks effectively.

### Risk Level

Medium

### Addresses

Security

### Compliance Standards

CBP



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console and open the AWS Shield console at https://console.aws.amazon.com/shield/.
   
2. In the navigation pane, choose "Settings". 

3. Under "AWS Shield Response Team access", check if the "Allow AWS Shield Response Team to access account" is enabled. 

4. If it is not enabled, it means the Shield Response Team (SRT) does not have access to the AWS account, indicating a misconfiguration.

#### Using CLI

1. First, you need to install and configure AWS CLI on your local machine. You can download it from the official AWS website and configure it using the "aws configure" command. You will need to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. Once the AWS CLI is set up, you can use the "aws shield describe-protection" command to list the AWS resources that are protected by AWS Shield. This command will return a list of all the resources that are currently protected.

   Command: 
   ```
   aws shield describe-protection --protection-id <value>
   ```
   Replace <value> with the ID of the protection object that you want to describe.

3. To check if the Shield Response Team (SRT) has access to your AWS account, you can use the "aws shield describe-assistance" command. This command will return information about the AWS Shield Advanced subscription for an account.

   Command: 
   ```
   aws shield describe-assistance --region <region>
   ```
   Replace <region> with the region where your AWS Shield Advanced subscription is located.

4. If the SRT does not have access to your AWS account, the "aws shield describe-assistance" command will return an error message. If the SRT does have access, the command will return information about your AWS Shield Advanced subscription, including the status of the subscription and the time when the subscription was activated.

#### Using Python

1. **Import necessary AWS SDK for Python (Boto3) modules**: To interact with AWS services, you need to import the necessary modules from Boto3. For this task, you will need the `boto3` and `botocore.exceptions` modules. 

```python
import boto3
from botocore.exceptions import NoCredentialsError, PartialCredentialsError
```

2. **Create a session using your AWS credentials**: You need to create a session using your AWS credentials. This session will be used to interact with AWS services. 

```python
try:
    session = boto3.Session(
        aws_access_key_id='YOUR_ACCESS_KEY',
        aws_secret_access_key='YOUR_SECRET_KEY',
        region_name='us-west-2'
    )
except (NoCredentialsError, PartialCredentialsError) as e:
    print("Error: ", e)
```

3. **Create a Shield client**: Using the session you created, you can now create a Shield client. This client will be used to interact with the AWS Shield service.

```python
shield_client = session.client('shield')
```

4. **Check if SRT has access to the AWS account**: You can use the `describe_subscription` method of the Shield client to get information about the AWS Shield subscription for an account. If the `SubscriptionState` is `ACTIVE` and `AutoRenew` is `ENABLED`, it means that the SRT has access to the AWS account.

```python
try:
    response = shield_client.describe_subscription()
    if response['Subscription']['SubscriptionState'] == 'ACTIVE' and response['Subscription']['AutoRenew'] == 'ENABLED':
        print("SRT has access to the AWS account.")
    else:
        print("SRT does not have access to the AWS account.")
except Exception as e:
    print("Error: ", e)
```

This script will print whether the SRT has access to the AWS account or not. If there is an error, it will print the error message.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration where the Shield Response Team (SRT) does not have access to the AWS account, follow these steps to grant them the necessary access using the AWS Management Console:

1. **Sign in to the AWS Management Console**: Go to the AWS Management Console at https://aws.amazon.com/ and sign in using your AWS account credentials.

2. **Navigate to AWS Shield**: In the AWS Management Console, search for "Shield" in the services search bar and click on "AWS Shield" to access the Shield dashboard.

3. **Go to the "Protection" Tab**: In the AWS Shield dashboard, navigate to the "Protection" tab on the left-hand side menu.

4. **Click on "Incident Management"**: Under the "Protection" tab, click on "Incident Management" to manage incidents and response team settings.

5. **Add SRT to Incident Response Team**: In the Incident Management page, locate the section for "Incident Response Team" and click on the "Edit" button.

6. **Add SRT as a Contact**: In the "Edit Incident Response Team" window, click on the "Add contact" button and enter the contact information for the Shield Response Team (SRT). Make sure to provide the necessary contact details and permissions for the SRT.

7. **Save Changes**: Once you have added the Shield Response Team (SRT) as a contact in the Incident Response Team settings, click on the "Save" button to apply the changes.

8. **Verify Access**: To verify that the Shield Response Team (SRT) now has access to the AWS account for incident response and management, you can conduct a test incident or review the incident response settings to ensure that the SRT is included as a contact.

By following these steps, you can remediate the misconfiguration and grant the Shield Response Team (SRT) access to the AWS account for incident management and response using the AWS Management Console.

#### Using CLI

To remediate the misconfiguration of providing Shield Response Team (SRT) access to the AWS account using AWS CLI, you can follow these steps:

1. **Create an IAM Policy**:
   - Create a new IAM policy that grants the necessary permissions to the Shield Response Team. Below is an example policy that provides full access to AWS Shield resources:
   
```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": "shield:*",
            "Resource": "*"
        }
    ]
}
```

2. **Attach the IAM Policy**:
   - Attach the newly created IAM policy to a new IAM role or an existing IAM role that is assigned to the Shield Response Team. Replace `IAM_ROLE_NAME` with the actual IAM role name.
   
```bash
aws iam attach-role-policy --role-name IAM_ROLE_NAME --policy-arn arn:aws:iam::aws:policy/FullAWSShieldAccess
```

3. **Verify Access**:
   - Ensure that the Shield Response Team members can now access AWS Shield resources using the assigned IAM role.

By following these steps, you can remediate the misconfiguration and provide the Shield Response Team with the necessary access to the AWS account using AWS CLI.

#### Using Python

To remediate the issue of granting Shield Response Team (SRT) access to the AWS account using Python, you can follow these steps:

1. **Install Boto3**: Boto3 is the AWS SDK for Python. You can install it using pip:
   ```
   pip install boto3
   ```

2. **Create an IAM Policy**: Create a new IAM policy that grants the necessary permissions to the Shield Response Team. You can use the following example policy as a starting point:

   ```json
   {
       "Version": "2012-10-17",
       "Statement": [
           {
               "Effect": "Allow",
               "Action": "shield:*",
               "Resource": "*"
           }
       ]
   }
   ```

3. **Attach the Policy to a Group or User**: You can attach the IAM policy to an existing IAM group that the Shield Response Team members are part of, or directly to individual IAM users.

4. **Use Boto3 to Implement the Remediation**:
   Here is a sample Python script that uses Boto3 to attach the IAM policy to an IAM group:

   ```python
   import boto3

   # Create an IAM client
   iam = boto3.client('iam')

   # Specify the IAM group name
   group_name = 'YOUR_GROUP_NAME'

   # Specify the ARN of the IAM policy created in step 2
   policy_arn = 'YOUR_POLICY_ARN'

   # Attach the policy to the IAM group
   response = iam.attach_group_policy(
       GroupName=group_name,
       PolicyArn=policy_arn
   )

   print(response)
   ```

5. **Run the Python Script**: Save the Python script in a file (e.g., `remediate_shield_access.py`) and run it using Python. Make sure to replace `'YOUR_GROUP_NAME'` and `'YOUR_POLICY_ARN'` with the actual group name and policy ARN.

By following these steps and running the Python script, you can remediate the misconfiguration and grant the Shield Response Team access to the AWS account.



</Tab>
</Tabs>