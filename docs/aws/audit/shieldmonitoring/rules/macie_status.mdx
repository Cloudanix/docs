---
slug: macie_status
title: Macie Should Be Enabled In Account Per Region.
sidebar_label: Macie Should Be Enabled In Account Per Region.
---

### More Info:

This rule checks if Amazon Macie is enabled in your account per region. The rule is NON_COMPLIANT if the 'status' attribute is not set to 'ENABLED'.

### Risk Level

High

### Addresses

Configuration

### Compliance Standards

CBP



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the AWS Management Console and open the Macie service.
2. In the navigation pane, select "Settings".
3. In the "Amazon Macie status" section, check if Macie is enabled. If Macie is enabled, the status will be "Enabled". If Macie is not enabled, the status will be "Disabled".
4. Repeat these steps for each region in your AWS account to ensure Macie is enabled in all regions.

#### Using CLI

1. Install and configure AWS CLI: Before you can start, make sure you have AWS CLI installed and configured with the necessary permissions. You can install it using pip:
   ```
   pip install awscli
   ```
   Then configure it using:
   ```
   aws configure
   ```
   You'll be asked to provide your AWS Access Key ID, Secret Access Key, default region name, and default output format.

2. List all AWS regions: You need to check Macie status in all regions. First, get a list of all regions:
   ```
   aws ec2 describe-regions --query "Regions[].{Name:RegionName}" --output text
   ```
   This command will return a list of all available regions.

3. Check Macie status in each region: For each region, you can check the status of Macie using the following command:
   ```
   aws macie2 get-admin-account --region <region-name>
   ```
   Replace `<region-name>` with the name of each region you got from the previous step. This command will return the status of Macie in the specified region.

4. Analyze the output: If Macie is enabled in the region, the command will return the AWS account ID and the status of the account as the delegated Amazon Macie administrator account for the AWS organization. If Macie is not enabled, the command will return an error. Repeat this step for each region.

#### Using Python

1. Install and configure AWS SDK for Python (Boto3): Before you can start writing Python scripts to check the status of Macie, you need to install and configure AWS SDK for Python (Boto3). You can install it using pip:

```python
pip install boto3
```
After installing Boto3, you need to configure it. You can do this by using the AWS CLI:

```bash
aws configure
```
Enter your AWS Access Key ID, AWS Secret Access Key, Default region name, and Default output format when prompted.

2. Import the necessary modules and create a session: In your Python script, you need to import the Boto3 module. You also need to create a session using your AWS credentials.

```python
import boto3

session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    region_name='us-west-2'
)
```
3. Create a Macie client and check the status: After creating a session, you can create a Macie client. You can then use this client to check the status of Macie in your account.

```python
macie = session.client('macie')
response = macie.describe_user_profile()

status = response['userPaused']
```
In the above code, `describe_user_profile` method is used to retrieve the status of Macie. The status is then stored in the `status` variable.

4. Print the status: Finally, you can print the status of Macie. If Macie is enabled, the status will be `False`. If it is disabled, the status will be `True`.

```python
if status:
    print("Macie is disabled")
else:
    print("Macie is enabled")
```
In the above code, if `status` is `True`, it means that Macie is disabled. If `status` is `False`, it means that Macie is enabled.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of Macie not being enabled in the AWS account per region, you can follow these steps using the AWS Management Console:

1. **Sign in to the AWS Management Console:**
   - Go to the AWS Management Console (https://aws.amazon.com/console/) and sign in to your account.

2. **Navigate to Macie Service:**
   - In the AWS Management Console, search for "Macie" in the services search bar and select the Amazon Macie service.

3. **Enable Macie in the Account:**
   - In the Macie dashboard, click on the "Get Started" button to enable Macie in your account.
   - Follow the on-screen instructions to set up Macie for your account. This may include configuring the Macie settings, such as choosing the regions where you want Macie to be enabled.

4. **Enable Macie in Each Region:**
   - To enable Macie in each region, navigate to the Macie service in each region by selecting the region from the top right corner of the AWS Management Console.
   - Follow the same steps as mentioned in step 3 to enable Macie in each region where you want it to be enabled.

5. **Verify Macie Configuration:**
   - Once Macie is enabled in the account and in each region, verify that the service is configured correctly by checking the Macie dashboard and settings in each region.

6. **Monitor Macie Alerts:**
   - Set up alerts and notifications in Macie to monitor and receive alerts for any security findings or sensitive data discovery in your account.

By following these steps, you can remediate the misconfiguration of Macie not being enabled in the AWS account per region and ensure that Macie is set up and configured correctly to help with data security and compliance in your AWS environment.

#### Using CLI

To remediate the misconfiguration of Macie not being enabled in an AWS account per region, you can follow these steps using AWS CLI:

Step 1: List the regions where Macie is not enabled in your AWS account
```bash
aws ec2 describe-regions --query "Regions[].RegionName" --output text | while read region; do aws macie2 describe-bucket-level-operations --region $region || echo "Macie not enabled in region $region"; done
```

Step 2: Enable Macie in each region where it is not enabled
```bash
aws macie2 create-member --account-id YOUR_ACCOUNT_ID --region REGION_NAME
```
Replace `YOUR_ACCOUNT_ID` with your AWS account ID and `REGION_NAME` with the specific region where Macie is not enabled.

Step 3: Verify that Macie is now enabled in all regions
```bash
aws ec2 describe-regions --query "Regions[].RegionName" --output text | while read region; do aws macie2 describe-bucket-level-operations --region $region || echo "Macie not enabled in region $region"; done
```

By following these steps using AWS CLI, you can remediate the misconfiguration of Macie not being enabled in an AWS account per region.

#### Using Python

To remediate the misconfiguration of Macie not being enabled in the AWS account per region using Python, you can follow these steps:

1. Import the necessary Python libraries:
```python
import boto3
```

2. Initialize the AWS Config and Macie clients:
```python
config_client = boto3.client('config')
macie_client = boto3.client('macie2')
```

3. Retrieve the list of AWS regions:
```python
regions = [region['RegionName'] for region in boto3.client('ec2').describe_regions()['Regions']]
```

4. Enable Macie in each region if it is not already enabled:
```python
for region in regions:
    try:
        response = macie_client.describe_bucket(region=region)
    except macie_client.exceptions.ClientError as e:
        if e.response['Error']['Code'] == 'AccessDeniedException':
            print(f"Macie is not enabled in region {region}. Enabling Macie in this region...")
            try:
                macie_client.create_member(accountId='current', email='youremail@example.com')
                print(f"Macie has been enabled in region {region}.")
            except macie_client.exceptions.ClientError as e:
                print(f"Failed to enable Macie in region {region}. Error: {str(e)}")
        else:
            print(f"Failed to describe Macie in region {region}. Error: {str(e)}")
```

5. Run the Python script to enable Macie in all regions of the AWS account. Make sure you have the necessary permissions to enable Macie in the account.

Please note that the above script assumes you have the necessary permissions to enable Macie in the AWS account. You may need to adjust the script based on your specific requirements and environment.



</Tab>
</Tabs>