---
slug: permissions_with_all_resources
title: Permission for all resources
sidebar_label: Permission for all resources
---

### More Info:

Giving permissions to resource: * (all resources) should be avoided or minimized in majority of the cases.

### Risk Level

Medium

### Address

Security

### Compliance Standards

CISGCP,HIPAA,SCO2,NISTCSF,NIST,AWSWAF,ISO27001,HITRUST,CBP
### Remediation

#### Using Console

To remediate the misconfiguration of granting permission for all resources in AWS IAM for the user "IAMDEEPDIVE" using the AWS Management Console, follow these steps:

1. Sign in to the AWS Management Console using your administrator account credentials.
2. Open the IAM service by searching for "IAM" in the AWS Management Console search bar and selecting "IAM" from the results.
3. In the left navigation pane, click on "Users" to view the list of IAM users.
4. Search for the user "IAMDEEPDIVE" in the user list and select it.
5. In the "Permissions" tab, you will see the attached policies for the user.
6. Click on the policy that grants permission for all resources to expand it.
7. Review the policy document to understand the permissions granted. It may look similar to:

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": "*",
            "Resource": "*"
        }
    ]
}
```

8. To remediate this misconfiguration, you will need to remove the policy that grants permission for all resources.
9. Click on the "Detach Policy" button to remove the policy from the user.
10. In the confirmation dialog, click on "Detach" to confirm the removal of the policy.
11. After detaching the policy, the user "IAMDEEPDIVE" will no longer have permission for all resources.
12. If required, you can attach a more specific policy or policies to grant the necessary permissions for the user's intended tasks.
13. To attach a new policy, click on the "Attach Policy" button.
14. Search for the desired policy in the policy list and select it.
15. Click on the "Attach Policy" button to attach the selected policy to the user.
16. Repeat steps 13-15 if you need to attach multiple policies.
17. Once you have attached the necessary policies, review the permissions to ensure they are appropriate for the user's requirements.
18. Finally, inform the user "IAMDEEPDIVE" about the updated permissions and advise them to test their access to ensure it meets their needs.

By following these steps, you have successfully remediated the misconfiguration by removing the policy that grants permission for all resources and attaching more specific policies as required.

#### Using CLI

To remediate the misconfiguration of granting permissions for all resources in AWS IAMDEEPDIVE using AWS CLI, follow these steps:

1. Identify the IAM user or role that has been granted permissions for all resources. You can do this by checking the policies attached to the user or role.

2. Open the AWS CLI and configure it with the appropriate credentials and region. Ensure that you have sufficient permissions to modify IAM policies.

3. List the policies attached to the IAM user or role using the following command:
```
aws iam list-attached-user-policies --user-name IAMDEEPDIVE
```
or
```
aws iam list-attached-role-policies --role-name IAMDEEPDIVE
```

4. Identify the policy that grants permissions for all resources. Take note of its name and ARN.

5. Detach the policy from the IAM user or role using the following command:
```
aws iam detach-user-policy --user-name IAMDEEPDIVE --policy-arn <policy-arn>
```
or
```
aws iam detach-role-policy --role-name IAMDEEPDIVE --policy-arn <policy-arn>
```
Replace `<policy-arn>` with the ARN of the policy identified in step 4.

6. Verify that the policy has been successfully detached by listing the attached policies again. The policy granting permissions for all resources should no longer be present.

7. To ensure that the IAM user or role has appropriate permissions, attach the necessary policies that provide specific and granular access to resources. You can use the `attach-user-policy` or `attach-role-policy` command, depending on whether it is a user or role.

8. Test the updated permissions to confirm that the misconfiguration has been remediated.

#### Using Python

To remediate the misconfiguration of granting permission for all resources in AWS IAMDEEPDIVE using Python, follow these steps:

1. Open the AWS Management Console and navigate to the IAM service.

2. Create a new IAM policy with the appropriate permissions for the IAMDEEPDIVE user. You can use the following code snippet as a starting point:

```python
import boto3
import json

# Define the policy document
policy_doc = {
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": "*",
            "Resource": "*"
        }
    ]
}

# Create the IAM policy
iam_client = boto3.client('iam')
response = iam_client.create_policy(
    PolicyName='IAMDEEPDIVE-FullAccess',
    PolicyDocument=json.dumps(policy_doc)
)

# Attach the policy to the IAMDEEPDIVE user
response = iam_client.attach_user_policy(
    UserName='IAMDEEPDIVE',
    PolicyArn=response['Policy']['Arn']
)
```

3. Replace `'IAMDEEPDIVE'` with the actual username of the IAMDEEPDIVE user.

4. Run the Python script to create the policy and attach it to the user. Make sure you have the necessary IAM permissions to perform these actions.

5. Verify that the policy has been attached successfully by checking the IAMDEEPDIVE user's permissions.

By following these steps, you will remediate the misconfiguration of granting permission for all resources in AWS IAMDEEPDIVE by creating a specific policy with the desired permissions and attaching it to the user.



