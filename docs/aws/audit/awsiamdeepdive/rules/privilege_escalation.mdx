---
slug: privilege_escalation
title: Privilege escalation
sidebar_label: Privilege escalation
---

### More Info:

IAM User or Role can be leveraged to escalate privileges and can present higher risk.

### Risk Level

High

### Address

Security

### Compliance Standards

CISGCP,HIPAA,SCO2,NISTCSF,NIST,AWSWAF,ISO27001,HITRUST
### Remediation

#### Using Console

To remediate the privilege escalation misconfiguration in AWS IAM, follow these steps using the AWS Management Console:

1. Sign in to the AWS Management Console using your administrator credentials.

2. Open the IAM service from the console.

3. Click on "Roles" in the left navigation pane.

4. Identify the role that has the misconfigured privilege escalation issue. You can search for the role using the search bar or manually locate it in the list.

5. Select the role by clicking on its name.

6. In the "Permissions" tab, review the policies attached to the role. Identify any policies that grant excessive privileges or allow privilege escalation.

7. Click on the policy name to view its details.

8. Review the policy document to identify the specific actions or resources that are causing the privilege escalation issue.

9. Edit the policy document by clicking on the "Edit policy" button.

10. Modify the policy document to remove any unnecessary or excessive permissions that lead to privilege escalation. Ensure that the policy only grants the minimum required permissions for the role.

11. Click on "Review policy" to validate the updated policy document.

12. Review the changes and ensure that the updated policy meets your requirements.

13. Click on "Save changes" to apply the updated policy to the role.

14. Repeat steps 5-13 for any other roles that have the privilege escalation misconfiguration.

By following these steps, you can remediate the privilege escalation misconfiguration in AWS IAM and ensure that roles have the appropriate and minimal permissions necessary for their intended purpose.

#### Using CLI

To remediate privilege escalation misconfiguration in AWS IAM using AWS CLI, follow these steps:

1. Identify the affected IAM user or role that has excessive permissions or privileges.

2. Log in to the AWS Management Console using the root account or an IAM user with administrative privileges.

3. Open the AWS CLI on your local machine or EC2 instance with the necessary IAM permissions.

4. Run the following command to list all the attached policies for the user or role:

   ```bash
   aws iam list-attached-user-policies --user-name <IAM_USER_NAME>
   ```

   or

   ```bash
   aws iam list-attached-role-policies --role-name <IAM_ROLE_NAME>
   ```

   Replace `<IAM_USER_NAME>` with the name of the affected IAM user or `<IAM_ROLE_NAME>` with the name of the affected IAM role.

5. Review the output and identify the policies that grant excessive permissions.

6. Run the following command to list all the inline policies attached to the user or role:

   ```bash
   aws iam list-user-policies --user-name <IAM_USER_NAME>
   ```

   or

   ```bash
   aws iam list-role-policies --role-name <IAM_ROLE_NAME>
   ```

   Replace `<IAM_USER_NAME>` with the name of the affected IAM user or `<IAM_ROLE_NAME>` with the name of the affected IAM role.

7. Review the output and identify any inline policies that grant excessive permissions.

8. Run the following command to remove the excessive attached policies:

   ```bash
   aws iam detach-user-policy --user-name <IAM_USER_NAME> --policy-arn <POLICY_ARN>
   ```

   or

   ```bash
   aws iam detach-role-policy --role-name <IAM_ROLE_NAME> --policy-arn <POLICY_ARN>
   ```

   Replace `<IAM_USER_NAME>` with the name of the affected IAM user or `<IAM_ROLE_NAME>` with the name of the affected IAM role. Replace `<POLICY_ARN>` with the ARN of the policy to be detached.

9. Repeat step 8 for all the identified attached policies that grant excessive permissions.

10. Run the following command to delete the excessive inline policies:

    ```bash
    aws iam delete-user-policy --user-name <IAM_USER_NAME> --policy-name <POLICY_NAME>
    ```

    or

    ```bash
    aws iam delete-role-policy --role-name <IAM_ROLE_NAME> --policy-name <POLICY_NAME>
    ```

    Replace `<IAM_USER_NAME>` with the name of the affected IAM user or `<IAM_ROLE_NAME>` with the name of the affected IAM role. Replace `<POLICY_NAME>` with the name of the policy to be deleted.

11. Repeat step 10 for all the identified inline policies that grant excessive permissions.

12. Verify that the privilege escalation misconfiguration is remediated by reviewing the user or role's permissions and policies.

By following these steps, you can remediate the privilege escalation misconfiguration in AWS IAM using the AWS CLI.

#### Using Python

To remediate privilege escalation in AWSIAM Deep Dive, you can follow these step-by-step instructions using Python:

1. Identify the affected IAM user or role: Start by identifying the IAM user or role that has the privilege escalation issue. This can be done by reviewing the IAM policies and roles associated with the user.

2. Remove unnecessary permissions: Review the IAM policies associated with the user or role and identify any unnecessary or excessive permissions. Remove these permissions to reduce the risk of privilege escalation.

3. Implement the principle of least privilege: Modify the IAM policies to follow the principle of least privilege. Only grant the minimum required permissions to perform specific tasks. This helps to limit the potential impact of privilege escalation.

4. Enable MFA (Multi-Factor Authentication): Enable MFA for the affected IAM user or role. This adds an extra layer of security by requiring an additional authentication factor, such as a physical token or mobile app, to access the account.

5. Regularly rotate access keys and credentials: Regularly rotate the access keys and credentials associated with the IAM user or role. This helps to minimize the impact in case any credentials are compromised.

6. Enable CloudTrail logging: Enable CloudTrail logging to monitor and track all API calls made to the AWS account. This provides visibility into any suspicious or unauthorized activities, including potential privilege escalation attempts.

7. Implement IAM roles for EC2 instances: If the privilege escalation issue is related to EC2 instances, consider using IAM roles instead of IAM users. IAM roles provide temporary credentials to EC2 instances, reducing the need to manage and rotate access keys.

8. Regularly review and update IAM policies: Continuously review and update IAM policies to ensure they align with the current requirements and follow the principle of least privilege. Regularly assess and remove any unnecessary permissions.

9. Monitor and respond to security alerts: Implement a monitoring system to detect and alert on any suspicious activities or potential privilege escalation attempts. Establish an incident response process to promptly investigate and remediate any identified security issues.

By following these steps, you can remediate the privilege escalation issue in AWSIAM Deep Dive using Python.


