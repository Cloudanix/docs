---
slug: object_lock
title: S3 Buckets Should Have Object Lock Enabled
sidebar_label: S3 Buckets Should Have Object Lock Enabled
---

### More Info:

AWS S3 buckets should use Object Lock for data protection and/or regulatory compliance and in order to prevent the objects they store from being deleted.

### Risk Level

Low

### Address

Security

### Compliance Standards

HIPAA, SOC2

### Remediation

#### Using Console

Sure, here are the step-by-step instructions to remediate the S3 Buckets Should Have Object Lock Enabled misconfiguration in AWS using the AWS console:

1. Login to AWS Management Console.
2. Navigate to the S3 service.
3. Select the bucket that needs to be remediated.
4. Click on the "Properties" tab.
5. Scroll down and click on the "Object lock" option.
6. Click on the "Edit" button.
7. Select "Enable object lock" and then click on the "Save changes" button.

Once you have followed these steps, the Object Lock feature will be enabled for the selected S3 bucket. This will ensure that all objects stored in the bucket are protected from deletion or modification for the specified retention period.

#### Using CLI

To remediate the misconfiguration "S3 Buckets Should Have Object Lock Enabled" for AWS using AWS CLI, follow the steps below:

1. Open the AWS CLI on your local machine or EC2 instance.

2. Run the following command to enable Object Lock on the S3 bucket:

```
aws s3api put-object-lock-configuration --bucket <bucket-name> --object-lock-configuration '{"ObjectLockEnabled":"Enabled"}'
```

Make sure to replace `<bucket-name>` with the name of your S3 bucket.

3. Verify that Object Lock is enabled on the S3 bucket by running the following command:

```
aws s3api get-object-lock-configuration --bucket <bucket-name>
```

This command should return the Object Lock configuration for the S3 bucket, which should include `"ObjectLockEnabled": "Enabled"`.

By following these steps, you can remediate the misconfiguration "S3 Buckets Should Have Object Lock Enabled" for AWS using AWS CLI.

#### Using Python

To remediate the misconfiguration of S3 Buckets not having Object Lock enabled in AWS using Python, follow these steps:

1. Install `boto3` library for AWS SDK for Python using the following command:

```python
pip install boto3
```

2. Create an AWS S3 client using `boto3` and provide the AWS access key and secret key:

```python
import boto3

s3 = boto3.client('s3', aws_access_key_id='YOUR_ACCESS_KEY',
                  aws_secret_access_key='YOUR_SECRET_KEY')
```

3. Get the list of all S3 buckets in your AWS account using the following command:

```python
response = s3.list_buckets()
buckets = [bucket['Name'] for bucket in response['Buckets']]
```

4. For each S3 bucket, check if Object Lock is enabled or not using the following code:

```python
for bucket in buckets:
    response = s3.get_bucket_object_lock_configuration(Bucket=bucket)
    if 'ObjectLockEnabled' not in response:
        # Object Lock is not enabled for the bucket
        # Enable Object Lock for the bucket
        response = s3.put_bucket_object_lock_configuration(
            Bucket=bucket,
            ObjectLockConfiguration={
                'ObjectLockEnabled': 'Enabled'
            }
        )
```

5. Save the Python script and run it to enable Object Lock for all S3 buckets in your AWS account.

Note: Make sure to provide the correct AWS access key and secret key with the required permissions to access and modify S3 buckets.

### Additional Reading:

- [https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lock-overview.html](https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lock-overview.html) 

