---
slug: s3_website_config_enabled
title: S3 Buckets Should Have Wite Configuration Enabled
sidebar_label: S3 Buckets Should Have Wite Configuration Enabled
---

### More Info:

S3 buckets with website configuration enabled should be regularly reviewed (informational). By regularly reviewing these S3 buckets you make sure that only the desired buckets are accessible from the website endpoint.

### Risk Level

Informational

### Address

Security

### Compliance Standards

CBP



### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console and open the Amazon S3 console at https://console.aws.amazon.com/s3/.
   
2. In the Bucket name list, choose the name of the bucket that you want to check for write configuration.

3. Choose the Permissions tab, and then choose Bucket Policy. Here you can see the bucket policy. 

4. Look for any statements in the policy that have "Effect": "Allow" and "Principal": "*". This indicates that the bucket is publicly accessible. If "Action" includes "s3:PutObject", "s3:PutObjectAcl", "s3:PutObjectVersionAcl", or "s3:PutObjectVersionAcl", it means that write permissions are enabled for everyone. If such statements are not present, then the bucket does not have write configuration enabled.
</Accordion>

<Accordion title='Using CLI'>
1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine. You can download it from the official AWS website. After installation, you need to configure it with your AWS account credentials. You can do this by running the command `aws configure` and then entering your AWS Access Key ID, Secret Access Key, Default region name, and Default output format when prompted.

2. List all S3 buckets: You can list all your S3 buckets using the following command: `aws s3api list-buckets --query "Buckets[].Name"`. This command will return a list of all your S3 bucket names.

3. Check bucket policy: For each bucket, you can check its policy using the following command: `aws s3api get-bucket-policy --bucket your-bucket-name`. Replace "your-bucket-name" with the name of your bucket. This command will return the bucket's policy.

4. Check for write configuration: In the returned policy, look for the `Statement` array. Each object in this array represents a permission. Check if there is any statement with `"Effect": "Allow"` and `"Action": "s3:PutObject"` or `"Action": "s3:*"`. If such a statement exists and its `"Principal"` is `"*"` (which means everyone), then the bucket has write configuration enabled.
</Accordion>

<Accordion title='Using Python'>
1. Install the necessary Python libraries: To interact with AWS services, you need to install the AWS SDK for Python (Boto3). You can install it using pip:

   ```bash
   pip install boto3
   ```

2. Configure AWS credentials: Before you can interact with AWS services, you need to set up your AWS credentials. You can do this by creating a file at ~/.aws/credentials. At a minimum, the credentials file should specify the access key and secret access key. To specify these for the default profile, you can use the following format:

   ```bash
   [default]
   aws_access_key_id = YOUR_ACCESS_KEY
   aws_secret_access_key = YOUR_SECRET_KEY
   ```

3. Write a Python script to check S3 bucket logging configuration: Here is a simple Python script that uses Boto3 to check if logging is enabled for each S3 bucket in your account:

   ```python
   import boto3

   # Create a session using your AWS credentials
   s3 = boto3.client('s3')

   # List all S3 buckets
   response = s3.list_buckets()

   # For each bucket, check if logging is enabled
   for bucket in response['Buckets']:
       bucket_logging = s3.get_bucket_logging(Bucket=bucket['Name'])

       # If the 'LoggingEnabled' key is missing, logging is disabled
       if 'LoggingEnabled' not in bucket_logging:
           print(f"Bucket {bucket['Name']} does not have logging enabled.")
   ```

4. Run the script: You can run the script using any Python interpreter. The script will print the names of all S3 buckets that do not have logging enabled. If no such buckets exist, the script will not output anything.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
To remediate the issue of S3 buckets not having write configuration enabled, you can follow the below steps using AWS console:

1. Log in to the AWS Management Console.
2. Navigate to the S3 service.
3. Select the S3 bucket that you want to remediate.
4. Click on the "Permissions" tab.
5. Scroll down to the "Bucket policy" section and click on "Edit".
6. Add the following policy to enable write configuration:

```
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "AllowWrite",
            "Effect": "Allow",
            "Principal": {
                "AWS": "*"
            },
            "Action": [
                "s3:PutBucketVersioning",
                "s3:PutBucketAcl",
                "s3:PutBucketPolicy",
                "s3:PutBucketLogging",
                "s3:PutBucketWebsite",
                "s3:PutBucketNotification",
                "s3:PutBucketTagging",
                "s3:PutLifecycleConfiguration"
            ],
            "Resource": [
                "arn:aws:s3:::your-bucket-name"
            ]
        }
    ]
}
```

Note: Replace "your-bucket-name" with the actual name of your S3 bucket.

7. Click on "Save changes" to save the policy.
8. Verify that the write configuration is now enabled for the S3 bucket by checking the bucket properties.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the S3 bucket write configuration misconfiguration in AWS using AWS CLI, follow the steps below:

1. Open the AWS CLI on your local machine.

2. Run the following command to list all the S3 buckets in your AWS account:

   ```
   aws s3 ls
   ```

3. Identify the S3 bucket that has the write configuration misconfiguration.

4. Run the following command to update the bucket policy to enable write configuration:

   ```
   aws s3api put-bucket-policy --bucket <bucket-name> --policy file://policy.json
   ```

   Note: Replace `<bucket-name>` with the name of the S3 bucket that needs to be updated with the write configuration.

5. Create a file named `policy.json` and add the following JSON code to it:

   ```
   {
       "Version": "2012-10-17",
       "Statement": [
           {
               "Effect": "Allow",
               "Principal": "*",
               "Action": [
                   "s3:PutObject",
                   "s3:PutObjectAcl",
                   "s3:PutObjectVersionAcl"
               ],
               "Resource": [
                   "arn:aws:s3:::<bucket-name>/*"
               ]
           }
       ]
   }
   ```

   Note: Replace `<bucket-name>` with the name of the S3 bucket that needs to be updated with the write configuration.

6. Save the `policy.json` file and run the command in step 4.

7. Verify that the write configuration has been enabled for the S3 bucket by running the following command:

   ```
   aws s3api get-bucket-policy --bucket <bucket-name>
   ```

   Note: Replace `<bucket-name>` with the name of the S3 bucket that has been updated with the write configuration.

8. The command in step 7 should return the updated bucket policy with the write configuration enabled.

By following the above steps, you can remediate the S3 bucket write configuration misconfiguration in AWS using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the S3 bucket write configuration issue in AWS using Python, you can follow these steps:

1. Import the necessary libraries:

```python
import boto3
from botocore.exceptions import ClientError
```

2. Create an S3 client:

```python
s3 = boto3.client('s3')
```

3. Get a list of all the S3 buckets in your account:

```python
buckets = s3.list_buckets()
```

4. For each bucket, check if the bucket policy allows write access:

```python
for bucket in buckets['Buckets']:
    bucket_name = bucket['Name']
    try:
        bucket_policy = s3.get_bucket_policy(Bucket=bucket_name)
        policy_text = bucket_policy['Policy']
        if 's3:PutObject' not in policy_text:
            # Add the 's3:PutObject' permission to the bucket policy
            new_policy = {
                'Version': '2012-10-17',
                'Statement': [{
                    'Sid': 'AddPerm',
                    'Effect': 'Allow',
                    'Principal': '*',
                    'Action': ['s3:PutObject'],
                    'Resource': f'arn:aws:s3:::{bucket_name}/*'
                }]
            }
            s3.put_bucket_policy(Bucket=bucket_name, Policy=json.dumps(new_policy))
            print(f'Write access added to bucket {bucket_name}')
        else:
            print(f'Bucket {bucket_name} already has write access')
    except ClientError as e:
        if e.response['Error']['Code'] == 'NoSuchBucketPolicy':
            # Create a new bucket policy with the 's3:PutObject' permission
            new_policy = {
                'Version': '2012-10-17',
                'Statement': [{
                    'Sid': 'AddPerm',
                    'Effect': 'Allow',
                    'Principal': '*',
                    'Action': ['s3:PutObject'],
                    'Resource': f'arn:aws:s3:::{bucket_name}/*'
                }]
            }
            s3.put_bucket_policy(Bucket=bucket_name, Policy=json.dumps(new_policy))
            print(f'Write access added to bucket {bucket_name}')
        else:
            print(f'Error: {e}')
```

This code will check each bucket in your account and add the 's3:PutObject' permission to the bucket policy if it's not already there. If the bucket doesn't have a policy, it will create one with the 's3:PutObject' permission.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html](https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html) 

