---
slug: s3_https
title: S3 Buckets Should Have A Secure Transport Policy
sidebar_label: S3 Buckets Should Have A Secure Transport Policy
---

### More Info:

AWS S3 buckets should enforce encryption of data over the network (as it travels to and from Amazon S3) using Secure Sockets Layer (SSL).

### Risk Level

Critical

### Address

Security

### Compliance Standards

HIPAA, CISAWS, CBP, GDPR, NIST, SOC2, PCIDSS, ISO27001, AWSWAF, HITRUST, NISTCSF

### Remediation

#### Using Console

Sure, here are the step by step instructions to remediate this misconfiguration for AWS using the AWS console:

1. Login to your AWS console.
2. Go to the S3 service.
3. Click on the S3 bucket for which you want to remediate the misconfiguration.
4. Click on the "Permissions" tab.
5. Click on the "Bucket Policy" button.
6. Add the following policy to the bucket policy editor:

```
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "ForceSSLOnlyAccess",
            "Effect": "Deny",
            "Principal": "*",
            "Action": "s3:*",
            "Resource": [
                "arn:aws:s3:::YOUR_BUCKET_NAME/*",
                "arn:aws:s3:::YOUR_BUCKET_NAME"
            ],
            "Condition": {
                "Bool": {
                    "aws:SecureTransport": "false"
                }
            }
        }
    ]
}
```

Note: Replace "YOUR_BUCKET_NAME" with the name of your S3 bucket.

7. Click on the "Save" button to apply the policy to the bucket.
8. Verify that the policy is working by trying to access the bucket using an insecure connection. You should receive an error message stating that the connection is insecure.

That's it! You have now remediated the misconfiguration by enforcing secure transport policy for your S3 bucket in AWS.

#### Using CLI

To remediate the misconfiguration of S3 Buckets Should Have A Secure Transport Policy in AWS using AWS CLI, follow the below steps:

1. Open the AWS CLI command prompt.
2. Run the following command to identify the S3 buckets that do not have secure transport policy enabled:

   ```
   aws s3api list-buckets --query "Buckets[?PublicAccessBlockConfiguration == null].Name"
   ```
   
   This command will list all the S3 buckets that do not have secure transport policy enabled.

3. For each bucket, run the following command to enable the secure transport policy:

   ```
   aws s3api put-public-access-block --bucket <bucket-name> --public-access-block-configuration "BlockPublicAcls=true,IgnorePublicAcls=true,BlockPublicPolicy=true,RestrictPublicBuckets=true"
   ```
   
   Replace `<bucket-name>` with the name of the bucket that you want to enable the secure transport policy for.

4. Verify that the secure transport policy has been enabled for the bucket by running the following command:

   ```
   aws s3api get-public-access-block --bucket <bucket-name>
   ```
   
   Replace `<bucket-name>` with the name of the bucket that you enabled the secure transport policy for.

   This command will return the current public access block configuration for the bucket. The response should show that the `BlockPublicAcls`, `IgnorePublicAcls`, `BlockPublicPolicy`, and `RestrictPublicBuckets` parameters are set to `true`, which indicates that the secure transport policy has been enabled successfully.

By following the above steps, you can remediate the misconfiguration of S3 Buckets Should Have A Secure Transport Policy in AWS using AWS CLI.

#### Using Python

To remediate the misconfiguration of S3 buckets not having a secure transport policy, you can follow the below steps:

1. Open the AWS console and navigate to the S3 service.
2. Select the bucket that you want to remediate.
3. Click on the "Permissions" tab.
4. Click on "Bucket Policy" and add the following policy to enforce secure transport:

```
{
  "Version":"2012-10-17",
  "Statement":[
    {
      "Sid":"ForceSSLOnlyAccess",
      "Effect":"Deny",
      "Principal":"*",
      "Action":"s3:*",
      "Resource":"arn:aws:s3:::YOUR_BUCKET_NAME/*",
      "Condition":{
        "Bool":{
          "aws:SecureTransport":"false"
        }
      }
    }
  ]
}
```

5. Replace "YOUR_BUCKET_NAME" with the name of your S3 bucket.
6. Save the policy.

To remediate this using Python, you can use the AWS SDK for Python (Boto3) and the following code:

```
import boto3
from botocore.exceptions import ClientError

# Replace "YOUR_BUCKET_NAME" with the name of your S3 bucket.
bucket_name = 'YOUR_BUCKET_NAME'

# Create an S3 client
s3 = boto3.client('s3')

# Add the secure transport policy to the bucket
try:
    bucket_policy = {
        "Version":"2012-10-17",
        "Statement":[
            {
                "Sid":"ForceSSLOnlyAccess",
                "Effect":"Deny",
                "Principal":"*",
                "Action":"s3:*",
                "Resource":"arn:aws:s3:::" + bucket_name + "/*",
                "Condition":{
                    "Bool":{
                        "aws:SecureTransport":"false"
                    }
                }
            }
        ]
    }
    s3.put_bucket_policy(Bucket=bucket_name, Policy=json.dumps(bucket_policy))
    print("Bucket policy updated successfully.")
except ClientError as e:
    print("Error updating bucket policy: ", e)
```

This code will add the secure transport policy to the specified S3 bucket.

### Additional Reading:

- [https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html](https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html) 

