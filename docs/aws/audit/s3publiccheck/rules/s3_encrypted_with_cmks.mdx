---
slug: s3_encrypted_with_cmks
title: S3 Buckets Should Be Encrypted with Customer-Provided CMKs
sidebar_label: S3 Buckets Should Be Encrypted with Customer-Provided CMKs
---

### More Info:

AWS S3 buckets should be configured to use Server-Side Encryption with customer managed CMKs instead of S3-Managed Keys (SSE-S3) in order to obtain a fine-grained control over Amazon S3 data-at-rest encryption and decryption process.

### Risk Level

Low

### Address

Security

### Compliance Standards

NIST, AWSWAF, HITRUST, SOC2, NISTCSF, PCIDSS

### Remediation

How to enable CMK encryption for S3 buckets?

#### Using AWS Console

1. Open the AWS Management Console and navigate to the Amazon S3 service.
2. Click on the name of the existing S3 bucket for which you want to enable CMK encryption.
    (In the Cloudanix Console, navigate to "Misconfig" page and look for Affected Assets for "S3 Buckets Should Be Encrypted with Customer-Provided CMKs" Policy.)
3. In the bucket details page, click on the "Properties" tab.
4. Under the "Default encryption" section, click on the "Edit" button.
5. In the "Default encryption" window, select the option for "AES-256" or "AWS Key Management Service (SSE-KMS)" depending on your preference.
   - If you choose "AES-256", Amazon S3 will manage the encryption keys for you automatically.
   - If you choose "AWS Key Management Service (SSE-KMS)", you can select a specific CMK to be used for encryption. If you haven't created a CMK yet, you can create one in the AWS Key Management Service (KMS) console and then return to this step.
6. If you selected "AWS Key Management Service (SSE-KMS)", click on the "Change encryption key" button to select the desired CMK from the list. You can search for the CMK by key alias, key ID, or key ARN.
7. Once you have selected the encryption option and, if applicable, the desired CMK, click on the "Save changes" button to enable CMK encryption for the bucket.
8. Amazon S3 will automatically apply the CMK encryption to new objects uploaded to the bucket. Existing objects in the bucket will remain encrypted with their original encryption settings until they are modified or overwritten.
9. To ensure that all existing objects in the bucket are encrypted with the selected CMK, you can initiate a "Copy" operation for each object. This process will create a copy of each object with the specified encryption settings.
   - You can use the AWS Command Line Interface (CLI) or an SDK to perform a batch copy operation for multiple objects.
10. Monitor the bucket to ensure that new objects are encrypted with the CMK, and update your processes and procedures accordingly to handle encrypted objects.

### Additional Reading:

- [https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html](https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html) 

