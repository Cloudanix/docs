---
slug: kms_key_rotation_enabled
title: KMS Key Rotation Should Be Enabled
sidebar_label: KMS Key Rotation Should Be Enabled
---

### More Info:

When you enable automatic key rotation, AWS KMS rotates the CMK 365 days after the enable date and every 365 days thereafter.

### Risk Level

Medium

### Address

Security

### Compliance Standards

HIPAA, GDPR, NIST, HITRUST, AWSWAF, CISAWS, CBP, SOC2, NISTCSF, PCIDSS



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the AWS Management Console.
2. Navigate to the KMS dashboard by selecting "Services" from the navigation bar, then selecting "Key Management Service" under the "Security, Identity, & Compliance" category.
3. In the KMS dashboard, select "Customer managed keys" from the left-hand navigation pane. This will display a list of all the KMS keys that are currently managed by your account.
4. For each key in the list, check the "Key rotation" column. If the status is "Disabled", then key rotation is not enabled for that key.

#### Using CLI

1. Install and configure AWS CLI: Before you can start using AWS CLI, you need to install it on your local machine and configure it with your AWS account credentials. You can do this by running the following commands:

   Installation:
   ```
   pip install awscli
   ```
   Configuration:
   ```
   aws configure
   ```
   You will be prompted to provide your AWS Access Key ID, Secret Access Key, Default region name, and Default output format.

2. List all KMS keys: Use the `list-keys` command to get a list of all KMS keys in your AWS account. The command will return a list of key IDs and ARNs (Amazon Resource Names).

   ```
   aws kms list-keys
   ```

3. Check key rotation status: For each key ID returned by the `list-keys` command, use the `get-key-rotation-status` command to check if key rotation is enabled. Replace `key-id` with the actual key ID.

   ```
   aws kms get-key-rotation-status --key-id key-id
   ```

4. Analyze the output: The `get-key-rotation-status` command will return a JSON object with a `KeyRotationEnabled` field. If the value of this field is `false`, then key rotation is not enabled for the corresponding key. If the value is `true`, then key rotation is enabled. Repeat this step for each key ID to check the rotation status of all keys.

#### Using Python

1. Install the necessary Python libraries: Before you can start writing the script, you need to install the necessary Python libraries. For AWS, you will need the boto3 library, which is the Amazon Web Services (AWS) SDK for Python. You can install it using pip:

```python
pip install boto3
```

2. Import the necessary libraries and initialize the client: In your Python script, you need to import the boto3 library and initialize the KMS client. 

```python
import boto3
kms_client = boto3.client('kms')
```

3. List all KMS keys: You can use the `list_keys` method to get a list of all KMS keys. 

```python
response = kms_client.list_keys()
keys = response['Keys']
```

4. Check key rotation status: For each key in the list, you can use the `get_key_rotation_status` method to check if key rotation is enabled. If it's not, print the key ID.

```python
for key in keys:
    key_id = key['KeyId']
    response = kms_client.get_key_rotation_status(KeyId=key_id)
    if not response['KeyRotationEnabled']:
        print(f"Key rotation is not enabled for key: {key_id}")
```

This script will print the IDs of all keys for which key rotation is not enabled.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

Sure, here are the step-by-step instructions to remediate the KMS Key Rotation misconfiguration in AWS using the AWS console:

1. Log in to your AWS Management Console.
2. Navigate to the AWS Key Management Service (KMS) dashboard.
3. Select the KMS key that needs to be remediated.
4. Click on the "Key policy" button to view the key policy.
5. In the key policy, locate the "KeyRotationEnabled" statement. If it is not present, add it to the key policy.
6. Set the value of "KeyRotationEnabled" to "true".
7. Click on the "Save changes" button to save the updated key policy.

After completing these steps, KMS key rotation will be enabled for the selected key. It is recommended to perform this remediation for all KMS keys used in your AWS environment.

#### Using CLI

To remediate the misconfiguration "KMS Key Rotation Should Be Enabled" for AWS using AWS CLI, follow these steps:

1. Open the AWS CLI on your local machine or in the AWS Management Console.

2. Check if the KMS key rotation is enabled or not using the following command:
```
aws kms get-key-rotation-status --key-id <key-id>
```
Note: Replace `<key-id>` with the ID of the KMS key for which you want to check the rotation status.

3. If the key rotation is not enabled, enable it using the following command:
```
aws kms enable-key-rotation --key-id <key-id>
```
Note: Replace `<key-id>` with the ID of the KMS key for which you want to enable the rotation.

4. Verify if the key rotation is enabled using the following command:
```
aws kms get-key-rotation-status --key-id <key-id>
```
Note: Replace `<key-id>` with the ID of the KMS key for which you want to check the rotation status.

5. Repeat steps 2-4 for all the KMS keys in your AWS account.

By following these steps, you can remediate the misconfiguration "KMS Key Rotation Should Be Enabled" for AWS using AWS CLI.

#### Using Python

To remediate KMS Key Rotation Should Be Enabled in AWS, you can use the following steps in Python:

1. Import the necessary libraries:

```
import boto3
```

2. Create a boto3 client for AWS Key Management Service:

```
kms_client = boto3.client('kms')
```

3. Get a list of all KMS keys:

```
keys = kms_client.list_keys()
```

4. Loop through each key and check if key rotation is enabled:

```
for key in keys['Keys']:
    key_id = key['KeyId']
    key_rotation_status = kms_client.get_key_rotation_status(KeyId=key_id)
    if not key_rotation_status['KeyRotationEnabled']:
        # Enable key rotation
        kms_client.enable_key_rotation(KeyId=key_id)
```

5. Save the Python script and run it to enable key rotation for all KMS keys.

Note: Make sure you have appropriate AWS credentials with required permissions to perform this operation.

### Additional Reading:

- [https://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html](https://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html) 


</Tab>
</Tabs>