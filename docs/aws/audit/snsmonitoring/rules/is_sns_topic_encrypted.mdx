---
slug: is_sns_topic_encrypted
title: SNS Topics Should Be Encrypted
sidebar_label: SNS Topics Should Be Encrypted
---

### More Info:

Server-Side Encryption (SSE) must be enabled for the SNS topics. This ensures protection of sensitive data delivered as messages to subscribers.

### Risk Level

High

### Address

Security

### Compliance Standards

HIPAA, GDPR, NIST, HITRUST


### Triage and Remediation
<Tabs>

<Tab title='Cause'>
### Check Cause
<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
1. Sign in to the AWS Management Console.
2. Navigate to the Simple Notification Service (SNS) dashboard by selecting "Services" from the top menu, then typing "SNS" in the search box and selecting "Simple Notification Service".
3. In the SNS dashboard, select "Topics" from the left-hand navigation pane. This will display a list of all the SNS topics in your AWS account.
4. For each topic, check the "Encryption" column. If the column is blank or shows "Disabled", then the SNS topic is not encrypted. If it shows "Enabled", then the topic is encrypted.
</Accordion>

<Accordion title='Using CLI'>
1. First, you need to list all the SNS topics in your AWS account. You can do this by using the following AWS CLI command:

```bash
aws sns list-topics
```

This command will return a list of all SNS topics in your AWS account.

2. Once you have the list of SNS topics, you can check the encryption status of each topic. You can do this by using the following AWS CLI command:

```bash
aws sns get-topic-attributes --topic-arn <TopicARN>
```

Replace `<TopicARN>` with the ARN of the SNS topic you want to check. This command will return the attributes of the specified SNS topic.

3. In the output of the above command, look for the `KmsMasterKeyId` attribute. If this attribute is present and has a value, it means that the SNS topic is encrypted.

4. Repeat steps 2 and 3 for each SNS topic in your AWS account. If any SNS topic does not have the `KmsMasterKeyId` attribute or if this attribute does not have a value, it means that the SNS topic is not encrypted.
</Accordion>

<Accordion title='Using Python'>
1. Install the necessary AWS SDK for Python (Boto3) if you haven't done so. You can install it using pip:
```python
pip install boto3
```

2. Import the necessary modules and create a session using your AWS credentials:
```python
import boto3

session = boto3.Session(
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    region_name='YOUR_REGION'
)
```

3. Use the SNS client from the session to get all the SNS topics:
```python
sns = session.client('sns')
response = sns.list_topics()
```

4. Iterate over the topics and check if they are encrypted. If the 'KmsMasterKeyId' key is not present in the topic attributes, the topic is not encrypted:
```python
for topic in response['Topics']:
    topic_arn = topic['TopicArn']
    topic_attributes = sns.get_topic_attributes(TopicArn=topic_arn)['Attributes']
    if 'KmsMasterKeyId' not in topic_attributes:
        print(f'Topic {topic_arn} is not encrypted.')
```
This script will print the ARNs of all unencrypted SNS topics.
</Accordion>

</AccordionGroup>
</Tab>

<Tab title='Remediation'>
### Remediation

<AccordionGroup>
<Accordion title='Using Console' defaultOpen='true'>
Sure, I can provide you with the steps to remediate the misconfiguration of unencrypted SNS topics in AWS. Here are the steps to remediate this issue:

1. Log in to your AWS console.

2. Go to the SNS service.

3. Select the SNS topic that you want to encrypt.

4. In the topic details page, click on the "Edit" button.

5. Scroll down to the "Encryption" section.

6. Select the "Enable encryption" option.

7. Choose the KMS key that you want to use for encryption. If you don't have a KMS key, you can create one by clicking on the "Create a new KMS key" button.

8. Click on the "Update" button to save the changes.

9. Verify that the SNS topic is now encrypted by checking the "Encryption" section in the topic details page.

By following these steps, you can remediate the misconfiguration of unencrypted SNS topics in AWS.

#
</Accordion>

<Accordion title='Using CLI'>
To remediate the SNS Topics should be encrypted misconfiguration for AWS using AWS CLI, follow the steps below:

1. Open the AWS CLI on your local machine.

2. Run the following command to list all the SNS topics in your AWS account:

   ```
   aws sns list-topics
   ```

3. Identify the SNS topic that needs to be encrypted.

4. Run the following command to enable server-side encryption for the identified SNS topic:

   ```
   aws sns set-topic-attributes --topic-arn <topic-arn> --attribute-name KmsMasterKeyId --attribute-value <kms-key-id>
   ```

   Replace `<topic-arn>` with the ARN of the SNS topic and `<kms-key-id>` with the ID of the KMS key that you want to use for encryption.

5. Verify that the encryption is enabled for the SNS topic by running the following command:

   ```
   aws sns get-topic-attributes --topic-arn <topic-arn>
   ```

   This command should return the attributes of the SNS topic, including the KmsMasterKeyId attribute with the value set to the KMS key ID that you specified.

6. Repeat the above steps for any other SNS topics that need to be encrypted.

7. Once you have confirmed that all SNS topics are encrypted, you can close the AWS CLI.

By following the above steps, you can remediate the SNS Topics should be encrypted misconfiguration for AWS using AWS CLI.
</Accordion>

<Accordion title='Using Python'>
To remediate the misconfiguration of SNS topics not being encrypted in AWS using Python, follow these steps:

1. Open the AWS Management Console and navigate to the SNS service.

2. Identify the SNS topic that needs to be encrypted.

3. In the topic settings, click on the "Encryption" tab.

4. Select the "Enable encryption" option.

5. Choose the KMS key that you want to use for encryption. 

6. Click on the "Update" button to save the changes.

7. To ensure that all future SNS topics are encrypted by default, you can set up a CloudFormation stack with the following code:

```yaml
Resources:
  SNSDefaultEncryption:
    Type: "AWS::SNS::Topic"
    Properties:
      KmsMasterKeyId: <your_kms_key_id>
      DisplayName: "Default Encrypted Topic"
      TopicName: "default-encrypted-topic"
      Subscription:
        - Protocol: "email"
          Endpoint: "your-email@example.com"
```

8. Deploy the CloudFormation stack to your AWS account.

9. Verify that the SNS topic is now encrypted by checking the "Encryption" tab in the topic settings.

By following these steps, you can remediate the misconfiguration of SNS topics not being encrypted in AWS using Python.
</Accordion>

</AccordionGroup>
</Tab>
</Tabs>
### Additional Reading:

- [https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html](https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html) 
- [https://docs.aws.amazon.com/sns/latest/dg/sns-enable-encryption.html](https://docs.aws.amazon.com/sns/latest/dg/sns-enable-encryption.html) 
- [https://aws.amazon.com/about-aws/whats-new/2018/11/amazon-sns-sse/](https://aws.amazon.com/about-aws/whats-new/2018/11/amazon-sns-sse/) 

