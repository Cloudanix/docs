--- 
slug: CreatePolicyVersion
eventname: CreatePolicyVersion
title: CreatePolicyVersion
sidebar_label: CreatePolicyVersion
---
                       
### Event Information

#### Meaning

- The CreatePolicyVersion event in AWS IAM refers to the action of creating a new version of an IAM policy.
- This event is triggered when a user or an automated process creates a new version of an existing IAM policy.
- Each version of an IAM policy represents a snapshot of the policy at a specific point in time and can be used to track changes and manage policy updates.

#### Example

1. Example of security impact: If an unauthorized user gains access to the AWS account and creates a new policy version using the CreatePolicyVersion event in AWS IAM, it can lead to potential security risks. The unauthorized policy version could grant excessive permissions to the user or allow them to escalate their privileges within the account.

Remediation:
- Immediately revoke the access credentials of the unauthorized user.
- Review and delete the unauthorized policy version.
- Enable AWS CloudTrail to capture all API activities and monitor for any suspicious activity.
- Regularly review IAM policies and permissions to ensure they align with the principle of least privilege.
- Implement multi-factor authentication (MFA) for all IAM users to add an extra layer of security.

AWS CLI command to delete a specific policy version:
```
aws iam delete-policy-version --policy-arn <policy-arn> --version-id <version-id>
```

2. Example of security impact: If a malicious insider modifies an existing IAM policy and creates a new policy version using the CreatePolicyVersion event, they can grant themselves additional privileges or access to sensitive resources.

Remediation:
- Regularly review and audit IAM policies for any unauthorized changes.
- Enable AWS CloudTrail to capture all API activities and monitor for any suspicious activity.
- Implement strict access controls and least privilege principles for IAM users.
- Implement AWS Config rules to detect and prevent unauthorized changes to IAM policies.
- Regularly rotate access keys and credentials for IAM users.

AWS CLI command to list all policy versions for a specific policy:
```
aws iam list-policy-versions --policy-arn <policy-arn>
```

3. Example of security impact: If a misconfiguration or vulnerability in the IAM policy creation process allows an attacker to create a malicious policy version using the CreatePolicyVersion event, they can gain unauthorized access to sensitive resources or perform privilege escalation.

Remediation:
- Implement strict validation and review processes for IAM policy creation and modification.
- Regularly scan and audit IAM policies for any misconfigurations or vulnerabilities.
- Enable AWS CloudTrail to capture all API activities and monitor for any suspicious activity.
- Implement AWS Config rules to detect and prevent unauthorized changes to IAM policies.
- Regularly review and update IAM policies to align with security best practices.

AWS CLI command to create a new policy version:
```
aws iam create-policy-version --policy-arn <policy-arn> --policy-document <policy-document> --set-as-default
```


 