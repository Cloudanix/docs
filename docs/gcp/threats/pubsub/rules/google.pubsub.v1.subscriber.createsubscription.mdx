--- 
slug: gcp_rt_pubsub_subscription_changes
eventname: google.pubsub.v1.Subscriber.CreateSubscription
title: google.pubsub.v1.Subscriber.CreateSubscription
sidebar_label: google.pubsub.v1.Subscriber.CreateSubscription
---
                       
### Event Information

- The google.pubsub.v1.Subscriber.CreateSubscription event in GCP for Pubsub indicates the creation of a new subscription within a Pubsub topic.
- This event signifies that a subscriber has been set up to receive messages from a specific topic in Pubsub.
- It is a crucial event for tracking the configuration and setup of subscriptions in Pubsub, allowing for monitoring and auditing of subscription creation activities.


### Examples

1. Unauthorized access: If the security of google.pubsub.v1.Subscriber.CreateSubscription is impacted, it could potentially allow unauthorized users to create subscriptions to Pub/Sub topics. This could lead to unauthorized access to sensitive data or the ability to receive and process messages intended for other subscribers.

2. Data leakage: A security impact could result in the creation of subscriptions with incorrect or unintended permissions. This could lead to data leakage, where sensitive information is exposed to unauthorized parties who have access to the newly created subscriptions.

3. Denial of Service (DoS): If the security of google.pubsub.v1.Subscriber.CreateSubscription is compromised, it could be exploited to create a large number of subscriptions, overwhelming the Pub/Sub service and causing a denial of service. This could disrupt the normal functioning of the system and impact the availability of the service for legitimate users.

### Remediation

#### Using Console

1. Unauthorized access:
- Review and update access controls and permissions for Pub/Sub topics and subscriptions.
- Ensure that only authorized users have the necessary permissions to create subscriptions to topics.
- Regularly monitor and audit access logs to identify any unauthorized access attempts.

2. Data leakage:
- Implement proper filtering and validation mechanisms for subscriptions to prevent receiving messages that should not be allowed.
- Use message filtering and validation features provided by Pub/Sub to ensure that only relevant and authorized messages are received.
- Regularly review and update filtering rules to adapt to changing data requirements.

3. Denial of Service (DoS) attacks:
- Implement rate limiting and quota policies to prevent excessive subscription creation.
- Monitor subscription creation activities for any suspicious patterns or anomalies.
- Implement automated monitoring and alerting systems to detect and mitigate DoS attacks in real-time.

Step-by-step instructions for GCP Pub/Sub using GCP console:
1. Access the GCP console and navigate to the Pub/Sub section.
2. Create or select the project where you want to manage Pub/Sub.
3. Create a topic by clicking on the "Create Topic" button and provide a name for the topic.
4. Once the topic is created, you can create a subscription by selecting the topic and clicking on the "Create Subscription" button.
5. Provide a name for the subscription and configure the necessary settings such as delivery type, acknowledgment deadline, and filtering options.
6. Set the appropriate access controls and permissions for the subscription to ensure authorized access.
7. Review and validate the subscription settings before finalizing the creation.
8. Repeat the steps to create additional topics and subscriptions as needed.
9. Regularly monitor and manage the topics and subscriptions to ensure proper access controls and prevent any unauthorized access or data leakage.

#### Using CLI

1. Unauthorized access:
- Review and update access controls and permissions for Pub/Sub topics and subscriptions.
- Use IAM roles and policies to restrict access to only authorized users or service accounts.
- Regularly audit and monitor access logs to identify any unauthorized access attempts.

2. Data leakage:
- Implement proper filtering and validation mechanisms for subscriptions to ensure that only relevant and authorized messages are received.
- Use message filtering options such as labels, attributes, or message content filtering to prevent data leakage.
- Regularly review and update subscription configurations to ensure they align with the intended data access requirements.

3. Denial of Service (DoS) attacks:
- Implement rate limiting and quota policies to prevent excessive subscription creation.
- Monitor subscription creation activities and set up alerts for any suspicious or abnormal patterns.
- Implement network-level protections such as firewalls or load balancers to mitigate DoS attacks targeting Pub/Sub.

CLI commands for GCP Pub/Sub:
- To create a subscription:
  ```
  gcloud pubsub subscriptions create SUBSCRIPTION_NAME --topic=TOPIC_NAME
  ```

- To update access controls and permissions for a subscription:
  ```
  gcloud pubsub subscriptions add-iam-policy-binding SUBSCRIPTION_NAME --member=MEMBER --role=ROLE
  ```

- To set up message filtering for a subscription:
  ```
  gcloud pubsub subscriptions update SUBSCRIPTION_NAME --message-filter=FILTER_EXPRESSION
  ```

Note: Replace `SUBSCRIPTION_NAME`, `TOPIC_NAME`, `MEMBER`, `ROLE`, and `FILTER_EXPRESSION` with the appropriate values for your environment.

#### Using Python

1. Unauthorized access:
- Ensure that proper access controls and permissions are implemented for Pub/Sub topics and subscriptions.
- Regularly review and update access policies to ensure that only authorized users have the necessary permissions.
- Implement multi-factor authentication (MFA) for user accounts to add an extra layer of security.

2. Data leakage:
- Implement message filtering and validation mechanisms to ensure that only relevant and authorized messages are received by subscriptions.
- Regularly review and update filtering rules to prevent any potential data leakage.
- Monitor and analyze subscription logs to identify any unauthorized access or data leakage incidents.

3. Denial of Service (DoS) attacks:
- Implement rate limiting and throttling mechanisms to prevent excessive subscription creation.
- Monitor subscription creation activities and set up alerts for any suspicious or abnormal behavior.
- Implement network-level protections, such as firewalls and intrusion detection systems, to detect and mitigate DoS attacks.

Python script example for creating a subscription in GCP Pub/Sub:

```python
from google.cloud import pubsub_v1

project_id = "your-project-id"
topic_id = "your-topic-id"
subscription_id = "your-subscription-id"

subscriber = pubsub_v1.SubscriberClient()
topic_path = subscriber.topic_path(project_id, topic_id)
subscription_path = subscriber.subscription_path(project_id, subscription_id)

subscription = subscriber.create_subscription(subscription_path, topic_path)

print(f"Subscription created: {subscription}")
```

Note: Make sure to install the `google-cloud-pubsub` library before running the script.


 