--- 
slug: gcp_rt_vpc_sslproxy_changes
eventname: v1.compute.targetSslProxies.delete
title: v1.compute.targetSslProxies.delete
sidebar_label: v1.compute.targetSslProxies.delete
---
                       
### Event Information

- The v1.compute.targetSslProxies.delete event in GCP for Compute refers to the deletion of a target SSL proxy resource.
- This event indicates that a target SSL proxy, which is responsible for terminating SSL/TLS connections for a specific target HTTPS proxy, has been deleted.
- When this event occurs, any existing SSL certificates associated with the target SSL proxy will also be removed, and the SSL termination functionality for the corresponding target HTTPS proxy will be disabled.


### Examples

1. Unauthorized deletion of target SSL proxies: If security is impacted with v1.compute.targetSslProxies.delete in GCP for Compute, it could potentially allow unauthorized individuals to delete target SSL proxies. This could lead to a loss of secure communication between clients and backend services, potentially exposing sensitive data or allowing for unauthorized access.

2. Disruption of SSL/TLS termination: Deleting target SSL proxies without proper authorization could disrupt the SSL/TLS termination process for incoming traffic. This could result in a loss of secure communication and potentially expose sensitive information to unauthorized parties.

3. Service availability and reliability: In some cases, deleting target SSL proxies without proper planning or coordination could lead to service disruptions or downtime. This can impact the availability and reliability of applications and services relying on SSL/TLS termination, potentially causing financial losses or reputational damage. It is important to carefully manage and control access to the v1.compute.targetSslProxies.delete operation to mitigate these risks and ensure the security of the environment.

### Remediation

#### Using Console

To remediate unauthorized deletion of target SSL proxies in GCP Compute using the GCP console, follow these step-by-step instructions:

1. Implement Access Controls:
   - Review and update IAM (Identity and Access Management) policies to ensure that only authorized individuals have the necessary permissions to delete target SSL proxies.
   - Grant the appropriate roles (such as Compute Instance Admin or Compute Network Admin) to trusted users who require the ability to manage SSL proxies.
   - Regularly review and audit IAM policies to remove any unnecessary or excessive permissions.

2. Enable Audit Logging:
   - Enable Cloud Audit Logs for Compute Engine API to track and monitor any changes made to target SSL proxies.
   - Configure the logs to be stored in a secure and centralized location for easy analysis and investigation.

3. Implement Monitoring and Alerting:
   - Set up Cloud Monitoring or a third-party monitoring tool to monitor the deletion of target SSL proxies.
   - Create alerts to notify the appropriate personnel whenever a deletion event is detected.
   - Configure the alerts to include relevant details such as the user, timestamp, and affected resources.

By following these steps, you can enhance the security of your GCP Compute environment and mitigate the risk of unauthorized deletion of target SSL proxies.

#### Using CLI

To remediate the unauthorized deletion of target SSL proxies in GCP Compute using GCP CLI commands, you can follow these steps:

1. Implement proper access controls: Ensure that only authorized individuals have the necessary permissions to delete target SSL proxies. This can be done by assigning appropriate IAM roles to users or service accounts.

   ```bash
   gcloud compute target-ssl-proxies set-iam-policy [TARGET_SSL_PROXY_NAME] --member=[MEMBER] --role=[ROLE]
   ```

   Replace [TARGET_SSL_PROXY_NAME] with the name of the target SSL proxy, [MEMBER] with the email address or service account of the authorized user, and [ROLE] with the desired IAM role.

2. Enable audit logging: Enable audit logging for target SSL proxies to track any deletion attempts or changes made to the SSL proxies. This will help in identifying unauthorized activities and potential security incidents.

   ```bash
   gcloud logging sinks create [SINK_NAME] storage.googleapis.com/[BUCKET_NAME] --log-filter="resource.type=gce_target_ssl_proxies"
   ```

   Replace [SINK_NAME] with the name of the logging sink and [BUCKET_NAME] with the name of the Cloud Storage bucket where the logs will be stored.

3. Regularly review access permissions: Conduct regular audits and reviews of access permissions to ensure that only authorized users have the necessary privileges. This can be done by listing the IAM policies for target SSL proxies and reviewing the assigned roles.

   ```bash
   gcloud compute target-ssl-proxies get-iam-policy [TARGET_SSL_PROXY_NAME]
   ```

   Replace [TARGET_SSL_PROXY_NAME] with the name of the target SSL proxy.

By implementing these measures, you can mitigate the risk of unauthorized deletion of target SSL proxies in GCP Compute and ensure the security, availability, and reliability of your applications and services.

#### Using Python

To remediate unauthorized deletion of target SSL proxies in GCP Compute using Python scripts, you can follow these steps:

1. Implement access controls: Ensure that only authorized individuals have the necessary permissions to delete target SSL proxies. This can be achieved by using IAM roles and policies to restrict access to the necessary users or service accounts.

```python
# Example code to set IAM policy for a target SSL proxy
from google.cloud import compute_v1

def set_ssl_proxy_iam_policy(project_id, ssl_proxy_name, member, role):
    client = compute_v1.TargetSslProxiesClient()
    ssl_proxy_path = client.target_ssl_proxy_path(project_id, ssl_proxy_name)

    policy = {
        "bindings": [
            {
                "role": role,
                "members": [member]
            }
        ]
    }

    request = compute_v1.SetIamPolicyTargetSslProxyRequest(
        resource=ssl_proxy_path,
        policy=policy
    )

    response = client.set_iam_policy(request)
    print("IAM policy set successfully")

# Usage
set_ssl_proxy_iam_policy("my-project", "my-ssl-proxy", "user:example@example.com", "roles/compute.targetSslProxies.delete")
```

2. Enable audit logging: Enable audit logging for target SSL proxies to track any deletion attempts or changes made to the SSL proxies. This can help in identifying unauthorized activities and taking appropriate actions.

```python
# Example code to enable audit logging for a target SSL proxy
from google.cloud import compute_v1

def enable_ssl_proxy_logging(project_id, ssl_proxy_name):
    client = compute_v1.TargetSslProxiesClient()
    ssl_proxy_path = client.target_ssl_proxy_path(project_id, ssl_proxy_name)

    logging_config = {
        "enable": True,
        "sample_rate": 0.5  # Optional: Set the desired sampling rate
    }

    request = compute_v1.SetSslPolicyTargetSslProxyRequest(
        target_ssl_proxy=ssl_proxy_path,
        ssl_policy_reference={"sslPolicy": "global/sslPolicies/default"},
        ssl_proxy_resource={"sslLogConfig": logging_config}
    )

    response = client.set_ssl_policy(request)
    print("Audit logging enabled successfully")

# Usage
enable_ssl_proxy_logging("my-project", "my-ssl-proxy")
```

3. Implement monitoring and alerting: Set up monitoring and alerting mechanisms to detect any unusual or unauthorized activities related to target SSL proxies. This can be done using cloud monitoring tools like Stackdriver or by implementing custom monitoring scripts.

```python
# Example code to monitor target SSL proxy deletion events
from google.cloud import logging_v2

def monitor_ssl_proxy_deletion(project_id, filter_expression):
    client = logging_v2.LoggingServiceV2Client()
    parent = client.project_path(project_id)

    response = client.list_log_entries(
        request={"resource_names": [parent], "filter": filter_expression}
    )

    for entry in response:
        # Process the log entry and trigger an alert if unauthorized deletion is detected
        print(entry)

# Usage
monitor_ssl_proxy_deletion("my-project", 'resource.type="gce_target_ssl_proxy" AND protoPayload.methodName="v1.compute.targetSslProxies.delete"')
```

By implementing these measures, you can mitigate the risk of unauthorized deletion of target SSL proxies in GCP Compute and ensure the security and availability of your applications and services.


 