--- 
slug: gcp_rt_spanner_database_changes
eventname: google.spanner.admin.database.v1.DatabaseAdmin.CreateDatabase
title: google.spanner.admin.database.v1.DatabaseAdmin.CreateDatabase
sidebar_label: google.spanner.admin.database.v1.DatabaseAdmin.CreateDatabase
---
                       
### Event Information

- The google.spanner.admin.database.v1.DatabaseAdmin.CreateDatabase event in GCP for CloudSpanner signifies the creation of a new database within the CloudSpanner service.
- This event indicates that a user or application has initiated the process of creating a new database in CloudSpanner.
- The event provides information about the database name, instance name, and other relevant details required for creating and configuring the database.


### Examples

1. Inadequate access controls: If security is impacted with the `google.spanner.admin.database.v1.DatabaseAdmin.CreateDatabase` operation in GCP CloudSpanner, it could be due to inadequate access controls. For example, if the operation is being performed by a user or service account with overly permissive IAM roles, it could result in unauthorized creation of databases or granting excessive privileges to the created databases.

2. Weak encryption settings: Another potential security impact could be related to weak encryption settings during the creation of a database using the `google.spanner.admin.database.v1.DatabaseAdmin.CreateDatabase` operation. If the encryption settings are not properly configured, it could lead to data exposure or unauthorized access to sensitive information stored in the database.

3. Lack of network security controls: The `google.spanner.admin.database.v1.DatabaseAdmin.CreateDatabase` operation may also impact security if there are insufficient network security controls in place. For instance, if the database is created without proper firewall rules or network access restrictions, it could expose the database to unauthorized network traffic or potential attacks from external sources.

### Remediation

#### Using Console

To remediate inadequate access controls, weak encryption settings, and lack of network security controls in GCP CloudSpanner using the GCP console, you can follow these step-by-step instructions:

1. Inadequate Access Controls:
   - Identify the user or service account that is performing the `google.spanner.admin.database.v1.DatabaseAdmin.CreateDatabase` operation.
   - Review the IAM roles assigned to the user or service account.
   - Remove any overly permissive IAM roles that grant unnecessary privileges.
   - Assign the user or service account with the minimum required IAM roles to perform the operation.

2. Weak Encryption Settings:
   - Access the GCP CloudSpanner console.
   - Navigate to the database creation page.
   - Ensure that the encryption settings are properly configured.
   - Enable encryption at rest using customer-managed keys or Google-managed keys.
   - Configure appropriate key rotation and key management practices.

3. Lack of Network Security Controls:
   - Access the GCP CloudSpanner console.
   - Navigate to the database creation page.
   - Configure firewall rules to restrict network access to the database.
   - Define appropriate IP ranges or CIDR blocks that are allowed to access the database.
   - Consider enabling VPC Service Controls to further secure the database from unauthorized network traffic.

By following these steps, you can remediate inadequate access controls, weak encryption settings, and lack of network security controls in GCP CloudSpanner using the GCP console.

#### Using CLI

1. Inadequate access controls: To remediate inadequate access controls for the `google.spanner.admin.database.v1.DatabaseAdmin.CreateDatabase` operation in GCP CloudSpanner, follow these steps:

- Review and update IAM roles: Identify the user or service account performing the operation and ensure that it has the appropriate IAM roles assigned. Remove any overly permissive roles and grant only the necessary permissions for database creation.

- Implement least privilege principle: Apply the principle of least privilege by granting only the minimum required permissions to create databases. Avoid granting excessive privileges that could lead to unauthorized creation or access to databases.

- Regularly audit access controls: Conduct regular audits to review and validate the access controls in place. This helps identify any misconfigurations or unauthorized access and allows for timely remediation.

2. Weak encryption settings: To address weak encryption settings during the creation of a database using the `google.spanner.admin.database.v1.DatabaseAdmin.CreateDatabase` operation, consider the following steps:

- Enable encryption at rest: Ensure that encryption at rest is enabled for the database. This can be achieved by specifying the appropriate encryption key or using the default encryption settings provided by GCP CloudSpanner.

- Use strong encryption algorithms: Configure the database to use strong encryption algorithms, such as AES-256, to protect the data stored within it. Avoid using weak or outdated encryption algorithms that may be susceptible to attacks.

- Regularly review and update encryption settings: Periodically review and update the encryption settings to align with industry best practices and any changes in encryption standards. Stay informed about any security updates or recommendations provided by GCP CloudSpanner.

3. Lack of network security controls: To mitigate the impact of inadequate network security controls for the `google.spanner.admin.database.v1.DatabaseAdmin.CreateDatabase` operation, consider the following actions:

- Configure firewall rules: Implement firewall rules to restrict network access to the database. Only allow connections from trusted sources or specific IP ranges that require access to the database.

- Utilize VPC Service Controls: Consider using VPC Service Controls to create a secure perimeter around the database. This helps prevent unauthorized access from external networks and provides additional security controls.

- Regularly monitor network traffic: Implement monitoring and logging mechanisms to track network traffic to the database. This allows for the detection of any suspicious or unauthorized activity and enables timely response and remediation.

CLI commands for GCP CloudSpanner:

1. Review and update IAM roles:
```
gcloud projects add-iam-policy-binding [PROJECT_ID] --member=[MEMBER] --role=[ROLE]
```

2. Enable encryption at rest:
```
gcloud spanner databases update [DATABASE_ID] --encryption-key=[ENCRYPTION_KEY]
```

3. Configure firewall rules:
```
gcloud compute firewall-rules create [FIREWALL_RULE_NAME] --allow=[ALLOWED_PROTOCOLS/PORTS] --source-ranges=[SOURCE_IP_RANGES] --target-tags=[TARGET_TAGS]
```

#### Using Python

To remediate the security issues mentioned in GCP CloudSpanner, you can follow these steps using Python scripts:

1. Inadequate access controls:
   - Review and update the IAM roles assigned to the user or service account performing the `google.spanner.admin.database.v1.DatabaseAdmin.CreateDatabase` operation.
   - Use the Google Cloud IAM API to programmatically manage IAM roles and permissions.
   - Restrict the roles to only those necessary for the operation, avoiding overly permissive roles.
   - Here's an example Python script to update IAM roles for a service account:
     ```python
     from google.cloud import iam

     client = iam.IAMClient()
     service_account = 'projects/{project_id}/serviceAccounts/{service_account_email}'
     role = 'roles/{role_name}'

     # Remove existing roles
     client.delete_service_account_iam_policy(service_account=service_account)

     # Add specific roles
     client.set_service_account_iam_policy(
         service_account=service_account,
         policy={
             'bindings': [
                 {
                     'role': role,
                     'members': [
                         'user:{user_email}',
                         'serviceAccount:{service_account_email}'
                     ]
                 }
             ]
         }
     )
     ```

2. Weak encryption settings:
   - Ensure that the encryption settings are properly configured during the creation of the database.
   - Use the appropriate encryption keys and algorithms supported by GCP CloudSpanner.
   - Here's an example Python script to create a database with encryption settings:
     ```python
     from google.cloud import spanner_admin_database_v1

     client = spanner_admin_database_v1.DatabaseAdminClient()
     instance = 'projects/{project_id}/instances/{instance_id}'
     database = 'projects/{project_id}/instances/{instance_id}/databases/{database_id}'
     encryption_config = {
         'kms_key_name': 'projects/{project_id}/locations/{location}/keyRings/{key_ring}/cryptoKeys/{crypto_key}'
     }

     operation = client.create_database(
         parent=instance,
         create_statement=database,
         encryption_config=encryption_config
     )

     result = operation.result()
     ```

3. Lack of network security controls:
   - Configure appropriate firewall rules and network access restrictions for the database.
   - Utilize VPC Service Controls or Cloud Armor to add additional layers of network security.
   - Here's an example Python script to create a database with firewall rules:
     ```python
     from google.cloud import spanner_admin_database_v1

     client = spanner_admin_database_v1.DatabaseAdminClient()
     instance = 'projects/{project_id}/instances/{instance_id}'
     database = 'projects/{project_id}/instances/{instance_id}/databases/{database_id}'
     firewall_rule = {
         'name': 'allow-internal-access',
         'allow_all': False,
         'source_range': '10.0.0.0/8'
     }

     operation = client.create_database(
         parent=instance,
         create_statement=database,
         extra_statements=[f'CREATE FIREWALL RULE {firewall_rule}']
     )

     result = operation.result()
     ```

Note: Replace the placeholders `{project_id}`, `{instance_id}`, `{database_id}`, `{user_email}`, `{service_account_email}`, `{role_name}`, `{location}`, `{key_ring}`, `{crypto_key}`, and `10.0.0.0/8` with the appropriate values for your environment.


 