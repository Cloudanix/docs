--- 
slug: gcp_rt_bigtable_instance_table_changes
eventname: google.bigtable.admin.v2.BigtableTableAdmin.CreateTable
title: google.bigtable.admin.v2.BigtableTableAdmin.CreateTable
sidebar_label: google.bigtable.admin.v2.BigtableTableAdmin.CreateTable
---
                       
### Event Information

- The google.bigtable.admin.v2.BigtableTableAdmin.CreateTable event in GCP for Bigtable indicates the creation of a new table in the Bigtable database.
- This event signifies that a user or application has initiated the process of creating a new table within the Bigtable instance.
- The event provides information about the table name, schema, and any additional configuration parameters specified during the creation process.


### Examples

1. Unauthorized access: If security is impacted with google.bigtable.admin.v2.BigtableTableAdmin.CreateTable in GCP for Bigtable, it could mean that unauthorized users or entities are able to create new tables in the Bigtable instance. This can lead to potential data breaches or unauthorized access to sensitive information stored in the tables.

2. Data leakage: Another security impact could be the potential for data leakage. If unauthorized users are able to create tables in the Bigtable instance, they may also have the ability to insert, update, or delete data within those tables. This can result in the exposure of sensitive data to unauthorized parties, leading to potential compliance violations and reputational damage.

3. Resource exhaustion: The creation of tables in Bigtable requires system resources, such as storage and processing power. If security is impacted and unauthorized users are able to create a large number of tables, it can lead to resource exhaustion. This can result in performance degradation or even service disruption for legitimate users, impacting the availability and reliability of the Bigtable service.

### Remediation

#### Using Console

1. Enable VPC Service Controls:
   - Go to the GCP Console and navigate to the VPC Service Controls page.
   - Click on "Create Perimeter" and provide a name for the perimeter.
   - Select the project where your Bigtable instance is located.
   - Choose the desired VPC network and subnet for the perimeter.
   - Click on "Create" to create the perimeter.
   - Once the perimeter is created, click on "Add Access Level" to define the access level for Bigtable.
   - Select the Bigtable API and choose the desired access level.
   - Click on "Add Access Level" to save the access level.
   - Finally, click on "Attach" to attach the perimeter to the project.

2. Enable VPC Service Controls for Bigtable API:
   - Go to the GCP Console and navigate to the VPC Service Controls page.
   - Click on "Create Perimeter" and provide a name for the perimeter.
   - Select the project where your Bigtable instance is located.
   - Choose the desired VPC network and subnet for the perimeter.
   - Click on "Create" to create the perimeter.
   - Once the perimeter is created, click on "Add Access Level" to define the access level for Bigtable.
   - Select the Bigtable API and choose the desired access level.
   - Click on "Add Access Level" to save the access level.
   - Finally, click on "Attach" to attach the perimeter to the project.

3. Enable Private IP for Bigtable instances:
   - Go to the GCP Console and navigate to the Bigtable instances page.
   - Select the desired Bigtable instance.
   - Click on "Edit" to edit the instance settings.
   - Under the "Network" section, select "Private IP" as the network type.
   - Choose the desired VPC network and subnet for the instance.
   - Click on "Save" to save the changes.
   - Once the changes are saved, the Bigtable instance will be accessible only through the private IP within the specified VPC network.

#### Using CLI

To remediate the issues mentioned in the previous response for GCP Bigtable using GCP CLI, you can follow these steps:

1. Enable audit logging for GCP Bigtable:
   - Use the following command to enable audit logging for Bigtable:
     ```
     gcloud logging sinks create [SINK_NAME] bigtable.googleapis.com/projects/[PROJECT_ID]/instances/[INSTANCE_ID] --log-filter='resource.type="bigtable_instance"'
     ```
   - Replace `[SINK_NAME]` with a name for the sink, `[PROJECT_ID]` with your GCP project ID, and `[INSTANCE_ID]` with the ID of your Bigtable instance.

2. Implement VPC Service Controls for Bigtable:
   - Create a VPC Service Controls perimeter for Bigtable using the following command:
     ```
     gcloud access-context-manager perimeters create [PERIMETER_NAME] --resources=bigtable.googleapis.com/projects/[PROJECT_ID]/instances/[INSTANCE_ID] --restricted-services=bigtable.googleapis.com
     ```
   - Replace `[PERIMETER_NAME]` with a name for the perimeter.

3. Enable encryption at rest for Bigtable:
   - Use the following command to enable encryption at rest for Bigtable:
     ```
     gcloud beta bigtable instances update [INSTANCE_ID] --cluster=[CLUSTER_ID] --encryption-at-rest-state=ENABLED
     ```
   - Replace `[INSTANCE_ID]` with the ID of your Bigtable instance and `[CLUSTER_ID]` with the ID of your Bigtable cluster.

Note: Make sure to authenticate with the appropriate GCP credentials before running these commands.

#### Using Python

To remediate the issues mentioned in the previous response for GCP Bigtable using Python, you can follow these steps:

1. Enable VPC Service Controls:
   - Use the `google-cloud-securitycenter` library to enable VPC Service Controls for your Bigtable instance.
   - Here's an example Python script to enable VPC Service Controls for Bigtable:

   ```python
   from google.cloud import securitycenter

   client = securitycenter.SecurityCenterClient()

   # Set the project ID and Bigtable instance ID
   project_id = 'your-project-id'
   instance_id = 'your-bigtable-instance-id'

   # Enable VPC Service Controls for Bigtable
   response = client.update_service_account(
       name=f'projects/{project_id}/locations/global/services/bigtable.googleapis.com',
       service_account='your-service-account-email',
       project=project_id,
       instance=instance_id
   )

   print('VPC Service Controls enabled for Bigtable')
   ```

2. Implement IAM Roles and Permissions:
   - Use the `google-cloud-iam` library to implement IAM roles and permissions for your Bigtable instance.
   - Here's an example Python script to grant a user the `roles/bigtable.reader` role for Bigtable:

   ```python
   from google.cloud import iam

   client = iam.IAMClient()

   # Set the project ID and Bigtable instance ID
   project_id = 'your-project-id'
   instance_id = 'your-bigtable-instance-id'

   # Grant the user the roles/bigtable.reader role for Bigtable
   response = client.set_iam_policy(
       resource=f'projects/{project_id}/instances/{instance_id}',
       policy={
           'bindings': [
               {
                   'role': 'roles/bigtable.reader',
                   'members': ['user:your-user-email']
               }
           ]
       }
   )

   print('IAM roles and permissions implemented for Bigtable')
   ```

3. Enable Audit Logging:
   - Use the `google-cloud-logging` library to enable audit logging for your Bigtable instance.
   - Here's an example Python script to enable audit logging for Bigtable:

   ```python
   from google.cloud import logging_v2

   client = logging_v2.LoggingServiceV2Client()

   # Set the project ID and Bigtable instance ID
   project_id = 'your-project-id'
   instance_id = 'your-bigtable-instance-id'

   # Enable audit logging for Bigtable
   response = client.update_sink(
       sink_name=f'projects/{project_id}/sinks/bigtable-audit-logs',
       sink={
           'name': f'projects/{project_id}/sinks/bigtable-audit-logs',
           'destination': f'bigtable.googleapis.com/projects/{project_id}/instances/{instance_id}',
           'filter': 'logName:"logs/cloudaudit.googleapis.com%2Factivity"',
           'output_version_format': 'V2'
       }
   )

   print('Audit logging enabled for Bigtable')
   ```

Please note that you need to replace the placeholders (`your-project-id`, `your-bigtable-instance-id`, `your-service-account-email`, and `your-user-email`) with the actual values specific to your GCP environment.


 