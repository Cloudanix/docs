--- 
slug: gcp_rt_cloudrun_domainmappings_change
eventname: google.cloud.run.v1.Jobs.CreateDomainMapping
title: google.cloud.run.v1.Jobs.CreateDomainMapping
sidebar_label: google.cloud.run.v1.Jobs.CreateDomainMapping
---
                       
### Event Information

#### Meaning

- The google.cloud.run.v1.Jobs.CreateDomainMapping event in GCP for CloudRun signifies the creation of a domain mapping for a Cloud Run service.
- This event indicates that a user has configured a custom domain to be associated with their Cloud Run service.
- The event provides information about the domain name, the Cloud Run service, and any additional settings or configurations applied during the domain mapping creation process.

### Remediation

#### Using Console

- Example of security impact: If security is impacted with `google.cloud.run.v1.Jobs.CreateDomainMapping` in GCP for CloudRun, it could potentially allow unauthorized users to create domain mappings for CloudRun services. This could lead to unauthorized access or misuse of the services.

- Remediation steps using GCP console:
  1. Access the GCP console and navigate to the CloudRun service.
  2. Select the specific CloudRun service that needs to be secured.
  3. In the service details page, click on the "Permissions" tab.
  4. Review the existing permissions and ensure that the `google.cloud.run.v1.Jobs.CreateDomainMapping` permission is only granted to authorized users or service accounts.
  5. Remove the permission from any unauthorized users or service accounts by clicking on the "Edit" button next to the permission.
  6. Save the changes and verify that only authorized users or service accounts have the necessary permissions to create domain mappings for the CloudRun service.

Note: It is important to regularly review and manage permissions to ensure that only authorized entities have access to perform critical operations like creating domain mappings.

#### Using CLI

- Example of security impact: If the `google.cloud.run.v1.Jobs.CreateDomainMapping` permission is granted to a user or service account in GCP CloudRun, it allows them to create domain mappings for CloudRun services. This can potentially lead to unauthorized access or misuse of the CloudRun service by mapping it to a malicious domain.

- Remediation steps using GCP CLI:
  1. Identify the user or service account that has been granted the `google.cloud.run.v1.Jobs.CreateDomainMapping` permission.
  2. Revoke the permission from the user or service account using the following GCP CLI command:
     ```
     gcloud projects remove-iam-policy-binding [PROJECT_ID] --member=[MEMBER] --role=roles/run.admin
     ```
     Replace `[PROJECT_ID]` with the ID of your GCP project and `[MEMBER]` with the email address or service account ID of the user or service account.
  3. Verify that the permission has been successfully revoked by checking the IAM policy for the project using the following GCP CLI command:
     ```
     gcloud projects get-iam-policy [PROJECT_ID]
     ```
     Replace `[PROJECT_ID]` with the ID of your GCP project. Ensure that the user or service account no longer has the `roles/run.admin` role assigned to them.

#### Using Python

Example of security impact: If the `google.cloud.run.v1.Jobs.CreateDomainMapping` permission is granted to a user or service account in GCP CloudRun, it allows them to create domain mappings for Cloud Run services. This can potentially lead to unauthorized access or misuse of the Cloud Run service.

Remediation steps for GCP CloudRun using Python:
1. Review IAM permissions: Ensure that only trusted users or service accounts have the `google.cloud.run.v1.Jobs.CreateDomainMapping` permission. Remove this permission from any accounts that do not require it.
2. Implement least privilege: Grant the minimum necessary permissions to perform specific tasks. For example, if a user or service account only needs to deploy Cloud Run services, grant them the `roles/run.admin` role instead of the broader `roles/run.developer` role.
3. Continuous monitoring: Regularly review and audit the IAM permissions assigned to users and service accounts. Implement automated monitoring and alerting to detect any unauthorized changes to permissions.

Python script to revoke `google.cloud.run.v1.Jobs.CreateDomainMapping` permission using the `google-cloud-iam` library:

```python
from google.cloud import iam_v1

def revoke_domain_mapping_permission(project_id, service_account_email):
    client = iam_v1.IAMClient()

    # Construct the resource name for the service account
    service_account_name = f"projects/{project_id}/serviceAccounts/{service_account_email}"

    # Construct the permission name
    permission_name = "google.cloud.run.v1.Jobs.CreateDomainMapping"

    # Revoke the permission from the service account
    policy = client.get_iam_policy(request={"resource": service_account_name})
    for binding in policy.bindings:
        if binding.role == "roles/run.admin":
            binding.members.remove(service_account_name)
            break

    # Update the IAM policy
    client.set_iam_policy(
        request={"resource": service_account_name, "policy": policy}
    )

# Usage example
revoke_domain_mapping_permission("my-project-id", "my-service-account@my-project-id.iam.gserviceaccount.com")
```

Note: Replace `"my-project-id"` with your actual GCP project ID and `"my-service-account@my-project-id.iam.gserviceaccount.com"` with the email of the service account that needs the permission revoked.


 