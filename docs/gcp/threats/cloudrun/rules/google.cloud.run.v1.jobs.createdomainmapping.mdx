--- 
slug: gcp_rt_cloudrun_domainmappings_change
eventname: google.cloud.run.v1.Jobs.CreateDomainMapping
title: google.cloud.run.v1.Jobs.CreateDomainMapping
sidebar_label: google.cloud.run.v1.Jobs.CreateDomainMapping
---
                       
### Event Information

- The google.cloud.run.v1.Jobs.CreateDomainMapping event in GCP for CloudRun signifies the creation of a domain mapping for a Cloud Run service.
- This event indicates that a custom domain has been configured to point to a specific Cloud Run service, allowing users to access the service using a custom domain name.
- The event provides information about the domain mapping, such as the domain name, the associated Cloud Run service, and any additional configuration settings applied during the mapping creation process.


### Examples

1. Inadequate access controls: If security is impacted with google.cloud.run.v1.Jobs.CreateDomainMapping in GCP for CloudRun, it could be due to inadequate access controls. For example, if the user or service account performing the operation has overly permissive IAM roles or permissions, it could lead to unauthorized domain mapping creation or modification, potentially exposing sensitive data or allowing unauthorized access to the application.

2. Lack of encryption: Another security impact could be the lack of encryption during the domain mapping creation process. If the communication between the client and the CloudRun service is not encrypted using protocols like HTTPS, it could result in the exposure of sensitive information, such as authentication tokens or user credentials, during the domain mapping creation process.

3. DNS hijacking or spoofing: A potential security impact could be DNS hijacking or spoofing. If an attacker gains unauthorized access to the DNS configuration or manipulates the DNS records, they could redirect the domain mapping to a malicious server, leading to potential data breaches, phishing attacks, or unauthorized access to the CloudRun application.

To mitigate these security impacts, it is important to ensure proper access controls are in place, enforce encryption for communication, and regularly monitor and secure DNS configurations to prevent unauthorized modifications.

### Remediation

#### Using Console

1. Inadequate access controls:
- Review and update IAM roles and permissions for the user or service account performing the domain mapping operation in GCP.
- Ensure that the user or service account has the necessary roles and permissions to create and modify domain mappings, but not overly permissive ones.
- Regularly audit and monitor IAM roles and permissions to identify and address any potential security risks.

2. Lack of encryption:
- Enable HTTPS for the communication between the client and the CloudRun service during the domain mapping creation process.
- Configure SSL certificates for the domain mapping to ensure secure and encrypted communication.
- Regularly monitor and update SSL certificates to maintain the security of the domain mapping operation.

3. Domain hijacking:
- Implement strong authentication mechanisms, such as multi-factor authentication, for the domain mapping creation process.
- Regularly review and update DNS settings to prevent unauthorized changes or compromises.
- Stay updated with security best practices and patches to mitigate vulnerabilities that could be exploited for domain hijacking.

#### Using CLI

1. Inadequate access controls: To remediate inadequate access controls for domain mapping in GCP CloudRun, follow these steps:

- Review and update IAM roles and permissions: Identify the user or service account performing the operation and ensure they have the least privilege necessary to create or modify domain mappings. Remove any overly permissive roles or permissions that could lead to unauthorized access.

- Implement IAM best practices: Follow GCP's recommended IAM best practices, such as using custom roles, regularly reviewing and auditing IAM policies, and enabling multi-factor authentication (MFA) for privileged accounts.

- Enable audit logging and monitoring: Enable Cloud Audit Logs to track and monitor domain mapping creation activities. Set up alerts or notifications for any suspicious or unauthorized actions.

2. Lack of encryption: To remediate the lack of encryption during domain mapping creation in GCP CloudRun, consider the following steps:

- Use HTTPS for communication: Ensure that the client communicates with the CloudRun service using HTTPS instead of HTTP. This can be achieved by configuring SSL certificates and enabling HTTPS endpoints for your CloudRun service.

- Implement SSL/TLS encryption: Configure SSL/TLS certificates for your custom domains to encrypt the traffic between the client and the CloudRun service. You can use managed SSL certificates provided by GCP or bring your own certificates.

- Regularly update and renew certificates: Keep track of certificate expiration dates and renew them in a timely manner to maintain secure communication.

3. Domain hijacking: To mitigate the risk of domain hijacking during domain mapping creation in GCP CloudRun, consider the following measures:

- Strengthen DNS security: Implement DNS security measures such as DNSSEC (Domain Name System Security Extensions) to protect against DNS spoofing and tampering. Regularly monitor DNS settings for any unauthorized changes.

- Enable domain ownership verification: Implement domain ownership verification mechanisms, such as DNS TXT records or HTML file uploads, to ensure that only authorized individuals can create or modify domain mappings.

- Regularly review and update domain mapping configurations: Periodically review and validate the domain mapping configurations to ensure they are accurate and not pointing to malicious destinations. Monitor for any unauthorized changes to domain mappings.

CLI commands:
- To review IAM roles and permissions: `gcloud iam roles describe [ROLE_ID]`
- To update IAM roles and permissions: `gcloud projects add-iam-policy-binding [PROJECT_ID] --member=[MEMBER] --role=[ROLE_ID]`
- To enable Cloud Audit Logs: `gcloud projects add-iam-policy-binding [PROJECT_ID] --member=[MEMBER] --role=roles/cloudauditlog.viewer`
- To configure SSL/TLS certificates: `gcloud beta run domain-mappings create [DOMAIN_MAPPING_NAME] --certificate-management=managed`
- To enable DNSSEC: `gcloud dns managed-zones update [ZONE_NAME] --dnssec-state=on`
- To verify domain ownership using DNS TXT records: `gcloud beta run domain-mappings describe [DOMAIN_MAPPING_NAME] --format="value(status.conditions[?type=='OwnershipVerified'].message)"`
- To validate domain mapping configurations: `gcloud beta run domain-mappings describe [DOMAIN_MAPPING_NAME]`

#### Using Python

To remediate the security issues related to inadequate access controls, lack of encryption, and domain hijacking in GCP CloudRun using Python scripts, you can follow these steps:

1. Inadequate access controls:
   - Review and update the IAM roles and permissions assigned to the user or service account performing the domain mapping operation.
   - Use the principle of least privilege and assign only the necessary roles and permissions required for the operation.
   - Regularly audit and monitor the IAM configurations to ensure they align with the security requirements.

2. Lack of encryption:
   - Modify your Python script to ensure that the communication between the client and the CloudRun service is encrypted using HTTPS.
   - Utilize the appropriate libraries or frameworks in Python that support secure communication, such as the `requests` library with SSL/TLS enabled.
   - Verify that the SSL/TLS certificates used for encryption are valid and up to date.

3. Domain hijacking:
   - Implement strong authentication mechanisms, such as multi-factor authentication (MFA), for the users or service accounts involved in the domain mapping process.
   - Regularly monitor and review the DNS settings to detect any unauthorized changes or suspicious activities.
   - Stay updated with security patches and best practices provided by GCP to mitigate vulnerabilities that could be exploited for domain hijacking.

Please note that the provided steps are general guidelines, and you may need to adapt them based on your specific requirements and the structure of your Python scripts.


 