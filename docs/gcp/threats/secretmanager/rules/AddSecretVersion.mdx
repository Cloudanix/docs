--- 
slug: gcp_rt_secretmanager_add_secret_version
eventname: google.cloud.secretmanager.v1.SecretManagerService.AddSecretVersion
title: AddSecretVersion
sidebar_label: google.cloud.secretmanager.v1.SecretManagerService.AddSecretVersion
---
                       
### Event Information

#### Meaning

- The google.cloud.secretmanager.v1.SecretManagerService.AddSecretVersion event in gcprealtime for SecretManager indicates that a new version of a secret has been added to the Secret Manager service in Google Cloud Platform (GCP).
- This event signifies that a new version of a secret has been created, which can be used to securely store sensitive information such as API keys, passwords, or certificates.
- The event provides real-time visibility into the addition of secret versions, allowing users to track and monitor changes to their secrets and ensure proper access controls and security measures are in place.

#### Example

1. Example of security impact: If the event "google.cloud.secretmanager.v1.SecretManagerService.AddSecretVersion" in GCP Realtime for SecretManager is compromised, it could potentially allow unauthorized access to sensitive secrets. For example, if an attacker gains access to the event and is able to add a new secret version, they could potentially retrieve and misuse sensitive information stored in the secret.

Remediation:
- Regularly monitor and review the SecretManager audit logs to detect any unauthorized access or suspicious activity.
- Implement strict access controls and permissions for SecretManager, ensuring that only authorized individuals or services have the necessary privileges to manage secrets.
- Enable SecretManager's built-in encryption at rest and in transit to protect the confidentiality and integrity of the stored secrets.

Example CLI command to enable encryption at rest for SecretManager:
```
gcloud secrets update [SECRET_NAME] --replication-policy automatic --locations [LOCATION] --add-iam-policy-binding [SERVICE_ACCOUNT] --member serviceAccount:[SERVICE_ACCOUNT] --role roles/secretmanager.secretAccessor
```

2. Example of security impact: If the event "google.cloud.secretmanager.v1.SecretManagerService.AddSecretVersion" is triggered by an unauthorized entity or service, it could lead to the introduction of malicious secrets into the SecretManager. These malicious secrets could be used to compromise the security of other systems or applications that rely on the secrets.

Remediation:
- Implement strong authentication mechanisms, such as multi-factor authentication (MFA), for accessing and managing SecretManager.
- Regularly rotate secrets and revoke access for any compromised or unused secrets.
- Enable SecretManager's versioning feature to track and manage changes to secrets, allowing for easy rollback in case of unauthorized modifications.

Example CLI command to enable versioning for SecretManager:
```
gcloud secrets versions enable [SECRET_NAME]
```

3. Example of security impact: If the event "google.cloud.secretmanager.v1.SecretManagerService.AddSecretVersion" is triggered by a misconfigured or vulnerable application, it could inadvertently expose sensitive secrets to unauthorized parties. For example, if an application mistakenly adds a secret version with overly permissive access controls, it could allow unintended access to the secret.

Remediation:
- Implement secure coding practices and conduct regular security reviews of applications that interact with SecretManager to ensure proper handling of secrets.
- Enforce least privilege access controls for applications accessing SecretManager, granting only the necessary permissions required for their functionality.
- Regularly audit and review the access controls and permissions assigned to secrets in SecretManager to identify and rectify any misconfigurations.

Example CLI command to update access controls for a secret in SecretManager:
```
gcloud secrets add-iam-policy-binding [SECRET_NAME] --member [MEMBER] --role [ROLE]
```


 