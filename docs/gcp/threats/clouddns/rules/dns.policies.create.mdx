--- 
slug: gcp_rt_clouddns_policies_changes
eventname: dns.policies.create
title: dns.policies.create
sidebar_label: dns.policies.create
---
                       
### Event Information

#### Meaning

1. The dns.policies.create event in GCP for CloudDNS indicates that a new DNS policy has been created in the Cloud DNS service.
2. This event signifies that a user or an automated process has defined a new policy to control how DNS queries are resolved within the Cloud DNS service.
3. The dns.policies.create event is important for tracking and auditing purposes, as it allows administrators to monitor the creation of DNS policies and ensure that the appropriate policies are in place for their DNS infrastructure.

### Remediation

#### Using Console

- Example: If security is impacted with dns.policies.create in GCP for CloudDNS, it means that an unauthorized user or service account has the ability to create DNS policies in the Cloud DNS service. This can potentially lead to unauthorized changes in DNS configurations, which can result in service disruptions or DNS hijacking.

- Remediation steps using GCP console:
  1. Identify the unauthorized user or service account: Review the IAM (Identity and Access Management) roles and permissions assigned to users and service accounts in your GCP project. Look for any accounts with the dns.policies.create permission that should not have it.
  2. Remove the unauthorized permission: To remediate this issue, you need to remove the dns.policies.create permission from the unauthorized user or service account. 
     - Go to the GCP Console (https://console.cloud.google.com) and navigate to the IAM & Admin section.
     - Find the user or service account with the unauthorized permission and click on it.
     - In the Permissions tab, locate the dns.policies.create permission and click on the trash bin icon to remove it.
  3. Review and monitor permissions: Regularly review and monitor the IAM roles and permissions assigned to users and service accounts in your GCP project to ensure that only authorized entities have the necessary access. Consider implementing least privilege principles to limit the permissions granted to each account.

Note: It is recommended to follow the principle of least privilege and regularly review and audit permissions to ensure the security of your GCP CloudDNS configuration.

#### Using CLI

- Example: If security is impacted with `dns.policies.create` in GCP for CloudDNS, it means that an unauthorized user or service account has the ability to create DNS policies in CloudDNS. This can lead to potential security risks such as unauthorized changes to DNS configurations or DNS hijacking.

- Remediation steps for GCP CloudDNS using GCP CLI:
  1. Identify the unauthorized user or service account that has the `dns.policies.create` permission. This can be done by reviewing the IAM roles and permissions assigned to users and service accounts.
  2. Revoke the `dns.policies.create` permission from the unauthorized user or service account using the following GCP CLI command:
     ```
     gcloud projects remove-iam-policy-binding [PROJECT_ID] --member=[MEMBER] --role=roles/dns.policies.create
     ```
     Replace `[PROJECT_ID]` with the ID of your GCP project and `[MEMBER]` with the email address or service account ID of the unauthorized user or service account.
  3. Regularly monitor and review IAM roles and permissions to ensure that only authorized users and service accounts have the necessary permissions for managing CloudDNS resources.

Note: The above steps assume that you have the necessary permissions to manage IAM roles and permissions in your GCP project.

#### Using Python

- Example of security impact: If the `dns.policies.create` permission is misconfigured or granted to unauthorized users in GCP for CloudDNS, it can lead to potential security risks. An attacker with this permission could create malicious DNS policies, which may result in DNS hijacking, DNS spoofing, or unauthorized DNS changes.

- Remediation steps for GCP CloudDNS using Python:
  1. Review IAM permissions: Ensure that the `dns.policies.create` permission is only granted to authorized users or service accounts who require it. Regularly review and audit IAM permissions to identify and revoke any unnecessary or excessive access.
  
  2. Implement least privilege principle: Follow the principle of least privilege by granting only the necessary permissions to perform specific tasks. Avoid granting broad permissions like `dns.policies.create` unless absolutely required.
  
  3. Enable Cloud Audit Logging: Enable Cloud Audit Logging for CloudDNS to capture and monitor any changes made to DNS policies. This will help in detecting any unauthorized creation of policies and provide an audit trail for investigation.
  
  Python script to check and revoke `dns.policies.create` permission for a user or service account:
  ```python
  from google.cloud import iam

  def revoke_dns_create_policy_permission(project_id, member):
      client = iam.IAMClient()
      policy = client.get_policy(request={"resource": f"projects/{project_id}"})
      
      for binding in policy.bindings:
          if binding.role == "roles/dns.policies.create" and member in binding.members:
              binding.members.remove(member)
      
      client.set_policy(request={"resource": f"projects/{project_id}", "policy": policy})
  ```
  Note: Replace `project_id` with your GCP project ID and `member` with the email or service account ID of the user whose permission needs to be revoked.


 