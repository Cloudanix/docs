--- 
slug: gcp_rt_storage_bucket_changes
eventname: storage.buckets.create
title: storage.buckets.create
sidebar_label: storage.buckets.create
---
                       
### Event Information

#### Meaning

- The storage.buckets.create event in GCP for CloudStorage refers to the creation of a new storage bucket in Google Cloud Storage.
- This event is triggered when a user or application creates a new bucket to store objects in Cloud Storage.
- It signifies the successful creation of a new storage bucket and can be used to track and monitor bucket creation activities in GCP.

### Remediation

#### Using Console

- Example: If security is impacted with storage.buckets.create in GCP for CloudStorage, it means that any user with the necessary permissions can create new storage buckets, potentially leading to unauthorized access or data leakage.

To remediate this for GCP CloudStorage using GCP console, you can follow these steps:

1. Identify the affected IAM role: Determine which IAM role grants the storage.buckets.create permission. This can be done by reviewing the IAM policies associated with the project or organization.

2. Remove the permission from the role: Once the affected IAM role is identified, navigate to the IAM & Admin section in the GCP console. Find the role and edit its permissions. Remove the storage.buckets.create permission from the role.

3. Review and update existing IAM bindings: After removing the permission from the role, review the existing IAM bindings to ensure that no user or service account has been granted the role with the storage.buckets.create permission. If any such bindings are found, update them to remove the permission.

By following these steps, you can remediate the security impact of storage.buckets.create in GCP CloudStorage and prevent unauthorized creation of storage buckets.

#### Using CLI

- Example: If security is impacted with `storage.buckets.create` in GCP CloudStorage, it means that users or service accounts have the ability to create new storage buckets, which can potentially lead to unauthorized data exposure or resource misuse.

- Remediation steps using GCP CLI:
  1. Identify the IAM role or permission that grants the `storage.buckets.create` capability to the user or service account.
  2. Revoke or modify the IAM role or permission to remove the `storage.buckets.create` capability.
  3. Use the following GCP CLI command to revoke the permission for a specific user or service account:
     ```
     gcloud projects remove-iam-policy-binding [PROJECT_ID] --member=[MEMBER] --role=[ROLE]
     ```
     Replace `[PROJECT_ID]` with the ID of your GCP project, `[MEMBER]` with the email address or service account identifier, and `[ROLE]` with the desired IAM role that includes the `storage.buckets.create` permission.

Note: The specific commands may vary depending on your GCP CLI version and configuration. Make sure to refer to the official GCP documentation for the most up-to-date commands and options.

#### Using Python

Example of security impact with storage.buckets.create in GCP CloudStorage:
- Unauthorized users gaining access to create buckets in CloudStorage, leading to potential data breaches or unauthorized data access.
- Malicious actors exploiting the permission to create buckets to launch denial-of-service (DoS) attacks or resource abuse.

Remediation for GCP CloudStorage using Python:
To remediate the security impact of storage.buckets.create in GCP CloudStorage, you can implement the following steps using Python:

1. Implement proper access controls:
   - Ensure that only authorized users or service accounts have the necessary permissions to create buckets.
   - Use IAM (Identity and Access Management) policies to restrict the creation of buckets to specific roles or users.
   - Regularly review and update the access controls to align with the principle of least privilege.

2. Enable bucket-level logging and monitoring:
   - Enable Cloud Audit Logs and Cloud Storage Bucket-level logging to capture and monitor bucket creation events.
   - Set up alerts or notifications to be triggered when unauthorized bucket creation attempts are detected.
   - Regularly review the logs and investigate any suspicious activities.

3. Implement automated security checks using Python:
   - Utilize the Google Cloud Storage Python client library to programmatically check for any unauthorized bucket creations.
   - Write a Python script that periodically scans the CloudStorage buckets and verifies if any unauthorized buckets have been created.
   - If unauthorized buckets are detected, the script can trigger an alert or take appropriate actions, such as deleting the unauthorized bucket or notifying the security team.

Example Python script to check for unauthorized bucket creations:

```python
from google.cloud import storage

def check_unauthorized_bucket_creations(project_id):
    client = storage.Client(project=project_id)
    unauthorized_buckets = []

    for bucket in client.list_buckets():
        if not bucket.iam_configuration.uniform_bucket_level_access.enabled:
            unauthorized_buckets.append(bucket.name)

    if unauthorized_buckets:
        print("Unauthorized bucket creations detected:")
        for bucket_name in unauthorized_buckets:
            print(bucket_name)
    else:
        print("No unauthorized bucket creations detected.")

# Usage
project_id = "your-project-id"
check_unauthorized_bucket_creations(project_id)
```

Note: This script checks if any buckets in the specified project have Uniform Bucket-Level Access disabled, indicating potential unauthorized bucket creations. Adjust the script as per your specific requirements and security policies.


 