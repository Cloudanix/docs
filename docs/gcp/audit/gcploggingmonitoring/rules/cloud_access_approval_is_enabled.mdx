---
slug: cloud_access_approval_is_enabled
title: Ensure Access Approval Is Enabled
sidebar_label: Ensure Access Approval Is Enabled
---

### More Info:

Controlling access to your information is one of the foundations of information security. Google Employees do have access to your organizations' projects for support reasons. With Access Approval, organizations can then be certain that their information is accessed by only approved Google Personnel.

### Risk Level

Medium

### Address

Security

### Compliance Standards

CISGCP, CBP



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the Google Cloud Platform Console: Open your web browser, visit the Google Cloud Platform Console, and sign in with your Google account credentials.

2. Navigate to Logging: From the main navigation menu, select "Logging" under the "Stackdriver" section. This will take you to the Logging dashboard.

3. Check Access Approval Settings: In the Logging dashboard, look for the "Access Approval" section. If Access Approval is enabled, you should see a list of resources for which Access Approval is configured. If this section is empty or non-existent, then Access Approval is not enabled.

4. Verify with Logs: You can also verify by checking the logs. In the Logging dashboard, select "Logs Explorer". Filter the logs by the "Access Approval" service. If there are logs present, it means Access Approval is enabled. If there are no logs, it means Access Approval is not enabled.

#### Using CLI

1. Install and configure the Google Cloud SDK CLI if you haven't done so already. You can do this by following the instructions provided by Google Cloud at https://cloud.google.com/sdk/docs/install.

2. Once the SDK is installed and configured, open your terminal or command prompt.

3. Run the following command to list all the projects in your GCP account:

   ```
   gcloud projects list
   ```
   This command will return a list of all the projects in your GCP account, along with their project IDs.

4. For each project ID, run the following command to check if Access Approval is enabled:

   ```
   gcloud access-approval settings describe --project=[PROJECT_ID]
   ```
   Replace `[PROJECT_ID]` with the ID of the project you want to check. This command will return the Access Approval settings for the specified project. If Access Approval is enabled, the `enrolledServices` field will not be empty. If it is empty, then Access Approval is not enabled for that project.

#### Using Python

To check if Access Approval is enabled in Google Cloud Platform (GCP) using Python scripts, you can use the Google Cloud Client Libraries. Here are the steps:

1. **Install the Google Cloud Client Library for Python**: You can install it using pip:
   ```
   pip install --upgrade google-cloud-access-approval
   ```
2. **Set up authentication**: Before you can interact with GCP services, you need to authenticate your client. You can do this by setting the `GOOGLE_APPLICATION_CREDENTIALS` environment variable to the path of your service account key file.
   ```
   import os
   os.environ["GOOGLE_APPLICATION_CREDENTIALS"]="/path/to/your/service-account-file.json"
   ```
3. **Initialize the Access Approval client**: You can do this by importing the `accessapproval_v1` module and creating an instance of the `AccessApprovalClient` class.
   ```
   from google.cloud import accessapproval_v1
   client = accessapproval_v1.AccessApprovalClient()
   ```
4. **Check if Access Approval is enabled**: You can do this by calling the `list_approval_requests` method on the client instance. If Access Approval is enabled, this method will return a list of approval requests. If it's not enabled, the method will raise an exception.
   ```
   try:
       requests = client.list_approval_requests(parent="projects/your-project-id")
       print("Access Approval is enabled.")
   except Exception as e:
       print("Access Approval is not enabled:", str(e))
   ```
Replace `"projects/your-project-id"` with the ID of your GCP project. If you don't know your project ID, you can find it in the GCP Console.

Please note that this script only checks if Access Approval is enabled at the project level. If you want to check if it's enabled at the organization level, you need to replace `"projects/your-project-id"` with `"organizations/your-organization-id"`.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the "Ensure Access Approval Is Enabled" misconfiguration in GCP using the GCP console, please follow the below steps:

1. Log in to the GCP console with your credentials.
2. Navigate to the "Access Approval" page by clicking on the hamburger menu in the top left corner and selecting "Security" > "Access Approval".
3. Click on the "Enable Access Approval" button.
4. Configure the access approval settings as per your organization's policies.
5. Click on the "Save" button to save the changes.

Once you have completed these steps, access approval will be enabled for your GCP organization, and any requests for access to resources will need to be approved before they are granted.

#### Using CLI

To remediate the misconfiguration "Ensure Access Approval Is Enabled" in GCP using GCP CLI, follow the below steps:

Step 1: Open the Cloud Shell in your GCP console.

Step 2: Run the following command to check if Access Approval is enabled or not:

```
gcloud access-approval settings describe
```

Step 3: If the output of the above command shows that Access Approval is not enabled, then run the following command to enable it:

```
gcloud access-approval settings update --enforce-on-approval=true
```

Step 4: After running the above command, Access Approval will be enabled and any requests for access to resources in your GCP project will require approval before they can be granted.

Step 5: Verify that Access Approval is enabled by running the following command:

```
gcloud access-approval settings describe
```

Step 6: The output of the above command should show that Access Approval is enabled and enforced.

With these steps, you have successfully remediated the misconfiguration "Ensure Access Approval Is Enabled" in GCP using GCP CLI.

#### Using Python

To remediate the misconfiguration "Ensure Access Approval Is Enabled" in GCP using Python, you can follow the below steps:

1. Import the necessary libraries:

```
from google.cloud import accessapproval_v1
from google.oauth2 import service_account
```

2. Create a service account and grant it the necessary permissions to access the Access Approval API.

```
credentials = service_account.Credentials.from_service_account_file('path/to/service_account.json')
client = accessapproval_v1.AccessApprovalClient(credentials=credentials)
```

3. Get the current Access Approval settings:

```
response = client.get_access_approval_settings(request={"name": "projects/<project_id>/accessApprovalSettings"})
```

4. Check if Access Approval is enabled or not:

```
if response.enforcement_mode == accessapproval_v1.EnforcementMode.ENFORCEMENT_MODE_UNSPECIFIED:
    response.enforcement_mode = accessapproval_v1.EnforcementMode.ENFORCEMENT_MODE_ENABLED
    response = client.update_access_approval_settings(request={"access_approval_settings": response})
```

5. If Access Approval is not enabled, enable it:

```
response.enforcement_mode = accessapproval_v1.EnforcementMode.ENFORCEMENT_MODE_ENABLED
response = client.update_access_approval_settings(request={"access_approval_settings": response})
```

6. Verify that Access Approval is enabled:

```
if response.enforcement_mode == accessapproval_v1.EnforcementMode.ENFORCEMENT_MODE_ENABLED:
    print("Access Approval is enabled.")
else:
    print("Failed to enable Access Approval.")
```

Note: Replace `<project_id>` with your actual project ID.

These steps will ensure that Access Approval is enabled in GCP using Python.


### Additional Reading:

- [https://cloud.google.com/cloud-provider-access-management/access-approval/docs](https://cloud.google.com/cloud-provider-access-management/access-approval/docs) 


</Tab>
</Tabs>