---
slug: bucket_versioning
title: Bucket Versioning Should Be Enabled
sidebar_label: Bucket Versioning Should Be Enabled
---

### More Info:

Ensures object versioning is enabled on storage buckets. Object versioning can help protect against the overwriting of objects or data loss in the event of a compromise.

### Risk Level

Low

### Address

Security, Operational Maturity, Reliability

### Compliance Standards

PCIDSS, HITRUST, SOC2, NISTCSF



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to your Google Cloud Platform (GCP) Console: Open your web browser, navigate to the GCP Console (console.cloud.google.com) and sign in with your GCP account credentials.

2. Navigate to the Cloud Storage: From the GCP Console dashboard, select the hamburger menu (three horizontal lines) in the upper left-hand corner of the screen. Scroll down and click on "Storage" under the "Storage" section.

3. Access the Buckets List: On the Cloud Storage page, you will see a list of all your storage buckets. 

4. Check Bucket Versioning: Click on the name of the bucket you want to check. Once you're in the bucket details page, click on the "Settings" tab. Under the "Metadata" section, look for the "Versioning" field. If the field says "Disabled", then bucket versioning is not enabled for this bucket. If it says "Enabled", then versioning is active.

#### Using CLI

1. Install and configure the Google Cloud SDK CLI on your local machine. You can download it from the official Google Cloud website and follow the instructions to set it up.

2. Once the SDK is installed and configured, open your terminal or command prompt and use the following command to list all the buckets in your GCP project:

   ```
   gsutil ls -p [PROJECT_ID]
   ```

   Replace `[PROJECT_ID]` with your actual Google Cloud project ID.

3. To check the versioning status of a specific bucket, use the following command:

   ```
   gsutil versioning get gs://[BUCKET_NAME]
   ```

   Replace `[BUCKET_NAME]` with the name of the bucket you want to check.

4. The output of the command will tell you whether versioning is enabled or not. If versioning is enabled, the output will be `Enabled`. If it's not enabled, the output will be `Suspended`.

#### Using Python

To check if bucket versioning is enabled in AWS S3, Azure Blob Storage, and Google Cloud Storage (GCS), you can use the respective SDKs provided by these cloud providers. Here are the steps to do it:

1. AWS S3:
   - Install boto3, the AWS SDK for Python, using pip: `pip install boto3`
   - Use the following script to check if versioning is enabled:

```python
import boto3

s3 = boto3.client('s3')

response = s3.get_bucket_versioning(Bucket='my-bucket')

if response.get('Status') == 'Enabled':
    print("Versioning is enabled")
else:
    print("Versioning is not enabled")
```

2. Azure Blob Storage:
   - Install the Azure SDK for Python using pip: `pip install azure-storage-blob`
   - Azure Blob Storage does not support bucket versioning like AWS S3 and GCS. Instead, it has a feature called Blob Versioning. You can check if it's enabled using Azure CLI or Azure Portal, but not directly through the SDK.

3. Google Cloud Storage (GCS):
   - Install the Google Cloud SDK for Python using pip: `pip install google-cloud-storage`
   - Use the following script to check if versioning is enabled:

```python
from google.cloud import storage

def check_bucket_versioning(bucket_name):
    storage_client = storage.Client()
    bucket = storage_client.get_bucket(bucket_name)

    if bucket.versioning_enabled:
        print("Versioning is enabled")
    else:
        print("Versioning is not enabled")

check_bucket_versioning('my-bucket')
```

Please replace 'my-bucket' with the name of your bucket. Also, ensure that you have the necessary permissions and your environment is properly configured to use these SDKs.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the "Bucket Versioning Should Be Enabled" misconfiguration in GCP using GCP console, follow these steps:

1. Go to the GCP console and select the project where the misconfigured bucket is located.

2. In the top navigation bar, click on the "Storage" option.

3. Click on the name of the bucket that needs to be remediated.

4. In the left-hand menu, click on the "Versions" option.

5. Click on the "Enable versioning" button.

6. A pop-up window will appear asking you to confirm that you want to enable versioning. Click on the "Enable" button.

7. Once versioning is enabled, you will see a message confirming that versioning has been enabled for the bucket.

8. You can now exit the GCP console.

By following these steps, you will have successfully remediated the misconfiguration "Bucket Versioning Should Be Enabled" for the specified bucket in GCP using GCP console.

#### Using CLI

To remediate the bucket versioning misconfiguration in GCP using GCP CLI, you can follow the below steps:

1. Open Cloud Shell from the GCP console.
2. Run the following command to enable versioning for a specific bucket:

```
gsutil versioning set on gs://[BUCKET_NAME]
```

Note: Replace [BUCKET_NAME] with the name of the bucket you want to enable versioning for.

3. Verify that versioning is enabled for the bucket by running the following command:

```
gsutil versioning get gs://[BUCKET_NAME]
```

Note: Replace [BUCKET_NAME] with the name of the bucket you enabled versioning for.

4. The output of the above command should show "Enabled: True" indicating that versioning has been enabled for the bucket.

By following these steps, you can remediate the misconfiguration of bucket versioning not being enabled in GCP using GCP CLI.

#### Using Python

To remediate the "Bucket Versioning Should Be Enabled" misconfiguration in GCP using Python, you can follow these steps:

1. Install the `google-cloud-storage` library using pip:

```python
pip install google-cloud-storage
```

2. Import the necessary modules:

```python
from google.cloud import storage
```

3. Initialize the client object:

```python
client = storage.Client()
```

4. Get the bucket object:

```python
bucket = client.get_bucket('bucket-name')
```

5. Enable versioning for the bucket:

```python
bucket.versioning_enabled = True
bucket.patch()
```

6. Verify that versioning is enabled:

```python
bucket.reload()
print(bucket.versioning_enabled)
```

This will enable versioning for the specified GCP bucket and ensure that all objects uploaded to the bucket have a unique version ID.


### Additional Reading:

- [https://cloud.google.com/storage/docs/using-object-versioning](https://cloud.google.com/storage/docs/using-object-versioning) 


</Tab>
</Tabs>