---
slug: storage_bucket_logs_not_public
title: Storage Bucket Logs Should Not be Publicly Accessible
sidebar_label: Storage Bucket Logs Should Not be Publicly Accessible
---

### More Info:

Ensure that cloud Storage bucket Logs are not Publicly Accessible by setting "publicAccessPrevention" to "enforced".

### Risk Level

High

### Address

Security

### Compliance Standards

HITRUST, SOC2, NISTCSF, PCIDSS
### Remediation

#### Using Console

Sure, I can help you with that. Here are the step by step instructions to remediate the issue "Storage Bucket Logs Should Not be Publicly Accessible" for GCP using GCP Console:

1. Open the GCP Console and navigate to the Cloud Storage page.

2. Select the bucket that you want to remediate.

3. Click on the "Permissions" tab.

4. Under the "Public access prevention" section, click on the "Edit" button.

5. Set the "Prevent public access" toggle to "On".

6. Click on the "Save" button to save the changes.

7. Under the "Access control" section, click on the "Add members" button.

8. Enter the email address of the user or service account that you want to grant access to.

9. Select the appropriate role from the "Select a role" dropdown menu.

10. Click on the "Add" button to add the member and role.

11. Repeat steps 7-10 for each user or service account that you want to grant access to.

12. Click on the "Save" button to save the changes.

By following these steps, you have successfully remediated the issue "Storage Bucket Logs Should Not be Publicly Accessible" for GCP using GCP Console.

#### Using CLI

To remediate the issue of publicly accessible storage bucket logs in GCP, you can follow the below steps using GCP CLI:

1. Open the Cloud Shell in your GCP console.

2. Run the following command to list all the storage buckets in your GCP project:

   ```
   gsutil ls
   ```

3. Identify the bucket that contains the logs which are publicly accessible.

4. Run the following command to update the bucket's permissions and make it private:

   ```
   gsutil iam ch -d allUsers gs://[BUCKET_NAME]
   ```
   Replace `[BUCKET_NAME]` with the name of the bucket that you identified in step 3.

5. Verify that the bucket's permissions have been updated by running the following command:

   ```
   gsutil iam get gs://[BUCKET_NAME]
   ```
   It should return the updated IAM policy for the bucket.

6. Finally, you can check if the bucket logs are still publicly accessible by trying to access them using a web browser or any other tool. If the remediation was successful, you should not be able to access the logs anymore.

Note: Make sure that you have the necessary permissions to modify the IAM policies of the storage buckets in your GCP project.

#### Using Python

To remediate the issue of publicly accessible storage bucket logs in GCP, you can use the following Python code:

```python
from google.cloud import storage

# Set the name of the bucket and the name of the log object
bucket_name = "your-bucket-name"
log_object_name = "your-log-object-name"

# Create a client object
client = storage.Client()

# Get the bucket object
bucket = client.get_bucket(bucket_name)

# Get the log object
log_object = bucket.get_blob(log_object_name)

# Set the log object's access control to private
log_object.acl.save_predefined('private')
```

Explanation:

1. Import the necessary libraries, including the `google.cloud.storage` library.
2. Set the name of the bucket and the name of the log object that you want to remediate.
3. Create a client object to interact with the GCP storage service.
4. Get the bucket object using the client and the bucket name.
5. Get the log object using the bucket and the log object name.
6. Set the log object's access control to private using the `save_predefined()` method of the `acl` attribute of the log object.

Note: You will need to have the necessary permissions to modify the access control of the log object in order to successfully remediate this issue.



