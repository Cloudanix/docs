---
slug: bigtable_cluster_storage_type_ssd
title: Bigtable Cluster Should Use SSD Storage Type
sidebar_label: Bigtable Cluster Should Use SSD Storage Type
---

### More Info:

Ensure that Bigtable clusters use SSD for best performance.

### Risk Level

Medium

### Address

Operational Maturity, Performance Efficiency

### Compliance Standards

CBP



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the Google Cloud Platform Console: Open your web browser, navigate to the Google Cloud Platform web console and sign in with your Google account credentials.

2. Navigate to Bigtable: From the main navigation menu, click on "Bigtable". This will take you to the Bigtable instances page where you can see all your Bigtable instances.

3. Select the Bigtable Instance: Click on the name of the Bigtable instance that you want to check. This will take you to the instance details page.

4. Check the Storage Type: On the instance details page, look for the "Storage type" field. If the value of this field is "SSD", then the Bigtable cluster is using SSD storage type. If the value is "HDD", then it is not using SSD storage type.

#### Using CLI

1. Install and configure Google Cloud SDK: Before you can use the GCP CLI, you need to install the Google Cloud SDK on your local machine. You can do this by following the instructions provided by Google Cloud. Once installed, you can authenticate your account by running the command `gcloud auth login`.

2. List all Bigtable instances: Use the following command to list all the Bigtable instances in your project:

    ```
    gcloud bigtable instances list
    ```

    This command will return a list of all Bigtable instances along with their details.

3. Get the details of a specific Bigtable instance: To get the details of a specific Bigtable instance, use the following command:

    ```
    gcloud bigtable instances describe [INSTANCE_ID]
    ```

    Replace `[INSTANCE_ID]` with the ID of the Bigtable instance you want to check. This command will return the details of the specified Bigtable instance, including the storage type.

4. Check the storage type: In the output of the previous command, look for the `storageType` field. If the value of this field is `SSD`, then the Bigtable cluster is using SSD storage type. If the value is `HDD`, then it is not using SSD storage type.

#### Using Python

1. Install Google Cloud SDK and Python Client for Google Cloud Bigtable: Before you start, make sure you have installed the Google Cloud SDK and authenticated it with your GCP account. Also, install the Python Client for Google Cloud Bigtable using pip:

   ```
   pip install google-cloud-bigtable
   ```

2. Import the necessary libraries and initialize the Bigtable client: You will need to import the `google.cloud.bigtable` library and initialize the Bigtable client with your project ID.

   ```python
   from google.cloud import bigtable
   client = bigtable.Client(project='your-project-id', admin=True)
   ```

3. Fetch the list of all Bigtable instances and their clusters: You can use the `list_instances()` method to get a list of all Bigtable instances in your project. For each instance, you can use the `list_clusters()` method to get a list of all clusters.

   ```python
   instances = client.list_instances()[0]
   for instance in instances:
       clusters = instance.list_clusters()[0]
       for cluster in clusters:
           print(f'Cluster ID: {cluster.cluster_id}, Storage Type: {cluster.storage_type}')
   ```

4. Check the storage type of each cluster: The `storage_type` attribute of a cluster object will tell you whether it is using HDD or SSD storage. You can check this attribute and print a warning message if it is not SSD.

   ```python
   for instance in instances:
       clusters = instance.list_clusters()[0]
       for cluster in clusters:
           if cluster.storage_type != bigtable.enums.StorageType.SSD:
               print(f'Warning: Cluster {cluster.cluster_id} is not using SSD storage.')
   ```
   
This script will print a warning message for each Bigtable cluster in your GCP project that is not using SSD storage.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration in GCP console, follow these steps:

1. Open the GCP console and select the project where the Bigtable cluster is located.

2. In the left-hand menu, select "Bigtable."

3. Select the Bigtable instance that you want to remediate.

4. In the "Instance details" page, select the "Storage" tab.

5. In the "Storage" tab, you will see a list of storage types available for your Bigtable cluster. Select "SSD" as the storage type.

6. Click "Save" to apply the changes.

7. Wait for the changes to be applied. This may take some time depending on the size of your cluster.

8. Once the changes are applied, your Bigtable cluster will be using SSD storage type.

Note: You can also use the gcloud command-line tool to remediate this misconfiguration. The command to use is:

```
gcloud bigtable instances update [INSTANCE_ID] --storage-type=SSD
```

Replace [INSTANCE_ID] with the ID of your Bigtable instance.

#### Using CLI

To remediate the misconfiguration "Bigtable Cluster Should Use SSD Storage Type" in GCP using GCP CLI, you can follow the below steps:

1. Open the Google Cloud Shell or any terminal with GCP CLI installed.

2. Run the following command to get the list of Bigtable instances in your project:

   ```
   gcloud bigtable instances list
   ```

3. Identify the instance that needs to be updated and note down the instance ID.

4. Run the following command to update the instance with SSD storage type:

   ```
   gcloud beta bigtable instances update <INSTANCE_ID> --storage-type ssd
   ```

   Replace `<INSTANCE_ID>` with the actual instance ID noted in step 3.

5. Verify the storage type of the instance by running the following command:

   ```
   gcloud beta bigtable instances describe <INSTANCE_ID> --format="value(storageType)"
   ```

   This should return `SSD` as the storage type of the instance.

By following the above steps, you can remediate the misconfiguration "Bigtable Cluster Should Use SSD Storage Type" in GCP using GCP CLI.

#### Using Python

To remediate this misconfiguration in GCP, you can use the following steps using Python:

1. Install the `google-cloud-bigtable` library using pip:

   ```
   pip install google-cloud-bigtable
   ```

2. Import the necessary libraries:

   ```python
   from google.cloud import bigtable
   from google.cloud.bigtable import enums
   ```

3. Set the project ID and instance ID:

   ```python
   project_id = 'your-project-id'
   instance_id = 'your-instance-id'
   ```

4. Connect to the Bigtable instance:

   ```python
   client = bigtable.Client(project=project_id)
   instance = client.instance(instance_id)
   ```

5. Get the list of clusters in the instance:

   ```python
   clusters = instance.list_clusters()
   ```

6. Loop through each cluster and check if it is using SSD storage:

   ```python
   for cluster in clusters:
       if cluster.storage_type != enums.StorageType.SSD:
           # Remediate the misconfiguration by updating the cluster to use SSD storage
           cluster.storage_type = enums.StorageType.SSD
           cluster.update()
   ```

   This code checks if the storage type of the cluster is not SSD, and if so, updates the storage type to SSD.

7. Verify that the misconfiguration has been remediated by checking the storage type of the cluster:

   ```python
   print(cluster.storage_type)
   ```

   This should output `SSD`.

Note: You will need to have the necessary permissions to make changes to the Bigtable instance in order to remediate this misconfiguration.


### Additional Reading:

- [https://cloud.google.com/bigtable/docs/instances-clusters-nodes#storage-types](https://cloud.google.com/bigtable/docs/instances-clusters-nodes#storage-types) 


</Tab>
</Tabs>