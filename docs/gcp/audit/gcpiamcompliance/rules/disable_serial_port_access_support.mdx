---
slug: disable_serial_port_access_support
title: Disable Serial Port Access Support at Organization Level
sidebar_label: Disable Serial Port Access Support at Organization Level
---

### More Info:

Ensure that "Disable VM serial port access" constraint policy is enabled for your Google Cloud Platform (GCP) organizations. Due to security and compliance regulations, the serial port access to your Compute Engine virtual machine (VM) instances must be disabled.

### Risk Level

Medium

### Address

Security, Operational Maturity

### Compliance Standards

CISGCP, CBP


<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to your Google Cloud Platform (GCP) console.

2. Navigate to the IAM & Admin section. This is where you can manage Identity and Access Management (IAM) for your organization.

3. In the IAM & Admin section, select the Organization that you want to check for the Serial Port Access Support.

4. In the Organization settings, look for the "Serial Port Access" setting. If it is enabled, it means that Serial Port Access Support is not disabled at the Organization level. If it is disabled, it means that Serial Port Access Support is disabled at the Organization level.

#### Using CLI

1. Install and configure Google Cloud SDK on your local machine. This will allow you to interact with your GCP resources using the command line interface. You can download it from the official Google Cloud website and follow the instructions to install it.

2. Authenticate your GCP account using the following command. This will prompt you to log in to your Google Cloud account and will give the SDK access to your resources.
   ```
   gcloud auth login
   ```

3. Set your active project to the project you want to check. Replace `PROJECT_ID` with the ID of your project.
   ```
   gcloud config set project PROJECT_ID
   ```

4. Run the following command to check the status of serial port access at the organization level. Replace `ORGANIZATION_ID` with the ID of your organization.
   ```
   gcloud compute project-info describe --project ORGANIZATION_ID | grep serial-port-enable
   ```
   If the output of this command is `serial-port-enable: "false"`, then serial port access is disabled at the organization level. If it is `serial-port-enable: "true"`, then serial port access is enabled.

#### Using Python

To check if Serial Port Access Support is disabled at the Organization Level in IAM using Python scripts, you can use the Google Cloud SDK (gcloud) or Google Cloud Client Libraries. Here are the steps:

1. **Set up Google Cloud SDK and authenticate your account:**
   Before you can interact with GCP resources using Python, you need to authenticate your account with GCP. You can do this by setting up the Google Cloud SDK and running the `gcloud auth application-default login` command.

2. **Install Google Cloud Client Libraries for Python:**
   You can install the Google Cloud Client Libraries for Python using pip. This library allows you to interact with GCP resources using Python. You can install it using the following command: `pip install --upgrade google-cloud-orgpolicy`

3. **Create a Python script to check the policy:**
   You can use the `google.cloud.orgpolicy_v1` module to interact with the Org Policy service. Here is a sample script that checks if Serial Port Access is disabled:

```python
from google.cloud import orgpolicy_v1

def check_serial_port_access_policy(project_id):
    client = orgpolicy_v1.OrgPolicyClient()

    policy = client.get_policy(
        orgpolicy_v1.PolicyName(project_id, "compute.disableSerialPortAccess"))

    if policy.boolean_policy.enforced:
        print("Serial Port Access is disabled.")
    else:
        print("Serial Port Access is not disabled.")

# Replace 'your-project-id' with your actual project ID
check_serial_port_access_policy('your-project-id')
```

4. **Run the Python script:**
   You can run the Python script using any Python interpreter. The script will print whether Serial Port Access is disabled or not.

Please note that you need the `resourcemanager.projects.get` permission to call the `get_policy` method. If you don't have this permission, you need to request it from your GCP administrator.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the "Disable Serial Port Access Support at Organization Level" misconfiguration in GCP using the GCP console, follow these steps:

1. Open the GCP console and navigate to the "IAM & Admin" section.
2. Click on "Organization" and select your organization from the dropdown menu.
3. Click on the "Policies" tab and scroll down to the "Compute Engine" section.
4. Locate the policy for "Serial Port Access" and click on the "Edit" button next to it.
5. In the policy editor, select "Deny" for the "SerialPortAccess" permission.
6. Click on "Save" to update the policy.

This will disable Serial Port Access Support at the organization level in GCP. Note that this change may take some time to propagate across all resources in your organization.

#### Using CLI

To remediate the misconfiguration "Disable Serial Port Access Support at Organization Level" for GCP using GCP CLI, follow these steps:

1. Open the GCP CLI and log in to your GCP account using your credentials.

2. Run the following command to disable serial port access support at the organization level:

```
gcloud alpha compute organizations update --disable-serial-port-access
```

3. Once the command is executed successfully, the serial port access support will be disabled at the organization level.

4. Verify the changes by running the following command:

```
gcloud alpha compute organizations describe
```

This command will display the organization's details, including the serial port access support status. If the serial port access support is disabled, it will be reflected in the output.

Note: The above command is in alpha state and may change in the future. It is recommended to check the latest documentation before executing the command.

#### Using Python

To disable Serial Port Access Support at the Organization Level in GCP using Python, you can follow these steps:

1. First, you need to authenticate with the GCP API using a Service Account. You can create a Service Account with the necessary permissions in the GCP Console and download the Service Account Key as a JSON file.

2. Install the Google Cloud SDK and the necessary Python libraries for interacting with the GCP API. You can do this by running the following command in your terminal:

```
pip install google-cloud google-auth google-auth-oauthlib google-auth-httplib2
```

3. Import the necessary libraries and authenticate with the GCP API using the Service Account Key:

```python
from google.oauth2 import service_account
from googleapiclient.discovery import build

credentials = service_account.Credentials.from_service_account_file(
    'path/to/service_account_key.json')
service = build('cloudresourcemanager', 'v1', credentials=credentials)
```

4. Use the `organizations.patch` method to update the `enableSerialPortAccess` field of the Organization resource. Set the value of `enableSerialPortAccess` to `False` to disable Serial Port Access Support at the Organization Level:

```python
org_id = 'your_organization_id'
org = service.organizations().get(name=f'organizations/{org_id}').execute()
org['enableSerialPortAccess'] = False
updated_org = service.organizations().patch(name=f'organizations/{org_id}', body=org).execute()
```

5. Verify that Serial Port Access Support has been disabled at the Organization Level by checking the `enableSerialPortAccess` field of the Organization resource:

```python
print(f'Serial Port Access Support is now disabled at the Organization Level: {updated_org["enableSerialPortAccess"]}')
```

And that's it! You have successfully remediated the misconfiguration by disabling Serial Port Access Support at the Organization Level in GCP using Python.




</Tab>
</Tabs>