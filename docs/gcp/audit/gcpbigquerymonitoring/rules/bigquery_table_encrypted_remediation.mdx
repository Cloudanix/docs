### Remediation

#### Using Console

To remediate the misconfiguration of BigQuery tables not being encrypted in GCP console, follow these steps:

1. Open the Google Cloud Console and navigate to the BigQuery section.
2. Select the dataset that contains the unencrypted table.
3. Click on the unencrypted table to open its details.
4. Click on the "Edit schema" button located in the top right corner of the screen.
5. Scroll down to the "Encryption" section and select the "Customer-managed key" option.
6. Choose the key that you want to use for encryption.
7. Click on the "Save" button to apply the changes.

Once you have completed these steps, the BigQuery table will be encrypted using the customer-managed key that you specified.

#### Using CLI

To remediate the misconfiguration of GCP BigQuery Tables not being encrypted, follow these steps:

1. Open the Google Cloud Console and navigate to the BigQuery service.
2. Select the dataset that contains the table you want to encrypt.
3. Click on the table you want to encrypt.
4. Click on the "Edit schema" button in the top-right corner of the screen.
5. In the "Schema" tab, click on the drop-down menu next to the column you want to encrypt and select "Edit column".
6. In the "Edit column" dialog box, check the box next to "Encrypt data in transit and at rest".
7. Click "Save" to save the changes to the column.
8. Repeat steps 5-7 for each column you want to encrypt.
9. Once you have encrypted all the necessary columns, click "Save schema" to save the changes to the table.

Alternatively, you can use the GCP CLI to encrypt the table. Here are the steps:

1. Open a terminal window and install the Google Cloud SDK if you haven't already done so.
2. Authenticate with your GCP account using the following command:
   ```
   gcloud auth login
   ```
3. Set your project ID using the following command:
   ```
   gcloud config set project [PROJECT_ID]
   ```
4. Encrypt the table using the following command:
   ```
   bq update --table [DATASET].[TABLE] --schema [SCHEMA_FILE] --encryption_configuration kms_key_name=[KMS_KEY_NAME]
   ```
   Replace [DATASET], [TABLE], and [SCHEMA_FILE] with the appropriate values. [KMS_KEY_NAME] is the name of the KMS key you want to use for encryption.
5. Verify that the table is encrypted by running the following command:
   ```
   bq show --format=prettyjson [DATASET].[TABLE]
   ```
   Look for the "encryptionConfiguration" field in the output. It should contain the KMS key name you specified in step 4.

By following these steps, you can remediate the misconfiguration of GCP BigQuery Tables not being encrypted.

#### Using Python

To remediate the misconfiguration of GCP BigQuery Tables not being encrypted, you can use the following Python code:

1. First, you need to enable the Cloud KMS API (Key Management Service) in your GCP project. This API is used to create and manage encryption keys.

```python
from google.cloud import kms_v1
from google.cloud.kms_v1 import enums

client = kms_v1.KeyManagementServiceClient()

# Replace [PROJECT_ID] with your GCP project ID
parent = client.location_path('[PROJECT_ID]', 'global')

response = client.list_key_rings(parent)

for key_ring in response:
    print(key_ring.name)
```

2. Next, you need to create an encryption key that will be used to encrypt the BigQuery tables. You can use the following code to create a key:

```python
# Replace [PROJECT_ID] with your GCP project ID
parent = client.location_path('[PROJECT_ID]', 'global')

# Replace [KEY_RING_ID] with the ID of the key ring you want to use
key_ring_id = '[KEY_RING_ID]'

# Replace [KEY_ID] with the ID you want to give to your new key
key_id = '[KEY_ID]'

# Create the key
response = client.create_crypto_key(parent, key_id, kms_v1.CryptoKey({
    'purpose': enums.CryptoKey.CryptoKeyPurpose.ENCRYPT_DECRYPT,
    'next_rotation_time': '2022-01-01T00:00:00.000Z'
}))

print('Created key: {}'.format(response.name))
```

3. Once you have created the encryption key, you can use it to encrypt the BigQuery tables. You can use the following code to encrypt a table:

```python
from google.cloud import bigquery

# Replace [PROJECT_ID] with your GCP project ID
client = bigquery.Client(project='[PROJECT_ID]')

# Replace [DATASET_ID] with the ID of the dataset containing the table you want to encrypt
# Replace [TABLE_ID] with the ID of the table you want to encrypt
table_ref = client.dataset('[DATASET_ID]').table('[TABLE_ID]')

# Replace [KEY_RING_ID] with the ID of the key ring you created in step 2
# Replace [KEY_ID] with the ID of the key you created in step 2
encryption_config = bigquery.EncryptionConfiguration(
    kms_key_name='projects/[PROJECT_ID]/locations/global/keyRings/[KEY_RING_ID]/cryptoKeys/[KEY_ID]'
)

table = client.get_table(table_ref)
table.encryption_configuration = encryption_config

client.update_table(table, ['encryption_configuration'])

print('Table {} is now encrypted.'.format(table_ref.table_id))
```

By following these steps, you can remediate the misconfiguration of GCP BigQuery tables not being encrypted.

