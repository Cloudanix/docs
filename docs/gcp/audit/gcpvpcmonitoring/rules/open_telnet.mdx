---
slug: open_telnet
title: Telnet Port Should Not Be Open
sidebar_label: Telnet Port Should Not Be Open
---

### More Info:

Determines if TCP port 23 for Telnet is open to the public.

### Risk Level

Medium

### Address

Security

### Compliance Standards

SOC2, GDPR, ISO27001, HIPAA, HITRUST, NISTCSF, PCIDSS, FedRAMP



<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Log in to the Google Cloud Platform Console: Open your preferred web browser, navigate to the Google Cloud Platform web console and sign in with your Google account credentials.

2. Navigate to VPC Network: From the main navigation menu, click on "VPC Network" and then select "Firewall rules". This will display a list of all the firewall rules that are currently configured in your Google Cloud environment.

3. Check for Open Telnet Ports: Look for any firewall rules that have "tcp:23" (the port number for Telnet) listed in the "Protocols / ports" column. If such a rule exists, it means that the Telnet port is open.

4. Verify Source Range: Check the "Source IP ranges" column for the rule. If it's set to "0.0.0.0/0", it means that the Telnet port is open to the entire internet, which is a serious security risk.

#### Using CLI

1. Install and authenticate the Google Cloud SDK: The Google Cloud SDK includes the gcloud command-line tool, which is necessary to interact with your GCP resources. You can install it by following the instructions provided by Google Cloud. After installation, authenticate the SDK using the command `gcloud auth login`.

2. List all the firewall rules: Use the following command to list all the firewall rules in your GCP project. This will display a list of all firewall rules, including their associated network, source range, allowed protocols and ports, and other information.

    ```
    gcloud compute firewall-rules list
    ```

3. Filter the firewall rules: To check if the Telnet port (port 23) is open, you can filter the output of the previous command. Look for rules that allow traffic on port 23. You can do this manually, or use a command like the following to filter the output:

    ```
    gcloud compute firewall-rules list --format="table(name, network, direction, priority, sourceRanges.list():label=SRC_RANGES, allowed[].map().firewall_rule().list():label=ALLOW)" | grep 'tcp:23'
    ```

4. Analyze the output: If the previous command returns any results, it means that there are firewall rules that allow traffic on the Telnet port. Each line in the output represents a firewall rule that allows traffic on port 23. The columns in the output provide information about the rule, such as its name, associated network, direction, priority, and source ranges.

#### Using Python

1. Import Required Libraries: The first step is to import the required libraries in your Python script. You will need the 'socket' library to create a socket object and connect to the server on the specified port.

```python
import socket
```

2. Define the Function: Next, define a function that will check if the Telnet port (port 23) is open. This function will take the IP address or hostname of the server as an argument.

```python
def check_telnet(ip):
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.settimeout(5)
    try:
        connection = sock.connect((ip, 23))
        print(f'Telnet port is open on {ip}')
    except socket.error as e:
        print(f'Telnet port is not open on {ip}')
    finally:
        sock.close()
```

3. Call the Function: Now, call the function with the IP address or hostname of the server you want to check.

```python
check_telnet('192.168.1.1')
```

4. Run the Script: Finally, run the script. If the Telnet port is open, it will print 'Telnet port is open on [IP]'. If the port is not open, it will print 'Telnet port is not open on [IP]'.

Please note that this script only checks if the Telnet port is open. It does not check if Telnet is actually running on the server. To check if Telnet is running, you would need to send a Telnet command to the server and check the response.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the misconfiguration of "Telnet Port Should Not Be Open" for GCP using GCP console, please follow the below steps:

1. Login to your GCP console.
2. Navigate to the GCP project which has the instance with the open Telnet port.
3. Click on the hamburger menu on the top left corner of the console and select "Compute Engine" under the "Compute" section.
4. From the list of instances, select the instance with the open Telnet port.
5. Click on the "Edit" button at the top of the page.
6. Scroll down to the "Firewall" section and click on "Management, disks, networking, SSH keys".
7. Under the "Firewall" section, click on "default-allow-internal".
8. Scroll down to the "Protocols and ports" section and uncheck the "tcp:23" option.
9. Click on the "Save" button at the bottom of the page.

By following the above steps, you have successfully remediated the misconfiguration of "Telnet Port Should Not Be Open" for GCP using GCP console.

#### Using CLI

To remediate the "Telnet Port Should Not Be Open" misconfiguration on GCP using GCP CLI, follow these steps:

1. Open the Cloud Shell in the GCP Console.

2. Run the following command to list all the instances in the project:
```bash
gcloud compute instances list
```

3. Identify the instance that has the telnet port open.

4. Connect to the instance using SSH:
```bash
gcloud compute ssh [INSTANCE_NAME] --zone [ZONE]
```

5. Once connected to the instance, run the following command to check if telnet is installed:
```bash
which telnet
```

6. If telnet is installed, run the following command to uninstall it:
```bash
sudo apt-get remove telnet
```

7. If telnet is not installed, run the following command to check if the telnet port is open:
```bash
sudo netstat -tuln | grep 23
```

8. If the telnet port is open, edit the firewall rules for the instance to close the telnet port:
```bash
gcloud compute firewall-rules update [FIREWALL_RULE_NAME] --remove-ports=23 --direction=INGRESS
```

9. Verify that the telnet port is closed by running the following command:
```bash
sudo netstat -tuln | grep 23
```

10. Exit the SSH session by typing `exit`.

11. Repeat steps 4-10 for any other instances that have the telnet port open.

By following the above steps, you can remediate the "Telnet Port Should Not Be Open" misconfiguration on GCP using GCP CLI.

#### Using Python

To remediate the Telnet Port Should Not Be Open misconfiguration in GCP using Python, you can follow these steps:

1. Connect to the GCP project using the Python client library.

```python
from google.cloud import compute_v1

compute_client = compute_v1.InstancesClient()
project = "your-project-id"
zone = "your-zone"
instance_name = "your-instance-name"
instance = compute_client.get(project=project, zone=zone, instance=instance_name)
```

2. Check if the Telnet port is open by looking at the instance's firewall rules.

```python
firewall_rules = compute_client.list_firewall_policies(project=project, zone=zone)
for rule in firewall_rules:
    if rule.allowed[0].ports == ['23']:
        print(f"Firewall rule {rule.name} allows Telnet traffic.")
```

3. If there is a firewall rule that allows Telnet traffic, delete it.

```python
for rule in firewall_rules:
    if rule.allowed[0].ports == ['23']:
        operation = compute_client.delete_firewall_policy(project=project, firewall_policy=rule.name)
        operation.result()
        print(f"Firewall rule {rule.name} deleted.")
```

4. Confirm that the Telnet port is no longer open by checking the instance's firewall rules again.

```python
firewall_rules = compute_client.list_firewall_policies(project=project, zone=zone)
for rule in firewall_rules:
    if rule.allowed[0].ports == ['23']:
        print(f"Firewall rule {rule.name} still allows Telnet traffic.")
```

By following these steps, you can remediate the Telnet Port Should Not Be Open misconfiguration for a GCP instance using Python.


### Additional Reading:

- [https://cloud.google.com/vpc/docs/using-firewalls](https://cloud.google.com/vpc/docs/using-firewalls) 


</Tab>
</Tabs>