---
slug: cloud_dns_dnssec_enabled
title: DNSSEC Should Be Enabled For Cloud DNS
sidebar_label: DNSSEC Should Be Enabled For Cloud DNS
---

### More Info:

Ensure that DNSSEC is enabled for Cloud DNS.

### Risk Level

Medium

### Address

Security

### Compliance Standards

CISGCP, CBP


<Tabs><Tab title='Cause'>
### Check Cause

#### Using Console

1. Sign in to the Google Cloud Platform (GCP) Console: Open your web browser, navigate to the GCP Console (console.cloud.google.com) and sign in with your GCP account credentials.

2. Navigate to the Cloud DNS: From the left-hand side menu, select "Network Services" and then "Cloud DNS". This will display a list of all your DNS zones.

3. Check DNSSEC status: For each DNS zone, check the "DNSSEC" column. If DNSSEC is enabled, it will show "On". If it is not enabled, it will show "Off".

4. Repeat for all DNS zones: Go through each DNS zone in your GCP project and check the DNSSEC status. Make a note of any DNS zones where DNSSEC is not enabled.

#### Using CLI

1. Install and configure the Google Cloud SDK CLI on your local machine. You can download it from the official Google Cloud website and follow the instructions for your specific operating system.

2. Authenticate your Google Cloud account by running the following command in your terminal:
   ```
   gcloud auth login
   ```
   Follow the prompts to log in with your Google Cloud account.

3. List all the DNS managed zones in your project by running the following command:
   ```
   gcloud dns managed-zones list --project=[PROJECT_ID]
   ```
   Replace [PROJECT_ID] with your actual project ID. This command will return a list of all DNS managed zones in your project.

4. For each DNS managed zone, check if DNSSEC is enabled by running the following command:
   ```
   gcloud dns managed-zones describe [ZONE_NAME] --project=[PROJECT_ID]
   ```
   Replace [ZONE_NAME] with the name of the DNS managed zone and [PROJECT_ID] with your actual project ID. This command will return the details of the DNS managed zone. If the "dnssecState" field is set to "on", then DNSSEC is enabled for that zone. If it's set to "off", then DNSSEC is not enabled.

#### Using Python

To check if DNSSEC (Domain Name System Security Extensions) is enabled for Cloud DNS in Google Cloud Platform (GCP), you can use the Google Cloud SDK (gcloud) or the Google Cloud Client Library for Python. Here are the steps:

1. **Install Google Cloud SDK and Python Client Library:**
   Before you can run any scripts, you need to install the Google Cloud SDK and the Python Client Library. You can do this using pip, the Python package installer.

   ```bash
   pip install --upgrade google-cloud-sdk
   pip install --upgrade google-cloud-dns
   ```

2. **Authenticate your SDK:**
   Use the `gcloud auth login` command to authenticate your SDK. This will open a new browser window where you can log in with your Google account.

   ```bash
   gcloud auth login
   ```

3. **Use Python Script to Check DNSSEC:**
   You can use the following Python script to check if DNSSEC is enabled for all your managed zones. This script uses the `google.cloud.dns` client library to list all managed zones and check their DNSSEC status.

   ```python
   from google.cloud import dns

   def check_dnssec():
       client = dns.Client()
       for zone in client.list_zones():
           if zone.dnssec_state != 'on':
               print(f'DNSSEC is not enabled for {zone.name}')

   if __name__ == '__main__':
       check_dnssec()
   ```

   This script will print the names of all managed zones where DNSSEC is not enabled.

4. **Run the Python Script:**
   Save the script to a file, for example `check_dnssec.py`, and run it using the Python interpreter.

   ```bash
   python check_dnssec.py
   ```

   If DNSSEC is not enabled for any of your managed zones, their names will be printed to the console. If nothing is printed, DNSSEC is enabled for all your managed zones.

</Tab>


<Tab title='Remediation'>
### Remediation

#### Using Console

To remediate the DNSSEC misconfiguration in GCP using the GCP console, follow these steps:

1. Open the GCP console and navigate to the Cloud DNS page.

2. Select the DNS zone for which you want to enable DNSSEC.

3. Click on the "DNSSEC" tab.

4. Click on the "Enable DNSSEC" button.

5. Enter the KSK (Key Signing Key) and ZSK (Zone Signing Key) values. You can either generate these keys yourself or use the default values provided by GCP.

6. Click on the "Enable" button to enable DNSSEC for the selected DNS zone.

7. Once DNSSEC is enabled, you can verify it by checking the "DNSSEC Status" column on the Cloud DNS page. It should show "Enabled" for the selected DNS zone.

That's it! You have successfully remediated the DNSSEC misconfiguration in GCP using the GCP console.

#### Using CLI

To remediate the DNSSEC misconfiguration in GCP using GCP CLI, follow these steps:

1. Open the Google Cloud Console and navigate to the Cloud Shell.

2. In the Cloud Shell, run the following command to enable DNSSEC for Cloud DNS:

   ```
   gcloud dns managed-zones update [ZONE_NAME] --dnssec-state on
   ```

   Replace `[ZONE_NAME]` with the name of the managed zone for which you want to enable DNSSEC.

3. Verify that DNSSEC has been enabled by running the following command:

   ```
   gcloud dns managed-zones describe [ZONE_NAME] --format="json(dnssecConfig.state)"
   ```

   This command will return the DNSSEC state of the managed zone. If DNSSEC is enabled, the output will be:

   ```
   {
     "dnssecConfig": {
       "state": "on"
     }
   }
   ```

4. Repeat steps 2 and 3 for all the managed zones that need to have DNSSEC enabled.

5. Verify that DNSSEC is working by checking the DNSSEC status of your domain using a DNSSEC validation tool.

   DNSViz is a useful tool for this purpose. You can enter your domain name and DNSSEC will be validated for your domain.

By following these steps, you can remediate the DNSSEC misconfiguration in GCP using GCP CLI.

#### Using Python

To remediate the misconfiguration of DNSSEC not being enabled for Cloud DNS in GCP using Python, you can follow the below steps:

1. Import the necessary libraries:

```python
from google.cloud import dns
from google.oauth2 import service_account
```

2. Set up authentication using a service account key:

```python
credentials = service_account.Credentials.from_service_account_file('path/to/service_account_key.json')
client = dns.Client(project='your-project-id', credentials=credentials)
```

3. Get the existing DNS policy for your Cloud DNS zone:

```python
zone_name = 'your-zone-name'
zone = client.zone(zone_name)
dns_policy = zone.dnssec_config
```

4. Check if DNSSEC is already enabled:

```python
if dns_policy.state == 'on':
    print('DNSSEC is already enabled')
else:
    # Enable DNSSEC
    dns_policy.state = 'on'
    zone.update(dns_policy=dns_policy)
    print('DNSSEC has been enabled')
```

5. Verify that DNSSEC is enabled:

```python
if zone.dnssec_config.state == 'on':
    print('DNSSEC is enabled')
else:
    print('DNSSEC is not enabled')
```

By following these steps, you can remediate the misconfiguration of DNSSEC not being enabled for Cloud DNS in GCP using Python.




</Tab>
</Tabs>